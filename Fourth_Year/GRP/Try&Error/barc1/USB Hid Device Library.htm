<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0058)http://labs.mike-obrien.net/view.aspx?projectid=hidlibrary -->
<HTML><HEAD><TITLE>USB Hid Device Library</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8"><LINK 
href="USB Hid Device Library_files/site.css" type=text/css rel=stylesheet><LINK 
href="USB Hid Device Library_files/project.css" type=text/css rel=stylesheet>
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE class=headerContainer>
  <TBODY>
  <TR class=headerContainerRow>
    <TD class=headerContainerCell><A href="http://www.mike-obrien.net/"><IMG 
      src="USB Hid Device Library_files/mike-obrien_logo.jpg" border=0></A></TD>
    <TD class=headerContainerCell align=right width="100%">
      <TABLE class=headerLinkContainer>
        <TBODY>
        <TR>
          <TD class=headerLinkContainerCell style="VERTICAL-ALIGN: bottom"><A 
            href="http://labs.mike-obrien.net/"><IMG 
            style="VERTICAL-ALIGN: bottom" 
            src="USB Hid Device Library_files/header_laboratory.jpg" 
            border=0></A> </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<TABLE class=content>
  <TBODY>
  <TR>
    <TD>
      <CENTER 
      style="PADDING-RIGHT: 30px; PADDING-LEFT: 30px; PADDING-BOTTOM: 30px; PADDING-TOP: 30px">
      <TABLE cellSpacing=0 cellPadding=0 bgColor=#ffffff>
        <TBODY>
        <TR>
          <TD noWrap width=14 
          background="USB Hid Device Library_files/doc_top_left_corner.gif" 
          height=15></TD>
          <TD></TD>
          <TD noWrap width=14 
          background="USB Hid Device Library_files/doc_top_right_corner.gif" 
          height=15></TD></TR>
        <TR>
          <TD noWrap width=14></TD>
          <TD 
          style="PADDING-RIGHT: 30px; PADDING-LEFT: 30px; PADDING-BOTTOM: 30px; PADDING-TOP: 30px">
            <DIV style="FONT-FAMILY: Verdana, Arial" align=left>
            <H3 style="MARGIN-BOTTOM: 4px">USB Hid Device Library</H3>
            <H5 style="MARGIN-TOP: 0px">VERSION 2.0.1</H5>
            <P 
style="FONT-SIZE: 8pt; FONT-FAMILY: Verdana; TEXT-ALIGN: justify">
            <P 
            style="FONT-SIZE: 8pt; FONT-FAMILY: Verdana; TEXT-ALIGN: justify">This 
            library enables you to enumerate and communicate with Hid compatible 
            USB devices in .NET. It offers synchronous and asynchronous read and 
            write functionality as well as notification of insertion and removal 
            of a device. </P>
            <P></P><B style="FONT-SIZE: 9pt; FONT-FAMILY: Verdana">Releases</B> 
            <BR><BR>
            <DIV class=ProjectTableBorder>
            <TABLE cellSpacing=2 cellPadding=5>
              <TBODY>
              <TR>
                <TD class=ProjectTableHeader noWrap>Version</TD>
                <TD class=ProjectTableHeader noWrap>Runtime</TD>
                <TD class=ProjectTableHeader width="100%">Notes</TD></TR>
              <TR>
                <TD class=ProjectTableCell noWrap align=middle><A 
                  href="http://labs.mike-obrien.net/projects/hidlibrary/Downloads/HIDLibrary_2.0.1.zip">2.0.1</A> 
                </TD>
                <TD class=ProjectTableCell noWrap>.NET 2.0</TD>
                <TD class=ProjectTableCell width="100%">Hid Library</TD></TR>
              <TR>
                <TD class=ProjectTableCell noWrap align=middle><A 
                  href="http://labs.mike-obrien.net/projects/hidlibrary/Downloads/IT4XXXScanner.zip">2.0.1</A> 
                </TD>
                <TD class=ProjectTableCell noWrap>.NET 2.0</TD>
                <TD class=ProjectTableCell width="100%">HHP IT4xxx 
                  (IT4600/IT4800)</TD></TR></TBODY></TABLE></DIV><BR><B 
            style="FONT-SIZE: 9pt; FONT-FAMILY: Verdana">Enhancements</B> 
            <BR><BR>
            <DIV class=ProjectTableBorder>
            <TABLE cellSpacing=2 cellPadding=5>
              <TBODY>
              <TR>
                <TD class=ProjectTableHeader noWrap>Status</TD>
                <TD class=ProjectTableHeader width="100%">Description</TD></TR>
              <TR>
                <TD class=ProjectTableCell noWrap>DONE</TD>
                <TD class=ProjectTableCell width="100%">Add device events 
                  (Inserted/Removed).</TD></TR>
              <TR>
                <TD class=ProjectTableCell noWrap>DONE</TD>
                <TD class=ProjectTableCell width="100%">Add asynchronous Read 
                  and Write functionality.</TD></TR>
              <TR>
                <TD class=ProjectTableCell noWrap>DONE</TD>
                <TD class=ProjectTableCell width="100%">Convert to .NET 
              2.0.</TD></TR>
              <TR>
                <TD class=ProjectTableCell noWrap>DONE</TD>
                <TD class=ProjectTableCell width="100%">Fix memory leak when 
                  monitoring device events.</TD></TR></TBODY></TABLE></DIV><BR><B 
            style="FONT-SIZE: 9pt; FONT-FAMILY: Verdana">Source Code (<A 
            href="http://subversion.tigris.org/">Subversion</A>)</B> <BR><BR>
            <DIV class=ProjectTableBorder>
            <TABLE cellSpacing=2 cellPadding=5>
              <TBODY>
              <TR>
                <TD class=ProjectTableHeader noWrap>Name</TD>
                <TD class=ProjectTableHeader noWrap>Runtime</TD>
                <TD class=ProjectTableHeader width="100%">Repository URL</TD>
                <TD class=ProjectTableHeader noWrap>Browse</TD></TR>
              <TR>
                <TD class=ProjectTableCell noWrap><A 
                  href="https://wush.net/websvn/mobrien/listing.php?repname=mobrien&amp;path=%2FHIDLibrary%2FLibrary%2F">Hid 
                  Library</A> </TD>
                <TD class=ProjectTableCell noWrap>.NET 2.0</TD>
                <TD class=ProjectTableCell width="100%"><A 
                  href="https://wush.net/svn/mobrien/HIDLibrary/Library/">https://wush.net/svn/mobrien/HIDLibrary/Library/</A> 
                </TD>
                <TD class=ProjectTableCell noWrap align=middle><A 
                  href="https://wush.net/websvn/mobrien/listing.php?repname=mobrien&amp;path=%2FHIDLibrary%2FLibrary%2F"><IMG 
                  alt="Browse Source Code" 
                  src="USB Hid Device Library_files/view.png" border=0> 
              </A></TD></TR>
              <TR>
                <TD class=ProjectTableCell noWrap><A 
                  href="https://wush.net/websvn/mobrien/listing.php?repname=mobrien&amp;path=%2FHIDLibrary%2FDevices%2FIT4XXX2DScanner%2F">HHP 
                  IT4xxx (IT4600/IT4800)</A> </TD>
                <TD class=ProjectTableCell noWrap>.NET 2.0</TD>
                <TD class=ProjectTableCell width="100%"><A 
                  href="https://wush.net/svn/mobrien/HIDLibrary/Devices/IT4XXX2DScanner/">https://wush.net/svn/mobrien/HIDLibrary/Devices/IT4XXX2DScanner/</A> 
                </TD>
                <TD class=ProjectTableCell noWrap align=middle><A 
                  href="https://wush.net/websvn/mobrien/listing.php?repname=mobrien&amp;path=%2FHIDLibrary%2FDevices%2FIT4XXX2DScanner%2F"><IMG 
                  alt="Browse Source Code" 
                  src="USB Hid Device Library_files/view.png" border=0> 
              </A></TD></TR></TBODY></TABLE></DIV><BR><B 
            style="FONT-SIZE: 9pt; FONT-FAMILY: Verdana">Example</B> <BR><BR>
            <DIV 
            style="FONT-SIZE: 8pt; MARGIN-LEFT: 20px; FONT-FAMILY: Verdana; TEXT-ALIGN: justify">
            <P 
            style="FONT-SIZE: 8pt; FONT-FAMILY: Verdana; TEXT-ALIGN: justify">This 
            code demonstrates how to use the Hid Library with an HHP IT4600 
            Scanner.</P>
            <DIV class=ProjectCodeBorder>
            <TABLE cellSpacing=0 cellPadding=0>
              <TBODY>
              <TR class=ProjectCodeHeader>
                <TD class=ProjectCodeHeaderCell noWrap width="100%">C#</TD>
                <TD class=ProjectCodeHeaderCopyCode noWrap width="100%"><SPAN 
                  style="CURSOR: pointer; COLOR: blue" 
                  onclick="javascript:window.clipboardData.setData('Text', document.getElementById('CodeBlock2').innerText)"><IMG 
                  src="USB Hid Device Library_files/copycode.gif" 
                  align=absMiddle> Copy Code </SPAN></TD></TR>
              <TR>
                <TD class=ProjectCodeBlock colSpan=2><PRE class=ProjectCode id=CodeBlock2>using HIDLibrary;
using System.Diagnostics;
using System.Threading;

...

HIDLibrary.HidDevice[] HidDeviceList;
HidDevice HidDevice;

// Enumerate the devices with the Vendor Id
// and Product Id of the IT4600
HidDeviceList = HidDevices.Enumerate(0x0536, 0x0207);

if (HidDeviceList.Length &gt; 0) {

    // Grab the first device
    HidDevice = HidDeviceList[0];

    // Check if connected...

    Debug.WriteLine("Connected: " + HidDevice.IsConnected.ToString());

    byte[] OutData = new byte[HidDevice.Capabilities.OutputReportByteLength - 1];

    // Send a report to initiate an error sound

    OutData[0] = 0x04;
    OutData[1] = 0x020;

    HidDevice.Write(OutData);

    // Send a report to initiate an success sound

    OutData[1] = 0x040;

    HidDevice.Write(OutData);

    // Send a report to start a scan

    OutData[1] = 0x04;

    HidDevice.Write(OutData);

    Thread.Sleep(2000);

    // Send a report to stop the scan

    OutData[1] = 0x01;

    HidDevice.Write(OutData);

    // Blocking read of report

    HidDeviceData InData;
    string Text;

    InData = HidDevice.Read();

    Text = System.Text.ASCIIEncoding.ASCII.GetString(InData.Data);

    Debug.WriteLine(Text);

}
</PRE></TD></TR></TBODY></TABLE></DIV>
            <DIV class=ProjectCodeBorder>
            <TABLE cellSpacing=0 cellPadding=0>
              <TBODY>
              <TR class=ProjectCodeHeader>
                <TD class=ProjectCodeHeaderCell noWrap width="100%">VB.NET</TD>
                <TD class=ProjectCodeHeaderCopyCode noWrap width="100%"><SPAN 
                  style="CURSOR: pointer; COLOR: blue" 
                  onclick="javascript:window.clipboardData.setData('Text', document.getElementById('CodeBlock3').innerText)"><IMG 
                  src="USB Hid Device Library_files/copycode.gif" 
                  align=absMiddle> Copy Code </SPAN></TD></TR>
              <TR>
                <TD class=ProjectCodeBlock colSpan=2><PRE class=ProjectCode id=CodeBlock3>Imports HIDLibrary
Imports System.Threading

...

    Dim HidDeviceList As HIDLibrary.HidDevice()
    Dim HidDevice As HidDevice

    ' Enumerate the devices with the Vendor Id
    ' and Product Id of the IT4600
    HidDeviceList = HidDevices.Enumerate(&amp;H0536, &amp;H0207)

    If HidDeviceList.Length &gt; 0 Then

        ' Grab the first device
        HidDevice = HidDeviceList(0)

        ' Check if connected...

        Debug.WriteLine("Connected: " + HidDevice.IsConnected.ToString())

        Dim OutData(HidDevice.Capabilities.OutputReportByteLength - 1) As Byte

        ' Send a report to initiate an error sound

        OutData(0) = &amp;H4
        OutData(1) = &amp;H20

        HidDevice.Write(OutData)

        ' Send a report to initiate an success sound

        OutData(1) = &amp;H40

        HidDevice.Write(OutData)

        ' Send a report to start a scan

        OutData(1) = &amp;H4

        HidDevice.Write(OutData)

        Thread.Sleep(2000)

        ' Send a report to stop the scan

        OutData(1) = &amp;H1

        HidDevice.Write(OutData)

        ' Blocking read of report

        Dim InData As HidDeviceData
        Dim Text As String

        InData = HidDevice.Read()

        Text = System.Text.ASCIIEncoding.ASCII.GetString(InData.Data)

        Debug.WriteLine(Text)

    End If

End Sub
</PRE></TD></TR></TBODY></TABLE></DIV></DIV><BR><B 
            style="FONT-SIZE: 9pt; FONT-FAMILY: Verdana">Related Resources</B> 
            <BR><BR>
            <DIV class=ProjectTableBorder>
            <TABLE cellSpacing=2 cellPadding=5>
              <TBODY>
              <TR>
                <TD class=ProjectTableHeader noWrap>Resource Name</TD>
                <TD class=ProjectTableHeader width="100%">Description</TD></TR>
              <TR>
                <TD class=ProjectTableCell noWrap><A 
                  href="http://www.lvr.com/hidpage.htm">Jan Axelson's USB Hid 
                  Programming Page</A> </TD>
                <TD class=ProjectTableCell width="100%">Excelent resource for 
                  USB Hid development. Full code samples in a number of 
                  different languages demonstrate how to use the Windows setup 
                  and Hid API.</TD></TR>
              <TR>
                <TD class=ProjectTableCell noWrap><A 
                  href="http://www.lvr.com/usbc.htm">Jan Axelson's 'USB 
                  Complete'</A> </TD>
                <TD class=ProjectTableCell width="100%">Jan Axelson's guide to 
                  USB programming. Very good covereage of Hid. Must read for 
                  anyone new to Hid 
            programming.</TD></TR></TBODY></TABLE></DIV><BR></DIV></TD>
          <TD noWrap width=14></TD></TR>
        <TR>
          <TD noWrap width=14 
          background="USB Hid Device Library_files/doc_bottom_left_corner.gif" 
          height=14></TD>
          <TD></TD>
          <TD noWrap width=14 
          background="USB Hid Device Library_files/doc_bottom_right_corner.gif" 
          height=14></TD></TR></TBODY></TABLE></CENTER></TD></TR></TBODY></TABLE>
<CENTER><BR><IMG src="USB Hid Device Library_files/copyright.jpg"> <IMG 
src="USB Hid Device Library_files/digit_2.jpg"><IMG 
src="USB Hid Device Library_files/digit_0.jpg"><IMG 
src="USB Hid Device Library_files/digit_0.jpg"><IMG 
src="USB Hid Device Library_files/digit_2.jpg"><IMG 
src="USB Hid Device Library_files/char_dash.jpg"><IMG 
src="USB Hid Device Library_files/digit_2.jpg"><IMG 
src="USB Hid Device Library_files/digit_0.jpg"><IMG 
src="USB Hid Device Library_files/digit_0.jpg"><IMG 
src="USB Hid Device Library_files/digit_7.jpg"> <IMG 
src="USB Hid Device Library_files/michaelpobrien.jpg"><BR><BR><IMG 
src="USB Hid Device Library_files/terms_1.jpg"><BR><IMG 
src="USB Hid Device Library_files/terms_2.jpg"><A 
href="http://labs.mike-obrien.net/terms.aspx"><IMG 
src="USB Hid Device Library_files/terms_3.jpg" border=0></A><IMG 
src="USB Hid Device Library_files/terms_4.jpg"> <BR><BR><IMG 
src="USB Hid Device Library_files/digit_1.jpg"><IMG 
src="USB Hid Device Library_files/digit_1.jpg"><IMG 
src="USB Hid Device Library_files/digit_0.jpg"><IMG 
src="USB Hid Device Library_files/digit_8.jpg"><IMG 
src="USB Hid Device Library_files/digit_9.jpg"> &nbsp;<IMG 
src="USB Hid Device Library_files/visitors.jpg"> </CENTER><BR></BODY></HTML>
