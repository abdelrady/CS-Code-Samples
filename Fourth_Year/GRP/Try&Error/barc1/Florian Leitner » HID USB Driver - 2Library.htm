<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3c.org/TR/1999/REC-html401-19991224/loose.dtd">
<!-- saved from url=(0074)http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/ -->
<HTML xmlns="http://www.w3.org/1999/xhtml"><HEAD 
profile=http://gmpg.org/xfn/11><TITLE>Florian Leitner » HID USB Driver / Library</TITLE>
<META http-equiv=Content-Type content="text/html; charset=UTF-8">
<META content=global name=distribution><!-- Robots -->
<META content=ALL,INDEX,FOLLOW,ARCHIVE name=robots>
<META content="7 days" name=revisit-after>
<META content=en name=language>
<META content="MSHTML 6.00.2900.2180" name=GENERATOR><!-- leave this for stats please --><LINK 
href="wp-content/favicon.ico" type=image/x-icon rel="shortcut icon"><LINK 
title="RSS 2.0" href="http://feeds.feedburner.com/FlorianLeitner" 
type=application/rss+xml rel=alternate><LINK title="RSS .92" 
href="http://feeds.feedburner.com/FlorianLeitner" type=text/xml 
rel=alternate><LINK title="Atom 0.3" 
href="http://feeds.feedburner.com/FlorianLeitner" type=application/atom+xml 
rel=alternate><LINK href="http://www.florian-leitner.de/xmlrpc.php" 
rel=pingback><LINK title="November 2007" 
href="http://www.florian-leitner.de/index.php/2007/11/" rel=archives><LINK 
title="October 2007" href="http://www.florian-leitner.de/index.php/2007/10/" 
rel=archives><LINK title="September 2007" 
href="http://www.florian-leitner.de/index.php/2007/09/" rel=archives><LINK 
title="August 2007" href="http://www.florian-leitner.de/index.php/2007/08/" 
rel=archives><LINK title=RSD href="http://www.florian-leitner.de/xmlrpc.php?rsd" 
type=application/rsd+xml rel=EditURI><!-- all in one seo pack 1.2.3 -->
<META 
content="A library which enables you to access a USB Human Interface Device (HID) with your C# application." 
name=description>
<META 
content="USB HID Library,C# (CSharp),English Posts,Software,HID, USB, C#, CSharp, USB Driver, hid.dll" 
name=keywords><!-- Start Of Script Generated By WP-Polls 2.20 -->
<SCRIPT src="Florian Leitner » HID USB Driver - 2Library_files/tw-sack.js" 
type=text/javascript></SCRIPT>

<SCRIPT src="Florian Leitner » HID USB Driver - 2Library_files/polls-js.php" 
type=text/javascript></SCRIPT>
<LINK media=screen 
href="Florian Leitner » HID USB Driver - 2Library_files/polls-css.css" 
type=text/css rel=stylesheet>
<STYLE type=text/css>.wp-polls .pollbar {
	BORDER-RIGHT: #c8c8c8 1px solid; BORDER-TOP: #c8c8c8 1px solid; FONT-SIZE: 6px; BACKGROUND-IMAGE: url(http://www.florian-leitner.de/wp-content/plugins/polls/images/default/pollbg.gif); MARGIN: 1px; BORDER-LEFT: #c8c8c8 1px solid; LINE-HEIGHT: 8px; BORDER-BOTTOM: #c8c8c8 1px solid; HEIGHT: 8px
}
</STYLE>
<!-- End Of Script Generated By WP-Polls 2.20 --><!-- Start Of Script Generated By WP-UserOnline 2.20 -->
<SCRIPT 
src="Florian Leitner » HID USB Driver - 2Library_files/useronline-js.php" 
type=text/javascript></SCRIPT>
<!-- End Of Script Generated By WP-UserOnline 2.20 -->
<STYLE type=text/css media=screen>@import url( http://www.florian-leitner.de/wp-content/themes/fsubtle-10/style.css );
</STYLE>

<SCRIPT src="Florian Leitner » HID USB Driver - 2Library_files/urchin.js" 
type=text/javascript>
</SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-467066-2";
urchinTracker();
</SCRIPT>
</HEAD>
<BODY class=log id=home>
<DIV id=wrap>
<DIV id=header>
<H1 id=blogname><A href="http://www.florian-leitner.de/">Florian 
Leitner</A></H1>
<DIV class=description>you can get it if you really want</DIV></DIV>
<DIV id=main>
<DIV id=content>
<P align=center><BR>
<SCRIPT type=text/javascript><!--
google_ad_client = "pub-3386113411654026";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
//2007-08-03: blog orange round
google_ad_channel = "8807110255";
google_color_border = "F2984C";
google_color_bg = "F0F0F0";
google_color_link = "F2984C";
google_color_text = "000000";
google_color_url = "F2984C";
google_ui_features = "rc:6";
//-->
</SCRIPT>

<SCRIPT src="Florian Leitner » HID USB Driver - 2Library_files/show_ads.js" 
type=text/javascript>
</SCRIPT>
</P>
<DIV class=entry><!--<h2 class="entrydate">
    August 3, 2007-->
<H2></H2>
<H3 class=entrytitle id=post-35><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/" 
rel=bookmark>HID USB Driver / Library </A></H3>
<DIV class=entrybody>
<H4>Table of Contents</H4>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#motivation"></A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#motivation">- 
Motivation</A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#hid-class"></A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#hid-class">- 
The Human Interface Device Class</A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#usb-stuff"></A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#usb-stuff">- 
USB Specific Stuff</A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#interface"></A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#interface">- 
The HID USB Device Interface</A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#integrate"></A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#integrate">- 
How to Integrate the Library into a Visual Studio Project</A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#internal"></A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#internal">- 
How the HID USB Library works internal</A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#download"></A></P>
<P><A 
href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#download">- 
Where can I get the HID USB Library</A></P>
<P><A title=motivation name=motivation></A></P>
<H4><A title=motivation name=motivation></A>Motivation</H4>
<P>We wanted to find a new solution to connect our Hardware to the PC via USB 
because the experience we made with FTDI Chips was not satisfying at all.</P>
<P>The USB controller of our choice was the Maxim MAX3420E that is connected to 
the microcontroller through a Serial Peripheral Interface (SPI).</P>
<P>The MAX3420E comes without any drivers or libraries you can use to “speak” 
with it.</P>
<P>This is the reason why I had to develop my own “driver”.</P>
<P>After a day of reading and googling I decided that the best an easiest way is 
to use the Human Interface Device Class (HID). The HID-Class is a generic device 
class which means that all devices in this class are supported by Microsoft 
Windows and there are already existing DLLs with functions that we can use.</P>
<P>The start point for the “driver” was an article I found in the Microsoft 
developer network: „Is That You? Writing Better Software for Cool USB Hardware” 
written by <A href="http://www.hanselman.com/blog/">Scott Hanselman</A>. (<A 
href="http://msdn.microsoft.com/coding4fun/someassemblyrequired/isthatyou/default.aspx">http://msdn.microsoft.com/coding4fun/someassemblyrequired/isthatyou/default.aspx</A>). 
Scott’s software is based on the <A 
href="http://www.lvr.com/hidpage.htm">USBSharp Class</A>.</P>
<P>Luckily the MAX3420E comes with a code sample that configures the controller 
as a Human Interface Device so we didn’t have much trouble to find out how to 
configure it as HID. <A title=hid-class name=hid-class></A></P>
<H4><A title=hid-class name=hid-class></A>The Human Interface Device Class</H4>
<P>As mentioned above the HID Class is a generic device class so the driver is 
integrated in the operating system which makes things easy. If a new HID device 
is plugged in there is no need of any driver installation. The functions to 
access and control a HID device are included in the Windows hid.dll which is 
located in the System32 folder.</P>
<P>If you do not know for sure if your device is a HID device you should have a 
look at this little application. It is a part of windows and you can run it with 
the start -&gt; run “msinfo32.exe” command. Or under Windows Vista just press 
the Windows-Key Type msinfo32.exe and hit enter.</P>
<P><A 
href="http://www.florian-leitner.de/wp-content/uploads/2007/08/windowslivewriterhidusbdriverlibrary-8620clip-image00124.gif" 
atomicselection="true"><IMG height=106 
src="Florian Leitner » HID USB Driver - 2Library_files/windowslivewriterhidusbdriverlibrary-8620clip-image00114.gif" 
width=240 border=0></A></P>
<P><STRONG><EM><BR></EM></STRONG><A title=usb-stuff name=usb-stuff></A></P>
<H4><A title=usb-stuff name=usb-stuff></A>USB Specific Stuff</H4>
<H5>Identify your USB device</H5>
<P>USB device are identified by their vendor and product id. Those IDs are 
consisting of a prefix (“vid_” for vendor id or “pid_” for product id) and a 4 
digit HEX number. The MAX3420E for example has the vendor id vid_06ba and the 
product id pid_5346. Usually both values can be changed in the source code of 
the USB device (assumes that you have access to that code).</P>
<H5>Package Size / Communication Speed</H5>
<P>HID devices are communicating with the pc through so called hid reports. 
Those reports consist of 64 bytes of data. Each microsecond one report is send 
from pc to the USB device and vice versa. This means that theoretical a transfer 
rate of 64 Kbytes per second can be achieved. <A title=interface 
name=interface></A></P>
<H4><A title=interface name=interface></A>The HID USB Driver Interface</H4>
<P>The driver is written in C# and designed as a DLL, this has the benefit so it 
is very easy to integrate the drive into a new project. Just import the DLL or 
the project and you are finished.</P>
<P>I tried to keep the interface as simple as possible on the one hand and on 
the other hand to integrate as much functionality as possible.</P>
<P>At the moment it has the following functions:</P>
<H4>USBInterface(String,String) constructor</H4>
<P>This method initializes a new instance of the USBInterface class.</P>
<H6>Parameters</H6>
<P><STRONG><EM>vid</EM></STRONG><STRONG> </STRONG></P>
<P>The vendor id of the USB device (e.g. vid_06ba)</P>
<P><STRONG><EM>pid</EM></STRONG><STRONG> </STRONG></P>
<P>The product id of the USB device (e.g. pid_5346)</P>
<H4>USBInterface(String) constructor</H4>
<P>This method initializes a new instance of the USBInterface class.</P>
<H6>Parameters</H6>
<P><STRONG><EM>vid</EM></STRONG><STRONG> </STRONG></P>
<P>The vendor id of the USB device (e.g. vid_06ba).</P>
<H4>Connect() method</H4>
<P>This method establishes a connection to the USB device. You can only 
establish a connection to a device if you have used the construct with vendor 
AND product id. Otherwise it will connect to a device which has the same vendor 
id is specified, this means if more than one device with these vendor id is 
plugged in, you can’t be determine to which one you will connect.</P>
<H6>Returns</H6>
<P>False if any error occurs</P>
<H4>Disconnect() method</H4>
<P>Disconnects the device</P>
<H4>getDeviceList() method</H4>
<P>Returns a list of devices with the vendor id (or vendor and product id) 
specified in the constructor. This function is needed if you want to know how 
many (and which) devices with the specified vendor id are plugged in.</P>
<H6>Returns</H6>
<P>String list with device paths</P>
<H4>write(Byte[]) method</H4>
<P>This method writes the specified bytes to the USB device. If the array length 
exceeds 64, the array while be divided into several arrays with each containing 
64 bytes. The 0-63 byte of the array is sent first, then the 64-127 byte and so 
on.</P>
<H6>Parameters</H6>
<P><STRONG><EM>bytes</EM></STRONG><STRONG> </STRONG></P>
<P>The bytes to send.</P>
<H6>Returns</H6>
<P>Returns true if all bytes have been written successfully</P>
<H4>startRead() method</H4>
<P>This method is used to activate the “reading-State”. If you execute this 
command a thread is started which listens to the USB device and waits for 
data.</P>
<H4>stopRead() method</H4>
<P>This method switches from “reading-State” into “idle-State”. By executing 
this command the read data thread is stopped and now data will be received.</P>
<H4>enableUsbBufferEvent(EventHandler) method</H4>
<P>By calling this method with an event handler (System.EventHandler) the 
add-event listener of the USB Buffer is enabled. Thus whenever a dataset is 
added to the buffer (and so received from the USB device) the event handler 
method will be called.</P>
<H6>Parameters</H6>
<P><STRONG><EM>eHandler</EM></STRONG><STRONG> </STRONG></P>
<P>The event handler (System.EventHandler) method.</P>
<P><STRONG><EM><BR></EM></STRONG><A title=integrate name=integrate></A></P>
<H4><A title=integrate name=integrate></A>How to integrate the HID USB Library 
into a Visual Basic Project</H4>
<P>There a two ways to integrate the HID USB Library into a Visual Studio 
project. One is to add the library project to your Visual Studio solution. The 
other way is to add a reference to the USBHIDDRIVER.dll in the visual basic 
project you want to use.</P>
<H5>Add the library project to a Visual Studio 2005 solution</H5>
<P><STRONG>1. </STRONG>Open your Visual Studio solution.<STRONG> </STRONG>Go to 
“File &gt; Add &gt; Existing Project”</P>
<P><STRONG><IMG height=120 hspace=12 
src="Florian Leitner » HID USB Driver - 2Library_files/windowslivewriterhidusbdriverlibrary-8620clip-image00314.gif" 
width=240></STRONG></P>
<P><STRONG>2. </STRONG>The following Dialog will open. Navigate to the 
USBHIDDRIVER.csproj and click open.</P>
<P><A 
href="http://www.florian-leitner.de/wp-content/uploads/2007/08/windowslivewriterhidusbdriverlibrary-8620clip-image00524.jpg" 
atomicselection="true"><IMG 
style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
height=154 
src="Florian Leitner » HID USB Driver - 2Library_files/windowslivewriterhidusbdriverlibrary-8620clip-image00514.jpg" 
width=240 border=0></A></P>
<P><STRONG>3.</STRONG> Right click on your Visual Studio project and click « Add 
Reference »</P>
<P><IMG height=240 hspace=12 
src="Florian Leitner » HID USB Driver - 2Library_files/windowslivewriterhidusbdriverlibrary-8620clip-image00714.gif" 
width=203></P>
<P><STRONG>4.</STRONG> Select the „Projects“-tab. Then select the USBHIDDRIVER 
and click ok.</P>
<P><IMG height=196 hspace=12 
src="Florian Leitner » HID USB Driver - 2Library_files/windowslivewriterhidusbdriverlibrary-8620clip-image009-thumb2.jpg" 
width=240></P>
<H5>Add the USBHIDDRIVER.dll to a Visual Studio project</H5>
<P><STRONG>1. </STRONG>Right click on your Visual Studio project and click « Add 
Reference »</P>
<P><IMG height=210 hspace=12 
src="Florian Leitner » HID USB Driver - 2Library_files/windowslivewriterhidusbdriverlibrary-8620clip-image01113.gif" 
width=240></P>
<P><STRONG>2. </STRONG>Select the „Browse”-tab. Then navigate to the 
USBHIDDRIVER.dll.dll and click ok.</P>
<P><IMG height=188 hspace=12 
src="Florian Leitner » HID USB Driver - 2Library_files/windowslivewriterhidusbdriverlibrary-8620clip-image013-thumb2.jpg" 
width=240></P>
<H5>Use the USBHIDDRIVER.dll with Visual Basic 6</H5>
<P>The .Net runtime allows unmanaged COM aware clients (like Visual Basic 6 
applications) to access .Net components through the COM interop and through the 
tools provided by the framework.</P>
<P>The USBHIDDRIVER.dll is a .NET assembly which can not be accessed by Visual 
Basic 6. Therefore we have to create a type library which can be used with 
Visual Basic 6. This can be done with the Tool RegAsm.exe that you will find in 
the directory of your .Net framework installation.</P>
<P>Create a .bat file in the directory of the USBHIDDRIVER.dll and write the 
following command into it. Then run the bat file.</P>
<P>“C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\RegAsm.exe” 
USBHIDDRIVER.dll.dll /tlb: USBHIDDRIVER.dll.tlb</P>
<P>Now you have to copy both the dll and the tlb file in the same directory as 
the application which is consuming it.</P>
<P><STRONG><EM><BR></EM></STRONG></P>
<H4>How to use the HID USB Library</H4>
<P>Let’s say you want to communicate with an USB device that has the vendor id 
vid_06ba and multiple products id.</P>
<P>So the first thing you may want to have is a list of all devices connected to 
the pc which have the specified vendor id. To do this just make a new instance 
of the USBInterface class with only the vendor id as parameter. Then call the 
getDeviceList-Mehtod and you will receive a list of the devices that are 
connected.</P>
<P>USBHIDDRIVER.USBInterface usb = new USBInterface(”vid_06ba”);</P>
<P>String[] list = usbI.getDeviceList();</P>
<P>For communicating with the device make a new instance of the USBInterface 
class with the vector id and the product id as parameter. After that, you can 
call the connect-method and a connection will be established.</P>
<P>USBHIDDRIVER.USBInterface usb = new USBInterface(”vid_0b6a”, “pid_5346″);</P>
<P>usb.Connect();</P>
<P><STRONG></STRONG></P>
<P>Once your device is connected you can read or write data. To write data just 
call the write method with an array of bytes you want to send as parameter.</P>
<P>For reading you have to options: first without the USB buffer event and 
second with USB buffer event.</P>
<P>If the event is enabled, the event handler method will be called when a new 
dataset is received.</P>
<P>Otherwise you can process the data with a timer or something like this.</P>
<P>usb.write(startByte);</P>
<P>usb.enableUsbBufferEvent(new System.EventHandler(myEventCacher));</P>
<P>Thread.Sleep(5);</P>
<P>usb.startRead();</P>
<P>…</P>
<P>usb.stopRead();</P>
<P>usb.write(stopByte)</P>
<H4></H4>
<P><STRONG><EM><BR></EM></STRONG><A title=internal name=internal></A></P>
<H4><A title=internal name=internal></A>How the HID USB Library works 
internal</H4>
<P>The library is based on the USBSharp class that imports all needed methods 
from the kernel32.dll and hid.dll. The HIDUSBDevice class wraps those methods 
and handles the read thread. The USBInterface is the main interface, which is 
accessible from outside the dll. In the USBInterface class exists a object of 
the ListWithEvent, which is basically a ArrayList with the bonus that an event 
is fired when a new dataset is added. Last but not least in the 
HidApiDeclaration class you will find some declarations needed for the whole 
hid-thing.</P>
<P><A 
href="http://www.florian-leitner.de/wp-content/uploads/2007/08/windowslivewriterhidusbdriverlibrary-8620clip-image01511123.jpg" 
atomicselection="true"><IMG 
style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
height=240 
src="Florian Leitner » HID USB Driver - 2Library_files/windowslivewriterhidusbdriverlibrary-8620clip-image01511113.jpg" 
width=192 border=0></A> <A title=download name=download></A></P>
<H4><A title=download name=download></A>Where can I get the HID USB 
Library?</H4>
<P>The project is hosted at <A 
title=http://code.google.com/p/csharp-usb-hid-driver/ 
href="http://code.google.com/p/csharp-usb-hid-driver/">http://code.google.com/p/csharp-usb-hid-driver/</A>. 
There is also a Wiki and an Issue-Tracker.</P>
<DIV class=entrymeta>August 03rd 2007 Posted to <A 
title="View all posts in USB HID Library" 
href="http://www.florian-leitner.de/index.php/category/usb-hid-library/" 
rel="category tag">USB HID Library</A>, <A title="View all posts in C# (CSharp)" 
href="http://www.florian-leitner.de/index.php/category/csharp/" 
rel="category tag">C# (CSharp)</A>, <A title="View all posts in English Posts" 
href="http://www.florian-leitner.de/index.php/category/english-posts/" 
rel="category tag">English Posts</A>, <A title="View all posts in Software" 
href="http://www.florian-leitner.de/index.php/category/software/" 
rel="category tag">Software</A> </DIV>
<P class=comments_link></P></DIV><!--
	<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
				xmlns:dc="http://purl.org/dc/elements/1.1/"
				xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
			<rdf:Description rdf:about="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/"
    dc:identifier="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/"
    dc:title="HID USB Driver / Library"
    trackback:ping="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/trackback/" />
</rdf:RDF>	--></DIV>
<DIV id=commentblock><!--comments area-->
<H2 id=comments>Comments </H2>
<OL id=commentlist>
  <LI class=alt id=comment-2>
  <DIV class=commentname><SPAN class=commentauthor>Jonas </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>September 2nd, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-2">8:45 
  pm </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>Were can I download this library?</P>
  <P>Thanks!</P></DIV><!-- <div class="commenttext"><p>Were can I download this library?</p>
<p>Thanks!</p>
</div> -->
  <LI class=standard id=comment-3>
  <DIV class=commentname><SPAN class=commentauthor>Dennis Haub </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>September 3rd, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-3">5:48 
  pm </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>Hi!</P>
  <P>Where can I get this HID USB Driver?</P>
  <P>Can you send it to me???</P>
  <P>Thx and have a nice day! Dennis <IMG class=wp-smiley alt=:) 
  src="Florian Leitner » HID USB Driver - 2Library_files/icon_smile.gif"></P></DIV><!-- <div class="commenttext"><p>Hi!</p>
<p>Where can I get this HID USB Driver?</p>
<p>Can you send it to me???</p>
<p>Thx and have a nice day! Dennis <img src='http://www.florian-leitner.de/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /></p>
</div> -->
  <LI class=alt id=comment-5>
  <DIV class=commentname><SPAN class=commentauthor>Florian Leitner </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>September 19th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-5">5:15 
  pm </A></SPAN></DIV>
  <DIV class=commenttext-admin>
  <P>Hi</P>
  <P>you can download it here:</P>
  <P><A href="http://code.google.com/p/csharp-usb-hid-driver/downloads/list" 
  rel=nofollow>http://code.google.com/p/csharp-usb-hid-driver/downloads/list</A></P></DIV><!-- <div class="commenttext"><p>Hi</p>
<p>you can download it here:</p>
<p><a href="http://code.google.com/p/csharp-usb-hid-driver/downloads/list" rel="nofollow">http://code.google.com/p/csharp-usb-hid-driver/downloads/list</a></p>
</div> -->
  <LI class=standard id=comment-6>
  <DIV class=commentname><SPAN class=commentauthor>Alex M </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>September 21st, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-6">6:26 
  am </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>How do I get the result of whatever is sent back from USB? I got the point 
  of usb.read() its something like comm port get bytes, but how can I assing 
  results to the variable?</P></DIV><!-- <div class="commenttext"><p>How do I get the result of whatever is sent back from USB? I got the point of usb.read() its something like comm port get bytes, but how can I assing results to the variable?</p>
</div> -->
  <LI class=alt id=comment-7>
  <DIV class=commentname><SPAN class=commentauthor>Florian Leitner </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>September 21st, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-7">12:23 
  pm </A></SPAN></DIV>
  <DIV class=commenttext-admin>
  <P>The usb.read() function only starts the read process.<BR>All data, which is 
  read from USB is stored in usbBuffer (an ArrayList in the USBInterface 
  Class).</P></DIV><!-- <div class="commenttext"><p>The usb.read() function only starts the read process.<br />
All data, which is read from USB is stored in usbBuffer (an ArrayList in the USBInterface Class).</p>
</div> -->
  <LI class=standard id=comment-8>
  <DIV class=commentname><SPAN class=commentauthor>Alex M </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>September 21st, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-8">5:38 
  pm </A></SPAN></DIV>
  <DIV class=commenttext>
  <P><IMG class=wp-smiley alt=:( 
  src="Florian Leitner » HID USB Driver - 2Library_files/icon_sad.gif"> I tryed 
  lblHID.DataSource = USBInterface.usbBuffer and im getting empty array. How 
  does the buffer works? Does it read every port or it reads the port that is 
  opened automatically? Can you post full working code that reads usb data. Also 
  how does this reading deals with USB addreeses, like my USB has 2 temperature 
  sensors, If i use your DLL should I get all sensors data or should i request 
  spesific address of the sensor (some how)?</P></DIV><!-- <div class="commenttext"><p> <img src='http://www.florian-leitner.de/wp-includes/images/smilies/icon_sad.gif' alt=':(' class='wp-smiley' /> I tryed  lblHID.DataSource = USBInterface.usbBuffer and im getting empty array. How does the buffer works? Does it read every port or it reads the port that is opened automatically? Can you post full working code that reads usb data. Also how does this reading deals with USB addreeses, like my USB has 2 temperature sensors, If i use your DLL should I get all sensors data or should i request spesific address of the sensor (some how)?</p>
</div> -->
  <LI class=alt id=comment-9>
  <DIV class=commentname><SPAN class=commentauthor><A 
  href="http://www.florian-leitner.de/" rel="external nofollow">Florian 
  Leitner</A> </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>September 24th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-9">9:26 
  am </A></SPAN></DIV>
  <DIV class=commenttext-admin>
  <P>&lt;p&gt;There is a working example in the project already (TestFixture.cs 
  in TESTS folder).<BR>All USB devices are identified by their USB vendor and 
  product ID (In the example the vendor id is vid_0b6a, and the product id 
  pid_0022).<BR>If you have only one USB out for two sensors this question can 
  only be answered by the specification / manual of your hardware.<BR>Here is an 
  example of how to read something USBHIDDRIVER.USBInterface usbI = new 
  USBInterface(”vid_0b6a”, 
  “pid_0022″)<BR>usbI.Connect()<BR>usbI.startRead()<BR>Thread.Sleep(5)<BR>for 
  (int i = 0; i &lt; 200; i++)<BR>{<BR>// DO SOMETHING WITH 
  USBHIDDRIVER.USBInterface.usbBuffer 
  HERE<BR>Thread.Sleep(5)<BR>}<BR>usbI.stopRead()</P></DIV><!-- <div class="commenttext"><p>&lt;p&gt;There is a working example in the project already (TestFixture.cs in TESTS folder).<br />
All USB devices are identified by their USB vendor and product ID (In the example the vendor id is vid_0b6a, and the product id pid_0022).<br />
If you have only one USB out for two sensors this question can only be answered by the specification / manual of your hardware.<br />
Here is an example of how to read something USBHIDDRIVER.USBInterface usbI = new USBInterface(&#8221;vid_0b6a&#8221;, &#8220;pid_0022&#8243;)<br />
usbI.Connect()<br />
usbI.startRead()<br />
Thread.Sleep(5)<br />
for (int i = 0; i &lt; 200; i++)<br />
{<br />
      // DO SOMETHING WITH USBHIDDRIVER.USBInterface.usbBuffer HERE<br />
	Thread.Sleep(5)<br />
}<br />
usbI.stopRead()</p>
</div> -->
  <LI class=standard id=comment-11>
  <DIV class=commentname><SPAN class=commentauthor>Guillermo Odone </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>October 19th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-11">9:33 
  pm </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>I’m having a little problem with my USB device,<BR>The problem is that i 
  cannot access it via the value returned by “HidD_GetHidGuid” which is 
  “{4D1E55B2-F16F-11CF-88CB-001111000030}”.<BR>With this Guid I don’t see my 
  device, BUT with “{A5DCBF10-6530-11D2-901F-00C04FB951ED}” this Guid YES!!.. My 
  device is an USB TouchScreen. The other problem I have is that I want to read 
  the data send by the Touch, this is for an app. I’m building where I have 2 
  monitors and with the Touch monitor can work with both monitors.<BR>When I 
  want to CreateFile with the 2nd Guid it returns -1 and also with this library 
  cannot read the data.</P>
  <P>Some help please!</P>
  <P>Thanks a lot.<BR>Guillermo.</P></DIV><!-- <div class="commenttext"><p>I&#8217;m having a little problem with my USB device,<br />
The problem is that i cannot access it via the value returned by &#8220;HidD_GetHidGuid&#8221; which is &#8220;{4D1E55B2-F16F-11CF-88CB-001111000030}&#8221;.<br />
With this Guid I don&#8217;t see my device, BUT with &#8220;{A5DCBF10-6530-11D2-901F-00C04FB951ED}&#8221; this Guid YES!!.. My device is an USB TouchScreen. The other problem I have is that I want to read the data send by the Touch, this is for an app. I&#8217;m building where I have 2 monitors and with the Touch monitor can work with both monitors.<br />
When I want to CreateFile with the 2nd Guid it returns -1 and also with this library cannot read the data.</p>
<p>Some help please!</p>
<p>Thanks a lot.<br />
Guillermo.</p>
</div> -->
  <LI class=alt id=comment-12>
  <DIV class=commentname><SPAN class=commentauthor>Florian Leitner </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>October 20th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-12">10:30 
  am </A></SPAN></DIV>
  <DIV class=commenttext-admin>
  <P>Hi Guillermo,<BR>please check if the operating system recognizes the 
  touchscreen as keyboard or mice. If this is the case, the operation system 
  will not allow you to access these device.</P>
  <P>Regards,</P>
  <P>Florian</P></DIV><!-- <div class="commenttext"><p>Hi Guillermo,<br />
please check if the operating system recognizes the touchscreen as keyboard or mice. If this is the case, the operation system will not allow you to access these device.</p>
<p>Regards,</p>
<p>Florian</p>
</div> -->
  <LI class=standard id=comment-15>
  <DIV class=commentname><SPAN class=commentauthor>Lawrence Teo </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>October 31st, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-15">3:30 
  pm </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>I have a lot of entries sharing the same vid and pid - mainly come from 
  some printer setup USBPrint, DOT4PRN, DOT4, DOT4…</P>
  <P>I don’t know if this is the reason that the Connect() doesn’t succeed. I 
  did supply the VID and PID in the constructor.</P>
  <P>Any hint how to proceed? Too bad, Connect() doesn’t return any failure 
  specific information for trouble shooting.</P>
  <P>Thanks for your help.</P></DIV><!-- <div class="commenttext"><p>I have a lot of entries sharing the same vid and pid - mainly come from some printer setup USBPrint, DOT4PRN, DOT4, DOT4&#8230;</p>
<p>I don&#8217;t know if this is the reason that the Connect() doesn&#8217;t succeed. I did supply the VID and PID in the constructor.</p>
<p>Any hint how to proceed? Too bad, Connect() doesn&#8217;t return any failure specific information for trouble shooting.</p>
<p>Thanks for your help.</p>
</div> -->
  <LI class=alt id=comment-16>
  <DIV class=commentname><SPAN class=commentauthor>Florian Leitner </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>October 31st, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-16">3:48 
  pm </A></SPAN></DIV>
  <DIV class=commenttext-admin>
  <P>Is the device you want to connect to a printer?<BR>Because the library is 
  only for human interface device class usb devices …</P>
  <P>you are right I should implement some error information for trouble 
  shooting</P></DIV><!-- <div class="commenttext"><p>Is the device you want to connect to a printer?<br />
Because the library is only for human interface device class usb devices &#8230;</p>
<p>you are right I should implement some error information for trouble shooting</p>
</div> -->
  <LI class=standard id=comment-17>
  <DIV class=commentname><SPAN class=commentauthor>Lawrence Teo </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>October 31st, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-17">4:11 
  pm </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>Yes, it is a printer.</P>
  <P>I didn’t know that printer isn’t human interface device class usb 
  devices.</P>
  <P>so, does it mean I couldn’t use your library to connect to a printer? Too 
  bad.</P>
  <P>By the way, where can I find more information on USBSharp? Google doesn’t 
  seem to provide me the original website of the library. Does the author of 
  USBSharp remove his/her USBSharp from the net?</P>
  <P>Thanks for your help.</P></DIV><!-- <div class="commenttext"><p>Yes, it is a printer.</p>
<p>I didn&#8217;t know that printer isn&#8217;t human interface device class usb devices.</p>
<p>so, does it mean I couldn&#8217;t use your library to connect to a printer? Too bad.</p>
<p>By the way, where can I find more information on USBSharp? Google doesn&#8217;t seem to provide me the original website of the library. Does the author of USBSharp remove his/her USBSharp from the net?</p>
<p>Thanks for your help.</p>
</div> -->
  <LI class=alt id=comment-19>
  <DIV class=commentname><SPAN class=commentauthor>Kurt Fankhauser </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>November 1st, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-19">1:58 
  am </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>I downloaded your library (uploaded to Google on Sept 19). It appears that 
  the declaration for HidP_Value_Caps is missing the ULONG UnitsExp and ULONG 
  Units fields defined in the Win32 HIDP_VALUE_CAPS structure.</P></DIV><!-- <div class="commenttext"><p>I downloaded your library (uploaded to Google on Sept 19).  It appears that the declaration for HidP_Value_Caps is missing the ULONG UnitsExp and ULONG Units fields defined in the Win32 HIDP_VALUE_CAPS structure.</p>
</div> -->
  <LI class=standard id=comment-21>
  <DIV class=commentname><SPAN class=commentauthor>Florian Leitner </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>November 1st, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-21">1:05 
  pm </A></SPAN></DIV>
  <DIV class=commenttext-admin>
  <P>Hello Kurt,</P>
  <P>thanks a lot for your hint.<BR>Does this have an effect on the 
  functionality of the library? Because I can’t find one?</P></DIV><!-- <div class="commenttext"><p>Hello Kurt,</p>
<p>thanks a lot for your hint.<br />
Does this have an effect on the functionality of the library? Because I can&#8217;t find one?</p>
</div> -->
  <LI class=alt id=comment-23>
  <DIV class=commentname><SPAN class=commentauthor>Kurt Fankhauser </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>November 5th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-23">8:36 
  pm </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>Okay, it looks like HidDeclarations.cs is basically unused so maybe that 
  does not matter, but the HID structures are also defined in USBSharp.cs. In 
  there the UnitsExp and Units fields of HIDP_VALUE_CAPS are defined, but their 
  specified sizes appear incorrect as are LogicalMin/Max and PhysicalMin/Max 
  which should all be 32-bit values. Do you concur?</P>
  <P>Can you also explain your use of “unsafe” in declaring many of these 
  structures that don’t appear to contain pointers? My understanding was that 
  unsafe was only used with pointers.</P></DIV><!-- <div class="commenttext"><p>Okay, it looks like HidDeclarations.cs is basically unused so maybe that does not matter, but the HID structures are also defined in USBSharp.cs.  In there the UnitsExp and Units fields of HIDP_VALUE_CAPS are defined, but their specified sizes appear incorrect as are LogicalMin/Max and PhysicalMin/Max which should all be 32-bit values.  Do you concur?</p>
<p>Can you also explain your use of &#8220;unsafe&#8221; in declaring many of these structures that don&#8217;t appear to contain pointers?  My understanding was that unsafe was only used with pointers.</p>
</div> -->
  <LI class=standard id=comment-24>
  <DIV class=commentname><SPAN class=commentauthor><A 
  href="http://www.florian-leitner.de/" rel="external nofollow">Florian 
  Leitner</A> </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>November 5th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-24">10:09 
  pm </A></SPAN></DIV>
  <DIV class=commenttext-admin>
  <P>This part is taken from the Scott’s Article so I don’t know much about 
  it.<BR>As you said the unsafe keyword is for pointers so maybe it is not 
  necessary there.</P>
  <P>I will rework the library as soon as I have some spare time. By the way 
  everyone who wants to join the project is welcome <IMG class=wp-smiley alt=;) 
  src="Florian Leitner » HID USB Driver - 2Library_files/icon_wink.gif"></P></DIV><!-- <div class="commenttext"><p>This part is taken from the Scott&#8217;s Article so I don&#8217;t know much about it.<br />
As you said the unsafe keyword is for pointers so maybe it is not necessary there.</p>
<p>I will rework the library as soon as I have some spare time. By the way everyone who wants to join the project is welcome <img src='http://www.florian-leitner.de/wp-includes/images/smilies/icon_wink.gif' alt=';)' class='wp-smiley' /></p>
</div> -->
  <LI class=alt id=comment-49>
  <DIV class=commentname><SPAN class=commentauthor>Alberto Ramacciotti 
  </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>November 23rd, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-49">6:04 
  pm </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>I’m be able to use synchronuos read mode (loop after startRead()) . I’d 
  prefer use eventHandler mode but no events fire in my environment. Is there an 
  example for this mode ? Test sample in package doesn’t seem use it (Handler is 
  defined but loop is used).</P>
  <P>Thank you for share this with us.</P></DIV><!-- <div class="commenttext"><p>I&#8217;m be able to use synchronuos read mode (loop after startRead()) . I&#8217;d prefer use eventHandler mode but no events fire in my environment. Is there an example for this mode ? Test sample in package doesn&#8217;t seem use it (Handler is defined but loop is used).</p>
<p>Thank you for share this with us.</p>
</div> -->
  <LI class=standard id=comment-54>
  <DIV class=commentname><SPAN class=commentauthor>Florian Leitner </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>November 25th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-54">5:15 
  pm </A></SPAN></DIV>
  <DIV class=commenttext-admin>
  <P>If you want to use the Event mode just add this:</P>
  <P>usbI.enableUsbBufferEvent(newSystem.EventHandler(myEventCacher));<BR>usbI.startRead();</P></DIV><!-- <div class="commenttext"><p>If you want to use the Event mode just add this:</p>
<p>usbI.enableUsbBufferEvent(newSystem.EventHandler(myEventCacher));<br />
usbI.startRead();</p>
</div> -->
  <LI class=alt id=comment-58>
  <DIV class=commentname><SPAN class=commentauthor>Alberto Ramacciotti 
  </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>November 26th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-58">3:00 
  pm </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>Thank you Florian, EventHandler works now. I receive many notifications 
  each command device for. I noticed this behaviour also with sample application 
  included in Microsoft DDK. So I’ll have to filter only first notification and 
  discard next (same) ones. Do you suggest to do un ArrayList.Clear() to 
  usbBuffer or not ? It seems each notification append a new element on 
  usbbuffer ArrayList (if I don’t clear() it)</P></DIV><!-- <div class="commenttext"><p>Thank you Florian, EventHandler works now. I receive many notifications each command device for. I noticed this behaviour also with sample application included in Microsoft DDK. So I&#8217;ll have to filter only first notification and discard next (same) ones. Do you suggest to do un ArrayList.Clear() to usbBuffer or not ? It seems each notification append a new element on usbbuffer ArrayList (if I don&#8217;t clear() it)</p>
</div> -->
  <LI class=standard id=comment-59>
  <DIV class=commentname><SPAN class=commentauthor>Florian Leitner </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>November 26th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-59">7:52 
  pm </A></SPAN></DIV>
  <DIV class=commenttext-admin>
  <P>Alberto, the event notifies you whenever a new data-set is added to the 
  usbBuffer. If you clear the buffer after reading the content, you will have to 
  ignore each second data-set.</P></DIV><!-- <div class="commenttext"><p>Alberto, the event notifies you whenever a new data-set is added to the usbBuffer. If you clear the buffer after reading the content, you will have to ignore each second data-set.</p>
</div> -->
  <LI class=alt id=comment-70>
  <DIV class=commentname><SPAN class=commentauthor>Jon </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>December 3rd, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-70">12:01 
  am </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>I cant get any HID devices to show up with your tutorial. So i made a 
  simple for loop to try all possible VID’s and still got nothing. Any help 
  would be appreciated.</P>
  <P>Dim usb As USBHIDDRIVER.USBInterface<BR>Dim hexcount As String = “”<BR>Dim 
  vids As String = “”<BR>Dim loopvar As Integer<BR>For loopvar = 0 To 
  65535<BR>If loopvar = 16 And loopvar = 256 And loopvar = 4096 Then hexcount = 
  Hex(loopvar)</P>
  <P>vids = “vid_” + hexcount</P>
  <P>usb = New USBHIDDRIVER.USBInterface(vids)</P>
  <P>Dim list As String() = usb.getDeviceList()</P>
  <P>If list.Length 0 Then ListBox1.Items.Add(vids)</P>
  <P>Next</P></DIV><!-- <div class="commenttext"><p>I cant get any HID devices to show up with your tutorial.  So i made a simple for loop to try all possible VID&#8217;s and still got nothing.  Any help would be appreciated.</p>
<p>Dim usb As USBHIDDRIVER.USBInterface<br />
Dim hexcount As String = &#8220;&#8221;<br />
Dim vids As String = &#8220;&#8221;<br />
Dim loopvar As Integer<br />
For loopvar = 0 To 65535<br />
If loopvar = 16 And loopvar = 256 And loopvar = 4096 Then hexcount = Hex(loopvar)</p>
<p>vids = &#8220;vid_&#8221; + hexcount</p>
<p>usb = New USBHIDDRIVER.USBInterface(vids)</p>
<p>Dim list As String() = usb.getDeviceList()</p>
<p>If list.Length  0 Then ListBox1.Items.Add(vids)</p>
<p>Next</p>
</div> -->
  <LI class=standard id=comment-74>
  <DIV class=commentname><SPAN class=commentauthor>Anish Thomas </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>December 4th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-74">6:49 
  pm </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>Your library is great although having some trouble using it. I have been 
  trying to write my own library and I was having some problem with that so I 
  decide to try yours. I have created a C# application. </P>
  <P>First I have a question. In your example code for connecting to a 
  device,<BR>USBHIDDRIVER.USBInterface usb = new 
  USBInte..;<BR>usb.Connect();<BR>But from the code, the 1st line will create a 
  connection a file (HIDHandle). Do we need the 2nd line?</P>
  <P>The next question is the GUID. In the code you have<BR>[assembly: 
  Guid(”3adea963-ff5f-4213-bc50-ac25c4769dfb”)]<BR>Is this the GUID of the 
  software APP or the device? From what I can see, it seems to be the GUID for 
  the APP. I ask because some of the other example code that I’ve seen uses 
  specific GUID values, to what I thought was referencing the device, when 
  calling SetupDiGetClassDevs &amp; SetupDiEnumDeviceInterfaces.</P>
  <P>Now to my problem. Basically I cannot seem to write to my USB device (SI 
  Labs Eval board - which comes up as a USB-HID device). The return value for 
  the WriteFile command always comes back as false (number of bytes written is 
  0) but when I check for errors (Marshal.GetLastWin32Error()), that is also 
  returning 0. I’m struggling to come up with ideas as to why this is happening. 
  </P>
  <P>The code:<BR>bool connected = false;<BR>byte[] USB_iobuf = new 
  byte[64];<BR>USBHIDDRIVER.USBInterface usb = new 
  USBHIDDRIVER.USBInterface(”vid_10c4″, “pid_8044″);</P>
  <P>connected = usb.Connect(); </P>
  <P>USB_iobuf[0] = 1;<BR>USB_iobuf[1] = 1;<BR>// other USB_iobuf values are not 
  included here</P>
  <P>usb.write(USB_iobuf);</P>
  <P>Any ideas?<BR>Thanks in advance for any help!</P></DIV><!-- <div class="commenttext"><p>Your library is great although having some trouble using it.  I have been trying to write my own library and I was having some problem with that so I decide to try yours.  I have created a C# application.  </p>
<p>First I have a question.  In your example code for connecting to a device,<br />
USBHIDDRIVER.USBInterface usb = new USBInte..;<br />
usb.Connect();<br />
But from the code, the 1st line will create a connection a file (HIDHandle).  Do we need the 2nd line?</p>
<p>The next question is the GUID.  In the code you have<br />
[assembly: Guid(&#8221;3adea963-ff5f-4213-bc50-ac25c4769dfb&#8221;)]<br />
Is this the GUID of the software APP or the device?  From what I can see, it seems to be the GUID for the APP.  I ask because some of the other example code that I&#8217;ve seen uses specific GUID values, to what I thought was referencing the device, when calling SetupDiGetClassDevs &amp; SetupDiEnumDeviceInterfaces.</p>
<p>Now to my problem. Basically I cannot seem to write to my USB device (SI Labs Eval board - which comes up as a USB-HID device).  The return value for the WriteFile command always comes back as false (number of bytes written is 0) but when I check for errors (Marshal.GetLastWin32Error()), that is also returning 0.  I&#8217;m struggling to come up with ideas as to why this is happening.  </p>
<p>The code:<br />
 bool connected = false;<br />
 byte[] USB_iobuf = new byte[64];<br />
 USBHIDDRIVER.USBInterface usb = new USBHIDDRIVER.USBInterface(&#8221;vid_10c4&#8243;, &#8220;pid_8044&#8243;);</p>
<p> connected = usb.Connect(); </p>
<p> USB_iobuf[0] = 1;<br />
 USB_iobuf[1] = 1;<br />
// other USB_iobuf values are not included here</p>
<p> usb.write(USB_iobuf);</p>
<p>Any ideas?<br />
Thanks in advance for any help!</p>
</div> -->
  <LI class=alt id=comment-77>
  <DIV class=commentname><SPAN class=commentauthor>Flo </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>December 7th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-77">9:39 
  pm </A></SPAN></DIV>
  <DIV class=commenttext>
  <P>Hi Florian,</P>
  <P>first of all thank you very much for sharing this with us!</P>
  <P>I experience quite the same problem as Thomas. The write() method always 
  returns false…</P>
  <P>Any lead ?<BR>Many thanks. Cheers</P>
  <P>Flo.</P></DIV><!-- <div class="commenttext"><p>Hi Florian,</p>
<p>first of all thank you very much for sharing this with us!</p>
<p>I experience quite the same problem as Thomas. The write() method always returns false&#8230;</p>
<p>Any lead ?<br />
Many thanks. Cheers</p>
<p>Flo.</p>
</div> -->
  <LI class=standard id=comment-78>
  <DIV class=commentname><SPAN class=commentauthor>Florian Leitner </SPAN></DIV>
  <DIV class=commentinfo><SPAN class=commentdate>December 8th, 2007 | <A 
  title="comment link url" 
  href="http://www.florian-leitner.de/index.php/2007/08/03/hid-usb-driver-library/#comment-78">2:09 
  pm </A></SPAN></DIV>
  <DIV class=commenttext-admin>
  <P>Hi guys,</P>
  <P>sorry for the delay.<BR>———-<BR>@Jon:</P>
  <P>If you run<BR>USBHIDDRIVER.USBInterface usbI = new 
  USBInterface(”_”);<BR>String[] list = usbI.getDeviceList();</P>
  <P>You will get all USB Devices plugged in.<BR>———-<BR>@ Anish Thomas:</P>
  <P>Connect():<BR>You are right, the usb[…].Connect() command is not needed to 
  establish the connect. But it is usefull if the connection to device is lost 
  and you want to re-establish it.</P>
  <P>GUID:<BR>It’s the GUID of the app.</P>
  <P>@ Anish Thomas &amp; Flo:</P>
  <P>Write:</P>
  <P>Are your shure that your device is accepting write requests and it is ready 
  to receive?</P>
  <P>A good way to debug the read and write function is using a USB Monitor 
  (e.g. <A href="http://www.hhdsoftware.com/Downloads/usb-monitor.html" 
  rel=nofollow>http://www.hhdsoftware.com/Downloads/usb-monitor.html</A>)</P>
  <P>If this does not help feel free to contact me <IMG class=wp-smiley alt=;) 
  src="Florian Leitner » HID USB Driver - 2Library_files/icon_wink.gif"></P></DIV><!-- <div class="commenttext"><p>Hi guys,</p>
<p>sorry for the delay.<br />
&#8212;&#8212;&#8212;-<br />
@Jon:</p>
<p>If you run<br />
USBHIDDRIVER.USBInterface usbI = new USBInterface(&#8221;_&#8221;);<br />
String[] list = usbI.getDeviceList();</p>
<p>You will get all USB Devices plugged in.<br />
&#8212;&#8212;&#8212;-<br />
@ Anish Thomas:</p>
<p>Connect():<br />
You are right, the usb[&#8230;].Connect() command is not needed to establish the connect. But it is usefull if the connection to device is lost and you want to re-establish it.</p>
<p>GUID:<br />
It&#8217;s the GUID of the app.</p>
<p>@ Anish Thomas &amp; Flo:</p>
<p>Write:</p>
<p>Are your shure that your device is accepting write requests and it is ready to receive?</p>
<p>A good way to debug the read and write function is using a USB Monitor (e.g. <a href="http://www.hhdsoftware.com/Downloads/usb-monitor.html" rel="nofollow">http://www.hhdsoftware.com/Downloads/usb-monitor.html</a>)</p>
<p>If this does not help feel free to contact me <img src='http://www.florian-leitner.de/wp-includes/images/smilies/icon_wink.gif' alt=';)' class='wp-smiley' /></p>
</div> --></LI></OL><!--comments form -->
<H2 id=commentsformheader>Leave a reply</H2>
<DIV id=commentsform>
<FORM id=commentform action=http://www.florian-leitner.de/wp-comments-post.php 
method=post>
<P><INPUT id=author tabIndex=1 size=22 name=author> <LABEL 
for=author><SMALL>name (required) </SMALL></LABEL></P>
<P><INPUT id=email tabIndex=2 size=22 name=email> <LABEL for=email><SMALL>email 
( will not be shown ) (required) </SMALL></LABEL></P>
<P><INPUT id=url tabIndex=3 size=22 name=url> <LABEL for=url><SMALL>website 
</SMALL></LABEL></P><!--<p><small><strong>XHTML:</strong> You can use these tags: &lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;code&gt; &lt;em&gt; &lt;i&gt; &lt;strike&gt; &lt;strong&gt; </small></p>-->
<P><TEXTAREA id=comment tabIndex=4 name=comment rows=10 cols=50></TEXTAREA> </P>
<P><INPUT id=submit tabIndex=5 type=submit value="Submit Comment" name=submit> 
<INPUT type=hidden value=35 name=comment_post_ID> </P></FORM></DIV></DIV>
<P></P></DIV>
<DIV id=sidebar>
<DIV id=searchdisearchdivv><BR><A 
href="http://feeds.feedburner.com/FlorianLeitner" type=application/rss+xml 
rel=alternate><IMG 
style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; VERTICAL-ALIGN: middle; BORDER-RIGHT-WIDTH: 0px" 
alt="" 
src="Florian Leitner » HID USB Driver - 2Library_files/feed-icon16x16.png"></A>&nbsp;<A 
href="http://feeds.feedburner.com/FlorianLeitner" type=application/rss+xml 
rel=alternate>Subscribe in a reader</A> 
<FORM id=searchform action="" method=get><LABEL for=s>Search this site:</LABEL> 
<INPUT size=12 name=s> <INPUT type=submit value=Go name=sbutt> </FORM></DIV>
<UL><!-- Author information is disabled per default. Uncomment and fill in your details if you want to use it.
			<li><h2>Author</h2>
			<p>A little something about you, the author. Nothing lengthy, just an overview.</p>
			</li>
			-->
  <LI class=pagenav>
  <H2>Pages</H2>
  <UL>
    <LI class=page_item><A title=Impressum 
    href="http://www.florian-leitner.de/index.php/impressum/">Impressum</A> 
  </LI></UL>
  <LI>
  <H2>Archives</H2>
  <UL>
    <LI><A title="November 2007" 
    href="http://www.florian-leitner.de/index.php/2007/11/">November 2007</A> 
    <LI><A title="October 2007" 
    href="http://www.florian-leitner.de/index.php/2007/10/">October 2007</A> 
    <LI><A title="September 2007" 
    href="http://www.florian-leitner.de/index.php/2007/09/">September 2007</A> 
    <LI><A title="August 2007" 
    href="http://www.florian-leitner.de/index.php/2007/08/">August 2007</A> 
  </LI></UL>
  <LI>
  <H2>Categories</H2>
  <UL>
    <LI><A title="View all posts filed under C# (CSharp)" 
    href="http://www.florian-leitner.de/index.php/category/csharp/">C# 
    (CSharp)</A> (2) 
    <LI><A title="View all posts filed under English Posts" 
    href="http://www.florian-leitner.de/index.php/category/english-posts/">English 
    Posts</A> (1) 
    <LI><A title="View all posts filed under Internet" 
    href="http://www.florian-leitner.de/index.php/category/internet/">Internet</A> 
    (5) 
    <LI><A title="View all posts filed under Mein Leben" 
    href="http://www.florian-leitner.de/index.php/category/mein-leben/">Mein 
    Leben</A> (6) 
    <LI><A title="View all posts filed under PartyMe.de" 
    href="http://www.florian-leitner.de/index.php/category/partymede/">PartyMe.de</A> 
    (1) 
    <LI><A title="View all posts filed under PHP" 
    href="http://www.florian-leitner.de/index.php/category/php/">PHP</A> (2) 
    <LI><A title="View all posts filed under Software" 
    href="http://www.florian-leitner.de/index.php/category/software/">Software</A> 
    (13) 
    <LI><A title="View all posts filed under Tools" 
    href="http://www.florian-leitner.de/index.php/category/tools/">Tools</A> (9) 

    <LI><A title="View all posts filed under USB HID Library" 
    href="http://www.florian-leitner.de/index.php/category/usb-hid-library/">USB 
    HID Library</A> (1) 
    <LI><A title="View all posts filed under Windows Vista" 
    href="http://www.florian-leitner.de/index.php/category/windows-vista/">Windows 
    Vista</A> (2) 
    <LI><A title="View all posts filed under Zitate" 
    href="http://www.florian-leitner.de/index.php/category/zitate/">Zitate</A> 
    (1) </LI></UL>
  <LI class=linkcat id=linkcat-8>
  <H2>Mein Leben</H2>
  <UL>
    <LI><A href="http://www.amazon.de/gp/registry/188AZV7OFG7SX">Wishlist</A> 
    </LI></UL>
  <LI>
  <H2>Meta</H2>
  <UL>
    <LI><A title="Syndicate this site using RSS" 
    href="http://feeds.feedburner.com/FlorianLeitner"><ABBR 
    title="Really Simple Syndication">RSS</ABBR></A> 
    <LI><A href="http://www.florian-leitner.de/wp-login.php">Login</A> 
  </LI></UL></LI></UL>
<P><A href="http://feeds.feedburner.com/FlorianLeitner"><IMG 
style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
height=26 alt="" src="" width=88></A> <BR><BR>
<DIV 
style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px; TEXT-ALIGN: center"><EMBED 
pluginspage=http://www.macromedia.com/go/getflashplayer 
src=http://maps.amung.us/flash/flashsrv.php?k=vumvqrag&amp;type=em.swf width=200 
height=135 type=application/x-shockwave-flash 
flashvars="wausitehash=vumvqrag&amp;map=night&amp;pin=triangle-orange&amp;link=no" 
allowNetworking="all" allowScriptAccess="always" wmode="transparent" 
quality="high">
<DIV 
style="MARGIN: -40px auto 0px; WIDTH: 200px; POSITION: relative; HEIGHT: 40px"><A 
href="http://whos.amung.us/maps/vumvqrag/night/triangle-orange"><IMG height=40 
src="Florian Leitner » HID USB Driver - 2Library_files/embblank.gif" width=200 
border=0></A></DIV></DIV>
<P></P></DIV><!-- The main column ends  --><!-- begin footer -->
<DIV id=footer>
<P align=center>
<SCRIPT type=text/javascript><!--
google_ad_client = "pub-3386113411654026";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "text_image";
//2007-08-03: blog orange round
google_ad_channel = "8807110255";
google_color_border = "F2984C";
google_color_bg = "F0F0F0";
google_color_link = "F2984C";
google_color_text = "000000";
google_color_url = "F2984C";
google_ui_features = "rc:6";
//-->
</SCRIPT>

<SCRIPT src="Florian Leitner » HID USB Driver - 2Library_files/show_ads.js" 
type=text/javascript>
</SCRIPT>
</P>
<P>Florian Leitner | <A href="http://www.partyme.de/" 
target=blank>PartyMe.de</A> | <A href="http://www.dww-design.net/" 
target=blank>Dream World Webdesign</A></P></DIV></DIV></DIV></BODY></HTML>
