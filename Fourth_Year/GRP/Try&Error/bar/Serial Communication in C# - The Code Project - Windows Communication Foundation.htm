<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://www.codeproject.com/useritems/SerialComm.asp -->
<HTML><HEAD><TITLE>Serial Communication in C# - The Code Project - Windows Communication Foundation</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=ISO-8859-1">
<META content=en-US name=MS.LOCALE>
<META content="Serail Communication in .Net connecting GSM Modem" 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content=Ranjan.D name=Author>
<META content="18 Jun 2007 14:00:00 GMT" name=Search.PublishDate>
<META content="11 Nov 2007 14:00:00 GMT" name=Search.RevisedDate>
<META content="Free source code, , Visual C++, MFC, Windows, Article" 
name=keywords>
<META 
content="Article content copyright Ranjan.D, 2007, everthing else Copyright © CodeProject, 1999-2007, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="The Code Project" 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK href="/favicon.ico" 
type=image/ico rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/oncopy.js"></SCRIPT>

<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
if (typeof(DemoUrl) != "undefined")
	document.write('<me' + 'ta http' + '-equiv="re' + 'fresh" con' + 'tent="1;url=' + DemoUrl + '">');
</SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white>
<SCRIPT 
src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/urchin.js" 
type=text/javascript>
</SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-1735123-1";
urchinTracker();
</SCRIPT>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=4539&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FMEX%5FBanner%2D728x90%2DOCT07%2D1%2Egif&C=False&id=4539&cb=2816414\" alt=\"\" border=0 width=728 height=90></a>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">4,711,521 members and 
            growing! &nbsp; 11,284 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=4567652">My 
            Profile </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/useritems/SerialComm.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=4567652">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/useritems/SerialComm.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=8">Architect</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=9">SQL</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=1">All Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 300px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=300>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleUneditedHeader cellSpacing=0 cellPadding=3 
      width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=2">MFC/C++</A>, <A 
            href="http://www.codeproject.com/?cat=3">C#</A>, <A 
            href="http://www.codeproject.com/?cat=4">ASP.NET</A>, <A 
            href="http://www.codeproject.com/?cat=5">.NET</A>, <A 
            href="http://www.codeproject.com/?cat=6">VB.NET</A> &gt;&gt; <A 
            href="http://www.codeproject.com/WCF/">Windows Communication 
            Foundation </A>&gt;&gt; <A 
            href="http://www.codeproject.com/WCF/#Unedited+Reader+Contributions">Unedited 
            Reader Contributions</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">Serial Communication 
            in C#</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=3325267">Ranjan.D</A></B>. 
            <BR><BR>
            <DIV style="FONT-SIZE: 12px">Serail Communication in .Net connecting 
            GSM Modem</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C# (C# 1.0, C# 
            2.0)<BR>Windows, .NET (.NET 1.1, .NET 2.0)<BR>Win32, VS 
            (VS.NET2003), WCF<BR>Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>19 Jun 
            2007</B><BR><SPAN style="PADDING-RIGHT: 0.3ex">Updated</SPAN>: <B>12 
            Nov 2007</B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: 
            <B>12,612</B> </TD></TR>
        <TR class=ArticleUneditedHeader>
          <TD colSpan=2>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD class=smallText width="100%"><B>Note: <A 
                  title="Click here for more information" 
                  href="http://www.codeproject.com/info/unedited.asp">This is an 
                  unedited reader contribution</B></A> </TD>
                <TD class=SmallText noWrap><A 
                  href="http://www.codeproject.com/script/Submit/EditArticle1.asp?guid=SerialComm%2Fuseritems6%2F19%2F2007">Modify</A> 
                  | <A 
                  href="http://www.codeproject.com/script/Submit/DeleteArticle1.asp?guid=SerialComm%2Fuseritems6%2F19%2F2007">Delete</A>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <DIV style="PADDING-TOP: 5px"><IMG 
      style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN: 12px 3px 12px 0px" 
      height=12 alt="VS 2008" 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/VS2008_sm.gif" 
      width=20> <A href="http://www.codeproject.com/Feature/VS2008/">Visual 
      Studio 2008<BR>competition.<BR>$25,000 in prizes</A></DIV>
      <DIV style="PADDING-TOP: 3px"><IMG 
      style="MARGIN-LEFT: 2px; MARGIN-RIGHT: 5px" height=16 alt=Jobs 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/staff_sm.gif" 
      width=12 align=absMiddle> <A 
      href="http://www.codeproject.com/info/jobs/">http://www.codeproject.com/info/jobs/</A></DIV>
      <DIV style="PADDING-TOP: 3px"><IMG 
      style="MARGIN-LEFT: 2px; MARGIN-RIGHT: 5px" height=20 alt=Comp 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/prize_winner_sm.gif" 
      width=10 align=absMiddle> <A 
      href="http://www.codeproject.com/script/competitions/monthly/">Monthly 
      Competition</A></DIV></DIV>
      <CENTER>
      <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=4460&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Fxoreax%5F808%5Ftower%5F160x600%2Egif&C=False&id=4460&cb=2816424\" alt=\"\" border=0 width=160 height=600></a>");</SCRIPT>
      </CENTER><BR><BR><IMG height=1 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
      width=160> </TD>
    <TD width="100%">
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD vAlign=center noWrap align=right width="60%">
            <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
            method=post><B>Search &nbsp;</B><INPUT class=smallText 
            style="WIDTH: 200px" name=target> <SELECT 
            style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=tinyText noWrap><A 
            href="http://www.codeproject.com/info/search.asp">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
          </TD></TR></TBODY></TABLE>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText noWrap>
            <TABLE>
              <TBODY>
              <TR>
                <TD class=smallText noWrap><IMG 
                  src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/print.gif" 
                  align=absMiddle> <A 
                  href="http://www.codeproject.com/useritems/SerialComm.asp?print=true" 
                  target=_print>Print</A></TD>
                <TD class=smallText noWrap><IMG 
                  src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/sitebuild_icon.gif" 
                  align=absMiddle><A 
                  href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=SerialComm%2Fuseritems6%2F19%2F2007">Broken 
                  Article?</A></TD>
                <TD class=smallText noWrap><IMG 
                  src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/link.gif" 
                  align=absMiddle><A 
                  href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fuseritems%2FSerialComm%2Easp&amp;guid=SerialComm%2Fuseritems6%2F19%2F2007">Bookmark</A></TD>
                <TD class=smallText noWrap><IMG 
                  src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/mail_small.gif" 
                  align=absMiddle> <A 
                  href="http://www.codeproject.com/useritems/SerialComm.asp#__comments">Discuss</A></TD>
                <TD class=smallText noWrap><IMG 
                  src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/mail.gif" 
                  align=absMiddle> <A 
                  href="http://www.codeproject.com/script/recommend/form.asp?guid=SerialComm%2Fuseritems6%2F19%2F2007">Send 
                  to a friend</A></TD></TR></TBODY></TABLE></TD>
          <TD noWrap align=right><A name=__top></A>
            <TABLE>
              <TBODY>
              <TR>
                <TD class=smallText align=right>7 votes for this article.</TD>
                <TD>
                  <TABLE cellSpacing=0 cellPadding=0 border=2>
                    <TBODY>
                    <TR>
                      <TD><IMG height=5 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/red.gif" 
                        width=20 border=0></TD>
                      <TD><IMG height=5 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/red.gif" 
                        width=20 border=0></TD>
                      <TD><IMG height=5 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/red.gif" 
                        width=14 border=0><IMG height=5 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/white.gif" 
                        width=6 border=0></TD>
                      <TD><IMG height=5 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/white.gif" 
                        width=20 border=0></TD>
                      <TD><IMG height=5 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/white.gif" 
                        width=20 border=0></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD class=smallText align=right colSpan=2><A 
                  title="Calculated as rating x Log10(# votes)" 
                  href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                  2.28</A>. Rating: <B>2.69</B> out of 
        5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=ArticlePane>
      <UL style="MARGIN-RIGHT: 20px; BACKGROUND-COLOR: #eeeeee">
        <LI 
        style="FONT-SIZE: 8pt; LIST-STYLE-IMAGE: url(/images/warning.gif)">You 
        are signed up for one or more <A 
        href="http://www.codeproject.com/script/profile/subscribe.asp">newsletters</A> 
        but unfortunately we are unable to send you emails. Please click <A 
        href="http://www.codeproject.com/script/profile/SendConfirmRequest.asp">here</A> 
        to have an email sent that will allow us to confirm your email 
        address.</LI></UL>
      <P class=smallText 
      style="PADDING-RIGHT: 5px; BORDER-TOP: #ff9900 1px dashed; PADDING-LEFT: 5px; PADDING-BOTTOM: 5px; MARGIN: 5px; PADDING-TOP: 5px; BORDER-BOTTOM: #ff9900 1px dashed" 
      ?><B>Note:</B> This is an unedited contribution. If this article is 
      inappropriate, needs attention or copies someone else's work without 
      reference then please <A 
      href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=SerialComm%2Fuseritems6%2F19%2F2007">Report 
      this article</A>.</P><SPAN id=intelliTXT>
      <DIV id=contentdiv><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/useritems/SerialComm/Serial_Demo.zip">Download 
        Demo project.zip - 32.4 KB</A> </LI></UL>
      <H2>Introduction</H2>
      <P>If there is an interaction between pc to hardware most of the time we 
      are communicating either through serial port or parallel. Here we will see 
      how serial communication is done in .Net 2003 using Microsoft 
      communication control (Mscomm). There are of course many ways we can 
      communicate serially without using Mscomm control. </P>
      <P>Communication happens through com ports in PC. We choose a com port 
      open it. Before we open com port we are going to set com properties like 
      baud rate, parity bit, handshaking, input mode etc. </P>
      <P>Mscomm control allows you to establish connection to a serial port 
      connect to another computer or modem, issue commands and responds to 
      various events. </P>
      <H2>Adding Mscomm control in .Net </H2>
      <P>Note: MSCOMM32.OCX is a registered Microsoft component it comes with 
      Visual basic 6.0 </P>
      <P>Go to Tools -&gt; Add/Remove Items.</P>
      <P>Click on Com Components tab.</P>
      <P>Click on browse then go to Windows - &gt; System 32 folder</P>
      <P>Choose file type as Com components, choose MSCOMM32.OCX click on open. 
      </P>
      <P>Click on Ok button of Customize Toolbox.</P>
      <H2>Setting Mscomm properties before opening com port </H2>
      <P>Select and add the "Microsoft Communications Control, version 6.0" 
      control </P>
      <P>(Telephone control) onto your form. Set its name property to com </P>
      <P>Using the code</P>
      <DIV class=smallText id=premain0 style="WIDTH: 100%"><IMG id=preimg0 
      height=9 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/minus.gif" 
      width=9 preid="0"> Collapse</DIV><PRE id=pre0 style="MARGIN-TOP: 0pt" __designer:dtid="562949953421342">    
private void InitComPort() 
{ 

           <SPAN class=cpp-comment>// Set the com port to be 1 </SPAN>

           com.CommPort = 1; 

           <SPAN class=cpp-comment>// Trigger the OnComm event whenever data is received </SPAN>

           com.RThreshold = 1; 

           <SPAN class=cpp-comment>// Set the port to 9600 baud, no parity bit, 8 data bits, 1 stop bit (all standard) </SPAN>

           com.Settings = <SPAN class=cpp-string>"9600, n, 8, 1"</SPAN>; 

           com.RTSEnable=true; 

           <SPAN class=cpp-comment>// No handshaking is used </SPAN>

           com.Handshaking = MSCommLib.HandshakeConstants.comNone; 

           <SPAN class=cpp-comment>// Use this line instead for byte array input, best for most communications </SPAN>

           com.InputMode = MSCommLib.InputModeConstants.comInputModeText; 

           <SPAN class=cpp-comment>// Read the entire waiting data when com.Input is used </SPAN>

           com.InputLen = 0; 

           <SPAN class=cpp-comment>// Don't discard nulls, 0x00 is a useful byte </SPAN>

           com.NullDiscard = false; 

           <SPAN class=cpp-comment>// Attach the event handler </SPAN>

           com.OnComm += new System.EventHandler(this.OnComm); 

} 
</PRE>
      <P __designer:dtid="562949953421344">Call InitComPort() method in form 
      load or in form's constructor after InitializeComponent(). Note: We can 
      set the input mode property of com to Text mode or binary mode. OnComm 
      Event </P>
      <H2>OnComm Event </H2>
      <P __designer:dtid="562949953421346">The OnComm event is used to handle 
      the communication events. The OnComm also handles communication 
errors.</P>
      <P __designer:dtid="562949953421347">In order to call OnComm event of comm 
      component we have to set Rthreshold property to 1 and attach an event 
      handler. We can either loop through input buffer if input buffer count is 
      greater than 0 and read data until some specified time is elapsed and then 
      process the data or you can use OnComm events to receive output data from 
      hardware.</P>
      <P __designer:dtid="562949953421348">You can either wait for characters to 
      be received </P><PRE __designer:dtid="562949953421349"> do
     Application.DoEvents();
 while com.InputBufferCount &gt;= 5 

</PRE>
      <P __designer:dtid="562949953421350">Wait for five characters to receive 
      and then you can process the read data. Properties of Mscomm </P>
      <H2>Properties of Mscomm </H2>
      <P __designer:dtid="562949953421352"><STRONG 
      __designer:dtid="562949953421353">Break Property: </STRONG></P>
      <P __designer:dtid="562949953421354">If the break property is set to true 
      suspends the transmission of characters until you set it false. If you 
      want you can place a timer where you can set some delay and set the break 
      property to false.</P>
      <P __designer:dtid="562949953421355"><STRONG 
      __designer:dtid="562949953421356">CTS Property: </STRONG></P>
      <P __designer:dtid="562949953421357">Clear to send property usually sent 
      from modem to computer to indicate the transmission can proceed. If CTS 
      property returns true when polled you can send command.</P>
      <P __designer:dtid="562949953421358"><STRONG 
      __designer:dtid="562949953421359">Com port property: </STRONG></P>
      <P __designer:dtid="562949953421360">You can set the com port value 
      between 1 to 16. If port doesn't exist Mscomm generates device error 
      68.</P>
      <P __designer:dtid="562949953421361"><STRONG 
      __designer:dtid="562949953421362">In Buffer Count: </STRONG></P>
      <P __designer:dtid="562949953421363">It refers to the number of characters 
      waiting in the buffer that you can read, if InBufferCount &gt; 0 you can 
      read the data.</P>
      <P __designer:dtid="562949953421364"><STRONG 
      __designer:dtid="562949953421365">CommEvent Property: </STRONG></P>
      <P __designer:dtid="562949953421366">Returns the most recent error or 
      event occurred, to determine the actual event or error occurred you must 
      reference commEvent property.</P>
      <P __designer:dtid="562949953421367">Communication errors:</P>
      <P __designer:dtid="562949953421368">comEventBreak -&gt; a break signal is 
      received.</P>
      <P __designer:dtid="562949953421369">comEventFrame -&gt; Hardware detected 
      a framing error.</P>
      <P __designer:dtid="562949953421370">comEventOverrun -&gt; a character was 
      not read from the hardware, before the next character arrived and was 
      lost.</P>
      <P __designer:dtid="562949953421371">comEventRxOver -&gt; Receive buffer 
      overflow.</P>
      <P __designer:dtid="562949953421372">comEventRxParity -&gt; Hardware 
      detected a parity error. </P>
      <P __designer:dtid="562949953421373">comEventTxFull -&gt; Transmit buffer 
      full. </P>
      <P __designer:dtid="562949953421374">comEventDCB -&gt; unexpected error 
      retrieving Device control block for the port. </P>
      <P __designer:dtid="562949953421375">Communication events:</P>
      <P __designer:dtid="562949953421376">comEvSend: There is fewer than 
      SThreshold number of characters in transmitting buffer.</P>
      <P __designer:dtid="562949953421377">comEvReceive: Received RThreshold 
      number of characters. This event is generated continuously until you read 
      the data from the receiving buffer.</P>
      <P __designer:dtid="562949953421378">comEvCTS: change is clear to send 
      line.</P>
      <P __designer:dtid="562949953421379">comEvDSR: change in data set ready 
      line, this event is generated only when DSR changes from 1 to 0.</P>
      <P __designer:dtid="562949953421380">comEvCD: changes in Carrier detect 
      line.</P>
      <P __designer:dtid="562949953421381">comEvRing: Ring detected note some 
      UART's may not support this.</P>
      <P __designer:dtid="562949953421382">comEvEOF: End of file character 
      received.</P>
      <P __designer:dtid="562949953421383"><STRONG 
      __designer:dtid="562949953421384">Output property: </STRONG></P>
      <P __designer:dtid="562949953421385">Is used to write a stream of data to 
      transmit buffer. You can write either in text or binary mode. If in text 
      mode you can send a string or else byte array in case of binary mode.</P>
      <P __designer:dtid="562949953421386"><STRONG 
      __designer:dtid="562949953421387">Port Open: </STRONG></P>
      <P __designer:dtid="562949953421388">Setting the PortOpen property to true 
      opens comm port. </P>
      <P __designer:dtid="562949953421389">Note: make sure that a com port is 
      set to valid port number.</P>
      <P __designer:dtid="562949953421390"><STRONG 
      __designer:dtid="562949953421391">RThreshold Property: </STRONG></P>
      <P __designer:dtid="562949953421392">If RThreshold property is set to zero 
      OnComm events is not generated, if you want to read the response you can 
      poll and read.</P>
      <P __designer:dtid="562949953421393">If RThreshold is not set to zero, 
      OnComm event is generated and comEvent Property is set to comEvReceive. 
      You can read RThreshold number of bytes from receiving buffer.</P>
      <P __designer:dtid="562949953421394"><STRONG 
      __designer:dtid="562949953421395">SThreshold Property: </STRONG></P>
      <P __designer:dtid="562949953421396">Setting SThreshold property to 0 
      disables generating OnComm event for data transmission. If you want to 
      generate comEvSend event to occur once the number of character crosses 
      SThreshold value.</P>
      <P __designer:dtid="562949953421397">If say SThreshold is set to 1, 
      comEvSend event is generated when the transmitting buffer is completely 
      empty. </P>
      <P __designer:dtid="562949953421398"><STRONG 
      __designer:dtid="562949953421399">Settings Property: </STRONG></P>
      <P __designer:dtid="562949953421400"><BR 
      __designer:dtid="562949953421401">It is used to set baud rate, parity 
      check, number of data bits, stop bit.</P>
      <P __designer:dtid="562949953421402">Syntax: object. Setting = 
      &lt;value&gt;</P>
      <P __designer:dtid="562949953421403">Value is composed of "BBBB, P, D, 
      S"</P>
      <P __designer:dtid="562949953421404">Where BBBB -&gt; baud rate</P>
      <P __designer:dtid="562949953421405">P -&gt; parity bit</P>
      <P __designer:dtid="562949953421406">D -&gt; number of data bits </P>
      <P __designer:dtid="562949953421407">S -&gt; number of stop bits</P>
      <P __designer:dtid="562949953421408">The default value "9600, N, 8, 1"</P>
      <P __designer:dtid="562949953421409"><STRONG 
      __designer:dtid="562949953421410">OutBufferCount Property: </STRONG></P>
      <P __designer:dtid="562949953421411">Returns the number of characters 
      currently waiting in the transmitting buffer. You can also use this to 
      clear the transmitting buffer by setting OutBufferCount property to 0.</P>
      <P __designer:dtid="562949953421412"><STRONG 
      __designer:dtid="562949953421413">OutBufferSize Property: </STRONG></P>
      <P __designer:dtid="562949953421414">Returns the total size of the 
      transmitting buffer, default value is 512 bytes.</P>
      <P __designer:dtid="562949953421415"><STRONG 
      __designer:dtid="562949953421416">NullDiscard Property: </STRONG></P>
      <P __designer:dtid="562949953421417">If set to false Null characters are 
      transferred from port to receiving buffer it is set by default. If not to 
      receive then set this property to true.</P>
      <P __designer:dtid="562949953421418"><STRONG 
      __designer:dtid="562949953421419">Handshaking Property: </STRONG></P>
      <P __designer:dtid="562949953421420">Handshaking property ensures that 
      data is not lost due to buffer overrun. When the data from the hardware is 
      received and directly read without moving into receiving buffer there may 
      be chances of losing some characters because the characters may arrive too 
      quickly. You can use Handshaking property and synchronize the 
      communication.</P>
      <P __designer:dtid="562949953421421">The Handshaking property can be set 
      to following values</P>
      <P __designer:dtid="562949953421422">comNone -&gt; No handshaking.</P>
      <P __designer:dtid="562949953421423">comXonXoff -&gt; XON/XOFF 
      handshaking.</P>
      <P __designer:dtid="562949953421424">comRTS -&gt; Request to send / Clear 
      to send handshaking.</P>
      <P __designer:dtid="562949953421425">comRTSXonXoff -&gt; both request to 
      send and XON/XOFF handshaking.</P>
      <P __designer:dtid="562949953421426"><STRONG 
      __designer:dtid="562949953421427">InputMode Property:</STRONG><STRONG 
      __designer:dtid="562949953421428"> </STRONG></P>
      <P __designer:dtid="562949953421429">It determines how the data will be 
      retrieved through input property; you can read the data either is string 
      or binary data in byte array.</P>
      <H2>Using Code</H2>
      <P __designer:dtid="562949953421431">Here we will see how you can Serial 
      communicate is done between 2 systems using GSM Modems</P>
      <P __designer:dtid="562949953421432">The following things are done 
here</P>
      <P __designer:dtid="562949953421433">Dial GSM number from one system by 
      clicking Dial button from one system.</P>
      <P __designer:dtid="562949953421434">From another system send command to 
      accept the call (Data).<STRONG __designer:dtid="562949953421435"> 
      </STRONG></P>
      <P __designer:dtid="562949953421436">You will get a response CONNET 9600 
      when the connection is established between 2 modems connected to different 
      systems.<STRONG __designer:dtid="562949953421437"> </STRONG></P>
      <P __designer:dtid="562949953421438">Once the data call is established you 
      can send data, it's received on other end.<STRONG 
      __designer:dtid="562949953421439"> </STRONG></P>
      <P __designer:dtid="562949953421440">Similarly you can send data from 
      another system.<STRONG __designer:dtid="562949953421441"> </STRONG></P>
      <P __designer:dtid="562949953421442">To send message after connection type 
      some messages and click on Send button.<STRONG 
      __designer:dtid="562949953421443"> </STRONG></P>
      <P __designer:dtid="562949953421444">To disconnect the connection you can 
      disconnect in any end just by closing the com port. In GUI you should 
      click on Disconnect button.<STRONG __designer:dtid="562949953421445"> 
      </STRONG></P>
      <P __designer:dtid="562949953421446">Note: after connecting GSM modem dial 
      from one system by clicking Dial button, on other system you will get the 
      response as RING, RING now you can connect by specifying command ATA\n and 
      then send CONNECT 9600\n which will establish the connection. </P>
      <P __designer:dtid="562949953421447">Initialize com port by calling 
      InitComPort().</P><PRE __designer:dtid="562949953421448">public Form1() 
{ 
        <SPAN class=cpp-comment>// Initialize Form Components </SPAN>
           InitializeComponent(); 
        <SPAN class=cpp-comment>// Initialize the COM Port control </SPAN>
           InitComPort(); 
}
</PRE>
      <P __designer:dtid="562949953421449">The OnComm event shown below receives 
      when ever there is a response from hardware. Note the Input mode of com 
      port is set to Textmode so that you can process the text read. Sleep for a 
      while until you receive full response then read the response using 
      com.Input. ProcessResponseText is used to display the response in Rich 
      Text box.</P>
      <DIV class=smallText id=premain3 style="WIDTH: 100%"><IMG id=preimg3 
      height=9 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/minus.gif" 
      width=9 preid="3"> Collapse</DIV><PRE id=pre3 style="MARGIN-TOP: 0pt" __designer:dtid="562949953421450">private void OnComm(object sender, EventArgs e) 
{ 

        <SPAN class=cpp-comment>// Wait for Some mili-seconds then process </SPAN>
        <SPAN class=cpp-comment>// The response. </SPAN>
        Thread.Sleep(200); 
        if (com.InBufferCount &gt; 0) 
        { 
            try 
            {   

                <SPAN class=cpp-comment>// If you want to receive data in Binary mode </SPAN>

                <SPAN class=cpp-comment>// Remove below 2 comment lines // and comment lines for Process response in </SPAN>

                <SPAN class=cpp-comment>// Text mode. </SPAN>

                <SPAN class=cpp-comment>//byte[] b1=(byte[])com.Input; </SPAN>

                <SPAN class=cpp-comment>//ProcessResponseBinary(b1); </SPAN>

                <SPAN class=cpp-comment>// Process response in Text mode. </SPAN>

                string response=(string)com.Input; 

                ProcessResponseText(response); 

            } 
            catch(Exception ex) 
            { 
                MessageBox.Show(ex.Message, this.Text, 
                MessageBoxButtons.OK,MessageBoxIcon.Information); 
            } 
        } 
} 
</PRE>
      <P __designer:dtid="562949953421451">The input string contains CONNECT 
      9600 when the connection is established from GSM Modem. Note: while you 
      communicate between 2 systems using GSM modem, say for example by using 
      WaveComm modem. The SIM must be enabled for making data calls in such case 
      after connection you can send data across the system. </P>
      <P>If you receive Text data as response </P><PRE __designer:dtid="562949953421452">private void ProcessResponseText(string input) 
{ 

        <SPAN class=cpp-comment>// Send incoming data to a Rich Text Box </SPAN>
        if( input.Trim().Equals(<SPAN class=cpp-string>"RING"</SPAN>)) 
        { 
            Message.Text=<SPAN class=cpp-string>"Ring..."</SPAN>; 
        } 
        else 
        if( input.Trim().Equals(<SPAN class=cpp-string>"CONNECT 9600"</SPAN>)) 
        { 
            MessageBox.Show(input.Trim(), this.Text, 
            MessageBoxButtons.OK,MessageBoxIcon.Information); 
        } 
        else 
        { 
            MessageBox.Show(input.Trim(), this.Text, 
            MessageBoxButtons.OK,MessageBoxIcon.Information); 
            Message.Text=input.Trim(); 
        }
        
        <SPAN class=cpp-comment>// Append output response to RichText Box</SPAN>
        rtfTerminal.AppendText(input + <SPAN class=cpp-string>"\n"</SPAN>);
}
</PRE>
      <P __designer:dtid="562949953421453">When the user clicks on Dial Button 
      send AT command to dial other modem. The command for dialing is 
      ATD<PHONENUMBER __designer:dtid="562949953421454" />\n.</PHONENUMBER 
/></P><PRE __designer:dtid="562949953421455">private void btn_dial_Click(object sender, System.EventArgs e) 
{ 

        if( txt_phoneno.Text.Trim().Equals(<SPAN class=cpp-string>""</SPAN>)) 
        { 
            MessageBox.Show(<SPAN class=cpp-string>"Please Specify Phone Number"</SPAN>, this.Text, 
            MessageBoxButtons.OK,MessageBoxIcon.Information); 
            txt_phoneno.Focus(); 
            return; 
        } 

        if(! com.PortOpen ) 
        com.PortOpen=true; 

        <SPAN class=cpp-comment>// GSM Command Dial a Modem </SPAN>
        <SPAN class=cpp-comment>// ATD&lt;phonenumber&gt;<PHONENUMBER __designer:dtid="562949953421456" />\n </PHONENUMBER /></SPAN>

        string gsm_command=<SPAN class=cpp-string>"ATD"</SPAN>; 
        string phone_number=txt_phoneno.Text.Trim(); 
        string command1=gsm_command + phone_number + <SPAN class=cpp-string>"\n"</SPAN>; 
        byte[]command_to_dial=System.Text.ASCIIEncoding.Default.GetBytes (command1); 
        com.Output=command_to_dial; 
        Message.Text=<SPAN class=cpp-string>"Dialing..."</SPAN>; 

} 
</PRE>
      <P>To disconnect connection the Disconnect Button is clicked which will 
      set com.PortOpen to false </P><PRE __designer:dtid="562949953421457">private void btn_disconnect_Click(object sender, System.EventArgs e) 
{ 

        <SPAN class=cpp-comment>// If com port is open then close it </SPAN>
        <SPAN class=cpp-comment>// to disconnect connection </SPAN>

        if( com.PortOpen ) 
        { 
            com.PortOpen=false; 
            MessageBox.Show(<SPAN class=cpp-string>"Disconnected..."</SPAN>, this.Text, 
            MessageBoxButtons.OK,MessageBoxIcon.Information); 
            Message.Text=<SPAN class=cpp-string>""</SPAN>; 
            rtfTerminal.Text=<SPAN class=cpp-string>""</SPAN>; 
        } 
} 

</PRE>
      <P __designer:dtid="562949953421458">To send messages click on Send Button 
      after typing some messages. If you are communicating using GSM modem by 
      sending commands then you have to send a byte array. Or else you can send 
      messages as plain text.</P><PRE __designer:dtid="562949953421459">private void btn_sendmessage_Click(object sender, System.EventArgs e) 
{ 

        string msg=<SPAN class=cpp-string>""</SPAN>; 
        if( txt_sendmessage.Text.Trim().Equals(<SPAN class=cpp-string>""</SPAN>)) 
        { 
            MessageBox.Show(<SPAN class=cpp-string>"Please Specify Command"</SPAN>, this.Text, 
            MessageBoxButtons.OK,MessageBoxIcon.Information); 
            txt_sendmessage.Focus(); 
            return; 
        } 

        if(! com.PortOpen ) 
        com.PortOpen=true; 

        <SPAN class=cpp-comment>// To send text messages </SPAN>
        <SPAN class=cpp-comment>// If you are using GSM Modem and you want to send </SPAN>
        <SPAN class=cpp-comment>// Command then use GetByes of your message </SPAN>
        <SPAN class=cpp-comment>// To send Byte data from com port </SPAN>

        msg=txt_sendmessage.Text.Trim() + <SPAN class=cpp-string>"\n"</SPAN>; 
        com.Output = System.Text.ASCIIEncoding.Default.GetBytes(msg); 

        <SPAN class=cpp-comment>// Or Else If systems are connected with Serial </SPAN>
        <SPAN class=cpp-comment>// Cable, Output simple text directly </SPAN>
        <SPAN class=cpp-comment>// com.Output= txt_sendmessage.Text; </SPAN>

        Message.Text=<SPAN class=cpp-string>"Message Sent...."</SPAN>; 
} 
</PRE>
      <H2>Points of Interest </H2>
      <P __designer:dtid="562949953421461">Communicating through Serial port is 
      very interesting topic, that too using GSM modems you can do lot many 
      things like you can programmatically send SMS , remote communication 
      etc.</P>
      <H2>Conclusion </H2>
      <P>Nice playing with Serial port , This serial demo project would'nt be 
      completed unless I thank <A class=TutDetAuthorName id=hlAuthorName 
      href="http://www.devhood.com/public.aspx?user_id=00037FFE81850D2F">Noah 
      Coad</A> (<A class=TutDetAuthorEmail id=hlAuthorEmail 
      href="mailto:noah@coad.net">noah@coad.net</A>) becuase of him I learnt 
      Serial communication , worked and modified his sample code and 
      communicated with GSM modem.</P>
      <P><A title="Serial Communication using MSComm" 
      href="http://www.devhood.com/tutorials/tutorial_details.aspx?tutorial_id=320&amp;printer=t" 
      target=_blank></A></P>
      <H2>Reference</H2>
      <P><A title="Serial Communication using MSComm" 
      href="http://www.devhood.com/tutorials/tutorial_details.aspx?tutorial_id=320&amp;printer=t" 
      target=_blank>Click Here to Noah Coad' s Serial Communication 
      Artical</A></P>
      <P 
__designer:dtid="562949953421461"><!-- Article Ends --></P></DIV></SPAN>
      <SCRIPT 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/togglePre.js" 
      type=text/javascript></SCRIPT>

      <H2>About Ranjan.D</H2>
      <DIV style="OVERFLOW: hidden">
      <TABLE border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText noWrap><IMG 
            src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/{8185898E-C2C2-48BB-9B40-998EB953CB11}.jpg"><BR></TD>
          <TD class=smallText><BR><BR>
            <P class=smallText>Click <A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=3325267">here</A> 
            to view Ranjan.D's online profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
      <TABLE cellPadding=4 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD width="100%">
            <H2>Other popular Windows Communication Foundation articles:</H2>
            <UL>
              <LI><A href="http://www.codeproject.com/WCF/WCFWPFChat.asp">WCF / 
              WPF Chat Application</A>
              <DIV class=smallText>WCF / WPF Chat Application</DIV>
              <LI><A 
              href="http://www.codeproject.com/WCF/WCF_CommOptions_part1.asp">Communication 
              options with WCF - Part 1</A>
              <DIV class=smallText>Communication options with WCF - Part 
1.</DIV>
              <LI><A 
              href="http://www.codeproject.com/WCF/WCF_Duplex_UI_Threads.asp">WCF: 
              Duplex Operations and UI Threads</A>
              <DIV class=smallText>This article examines how duplex operations 
              are implemented in WCF as well as some of the issues that may 
              arise when dealing with UI threads.</DIV>
              <LI><A 
              href="http://www.codeproject.com/WCF/NullTransportForWCF.asp">NullTransport 
              for WCF</A>
              <DIV class=smallText>This article describes design, implementation 
              and the usage of the custom in-process transport for Microsoft 
              Windows Communication Foundation (WCF) model.</DIV></LI></UL></TD>
          <TD width=360>
            <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=4549&cb=2816429\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</SCRIPT>
          </TD></TR></TBODY></TABLE><BR>
      <SCRIPT language=JavaScript 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/addto.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT language=JavaScript type=text/javascript>
var addtoMethod=1;
var AddURL = document.location.href;
var AddTitle = escape(document.title);
DrawLinks(100, 0, "smallText", "addto") 
</SCRIPT>
      <BR><BR>
      <FORM action=/script/rating/code/app/insert_vote.asp method=post><INPUT 
      type=hidden value=SerialComm/useritems6/19/2007 name=vote_name> <INPUT 
      type=hidden value=/useritems/SerialComm.asp name=goal> 
      <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
        border=0><TBODY>
        <TR>
          <TD width="100%">
            <TABLE cellSpacing=0 cellPadding=4 width="100%" bgColor=#fbedbb 
            border=0>
              <TBODY>
              <TR>
                <TD class=smalltext vAlign=center>[<A 
                  href="http://www.codeproject.com/useritems/SerialComm.asp#__top">Top</A>]</TD>
                <TD vAlign=center noWrap align=right><I><B>Rate this Article 
                  for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; <I>Poor</I><INPUT 
                  type=radio value=1 name=rate><INPUT type=radio value=2 
                  name=rate><INPUT type=radio value=3 name=rate><INPUT 
                  type=radio value=4 name=rate><INPUT type=radio value=5 
                  name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
      <CENTER>
      <DIV style="MARGIN: 10px"><SPAN id=AdBanner5>
      <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=4114&cb=2816418\" border=0 frameborder=0 scrolling=no width=468 height=60></IFRAME>");</SCRIPT>
      </SPAN></DIV></CENTER><A name=__comments></A>
      <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

      <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

      <DIV id=_MessageBoard onclick=SwitchMessage(event)>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
        border=0><TBODY>
        <TR>
          <TD width="100%">
            <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
            bgColor=#ff9900 border=0>
              <FORM 
              action=/script/comments/app/do_filtermessages.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131 
              method=post>
              <TBODY>
              <TR>
                <TD>
                  <TABLE cellSpacing=0 cellPadding=3 width="100%" bgColor=white 
                  border=0>
                    <TBODY>
                    <TR bgColor=#fbedbb>
                      <TD class=smalltext noWrap><A 
                        href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                        height=16 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/forum_faq.gif" 
                        width=16 align=absMiddle border=0> 
                      <B>FAQ</B></A>&nbsp;</TD>
                      <TD class=smalltext vAlign=top noWrap 
                        align=right>Message score threshold <SELECT 
                        class=smalltext size=1 name=noise><OPTION 
                          value=1>1.0</OPTION> <OPTION value=2>2.0</OPTION> 
                          <OPTION value=3 selected>3.0</OPTION> <OPTION 
                          value=4>4.0</OPTION> <OPTION 
                        value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                      <TD class=smalltext vAlign=center noWrap align=right 
                      colSpan=2><A 
                        href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=430131"><IMG 
                        height=15 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/forum_search.gif" 
                        width=16 border=0> Search comments</A> &nbsp;</TD>
                      <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                    <TR bgColor=#ff9900>
                      <TD width="100%">&nbsp;</TD>
                      <TD class=smalltext vAlign=top noWrap align=right>View 
                        <SELECT class=smalltext size=1 name=expand><OPTION 
                          value=0>Normal (slow)</OPTION> <OPTION value=2>Preview 
                          (slow)</OPTION> <OPTION value=5 selected>Message 
                          View</OPTION> <OPTION value=6>Topic View</OPTION> 
                          <OPTION value=1>Thread View</OPTION> <OPTION 
                          value=3>Expanded</OPTION></SELECT>&nbsp;&nbsp;</TD>
                      <TD class=smalltext vAlign=top noWrap>Per page <SELECT 
                        class=smalltext size=1 name=perpage><OPTION 
                          value=10>10</OPTION> <OPTION value=25 
                          selected>25</OPTION> <OPTION 
                        value=50>50</OPTION></SELECT></TD>
                      <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
              <TR bgColor=#fbedbb>
                <TD><A name=xx0xx></A>
                  <TABLE cellPadding=2 width="100%" bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=messagetitle><IMG height=16 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/forum_newmsg.gif" 
                        width=16 align=top border=0><A class=HoverLink 
                        title="Add a new message to the discussions" 
                        href="http://www.codeproject.com/script/comments/user_new.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131" 
                        target=_top name=HoverNL><B>New Message</B></A></TD>
                      <TD class=messagetitle>Msgs 1 to 7 of 7 (Total: 7) (<A 
                        href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;forumid=430131">Refresh</A>)</TD>
                      <TD noWrap align=right><FONT class=messagetitle><SPAN 
                        class=HoverLink>First</SPAN> <SPAN 
                        class=HoverLink>Prev</SPAN> <SPAN 
                        class=HoverLink>Next</SPAN> <SPAN 
                        class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                      </FONT></TD></TR></TBODY></TABLE></TD></TR>
              <TR bgColor=white>
                <TD>
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle 
                            width="100%">Subject&nbsp;</TD>
                            <TD class=messagetitle noWrap 
                            width=140>Author&nbsp;</TD>
                            <TD style="WIDTH: 9em" noWrap align=right 
                              width=120><FONT 
                              class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD><IMG height=5 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
                        width=1 border=0></TD></TR>
                    <TR id=2316270_h0 bgColor=#fef9e7>
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD bgColor=white><A name=xx2316270xx></A><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_general.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD class=messagetitle width="100%"><A 
                              class=messagetitle id=DynMessLink 
                              href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;forumid=430131&amp;select=2316270#xx2316270xx" 
                              name=2316270><B>Nice</B></A><IMG height=12 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/New.gif"></TD>
                            <TD vAlign=bottom noWrap><A 
                              href="http://www.codeproject.com/script/profile/whos_who.asp?id=3107109"><IMG 
                              title="Click for User Profile" height=15 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/userinfo.gif" 
                              width=14 border=0></A>&nbsp;</TD>
                            <TD noWrap width=140><FONT 
                              class=messagetitle><B>Windmiller</B>&nbsp;</FONT></TD>
                            <TD style="WIDTH: 9em" noWrap align=right 
                              width=120><FONT class=messagetitle><B>6:46 13 Nov 
                              '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=2316270_h1 style="DISPLAY: none">
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_blank.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD width="100%" bgColor=#d5eaff>
                              <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Nice to 
                                see someone work with serial coms, gave you a 5 
                                to compensate your way too low 
                                rating.<BR><BR>Regards,<BR>Morgan<BR><BR><BR>
                                <DIV class=ForumSig>The day I became a WhuShu 
                                coder..</DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2316270">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2316270">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;tid=2316270&amp;forumid=430131&amp;select=2316270#xx2316270xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2316270#xx2316270xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2316270#xx2316270xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3107109,2316270);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD><IMG height=5 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
                        width=1 border=0></TD></TR>
                    <TR height=1>
                      <TD bgColor=#ff9900><IMG height=1 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
                        width=1></TD></TR>
                    <TR id=2303370_h0 bgColor=#fef9e7>
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD bgColor=white><A name=xx2303370xx></A><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_general.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD class=messagetitle width="100%"><A 
                              class=messagetitle id=DynMessLink 
                              href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;forumid=430131&amp;select=2303370#xx2303370xx" 
                              name=2303370><B>microncontroller AduC</B></A></TD>
                            <TD vAlign=bottom noWrap><A 
                              href="http://www.codeproject.com/script/profile/whos_who.asp?id=4685182"><IMG 
                              title="Click for User Profile" height=15 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/userinfo.gif" 
                              width=14 border=0></A>&nbsp;</TD>
                            <TD noWrap width=140><FONT 
                              class=messagetitle><B>Juan 
                            Silva</B>&nbsp;</FONT></TD>
                            <TD style="WIDTH: 9em" noWrap align=right 
                              width=120><FONT class=messagetitle><B>16:52 4 Nov 
                              '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=2303370_h1 style="DISPLAY: none">
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_blank.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD width="100%" bgColor=#d5eaff>
                              <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>This 
                                implementation can be used in communication via 
                                the serial port with the microncontrolador AduC? 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2303370">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2303370">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;tid=2303370&amp;forumid=430131&amp;select=2303370#xx2303370xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2303370#xx2303370xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2303370#xx2303370xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(4685182,2303370);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD><IMG height=5 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
                        width=1 border=0></TD></TR>
                    <TR height=1>
                      <TD bgColor=#ff9900><IMG height=1 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
                        width=1></TD></TR>
                    <TR id=2212883_h0 bgColor=#fef9e7>
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD bgColor=white><A name=xx2212883xx></A><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_general.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD class=messagetitle width="100%"><A 
                              class=messagetitle id=DynMessLink 
                              href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;forumid=430131&amp;select=2212883#xx2212883xx" 
                              name=2212883><B>using GSM modem</B></A></TD>
                            <TD vAlign=bottom noWrap><A 
                              href="http://www.codeproject.com/script/profile/whos_who.asp?id=3526394"><IMG 
                              title="Click for User Profile" height=15 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/userinfo.gif" 
                              width=14 border=0></A>&nbsp;</TD>
                            <TD noWrap width=140><FONT 
                              class=messagetitle><B>nigege</B>&nbsp;</FONT></TD>
                            <TD style="WIDTH: 9em" noWrap align=right 
                              width=120><FONT class=messagetitle><B>22:58 4 Sep 
                              '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=2212883_h1 style="DISPLAY: none">
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_blank.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD width="100%" bgColor=#d5eaff>
                              <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>hi, GSM 
                                modem is an interesting topic and my boss feel 
                                it also. so i have been ask to do a program that 
                                can send simple txt file between 2 pc by using 
                                GSM modem.. he told me they using it by dial up 
                                to the other side modem then can send file. but 
                                i cant find any related information from 
                                internet.. do you have any idea to help me?? 
                                thanks in advance!! <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2212883">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2212883">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;tid=2212883&amp;forumid=430131&amp;select=2212883#xx2212883xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2212883#xx2212883xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2212883#xx2212883xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3526394,2212883);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD><IMG height=6 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
                        width=1 border=0></TD></TR>
                    <TR id=2219521_h0 bgColor=#fef9e7>
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD bgColor=white><A name=xx2219521xx></A><IMG 
                              height=1 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/ind.gif" 
                              width=18><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_general.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD class=messagetitle width="100%"><A 
                              class=messagetitle id=DynMessLink 
                              href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;forumid=430131&amp;select=2219521#xx2219521xx" 
                              name=2219521>using GSM modem</A></TD>
                            <TD vAlign=bottom noWrap><A 
                              href="http://www.codeproject.com/script/profile/whos_who.asp?id=3325267"><IMG 
                              title="Click for User Profile" height=15 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/userinfo.gif" 
                              width=14 border=0></A>&nbsp;</TD>
                            <TD noWrap width=140><FONT 
                              class=messagetitle>Ranjan.D&nbsp;</FONT></TD>
                            <TD style="WIDTH: 9em" noWrap align=right 
                              width=120><FONT class=messagetitle>0:45 10 Sep 
                              '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=2219521_h1 style="DISPLAY: none">
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD><IMG height=1 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/ind.gif" 
                              width=18><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_blank.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD width="100%" bgColor=#d5eaff>
                              <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>Yes 
                                communicating through GSM modem is really an 
                                interesting topic.<BR><BR>Your GSM modem should 
                                be enabled with Data Calls. Note: Initially the 
                                SIM is enabled with voice calls. You can request 
                                your service providers to enable Data 
                                calls.<BR><BR>1) How to send a text file through 
                                GSM?<BR>You need to have 2 GSM modem , one acts 
                                as initiator ( which will make a request , I 
                                mean send a command to dial remote GSM modem ( 
                                which just acts like a slave) ). After dialing 
                                up. Once The connection gets established you can 
                                send any data. <BR><BR>You can send data as byte 
                                array. So first open and read the text file , 
                                then get bytes of the read data.<BR><BR>In the 
                                receiving side you need to read until the those 
                                bytes which has send from the initiating modem. 
                                <BR><BR>So before you transfer any text file or 
                                any thing you need to know how many bytes you 
                                are sending , so calculate first the length and 
                                send first the number of bytes which is required 
                                to be read by the remote modem.<BR><BR>what 
                                after receiving text ?<BR>You need to process 
                                the read data. First open a file with write mode 
                                , then write read byte content.<BR><BR>You can 
                                get more information about how to dial,by just 
                                google with "AT Command for Wavecom". I am using 
                                Wavecom. The AT Commands are those commands the 
                                GSM modem understands.<BR><BR>If you have any 
                                doubt please be free to ask.<BR><BR><BR><BR><BR>
                                <DIV 
                                class=ForumSig>Ranjan.D</DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2219521">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2219521">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;tid=2212883&amp;forumid=430131&amp;select=2219521#xx2219521xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2219521#xx2219521xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2212883#xx2212883xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3325267,2219521);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD><IMG height=6 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
                        width=1 border=0></TD></TR>
                    <TR id=2259690_h0 bgColor=#fef9e7>
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD bgColor=white><A name=xx2259690xx></A><IMG 
                              height=1 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/ind.gif" 
                              width=36><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_general.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD class=messagetitle width="100%"><A 
                              class=messagetitle id=DynMessLink 
                              href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;forumid=430131&amp;select=2259690#xx2259690xx" 
                              name=2259690>Re: using GSM modem</A></TD>
                            <TD vAlign=bottom noWrap><A 
                              href="http://www.codeproject.com/script/profile/whos_who.asp?id=3526394"><IMG 
                              title="Click for User Profile" height=15 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/userinfo.gif" 
                              width=14 border=0></A>&nbsp;</TD>
                            <TD noWrap width=140><FONT 
                              class=messagetitle>nigege&nbsp;</FONT></TD>
                            <TD style="WIDTH: 9em" noWrap align=right 
                              width=120><FONT class=messagetitle>23:13 5 Oct 
                              '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=2259690_h1 style="DISPLAY: none">
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD><IMG height=1 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/ind.gif" 
                              width=36><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_blank.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD width="100%" bgColor=#d5eaff>
                              <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>thanks 
                                for help! AT command for dial is ATD, but "The 
                                connection gets established" mean? dial from A 
                                and B answer only? then how to start transfer 
                                data? i means command or step to do that. The 
                                procedure you said is totally help me understand 
                                the GSM transfer data. i understand the rest 
                                except for the below questions:<BR>1. how the 
                                connections get established?<BR>2. what the 
                                command or step to transfer data?(if not using 
                                programming)<BR>3. how the other side to start 
                                receive data?<BR><BR>thanks and hope you can 
                                help me on this topic. i have download the AT 
                                command for wavecom pdf. but i dun know which 
                                part is for transfer the data. hope you can show 
                                me some directions. thanks 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2259690">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2259690">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;tid=2212883&amp;forumid=430131&amp;select=2259690#xx2259690xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2259690#xx2259690xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2212883#xx2212883xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3526394,2259690);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD><IMG height=6 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
                        width=1 border=0></TD></TR>
                    <TR id=2264077_h0 bgColor=#fef9e7>
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD bgColor=white><A name=xx2264077xx></A><IMG 
                              height=1 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/ind.gif" 
                              width=54><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_general.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD class=messagetitle style="COLOR: #aa0000" 
                            width="100%"><A class=messagetitle id=DynMessLink 
                              style="COLOR: #aa0000" 
                              href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;forumid=430131&amp;select=2264077#xx2264077xx" 
                              name=2264077>Re: using GSM modem [modified]</A></TD>
                            <TD vAlign=bottom noWrap><A 
                              href="http://www.codeproject.com/script/profile/whos_who.asp?id=3325267"><IMG 
                              title="Click for User Profile" height=15 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/userinfo.gif" 
                              width=14 border=0></A>&nbsp;</TD>
                            <TD noWrap width=140><FONT class=messagetitle 
                              style="COLOR: #aa0000">Ranjan.D&nbsp;</FONT></TD>
                            <TD style="WIDTH: 9em" noWrap align=right 
                              width=120><FONT class=messagetitle 
                              style="COLOR: #aa0000">23:52 9 Oct 
                            '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=2264077_h1 style="DISPLAY: none">
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD><IMG height=1 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/ind.gif" 
                              width=54><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_blank.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD width="100%" bgColor=#d5eaff>
                              <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Yes Its 
                                ATD command which is used to for connecting 2 
                                GSM modems.<BR><BR>You can use Windows -&gt; 
                                HyperLink program to connect between 2 GSM 
                                modems.<BR><BR>ATD<PHONE Number> ( say 
                                ATD990227451) a command from say GSM modem A ( 
                                Initiating One) which will Dial for connection 
                                between 2 GSM modem.<BR><BR>The Remote GSM modem 
                                say B will get a RING,RING If you already opened 
                                com Port with specific baud rate in HyperLink 
                                Program of remote a GSM modem.<BR><BR>Note: If 
                                you already set your remote GSM modem(B) with 
                                command ATS0=2 which mean automatically 
                                connected after 2 RING's or else you need to 
                                manually specify command ATA to connect after 
                                RING.<BR><BR>You will receive a message CONNECT 
                                9600 in HyperTerminal of Modem B. If connection 
                                get sucessfully established from A to B. Here 
                                9600 is baud rate.<BR><BR>We will consider 
                                Initiating modem as A and Remote modem which 
                                receives text file as GSM modem say 
                                B.<BR><BR>One's the connection gets established 
                                If the modems are enabled with Data Calls then 
                                you can send byets.<BR><BR>There should be 2 
                                program say VB.Net or C# one sends a text file 
                                and the other acting as server which will 
                                receive text file.<BR><BR>Following are the 
                                steps taken in Modem A (Initiating 
                                Modem):<BR><BR>1) InitComPort() method used for 
                                Comm Settings you can get in this article.<BR>2) 
                                Dial GSM modem which button click to transfer 
                                text file.<BR>// Open the com port if it is not 
                                open<BR><CODE>if( ! 
                                com.PortOpen)<BR>com.PortOpen = 
                                true;<BR></CODE><BR>3) Open a Text file in Read 
                                mode read chars one by one until EOF and assign 
                                all the read chars in a string array.<BR>4) Get 
                                Bytes for each chars from the String array and 
                                assign to Byte Array say B1 which will be used 
                                to send text file.<BR>5) First send the number 
                                of bytes to read to Modem B.<BR>6) Then you can 
                                send byte array ( B1 already mentioned in step 
                                4.)<BR>com.Output=B1; ( Which will send the 
                                bytes )<BR><BR>Following are the steps taken in 
                                Modem B (Remote Modem):<BR><BR>In OnComm event 
                                <BR>1) You need to open comm port as with Modem 
                                A, will get a message CONNECT 9600 in First 
                                OnComm Event, use comm.Input If input mode of 
                                comm object is text then you will receive 
                                CONNECT 9600.<BR>2) First as I told you need to 
                                know how many bytes to read. ( In Second OnComm 
                                Event )<BR>3) Loop until the number of bytes for 
                                the third OnComm Event Here's what we are 
                                receiving text files as Bytes.<BR>4) After 
                                getting the number of bytes convert them back to 
                                text and assign them to String Array.<BR>5) Open 
                                a file in Write mode then start writing all the 
                                chars from String Array.<BR><BR>Note: Apart from 
                                all these you need to know whether your GSM 
                                modems are Enabled with Data Calls, You can 
                                request your SIM serivice provider for Enabling 
                                Data Calls.<BR><BR>Thanks <BR><BR><BR>-- 
                                modified at 9:11 Sunday 14th October, 2007 
                                <BR><BR>
                                <DIV 
                                class=ForumSig>Ranjan.D</DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2264077">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2264077">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;tid=2212883&amp;forumid=430131&amp;select=2264077#xx2264077xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2264077#xx2264077xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2212883#xx2212883xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(3325267,2264077);</SCRIPT>
                                 
                              </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD><IMG height=5 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
                        width=1 border=0></TD></TR>
                    <TR height=1>
                      <TD bgColor=#ff9900><IMG height=1 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
                        width=1></TD></TR>
                    <TR id=2090029_h0 bgColor=#fef9e7>
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD bgColor=white><A name=xx2090029xx></A><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_general.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD class=messagetitle width="100%"><A 
                              class=messagetitle id=DynMessLink 
                              href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;forumid=430131&amp;select=2090029#xx2090029xx" 
                              name=2090029><B>how bout updating for visual c# 
                              05?</B></A></TD>
                            <TD vAlign=bottom noWrap><A 
                              href="http://www.codeproject.com/script/profile/whos_who.asp?id=4111047"><IMG 
                              title="Click for User Profile" height=15 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/userinfo.gif" 
                              width=14 border=0></A>&nbsp;</TD>
                            <TD noWrap width=140><FONT 
                              class=messagetitle><B>dirtylarry</B>&nbsp;</FONT></TD>
                            <TD style="WIDTH: 9em" noWrap align=right 
                              width=120><FONT class=messagetitle><B>20:12 19 Jun 
                              '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=2090029_h1 style="DISPLAY: none">
                      <TD width="100%">
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD><IMG 
                              src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_blank.gif" 
                              align=absMiddle>&nbsp;</TD>
                            <TD width="100%" bgColor=#d5eaff>
                              <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>how 
                                bout updating for visual c# 05? 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2090029">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/useritems/SerialComm.asp&amp;df=100&amp;forumid=430131&amp;select=2090029">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?df=100&amp;tid=2090029&amp;forumid=430131&amp;select=2090029#xx2090029xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2090029#xx2090029xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/useritems/SerialComm.asp?msg=2090029#xx2090029xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(4111047,2090029);</SCRIPT>
                                 
                              </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD><IMG height=5 
                        src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/t.gif" 
                        width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
              <TR bgColor=#fbedbb>
                <TD>
                  <TABLE cellPadding=2 width="100%">
                    <TBODY>
                    <TR>
                      <TD class=messagetitle>Last Visit: 8:57 Sunday 11th 
                        November, 2007</TD>
                      <TD noWrap align=right><FONT class=messagetitle><SPAN 
                        class=HoverLink>First</SPAN> <SPAN 
                        class=HoverLink>Prev</SPAN> <SPAN 
                        class=HoverLink>Next</SPAN> <SPAN 
                        class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                      </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=smallText><IMG 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_general.gif" 
      align=absMiddle> General comment &nbsp;&nbsp; <IMG 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_info.gif" 
      align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_question.gif" 
      align=absMiddle> Question &nbsp;&nbsp; <IMG 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_answer.gif" 
      align=absMiddle> Answer &nbsp;&nbsp; <IMG 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_game.gif" 
      align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/news_sticky.gif" 
      align=absMiddle> Admin message</P><BR>
      <TABLE cellSpacing=5 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText>Updated: 12 Nov 2007 </TD>
          <TD class=SmallText align=right>Article content copyright Ranjan.D, 
            2007<BR>everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 
            1999-2007</A>. <BR>Web11 | <A 
            href="http://www.codeproject.com/info/MediaKit">Advertise on The 
            Code Project</A> | <A 
            href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
        </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<SCRIPT 
src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/front.asp" 
type=text/javascript></SCRIPT>
<BR>
<CENTER>
<TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
  <TBODY>
  <TR>
    <TD bgColor=#ff9900 height=1><IMG height=1 
      src="Serial Communication in C# - The Code Project - Windows Communication Foundation_files/space.gif"></TD></TR>
  <TR>
    <TD align=middle><FONT size=1><A 
      href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  <A 
      href="http://aspalliance.com/">ASP Alliance</A>  <A 
      href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
      href="http://www.developersdex.com/">Developersdex</A>  <A 
      href="http://www.devguru.com/">DevGuru</A>  <A 
      href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
      href="http://www.planet-source-code.com/">Planet Source Code</A>  <A 
      href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
</FONT></TD></TR></TBODY></TABLE></CENTER></BODY></HTML>
