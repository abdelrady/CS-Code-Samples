<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: CreatePolygonRgn Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the CreatePolygonRgn function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,CreatePolygonRgn" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>CreatePolygonRgn Function</H1>

<P><CODE class="declare">Declare Function CreatePolygonRgn Lib "gdi32.dll" (lpPoint As <A href="point_type.html" tppabs="http://www.vbapi.com/ref/p/point_type.html">POINT_TYPE</A>, ByVal nCount As Long, ByVal nPolyFillMode As Long) As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>CreatePolygonRgn</B> creates a polygonal region and provides a handle to it.  The polygon is defined by an array of points specifying its vertices.  Note that the polygon fill mode must explictly be specified, instead of using the one set for whatever device the region is used with.  The function returns the handle to the newly created region if successful, or 0 if an error occured.

<DL>
<DT><VAR>lpPoint</VAR><DD>An array holding the vertices of the polygonal region.  Specify each point in order only once.
<DT><VAR>nCount</VAR><DD>The number of elements in the array passed as <VAR>lpPoint</VAR>.
<DT><VAR>nPolyFillMode</VAR><DD>Exactly one of the following flags specifying the polygon fill mode to use for the polygonal region:
<DL>
<DT>ALTERNATE = 1<DD>Alternates between filling and not filling contiguous sections whose boundaries are determined by the edge(s) of the polygon crossing through the polygon's interior.
<DT>WINDING = 2<DD>Any section inside the polygon is filled, regardless of any intra-polygonal boundaries and edges.
</DL>
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' Invert the pixels within a triangular region on window Form1.  The triangular
' region has vertices (150,150), (250, 200), and (100, 200).  Note how the points are loaded
' into the array of vertices. 
Dim vertex(0 To 2) As <A href="point_type.html" tppabs="http://www.vbapi.com/ref/p/point_type.html">POINT_TYPE</A>  ' array of region's vertices
Dim hrgn As Long  ' handle to the triangular region
Dim retval As Long  ' return value

' Load the vertices of the triangular region into the array.
vertex(0).x = 150: vertex(0).y = 150  ' 1st point: (150,150)
vertex(1).x = 250: vertex(1).y = 200  ' 2nd point: (250,200)
vertex(2).x = 100: vertex(2).y = 200  ' 3rd point: (100,200)

' Create the polygonal region based on the array of vertices.
hrgn = <B>CreatePolygonRgn</B>(vertex(0), 3, ALTERNATE)  ' for a triangle, fill mode is irrelevant
' Invert the pixels within the triangular region on Form1.
retval = <A href="invertrgn.html" tppabs="http://www.vbapi.com/ref/i/invertrgn.html">InvertRgn</A>(Form1.hDC, hrgn)
' Delete the region to free up resources.
retval = <A href="deleteobject.html" tppabs="http://www.vbapi.com/ref/d/deleteobject.html">DeleteObject</A>(hrgn)</CODE></PRE>

<P><B>See Also:</B> <A href="createpolypolygonrgn.html" tppabs="http://www.vbapi.com/ref/c/createpolypolygonrgn.html">CreatePolyPolygonRgn</A><BR>
<B>Category:</B> <A href="index.html#regions" tppabs="http://www.vbapi.com/ref/index.html#regions">Regions</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="createpolygonrgn.html" tppabs="http://www.vbapi.com/ref/c/createpolygonrgn.html">http://www.vbapi.com/ref/c/createpolygonrgn.html</A>

</BODY>
</HTML>