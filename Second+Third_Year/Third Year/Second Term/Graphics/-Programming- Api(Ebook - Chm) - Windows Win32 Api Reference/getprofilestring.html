<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetProfileString Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetProfileString function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetProfileString" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetProfileString Function</H1>

<P><CODE class="declare">Declare Function GetProfileString Lib "kernel32.dll" Alias "GetProfileStringA" (ByVal lpAppName As String, ByVal lpKeyName As String, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Long) As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>GetProfileString</B> reads an string value from the WIN.INI file.  The parameters passed to the function specify which value will be read from.  The function always returns the length in characters of the string put into the variable passed as <VAR>lpReturnedString</VAR>.  If the function was successful, the string read from the INI file will be put into <VAR>lpReturnedString</VAR>.  If not, it will instead receive the string given as <VAR>lpDefault</VAR>.  This function is basically a watered-down version of <A href="getprivateprofilestring.html" tppabs="http://www.vbapi.com/ref/g/getprivateprofilestring.html">GetPrivateProfileString</A> because it, unlike this function, works with all INI files.  Note that INI file support is only provided in Windows for backwards compatibility; using the registry to store information is preferred.

<DL>
<DT><VAR>lpAppName</VAR><DD>The header of the INI file section the value is in.
<DT><VAR>lpKeyName</VAR><DD>The name of the value to read.
<DT><VAR>lpDefault</VAR><DD>The value to return if a valid value cannot be read.  Make it something that would definitely not be read, such as "(error)".
<DT><VAR>lpReturnedString</VAR><DD>A fixed-length string that will receive either the string read from the file or <VAR>lpDefault</VAR>.
<DT><VAR>nSize</VAR><DD>The length in characters of <VAR>lpReturnedString</VAR>.
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' Read the value "Wallpaper" from under the [Desktop] section
' of WIN.INI.  If an error occurs, the function will return "(error)"
Dim wallpaper As String  ' receives string read from WIN.INI
Dim slength As Long  ' receives length of string read from WIN.INI

wallpaper = Space(255)  ' make room in the buffer to receive the string read from WIN.INI
' Read the string from WIN.INI
slength = <B>GetProfileString</B>("Desktop", "Wallpaper", "(error)", buffer, 255)
wallpaper = Left(wallpaper, slength)  ' extract the returned string from the buffer
If wallpaper = "(error)" Then
  Debug.Print "Could not read information from WIN.INI."
Else
  Debug.Print "Wallpaper file: "; wallpaper
End If</CODE></PRE>

<P><B>See Also:</B> <A href="getprivateprofilestring.html" tppabs="http://www.vbapi.com/ref/g/getprivateprofilestring.html">GetPrivateProfileString</A>, <A href="getprofileint.html" tppabs="http://www.vbapi.com/ref/g/getprofileint.html">GetProfileInt</A>, <A href="writeprofilestring.html" tppabs="http://www.vbapi.com/ref/w/writeprofilestring.html">WriteProfileString</A><BR>
<B>Category:</B> <A href="index.html#inifiles" tppabs="http://www.vbapi.com/ref/index.html#inifiles">INI Files</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">rogue953@st-louis.crosswinds.net</A><BR>
This page is at <A href="getprofilestring.html" tppabs="http://www.vbapi.com/ref/g/getprofilestring.html">http://www.vbapi.com/ref/g/getprofilestring.html</A>

</BODY>
</HTML>