<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: ClipCursor Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the ClipCursor function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,ClipCursor" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<META content="Sat, 11 Sep 1999 02:48:00 GMT" http-equiv="Last-Modified">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">

<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>ClipCursor Function</H1>

<P><CODE class="declare">Declare Function ClipCursor Lib "user32.dll" (lpRect As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>) As Long</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>ClipCursor</B> confines the mouse cursor to a rectangular area of the screen.  If the user tries to move the cursor outside of this bounding region or a call to <A href="setcursorpos.html" tppabs="http://www.vbapi.com/ref/s/setcursorpos.html">SetCursorPos</A> tells it to go outside the box, the cursor will immediately returned to the area.  There is no way to get it out.  This bounding effect will last in whatever program you switch to, and will remain even if the program that confined the cursor closes!  The only way to "release" the cursor is to "confine" it to the entire screen (see example).  It isn't usually a good idea to confine the cursor, since the user expects to move the cursor anywhere (not to mention the disasterous effect if your program quit before releasing the cursor!).</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns zero (call <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).  If successful, the function returns a non-zero value.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>lpRect</VAR><DD>The rectangle (in screen coordinates) defining the confinement rectangle.
</DL></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

' Confine the cursor temporarily to inside of Form1

' ** Place the following code where you want to confine the cursor. **
Dim r As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>  ' confinement rectangle
Dim retval As Long  ' return value

retval = <A href="getwindowrect.html" tppabs="http://www.vbapi.com/ref/g/getwindowrect.html">GetWindowRect</A>(Form1.hWnd, r)  ' put window's coordinates into r
retval = <B>ClipCursor</B>(r)  ' confine the cursor

' ** Place the following code where you want to release the cursor. **
Dim r As RECT, retval As Long
Dim deskhWnd As Long  ' the handle of the desktop window

deskhWnd = <A href="getdesktopwindow.html" tppabs="http://www.vbapi.com/ref/g/getdesktopwindow.html">GetDesktopWindow</A>()  ' get handle of the desktop window
retval = <A href="getwindowrect.html" tppabs="http://www.vbapi.com/ref/g/getwindowrect.html">GetWindowRect</A>(deskhWnd, r)  ' put window's coordinates into r
retval = <B>ClipCursor</B>(r)  ' "confine" the cursor to the entire screen</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="getclipcursor.html" tppabs="http://www.vbapi.com/ref/g/getclipcursor.html">GetClipCursor</A></P>

<H2>Category</H2>
<P><A href="funcc.html#cursor" tppabs="http://www.vbapi.com/ref/funcc.html#cursor">Cursor</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last-Modified:</B> September 10, 1999<BR>
This page is copyright &copy; 1999 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>

<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="clipcursor.html" tppabs="http://www.vbapi.com/ref/c/clipcursor.html">http://www.vbapi.com/ref/c/clipcursor.html</A>
</P>
</BODY>
</HTML>