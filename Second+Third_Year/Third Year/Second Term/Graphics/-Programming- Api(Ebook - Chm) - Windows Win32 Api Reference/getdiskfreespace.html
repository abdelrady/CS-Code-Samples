<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetDiskFreeSpace Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetDiskFreeSpace function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetDiskFreeSpace" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<META content="Mon, 26 Jul 1999 00:49:00 GMT" http-equiv="Last-Modified">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">

<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetDiskFreeSpace Function</H1>

<P><CODE class="declare">Declare Function GetDiskFreeSpace Lib "kernel32.dll" Alias "GetDiskFreeSpaceA" (ByVal lpRootPathName As String, lpSectorsPerCluster As Long, lpBytesPerSector As Long, lpNumberOfFreeClusters As Long, lpTotalNumberOfClusters As Long) As Long</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported but Obsolete with OEM Service Release 2 (OEM2) or later; use <A href="getdiskfreespaceex.html" tppabs="http://www.vbapi.com/ref/g/getdiskfreespaceex.html">GetDiskFreeSpaceEx</A> instead.
<LI><B>Windows 98:</B> Supported but Obsolete; use <A href="getdiskfreespaceex.html" tppabs="http://www.vbapi.com/ref/g/getdiskfreespaceex.html">GetDiskFreeSpaceEx</A> instead.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later but obsolete in Windows NT 4.0 or later; use <A href="getdiskfreespaceex.html" tppabs="http://www.vbapi.com/ref/g/getdiskfreespaceex.html">GetDiskFreeSpaceEx</A> instead.
<LI><B>Windows 2000:</B> Supported but Obsolete; use <A href="getdiskfreespaceex.html" tppabs="http://www.vbapi.com/ref/g/getdiskfreespaceex.html">GetDiskFreeSpaceEx</A> instead.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>GetDiskFreeSpace</B> retrives information about the amount of space on a disk.  This information includes the number of sectors in each cluster, the number of bytes in each sector, the number of free clusters, and the total number of clusters.  Due to the limitations of the 32-bit integer data type, this function only works properly with disks with a capacity less than 2 MB.  The replacement function <A href="getdiskfreespaceex.html" tppabs="http://www.vbapi.com/ref/g/getdiskfreespaceex.html">GetDiskFreeSpaceEx</A> does not have this limitation.</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns 0 (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to determine the error code).  If successful, the function returns a non-zero value.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>lpRootPathName</VAR><DD>The root directory of the disk to get information on, such as "c:\" or "a:\"
<DT><VAR>lpSectorsPerCluster</VAR><DD>32-bit integer variable which receives the number of sectors in a cluster on the disk.
<DT><VAR>lpBytesPerSector</VAR><DD>32-bit integer variable which receives the number of bytes in a sector on the disk.
<DT><VAR>lpNumberOfFreeClusters</VAR><DD>32-bit integer variable which receives the number of unused, empty clusters on the disk.  <B>Windows 2000:</B> This may be lower than the actual value if per-user quotas are enabled.
<DT><VAR>lpTotalNumberOfClusters</VAR><DD>32-bit integer variable which receives the total number of clusters, used and unused, on the disk.  <B>Windows 2000:</B> This may be lower than the actual value if per-user quotas are enabled.
</DL></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

' Calculate and display the free and total space on drive C:
Dim secPerClus As Long  ' receives sectors per cluster
Dim bytePerSec As Long  ' receives bytes per sector
Dim freeClus As Long  ' receives number of free clusters
Dim totalClus As Long  ' receives total number of clusters
Dim retval As Long  ' return value

' Read the information into the variables
retval = <B>GetDiskFreeSpace</B>("c:\", secPerClus, bytePerSec, freeClus, totalClus)

' Display the information
Debug.Print "Free space:"; freeClus * secPerClus * bytePerSec; "bytes"
Debug.Print "Total space:"; totalClus * secPerClus * bytePerSec; "bytes"</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="getdiskfreespaceex.html" tppabs="http://www.vbapi.com/ref/g/getdiskfreespaceex.html">GetDiskFreeSpaceEx</A></P>

<H2>Category</H2>
<P><A href="funcc.html#files" tppabs="http://www.vbapi.com/ref/funcc.html#files">Files</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>
<B>Last Modified:</B> July 25, 1999<BR>
This page is copyright &copy; 1999 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>

<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="getdiskfreespace.html" tppabs="http://www.vbapi.com/ref/g/getdiskfreespace.html">http://www.vbapi.com/ref/g/getdiskfreespace.html</A>
</P>
</BODY>
</HTML>