<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: SendInput Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the SendInput function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,SendInput" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>SendInput Function</H1>

<P><CODE class="declare"><SPAN class="kw">Declare Function</SPAN> SendInput <SPAN class="kw">Lib</SPAN> "user32.dll" (<SPAN class="kw">ByVal</SPAN> nInputs <SPAN class="kw">As Long</SPAN>, pInputs <SPAN class="kw">As</SPAN> <A href="input_type.html" tppabs="http://www.vbapi.com/ref/i/input_type.html">INPUT_TYPE</A>, <SPAN class="kw">ByVal</SPAN> cbSize <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN></CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Not Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 4.0 with Service Pack 3 (SP3) or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 2.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>SendInput</B> synthesizes a series of keyboard, mouse, or other hardware inputs and adds them the input stream.  The events generated by the function are not intersperced with any other input messages, user-created or otherwise.</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns 0 (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).  If successful, the function returns the number of input events which were successfully added to the input stream.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>nInputs</VAR><DD>The number of elements in the array passed as <VAR>pInputs</VAR>.
<DT><VAR>pInputs</VAR><DD>An array holding information about each input event to insert into the input stream.  Each element corresponds to a single input event.
<DT><VAR>cbSize</VAR><DD>The size in bytes of a single <A href="input_type.html" tppabs="http://www.vbapi.com/ref/i/input_type.html">INPUT_TYPE</A> structure (not the total size of the array passed as <VAR>pInputs</VAR>).
</DL></P>

<H2>Example</H2>
<P>Synthesize the user typing the letter P followed by clicking the right mouse button.  Note how the information for each individual event is placed in its associated structure before copying it into the input array.  This example runs when the user clicks button Command1.  So, to run this example, you must first place a command button named Command1 on a form window.</P>

<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Type</SPAN> <A href="mouseinput.html" tppabs="http://www.vbapi.com/ref/m/mouseinput.html">MOUSEINPUT</A>
      dx <SPAN class="kw">As Long</SPAN>
      dy <SPAN class="kw">As Long</SPAN>
      mouseData <SPAN class="kw">As Long</SPAN>
      dwFlags <SPAN class="kw">As Long</SPAN>
      time <SPAN class="kw">As Long</SPAN>
      dwExtraInfo <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">End Type</SPAN>
<SPAN class="kw">Public Const</SPAN> MOUSEEVENTF_RIGHTDOWN = &amp;H8
<SPAN class="kw">Public Const</SPAN> MOUSEEVENTF_RIGHTUP = &amp;H10
<SPAN class="kw">Public Type</SPAN> <A href="keybdinput.html" tppabs="http://www.vbapi.com/ref/k/keybdinput.html">KEYBDINPUT</A>
      wVk <SPAN class="kw">As Integer</SPAN>
      wScan <SPAN class="kw">As Integer</SPAN>
      dwFlags <SPAN class="kw">As Long</SPAN>
      time <SPAN class="kw">As Long</SPAN>
      dwExtraInfo <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">End Type</SPAN>
<SPAN class="kw">Public Const</SPAN> VK_P = &ampH50  <SPAN class="com">' using vbKeyP instead would also work</SPAN>
<SPAN class="kw">Public Const</SPAN> KEYEVENTF_KEYUP = &amp;H2
<SPAN class="kw">Public Type</SPAN> <A href="input_type.html" tppabs="http://www.vbapi.com/ref/i/input_type.html">INPUT_TYPE</A>
      dwType <SPAN class="kw">As Long</SPAN>
      xi(0 <SPAN class="kw">To</SPAN> 23) <SPAN class="kw">As Byte</SPAN>
<SPAN class="kw">End Type</SPAN>
<SPAN class="kw">Public Const</SPAN> INPUT_KEYBOARD = 1
<SPAN class="kw">Public Const</SPAN> INPUT_MOUSE = 0
<SPAN class="kw">Public Declare Function</SPAN> <B>SendInput</B> <SPAN class="kw">Lib</SPAN> "user32.dll" (<SPAN class="kw">ByVal</SPAN> nInputs <SPAN class="kw">As Long</SPAN>, pInputs <SPAN class="kw">As</SPAN> <A href="input_type.html" tppabs="http://www.vbapi.com/ref/i/input_type.html">INPUT_TYPE</A>, _
	<SPAN class="kw">ByVal</SPAN> cbSize <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Declare Sub</SPAN> <A href="copymemory.html" tppabs="http://www.vbapi.com/ref/c/copymemory.html">CopyMemory</A> <SPAN class="kw">Lib</SPAN> "kernel32.dll" <SPAN class="kw">Alias</SPAN> "RtlMoveMemory" (Destination <SPAN class="kw">As Any</SPAN>, Source _
	<SPAN class="kw">As Any</SPAN>, <SPAN class="kw">ByVal</SPAN> Length <SPAN class="kw">As Long</SPAN>)

<SPAN class="com">' *** Place the following code inside the form window. ***</SPAN>

<SPAN class="kw">Private Sub</SPAN> Command1_Click()
	<SPAN class="kw">Dim</SPAN> inputevents(0 <SPAN class="kw">To</SPAN> 3) As <A href="input_type.html" tppabs="http://www.vbapi.com/ref/i/input_type.html">INPUT_TYPE</A>  <SPAN class="com">' holds information about each event</SPAN>
	<SPAN class="kw">Dim</SPAN> keyevent <SPAN class="kw">As</SPAN> <A href="keybdinput.html" tppabs="http://www.vbapi.com/ref/k/keybdinput.html">KEYBDINPUT</A>             <SPAN class="com">' temporarily hold keyboard input info</SPAN>
	<SPAN class="kw">Dim</SPAN> mouseevent <SPAN class="kw">As</SPAN> <A href="mouseinput.html" tppabs="http://www.vbapi.com/ref/m/mouseinput.html">MOUSEINPUT</A>           <SPAN class="com">' temporarily hold mouse input info</SPAN>
	
	<SPAN class="com">' Load the information needed to imitate pressing the P key.</SPAN>
	<SPAN class="kw">With</SPAN> keyevent
		.wVk = VK_P       <SPAN class="com">' the P key</SPAN>
		.wScan = 0        <SPAN class="com">' not needed</SPAN>
		.dwFlags = 0      <SPAN class="com">' press the key down</SPAN>
		.time = 0         <SPAN class="com">' use the default</SPAN>
		.dwExtraInfo = 0  <SPAN class="com">' not needed</SPAN>
	<SPAN class="kw">End With</SPAN>
	<SPAN class="com">' Copy the structure into the input array's buffer.</SPAN>
	inputevents(0).dwType = INPUT_KEYBOARD
	<A href="copymemory.html" tppabs="http://www.vbapi.com/ref/c/copymemory.html">CopyMemory</A> inputevents(0).xi(0), keyevent, Len(keyevent)
	
	<SPAN class="com">' Do the same as above, but for releasing the P key.</SPAN>
	<SPAN class="kw">With</SPAN> keyevent
		.wVk = VK_P       <SPAN class="com">' the P key</SPAN>
		.wScan = 0        <SPAN class="com">' not needed</SPAN>
		.dwFlags = KEYEVENTF_KEYUP  <SPAN class="com">' release the key</SPAN>
		.time = 0         <SPAN class="com">' use the default</SPAN>
		.dwExtraInfo = 0  <SPAN class="com">' not needed</SPAN>
	<SPAN class="kw">End With</SPAN>
	inputevents(1).dwType = INPUT_KEYBOARD
	<A href="copymemory.html" tppabs="http://www.vbapi.com/ref/c/copymemory.html">CopyMemory</A> inputevents(1).xi(0), keyevent, Len(keyevent)
	
	<SPAN class="com">' Load the information needed to imitate pressing the right mouse button.</SPAN>
	<SPAN class="kw">With</SPAN> mouseevent
		.dx = 0            <SPAN class="com">' no horizontal movement</SPAN>
		.dy = 0            <SPAN class="com">' no vertical movement</SPAN>
		.mouseData = 0     <SPAN class="com">' not needed</SPAN>
		.dwFlags = MOUSEEVENTF_RIGHTDOWN  <SPAN class="com">' right button down</SPAN>
		.time = 0          <SPAN class="com">' use the default</SPAN>
		.dwExtraInfo = 0   <SPAN class="com">' not needed</SPAN>
	<SPAN class="kw">End With</SPAN>
	<SPAN class="com">' Copy the structure into the input array's buffer.</SPAN>
	inputevents(2).dwType = INPUT_MOUSE
	<A href="copymemory.html" tppabs="http://www.vbapi.com/ref/c/copymemory.html">CopyMemory</A> inputevents(2).xi(0), mouseevent, Len(mouseevent)
	
	<SPAN class="com">' Do the same as above, but for releasing the right mouse button.</SPAN>
	<SPAN class="kw">With</SPAN> mouseevent
		mouseevent.dx = 0           <SPAN class="com">' no horizontal movement</SPAN>
		mouseevent.dy = 0           <SPAN class="com">' no vertical movement</SPAN>
		mouseevent.mouseData = 0    <SPAN class="com">' not needed</SPAN>
		mouseevent.dwFlags = MOUSEEVENTF_RIGHTUP  <SPAN class="com">' right button up</SPAN>
		mouseevent.time = 0         <SPAN class="com">' use the default</SPAN>
		mouseevent.dwExtraInfo = 0  <SPAN class="com">' not needed</SPAN>
	<SPAN class="kw">End With</SPAN>
	<SPAN class="com">' Copy the structure into the input array's buffer.</SPAN>
	inputevents(3).dwType = INPUT_MOUSE
	<A href="copymemory.html" tppabs="http://www.vbapi.com/ref/c/copymemory.html">CopyMemory</A> inputevents(3).xi(0), mouseevent, Len(mouseevent)
	
	<SPAN class="com">' Now that all the information for the four input events has been placed
	' into the array, finally send it into the input stream.</SPAN>
	<B>SendInput</B> 4, inputevents(0), Len(inputevents(0))
<SPAN class="kw">End Sub</SPAN></CODE></PRE></P>

<H2>See Also</H2>
<P><A href="keybd_event.html" tppabs="http://www.vbapi.com/ref/k/keybd_event.html">keybd_event</A>, 
<A href="mouse_event.html" tppabs="http://www.vbapi.com/ref/m/mouse_event.html">mouse_event</A></P>

<H2>Category</H2>
<P><A href="funcc.html#input" tppabs="http://www.vbapi.com/ref/funcc.html#input">Input (General)</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>
<B>Last Modified:</B> August 26, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="sendinput.html" tppabs="http://www.vbapi.com/ref/s/sendinput.html">http://www.vbapi.com/ref/s/sendinput.html</A></P>
</BODY>
</HTML>