<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: LB_GETSELITEMS Message</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the LB_GETSELITEMS message in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,LB_GETSELITEMS" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>LB_GETSELITEMS Message</H1>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 1.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P>Sending the <B>LB_GETSELITEMS</B> message to a multiple-selection list box retrieves an list of all the selected items.  The index of each selected item is copied into an array passed with the message.  For single-selection list boxes, send the <A href="lb_getcursel.html" tppabs="http://www.vbapi.com/ref/l/lb_getcursel.html">LB_GETCURSEL</A> message instead.</P>

<H2>Return Value</H2>
<P>If successful, the message returns the number of item indexes copied into the array.  If an error occured, the function returns LB_ERR.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>wParam</VAR><DD>The number of list box item indexes that the array passed as <VAR>lParam</VAR> can hold.
<DT><VAR>lParam</VAR><DD>The array that receives the indexes of the selected items.  If the array is too small, then only some of the indexes are copied over.  To get the minimum length needed for all the indexes, use the <A href="lb_getselcount.html" tppabs="http://www.vbapi.com/ref/l/lb_getselcount.html">LB_GETSELCOUNT</A> message.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const"><SPAN class="kw">Const</SPAN> LB_GETSELITEMS = &amp;H191
<SPAN class="kw">Const</SPAN> LB_ERR = -1</CODE></PRE></P>

<H2>Example</H2>
<P>Display a list of all items that are selected in a list box.  To use this example, place a multi-select list box named List1 and a command button named Command1 on a form window.</P>

<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A> <SPAN class="kw">Lib</SPAN> "user32.dll" <SPAN class="kw">Alias</SPAN> "SendMessageA" (<SPAN class="kw">ByVal</SPAN> hWnd <SPAN class="kw">As Long</SPAN>, _
	<SPAN class="kw">ByVal</SPAN> Msg <SPAN class="kw">As Long</SPAN>, wParam <SPAN class="kw">As Any</SPAN>, lParam <SPAN class="kw">As Any</SPAN>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Const</SPAN> <A href="lb_getselcount.html" tppabs="http://www.vbapi.com/ref/l/lb_getselcount.html">LB_GETSELCOUNT</A> = &amp;H190
<SPAN class="kw">Public Const</SPAN> <B>LB_GETSELITEMS</B> = &amp;H191

<SPAN class="com">' *** Place the following code inside the form window. ***</SPAN>

<SPAN class="kw">Private Sub</SPAN> Command1_Click()
	<SPAN class="kw">Dim</SPAN> items() <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' indexes of the selected items</SPAN>
	<SPAN class="kw">Dim</SPAN> numsel <SPAN class="kw">As Long</SPAN>   <SPAN class="com">' number of selected items</SPAN>
	<SPAN class="kw">Dim</SPAN> c <SPAN class="kw">As Long</SPAN>        <SPAN class="com">' counter variable</SPAN>
	<SPAN class="kw">Dim</SPAN> retval <SPAN class="kw">As Long</SPAN>   <SPAN class="com">' return value</SPAN>
	
	<SPAN class="com">' Count the number of selected items.</SPAN>
	numsel = <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A>(List1.hWnd, <A href="lb_getselcount.html" tppabs="http://www.vbapi.com/ref/l/lb_getselcount.html">LB_GETSELCOUNT</A>, <SPAN class="kw">ByVal CLng(</SPAN>0<SPAN class="kw">)</SPAN>, <SPAN class="kw">ByVal CLng(</SPAN>0<SPAN class="kw">)</SPAN>)
	<SPAN class="kw">If</SPAN> numsel = 0 <SPAN class="kw">Then</SPAN>
		<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> "No items are selected."
	<SPAN class="kw">Else</SPAN>
		<SPAN class="com">' Resize the array so it can hold all the indexes.</SPAN>
		<SPAN class="kw">ReDim</SPAN> items(0 <SPAN class="kw">To</SPAN> numsel - 1) <SPAN class="kw">As Long</SPAN>
		<SPAN class="com">' Get the indexes of all selected items.</SPAN>
		retval = <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A>(List1.hWnd, <B>LB_GETSELITEMS</B>, <SPAN class="kw">ByVal</SPAN> numsel, items(0))
		<SPAN class="com">' Display them.</SPAN>
		<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> "The following items are selected (identified by index):"
		<SPAN class="kw">For</SPAN> c = 0 <SPAN class="kw">To</SPAN> numsel - 1
			<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> items(c);
		<SPAN class="kw">Next</SPAN> c
		<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN>
	<SPAN class="kw">End If</SPAN>
<SPAN class="kw">End Sub</SPAN></CODE></PRE></P>

<H2>See Also</H2>
<P><A href="lb_getcursel.html" tppabs="http://www.vbapi.com/ref/l/lb_getcursel.html">LB_GETCURSEL</A>, 
<A href="lb_getsel.html" tppabs="http://www.vbapi.com/ref/l/lb_getsel.html">LB_GETSEL</A>, 
<A href="lb_getselcount.html" tppabs="http://www.vbapi.com/ref/l/lb_getselcount.html">LB_GETSELCOUNT</A></P>

<H2>Category</H2>
<P><A href="msgc.html#listboxes" tppabs="http://www.vbapi.com/ref/msgc.html#listboxes">List Boxes</A></P>

<P><A href="msga.html" tppabs="http://www.vbapi.com/ref/msga.html">Back to the Message list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> January 21, 2001<BR>
This page is copyright &copy; 2001 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="lb_getselitems.html" tppabs="http://www.vbapi.com/ref/l/lb_getselitems.html">http://www.vbapi.com/ref/l/lb_getselitems.html</A></P>
</BODY>
</HTML>