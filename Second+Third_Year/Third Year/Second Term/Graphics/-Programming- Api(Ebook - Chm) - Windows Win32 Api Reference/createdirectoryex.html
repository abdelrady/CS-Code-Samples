<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: CreateDirectoryEx Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the CreateDirectoryEx function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,CreateDirectoryEx" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<META content="Fri, 24 Dec 1999 19:25:00 GMT" http-equiv="Last-Modified">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">

<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>CreateDirectoryEx Function</H1>

<P><CODE class="declare">Declare Function CreateDirectoryEx Lib "kernel32.dll" Alias "CreateDirectoryExA" (ByVal lpTemplateDirectory As String, ByVal lpNewDirectory As String, lpSecurityAttributes As <A href="security_attributes.html" tppabs="http://www.vbapi.com/ref/s/security_attributes.html">SECURITY_ATTRIBUTES</A>) As Long</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.5 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>CreateDirectoryEx</B> creates a new directory on a disk.  It also allows you to specify the security attributes of the newly created directory, if the operating system supports it.  The newly created directory will inherit most of its attributes (except security) from a template directory specified by the function.  For example, the new directory will have the same file attributes as the template directory.</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns 0 (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).  If successful, the function returns a non-zero value.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>lpTemplateDirectory</VAR><DD>The name of the directory to use as an attribute template for creating the new directory.
<DT><VAR>lpNewDirectory</VAR><DD>The name of the new directory to create.
<DT><VAR>lpSecurityAttributes</VAR><DD><B>Windows NT, 2000:</B> The security attributes to assign to the newly created directory.  <B>Windows 95, 98, CE:</B> This parameter is ignored.
</DL></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

' Create the new directory C:\Dummy\NewDir and
' give it default security attributes.  It will inherit its properties from the
' directory C:\Recycled (the "Recycle Bin") -- although this won't be another
' recycle bin, it will have the Hidden and System attributes.
Dim secattr As <A href="security_attributes.html" tppabs="http://www.vbapi.com/ref/s/security_attributes.html">SECURITY_ATTRIBUTES</A>  ' security attributes structure
Dim retval As Long  ' return value

' Set the desired security attributes
secattr.nLength = Len(secattr)  ' size of the structure
secattr.lpSecurityDescriptor = 0  ' default (normal) level of security
secattr.bInheritHandle = 1  ' this is the default setting

' Create the directory, using C:\Recycled as the template.
retval = <B>CreateDirectoryEx</B>("C:\Recycled", "C:\Dummy\NewDir", secattr)</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="createdirectory.html" tppabs="http://www.vbapi.com/ref/c/createdirectory.html">CreateDirectory</A>, <A href="removedirectory.html" tppabs="http://www.vbapi.com/ref/r/removedirectory.html">RemoveDirectory</A></P>

<H2>Category</H2>
<P><A href="funcc.html#files" tppabs="http://www.vbapi.com/ref/funcc.html#files">Files</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> March 19, 2000<BR>
This page is copyright &copy; 1999 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>

<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="createdirectory.html" tppabs="http://www.vbapi.com/ref/c/createdirectory.html">http://www.vbapi.com/ref/c/createdirectory.html</A>
</P>
</BODY>
</HTML>