<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: MessageBoxIndirect Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the MessageBoxIndirect function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,MessageBoxIndirect" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>MessageBoxIndirect Function</H1>

<P><CODE class="declare">Declare Function MessageBoxIndirect Lib "user32.dll" Alias "MessageBoxIndirectA" (lpMsgBoxParams As <A href="msgboxparams.html" tppabs="http://www.vbapi.com/ref/m/msgboxparams.html">MSGBOXPARAMS</A>) As Long</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 4.0 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>MessageBoxIndirect</B> opens and operates a small message box on the screen.  Message boxes are typically used either to communicate important information (such as an error message) or to prompt the user.  This function offers more options for the creation of the message box than <A href="messagebox.html" tppabs="http://www.vbapi.com/ref/m/messagebox.html">MessageBox</A> and <A href="messageboxex.html" tppabs="http://www.vbapi.com/ref/m/messageboxex.html">MessageBoxEx</A> do because this function stores those options in a structure passed to the function.  The message box only closes when the user presses one of the buttons presented.</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns 0 (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).  If successful, the function returns one of the following flags specifying the button the user clicked on:
<DL>
<DT>IDABORT<DD>The Abort button was clicked.
<DT>IDCANCEL<DD>The Cancel button was clicked (or the user dismissed the message box using the Esc key).
<DT>IDCONTINUE<DD><B>Windows 2000:</B> The Continue button was clicked.
<DT>IDIGNORE<DD>The Ignore button was clicked.
<DT>IDNO<DD>The No button was clicked.
<DT>IDOK<DD>The OK button was clicked.
<DT>IDRETRY<DD>The Retry button was clicked.
<DT>IDTRYAGAIN<DD><B>Windows 2000:</B> The Try Again button was clicked.
<DT>IDYES<DD>The Yes button was clicked.
</DL></P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>lpMsgBoxParams</VAR><DD>The settings used to create and operate the message box.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const">Const IDABORT = 3
Const IDCANCEL = 2
Const IDCONTINUE = 5
Const IDIGNORE = 5
Const IDNO = 7
Const IDOK = 1
Const IDRETRY = 4
Const IDTRYAGAIN = 4
Const IDYES = 6</CODE></PRE></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

' Create a Yes/No dialog for the user.  Also offer a Help
' button which opens the corresponding topic in a WinHelp file.
' The message box is owned by window Form1.  Pay attention
' to where various parts of the example code must be placed.

' *** Place the following code in a module. ***
' This callback function handles the message box's Help button.
Public Sub <A href="msgboxcallback.html" tppabs="http://www.vbapi.com/ref/m/msgboxcallback.html">MsgBoxCallback</A> (lpHelpInfo As <A href="helpinfo.html" tppabs="http://www.vbapi.com/ref/h/helpinfo.html">HELPINFO</A>)
  Dim retval As Long  ' return value

  ' Open the proper topic in the help file "C:\MyProg\proghelp.hlp".
  ' The desired Context ID is found inside the structure.
  retval = <A href="winhelp.html" tppabs="http://www.vbapi.com/ref/w/winhelp.html">WinHelp</A>(Form1.hWnd, "C:\MyProg\proghelp.hlp", HELP_CONTEXT, lpHelpInfo.dwContextId)
End Sub

' This is a dummy function, merely returning what is passed to it.  This
' is needed because the AddressOf operator is only valid inside
' a function call, whereas we need to use it to set a data member.
Public Function DummyFunc (ByVal param As Long) As Long
  DummyFunc = param
End Function

' *** Place the following code where you want to create the message box. ***
Dim mbp As <A href="msgboxparams.html" tppabs="http://www.vbapi.com/ref/m/msgboxparams.html">MSGBOXPARAMS</A>  ' message box's parameters
Dim mbresult As Long  ' result of message box

' Fill in the parameter structure for the message box.
With mbp
  .cbSize = Len(mbp)  ' size of structure
  .hwndOwner = Form1.hWnd  ' window which owns the message box
  .hInstance = App.hInstance  ' handle to instance of this program
  .lpszText = "Are you sure you want to do that?"  ' message box text
  .lpszCaption = "User Prompt"  ' message box's title bar text
  .dwStyle = MB_YESNO Or MB_HELP Or MB_ICONQUESTION  ' flags for display
  .lpszIcon = 0  ' not needed
  .dwContextHelpId = 2300  ' Context ID for the proper topic in the Help file
  .lpfnMsgBoxCallback = DummyFunc(AddressOf <A href="msgboxcallback.html" tppabs="http://www.vbapi.com/ref/m/msgboxcallback.html">MsgBoxCallback</A>)  ' pointer to calback function
  .dwLanguageId = <A href="makelangid.html" tppabs="http://www.vbapi.com/ref/m/makelangid.html">MAKELANGID</A>(LANG_ENGLISH, SUBLANG_ENGLISH_US)  ' use American English
End With

' Display the message box.
mbresult = <B>MessageBoxIndirect</B>(mbp)
' Determine what the user pressed.
If mbresult = IDYES Then
  Debug.Print "OK, go ahead and do that."
Elseif mbresult = IDNO Then
  Debug.Print "Operation aborted."
End If</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="messagebox.html" tppabs="http://www.vbapi.com/ref/m/messagebox.html">MessageBox</A>, <A href="messageboxex.html" tppabs="http://www.vbapi.com/ref/m/messageboxex.html">MessageBoxEx</A></P>

<H2>Category</H2>
<P><A href="funcc.html#dialogboxes" tppabs="http://www.vbapi.com/ref/funcc.html#dialogboxes">Dialog Boxes</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Back to the Function list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> February 11, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="messageboxindirect.html" tppabs="http://www.vbapi.com/ref/m/messageboxindirect.html">http://www.vbapi.com/ref/m/messageboxindirect.html</A></P>
</BODY>
</HTML>