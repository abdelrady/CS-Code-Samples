<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: SetBrushOrgEx Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the SetBrushOrgEx function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,SetBrushOrgEx" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>SetBrushOrgEx Function</H1>

<P><CODE class="declare">Declare Function SetBrushOrgEx Lib "gdi32.dll" (ByVal hdc As Long, ByVal nXOrg As Long, ByVal nYOrg As Long, lppt As <A href="point_type.html" tppabs="http://www.vbapi.com/ref/p/point_type.html">POINT_TYPE</A>) As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>SetBrushOrgEx</B> sets the origin point for using a brush on a given device.  Note that this function only takes effect on the next brush the device selects -- the currently selected brush in unaffected!  The brush origin point determines the offset of the 8x8 block used to fill in areas (the brush).  For example, an origin point of (2,3) would shift the fill pattern 2 pixels to the right and 3 pixels downward.  The old brush origin point is put into the variable passed as <VAR>lppt</VAR>.  The function returns 1 if successful, or 0 if an error occured.

<DL>
<DT><VAR>hdc</VAR><DD>A device context to the device to set the brush origin point of.
<DT><VAR>nXOrg</VAR><DD>The x-coordinate of the new brush origin point.  This must be between 0 and 7 inclusive.
<DT><VAR>nYOrg</VAR><DD>The y-coordinate of the new brush origin point.  This must be between 0 and 7 inclusive.
<DT><VAR>lppt</VAR><DD>Receives the former brush origin point.
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' Fill in rectange (10,20)-(200,150) on window Form1 with a double diagonal-
' cross hatch pattern: one in green, one in blue.  After the first draw/paint, the brush
' origin is adjusted to make a nice overlay effect.
Dim hbrush As Long  ' receives handle to the brushes the program creates
Dim holdbrush As Long  ' receives handle to the device's default brush
Dim oldorg As <A href="point_type.html" tppabs="http://www.vbapi.com/ref/p/point_type.html">POINT_TYPE</A>  ' receives original origin point
Dim xorg As <A href="point_type.html" tppabs="http://www.vbapi.com/ref/p/point_type.html">POINT_TYPE</A>  ' throw-away value
Dim retval As Long  ' return value

' ** First, draw the rectangle using the green hatched pattern **
' Create the green hatched brush
hbrush = <A href="createhatchbrush.html" tppabs="http://www.vbapi.com/ref/c/createhatchbrush.html">CreateHatchBrush</A>(HS_DIAGCROSS, RGB(0, 255, 0))
' Set the brush origin point to (0,0) and store the old value (we'll restore it later)
retval = <B>SetBrushOrgEx</B>(Form1.hDC, 0, 0, oldorg)
' Select the hatched brush and create the rectangle
holdbrush = <A href="selectobject.html" tppabs="http://www.vbapi.com/ref/s/selectobject.html">SelectObject</A>(Form1.hDC, hbrush)  ' select the brush
retval = <A href="rectangle.html" tppabs="http://www.vbapi.com/ref/r/rectangle.html">Rectangle</A>(Form1.hDC, 10, 20, 200, 150)  ' make the rectangle
' Restore the default brush temporarily and destroy the hatched brush
retval = <A href="selectobject.html" tppabs="http://www.vbapi.com/ref/s/selectobject.html">SelectObject</A>(Form1.hDC, holdbrush)  ' restore old brush
retval = <A href="deleteobject.html" tppabs="http://www.vbapi.com/ref/d/deleteobject.html">DeleteObject</A>(hbrush)  ' delete the hatched brush

' ** Now, redraw the rectangle using an offset blue hatched pattern **
' Create the blue hatched brush
hbrush = <A href="createhatchbrush.html" tppabs="http://www.vbapi.com/ref/c/createhatchbrush.html">CreateHatchBrush</A>(HS_DIAGCROSS, RGB(0, 0, 255))
' Set the brush origin point to (4,4) and ignore the old value
retval = <B>SetBrushOrgEx</B>(Form1.hDC, 0, 0, xorg)  ' we don't care about xorg
' Select the hatched brush and recreate the rectangle
holdbrush = <A href="selectobject.html" tppabs="http://www.vbapi.com/ref/s/selectobject.html">SelectObject</A>(Form1.hDC, hbrush)  ' select the brush
retval = <A href="rectangle.html" tppabs="http://www.vbapi.com/ref/r/rectangle.html">Rectangle</A>(Form1.hDC, 10, 20, 200, 150)  ' make the rectangle
' Restore the default brush and destroy the hatched brush
retval = <A href="selectobject.html" tppabs="http://www.vbapi.com/ref/s/selectobject.html">SelectObject</A>(Form1.hDC, holdbrush)  ' restore old brush
retval = <A href="deleteobject.html" tppabs="http://www.vbapi.com/ref/d/deleteobject.html">DeleteObject</A>(hbrush)  ' delete the hatched brush
' Now, restore the device's old brush origin point
retval = <B>SetBrushOrgEx</B>(Form1.hDC, oldorg.x, oldorg.y, xorg)</CODE></PRE>

<P><B>See Also:</B> <A href="getbrushorgex.html" tppabs="http://www.vbapi.com/ref/g/getbrushorgex.html">GetBrushOrgEx</A><BR>
<B>Category:</B> <A href="index.html#brushes" tppabs="http://www.vbapi.com/ref/index.html#brushes">Brushes</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="setbrushorgex.html" tppabs="http://www.vbapi.com/ref/s/setbrushorgex.html">http://www.vbapi.com/ref/s/setbrushorgex.html</A>

</BODY>
</HTML>