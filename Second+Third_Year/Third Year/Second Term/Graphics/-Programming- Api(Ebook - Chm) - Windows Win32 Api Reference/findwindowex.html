<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: FindWindowEx Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the FindWindowEx function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,FindWindowEx" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>FindWindowEx Function</H1>

<P><CODE class="declare"><SPAN class="kw">Declare Function</SPAN> FindWindowEx <SPAN class="kw">Lib</SPAN> "user32.dll" <SPAN class="kw">Alias</SPAN> "FindWindowExA" (<SPAN class="kw">ByVal</SPAN> hwndParent <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> hwndChildAfter <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> lpszClass <SPAN class="kw">As String</SPAN>, <SPAN class="kw">ByVal</SPAN> lpszWindow <SPAN class="kw">As String</SPAN>) <SPAN class="kw">As Long</SPAN></CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 4.0 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>FindWindowEx</B> searches for a window matching a specified <A class="def" href="glossary.html#windowclass" tppabs="http://www.vbapi.com/ref/glossary.html#windowclass" rel="glossary">window class</A> name and/or window name.  The function searches all of the child windows of a given window (if desired), beginning with the windows below a specified child window.  To ignore the window's class and/or title, pass a null string for those parameters.</P>

<H2>Return Value</H2>
<P>If successful, the function returns a <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to the found window.  If no matching window could be found, or if an error occured, the function returns zero (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>To pass a null string as one of the function's parameters, use the vbNullString constant.</P>

<H2>Parameters</H2>
<P><DL><VAR>hWndParent</VAR>A handle to the parent window to search the child windows of.  To search all windows, specify 0 for this parameter.
<DT><VAR>hWndChildAfter</VAR>A handle to the child window specifying a place to begin searching.  Searching begins with the child window immediately after this window in the <A class="def" href="glossary.html#zorder" tppabs="http://www.vbapi.com/ref/glossary.html#zorder" rel="glossary">Z-order</A>.  If this is 0, searching begins with the child window at the top of the Z-order.
<DT><VAR>lpszClass</VAR><DD>The name of the window class of the window to find.  Specify a null string to ignore the class.
<DT><VAR>lpszWindow</VAR><DD>The name of the title bar text of the window to find.  Specify a null string to ignore the window's title.
</DL></P>

<H2>Example</H2>
<P>Display the name of the first command button on window Form1.  The buttons on a form are child windows of the window they appear in.  In VB5 and VB6, buttons created in the Form Editor have class "ThunderCommandButton".  This search runs when the user clicks button cmdFind, so to use this example, you must first place a command button named cmdFind on a form window.</P>

<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <B>FindWindowEx</B> <SPAN class="kw">Lib</SPAN> "user32.dll" <SPAN class="kw">Alias</SPAN> "FindWindowExA" (<SPAN class="kw">ByVal</SPAN> hwndParent <SPAN class="kw">As Long</SPAN>, _
	<SPAN class="kw">ByVal</SPAN> hwndChildAfter <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> lpszClass <SPAN class="kw">As String</SPAN>, <SPAN class="kw">ByVal</SPAN> lpszWindow <SPAN class="kw">As String</SPAN>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <A href="getwindowtextlength.html" tppabs="http://www.vbapi.com/ref/g/getwindowtextlength.html">GetWindowTextLength</A> <SPAN class="kw">Lib</SPAN> "user32.dll" <SPAN class="kw">Alias</SPAN> "GetWindowTextLengthA" _
	(<SPAN class="kw">ByVal</SPAN> hWnd <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <A href="getwindowtext.html" tppabs="http://www.vbapi.com/ref/g/getwindowtext.html">GetWindowText</A> <SPAN class="kw">Lib</SPAN> "user32.dll" <SPAN class="kw">Alias</SPAN> "GetWindowTextA" (<SPAN class="kw">ByVal</SPAN> hWnd <SPAN class="kw">As Long</SPAN>, _
	<SPAN class="kw">ByVal</SPAN> lpString <SPAN class="kw">As String</SPAN>, <SPAN class="lw">ByVal</SPAN> nMaxCount <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>

<SPAN class="com">' *** Place the following code inside the form window. ***</SPAN>

<SPAN class="kw">Private Sub</SPAN> cmdFind_Click()
	<SPAN class="kw">Dim</SPAN> hWnd <SPAN class="kw">As Long</SPAN>       <SPAN class="com">' handle to the found window (the command button)</SPAN>
	<SPAN class="kw">Dim</SPAN> slength <SPAN class="kw">As Long</SPAN>    <SPAN class="com">' length of the found window's text</SPAN>
	<SPAN class="kw">Dim</SPAN> wintext <SPAN class="kw">As String</SPAN>  <SPAN class="com">' holds the window's text</SPAN>
	<SPAN class="kw">Dim</SPAN> retval <SPAN class="kw">As Long</SPAN>     <SPAN class="com">' return value</SPAN>
	
	<SPAN class="com">' Find the "topmost" command button on Form1.  Begin searching at the top.</SPAN>
	hWnd = <B>FindWindowEx</B>(Form1.hWnd, 0, "ThunderCommandButton", vbNullString)
	<SPAN class="kw">If</SPAN> hWnd = 0 <SPAN class="kw">Then</SPAN>
		<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> "No command buttons of class ThunderCommandButton were found."
	<SPAN class="kw">Else</SPAN>
		<SPAN class="com">' Get the text displayed in the button.</SPAN>
		slength = <A href="getwindowtextlength.html" tppabs="http://www.vbapi.com/ref/g/getwindowtextlength.html">GetWindowTextLength</A>(hWnd)
		wintext = Space(slength + 1)
		retval = <A href="getwindowtext.html" tppabs="http://www.vbapi.com/ref/g/getwindowtext.html">GetWindowText</A>(hWnd, wintext, slength + 1)
		<SPAN class="com">' Remove the terminating null and display the result.</SPAN>
		wintext = Left(wintext, slength)
		<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> "The command button's name is: "; wintext
	<SPAN class="kw">End If</SPAN>
<SPAN class="kw">End Sub</SPAN></CODE></PRE></P>

<H2>See Also</H2>
<P><A href="findwindow.html" tppabs="http://www.vbapi.com/ref/f/findwindow.html">FindWindow</A></P>

<H2>Category</H2>
<P><A href="funcc.html#windows" tppabs="http://www.vbapi.com/ref/funcc.html#windows">Windows</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>
<B>Last Modified:</B> December 17, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.<BR>
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="findwindowex.html" tppabs="http://www.vbapi.com/ref/f/findwindowex.html">http://www.vbapi.com/ref/f/findwindowex.html</A>
</P>
</BODY>
</HTML>