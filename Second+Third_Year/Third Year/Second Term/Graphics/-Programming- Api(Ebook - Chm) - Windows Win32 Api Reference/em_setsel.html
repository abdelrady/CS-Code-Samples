<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: EM_SETSEL Message</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the EM_SETSEL message in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,EM_SETSEL" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>EM_SETSEL Message</H1>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 1.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P>The <B>EM_SETSEL</B> message changes the current text selection inside an edit control.  Once this message sets the selection, the edit control's <A class="def" href="glossary.html#caret" tppabs="http://www.vbapi.com/ref/glossary.html#caret" rel="glossary">caret</A> is placed immediately at the end of the selection.</P>

<H2>Return Value</H2>
<P>This message does not return a meaningful value.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>wParam</VAR><DD>The zero-based position of the first character in the selection.  If this is -1, no text is selected.
<DT><VAR>lParam</VAR><DD>The zero-based position of the first character that appears immediately after the end of the selection.  In other words, this is one plus the position of the last selected character.  If this is -1, the selection extends to the end of the control.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const"><SPAN class="kw">Const</SPAN> EM_SETSEL = &amp;HB1</CODE></PRE></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A> <SPAN class="kw">Lib</SPAN> "user32.dll" <SPAN class="kw">Alias</SPAN> "SendMessageA" (<SPAN class="kw">ByVal</SPAN> hWnd _
	<SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> Msg <SPAN class="kw">As Long</SPAN>, wParam <SPAN class="kw">As Any</SPAN>, lParam <SPAN class="kw">As Any</SPAN>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Const</SPAN> <A href="em_replacesel.html" tppabs="http://www.vbapi.com/ref/e/em_replacesel.html">EM_REPLACESEL</A> = &amp;HC2
<SPAN class="kw">Public Const</SPAN> <B>EM_SETSEL</B> = &amp;HB1

<SPAN class="com">' Select the first five characters in edit control Text1.  Then replace the newly
' selected text with the words "REPLACEMENT TEXT".</SPAN>
<SPAN class="kw">Dim</SPAN> retval <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' return value</SPAN>

<SPAN class="com">' First, select the first five characters of Text1.</SPAN>
retval = <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A>(Text1.<SPAN class="kw">hWnd</SPAN>, <B>EM_SETSEL</B>, <SPAN class="kw">ByVal CLng(</SPAN>0<SPAN class="kw">)</SPAN>, <SPAN class="kw">ByVal CLng(</SPAN>5<SPAN class="kw">)</SPAN>)
<SPAN class="com">' Then replace the selection with some other text.  Allow the user to undo it.</SPAN>
retval = <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A>(Text1.<SPAN class="kw">hWnd</SPAN>, <A href="em_replacesel.html" tppabs="http://www.vbapi.com/ref/e/em_replacesel.html">EM_REPLACESEL</A>, <SPAN class="kw">ByVal CLng(</SPAN>1<SPAN class="kw">)</SPAN>, <SPAN class="kw">ByVal</SPAN> "REPLACEMENT TEXT")</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="em_getsel.html" tppabs="http://www.vbapi.com/ref/e/em_getsel.html">EM_GETSEL</A>, 
<A href="em_replacesel.html" tppabs="http://www.vbapi.com/ref/e/em_replacesel.html">EM_REPLACESEL</A></P>

<H2>Category</H2>
<P><A href="msgc.html#editcontrols" tppabs="http://www.vbapi.com/ref/msgc.html#editcontrols">Edit Controls</A></P>

<P><A href="msga.html" tppabs="http://www.vbapi.com/ref/msga.html">Back to the Message list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> May 21, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="em_setsel.html" tppabs="http://www.vbapi.com/ref/e/em_setsel.html">http://www.vbapi.com/ref/e/em_setsel.html</A></P>
</BODY>
</HTML>