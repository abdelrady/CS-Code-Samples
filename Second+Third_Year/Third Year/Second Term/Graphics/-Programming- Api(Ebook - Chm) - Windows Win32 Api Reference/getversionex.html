<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetVersionEx Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetVersionEx function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetVersionEx" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetVersionEx Function</H1>

<P><CODE class="declare">Declare Function GetVersionEx Lib "kernel32.dll" Alias "GetVersionExA" (lpVersionInformation As <A href="osversioninfo.html" tppabs="http://www.vbapi.com/ref/o/osversioninfo.html">OSVERSIONINFO</A>) As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>GetVersionEx</B> reads information about the version of Windows running as the operating system.  This information includes the strict version number and platform (3.x with Win32s, Windows 95, Windows NT, Windows 98, etc.).  The information is put into the variable passed as <VAR>lpVersionInformation</VAR>.  The function returns 0 if an error occured, or a 1 if successful.

<DL>
<DT><VAR>lpVersionInformation</VAR><DD>Receives the version information for the operating system.
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' Display the major and minor version numbers of Windows.
' For example, 4.0 could represent Windows 95.
Dim os As <A href="osversioninfo.html" tppabs="http://www.vbapi.com/ref/o/osversioninfo.html">OSVERSIONINFO</A>  ' receives version information
Dim retval As Long  ' return value

os.dwOSVersionInfoSize = Len(os)  ' set the size of the structure
retval = <B>GetVersionEx</B>(os)  ' read Windows's version information
Debug.Print "Windows version number:"; os.dwMajorVersion; "."; os.dwMinorVersion</CODE></PRE>

<P><B>Category:</B> <A href="index.html#systeminformation" tppabs="http://www.vbapi.com/ref/index.html#systeminformation">System Information</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="getversionex.html" tppabs="http://www.vbapi.com/ref/g/getversionex.html">http://www.vbapi.com/ref/g/getversionex.html</A>

</BODY>
</HTML>