<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetWindowTextLength Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetWindowTextLength function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetWindowTextLength" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetWindowTextLength Function</H1>

<P><CODE class="declare">Declare Function GetWindowTextLength Lib "user32.dll" Alias "GetWindowTextLengthA" (ByVal hWnd As Long) As Long</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 1.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>GetWindowTextLength</B> returns the length in characters of a window's text.  You can use this function in conjunction with <A href="getwindowtext.html" tppabs="http://www.vbapi.com/ref/g/getwindowtext.html">GetWindowText</A> to create a string just long enough to receive the text.  However, this function does not include the terminating null character in the window's text in the character count.  In some instances, this function might report a larger text length than actually exists; however, it will never report fewer than the actual number of characters.  <B>GetWindowTextLength</B> does not work with controls owned by other programs.  To get the window text length of these controls, use the <A href="wm_gettextlength.html" tppabs="http://www.vbapi.com/ref/w/wm_gettextlength.html">WM_GETTEXTLENGTH</A> message instead.</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns 0 (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).  If successful, the function returns the number of characters in the window's text, not including the terminating null character.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<DL>
<DT><VAR>hWnd</VAR><DD>A <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to the window to retrieve the length of the window text of.
</DL>

<H2>Example</H2>
<PRE><CODE class="example">' Display the text displayed in the title bar of window Form1
Dim textlen As Long  ' receives length of text of the window
Dim wintext As String  ' receives the text of the window
Dim slength As Long  ' receives the length of the returned string

' Find out how many characters are in the window's text.
' Add 1 to compensate for the terminating null.
textlen = <B>GetWindowTextLength</B>(Form1.hWnd) + 1
' Make sufficient room in the buffer.
wintext = Space(textlen)
' Retrieve the text of window Form1.
slength = <A href="getwindowtext.html" tppabs="http://www.vbapi.com/ref/g/getwindowtext.html">GetWindowText</A>(Form1.hWnd, wintext, textlen)
' Remove the empty space from the string, if any.
wintext = Left(wintext, slength)
' Display the result.
Debug.Print "The title bar of window Form1 is: "; wintext</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="getwindowtext.html" tppabs="http://www.vbapi.com/ref/g/getwindowtext.html">GetWindowText</A>, 
<A href="wm_gettextlength.html" tppabs="http://www.vbapi.com/ref/w/wm_gettextlength.html">WM_GETTEXTLENGTH</A></P>

<H2>Category</H2>
<P><A href="funcc.html#windows" tppabs="http://www.vbapi.com/ref/funcc.html#windows">Windows</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> February 12, 2000.<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="getwindowtextlength.html" tppabs="http://www.vbapi.com/ref/g/getwindowtextlength.html">http://www.vbapi.com/ref/g/getwindowtextlength.html</A>
</BODY>
</HTML>