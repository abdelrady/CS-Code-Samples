<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: mouse_event Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the mouse_event function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,mouse_event" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>mouse_event Function</H1>

<P><CODE class="declare"><SPAN class="kw">Declare Sub</SPAN> mouse_event <SPAN class="kw">Lib</SPAN> "user32.dll" (<SPAN class="kw">ByVal</SPAN> dwFlags <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> dx <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> dy <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> cButtons <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> dwExtraInfo <SPAN class="kw">As Long</SPAN>)</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 2.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>mouse_event</B> synthesizes mouse input by placing mouse input information into the input stream.  A single mouse input event consists of either a move of the mouse or the change of the button state.  For mouse movement, the coordinates can be given in either absolute or relative form.  Only changes in mouse position or button state should be send via this function.  For example, if the left mouse button is already down, the program should not send another left-button-down input.

<H2>Return Value</H2>
<P><B>mouse_event</B> does not return a value.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>dwFlags</VAR><DD>A combination of the following flags specifying which mouse input information to place into the input stream.  Remember to only specify button status information for those which have changed.  Note that scroll wheel movement and X button status cannot be simultaneously specified because they both use the <VAR>dwData</VAR> parameter.
<DL>
<DT>MOUSEEVENTF_ABSOLUTE<DD>The <VAR>dx</VAR> and <VAR>dy</VAR> parameters contain absolute mouse coordinates.  In the coordinate system used by the function, the screen's upper-left corner has coordinates (0,0) and the lower-right corner has coordinates (65535,65535), regardless of the actual screen size.  If this flag is not set, <VAR>dx</VAR> and <VAR>dy</VAR> contain relative coordinates, whose actual amount of movement depends on the current mouse speed and acceleration settings.
<DT>MOUSEEVENTF_LEFTDOWN<DD>The left button was pressed.
<DT>MOUSEEVENTF_LEFTUP<DD>The left button was released.
<DT>MOUSEEVENTF_MIDDLEDOWN<DD>The middle button was pressed.
<DT>MOUSEEVENTF_MIDDLEUP<DD>The middle button was released.
<DT>MOUSEEVENTF_MOVE<DD>The mouse moved.  The <VAR>dx</VAR> and <VAR>dy</VAR> parameters specify the amount or location of the movement.
<DT>MOUSEEVENTF_RIGHTDOWN<DD>The right button was pressed.
<DT>MOUSEEVENTF_RIGHTUP<DD>The right button was released.
<DT>MOUSEEVENTF_WHEEL<DD><B>Windows NT, 2000:</B> The scroll wheel has moved.  The <VAR>dwData</VAR> parameter specifies the amount of movement.
<DT>MOUSEEVENTF_XDOWN<DD><B>Windows 2000:</B> An X button was pressed.  The <VAR>dwData</VAR> parameter identifies which X buttons.
<DT>MOUSEEVENTF_XUP<DD><B>Windows 2000:</B> An X button was released.  The <VAR>dwData</VAR> parameter identifies which X buttons.
</DL>
<DT><VAR>dx</VAR><DD>Specifies either the x-coordinate of absolute mouse movement or the amount of relative movement along the x-axis.  For relative motion, positive values move right and negative values move left.
<DT><VAR>dy</VAR><DD>Specifies either the y-coordinate of absolute mouse movement or the amount of relative movement along the y-axis.  For relative motion, positive values move down and negative values move up.
<DT><VAR>dwData</VAR><DD><B>Windows NT, 2000:</B> If <VAR>dwFlags</VAR> contains MOUSEEVENTF_WHEEL, this specifies the amount of wheel movement, in integer multiples of WHEEL_DELTA.  Positive values mean forward (away) rotation, and negative values mean backwards (toward) rotation.  <B>Windows 2000:</B> If <VAR>dwFlags</VAR> contains either MOUSEEVENTF_XDOWN or MOUSEEVENTF_XUP, this is a combination of the following flags specifying which X buttons have been pressed or released:
<DL>
<DT>XBUTTON1<DD>The first X button was pressed or released.
<DT>XBUTTON2<DD>The second X button was pressed or released.
</DL>
<DT><VAR>dwExtraInfo</VAR><DD>An additional 32-bit value associated with the mouse event.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const">Const MOUSEEVENTF_ABSOLUTE = &amp;H8000
Const MOUSEEVENTF_LEFTDOWN = &amp;H2
Const MOUSEEVENTF_LEFTUP = &amp;H4
Const MOUSEEVENTF_MIDDLEDOWN = &amp;H20
Const MOUSEEVENTF_MIDDLEUP = &amp;H40
Const MOUSEEVENTF_MOVE = &amp;H1
Const MOUSEEVENTF_RIGHTDOWN = &amp;H8
Const MOUSEEVENTF_RIGHTUP = &amp;H10
Const MOUSEEVENTF_WHEEL = &amp;H80
Const MOUSEEVENTF_XDOWN = &amp;H100
Const MOUSEEVENTF_XUP = &amp;H200
Const WHEEL_DELTA = 120
Const XBUTTON1 = &amp;H1
Const XBUTTON2 = &amp;H2</CODE></PRE></P>

<H2>Example</H2>
<P>Simulate clicking the left mouse button at the upper-left corner of the screen.  Although we could use the <B>mouse_event</B> function to move the cursor, it is much easier to use <A href="setcursorpos.html" tppabs="http://www.vbapi.com/ref/s/setcursorpos.html">SetCursorPos</A> instead.  The example runs when the user clicks button Command1.  Obviously, to use this example, you must place a command button named Command1 on a form window.</P>

<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Declare Sub</SPAN> <B>mouse_event</B> <SPAN class="kw">Lib</SPAN> "user32.dll" (<SPAN class="kw">ByVal</SPAN> dwFlags <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> dx <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> dy _
	<SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> cButtons <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> dwExtraInfo <SPAN class="kw">As Long</SPAN>)
<SPAN class="kw">Public Declare Function</SPAN> <A href="setcursorpos.html" tppabs="http://www.vbapi.com/ref/s/setcursorpos.html">SetCursorPos</A> <SPAN class="kw">Lib</SPAN> "user32.dll" (<SPAN class="kw">ByVal</SPAN> x <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> y <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>

<SPAN class="kw">Private Sub</SPAN> Command1_Click()
	<SPAN class="kw">Dim</SPAN> retval <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' return value</SPAN>
	
	<SPAN class="com">' Move the mouse cursor to the upper-left corner of the screen.</SPAN>
	retval = <A href="setcursorpos.html" tppabs="http://www.vbapi.com/ref/s/setcursorpos.html">SetCursorPos</A>(0, 0)
	<SPAN class="com">' Click the left mouse button once.</SPAN>
	<B>mouse_event</B> MOUSEEVENTF_LEFTDOWN, 0, 0, 0, 0
	<B>mouse_event</B> MOUSEEVENTF_LEFTUP, 0, 0, 0, 0
<SPAN class="kw">End Sub</SPAN></CODE></PRE></P>

<H2>See Also</H2>
<P><A href="keybd_event.html" tppabs="http://www.vbapi.com/ref/k/keybd_event.html">keybd_event</A>, 
<A href="sendinput.html" tppabs="http://www.vbapi.com/ref/s/sendinput.html">SendInput</A></P>

<H2>Category</H2>
<P><A href="funcc.html#mouse" tppabs="http://www.vbapi.com/ref/funcc.html#mouse">Mouse</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>
<B>Last Modified:</B> August 26, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="mouse_event.html" tppabs="http://www.vbapi.com/ref/m/mouse_event.html">http://www.vbapi.com/ref/m/mouse_event.html</A></P>
</BODY>
</HTML>