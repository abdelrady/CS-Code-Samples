<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetAsyncKeyState Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetAsyncKeyState function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetAsyncKeyState" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetAsyncKeyState Function</H1>

<P><CODE class="declare"><SPAN class="kw">Declare Function</SPAN> GetAsyncKeyState <SPAN class="kw">Lib</SPAN> "user32.dll" (<SPAN class="kw">ByVal</SPAN> vKey <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Integer</SPAN></CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 1.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>GetAsyncKeyState</B> determines whether a certain key is currently pressed and whether that key has been pressed since the last call to the function.  This function fails if the thread calling it does not currently have the input focus.</P>

<H2>Return Value</H2>
<P>If the function fails (if the current thread does not have the input focus), the function returns 0.  If the &amp;H8000 bit of the return value is set, the key has been pressed at least once since the last time the thread called <B>GetAsyncKeyState</B>.  If the &amp;H1 bit of the return value is set, the key is currently pressed down.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>vKey</VAR><DD>The <A href="virtualkeycodes.html" tppabs="http://www.vbapi.com/ref/other/virtualkeycodes.html">virtual-key code</A> of the key to check.  <B>Windows NT, 2000:</B> This could also be one of the following flags which distinguish between the left and right Ctrl, Alt, and Shift keys:
<DL>
<DT>VK_LSHIFT<DD>The left Shift key.
<DT>VK_RSHIFT<DD>The right Shift key.
<DT>VK_LCONTROL<DD>The left Ctrl key.
<DT>VK_RCONTROL<DD>The right Ctrl key.
<DT>VK_LMENU<DD>The left Alt key.
<DT>VK_RMENU<DD>The right Alt key.
</DL>
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const">Const VK_LSHIFT = &amp;HA0
Const VK_RSHIFT = &amp;HA1
Const VK_LCONTROL = &amp;HA2
Const VK_RCONTROL = &amp;HA3
Const VK_LMENU = &amp;HA4
Const VK_RMENU = &amp;HA5</CODE></PRE></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <B>GetAsyncKeyState</B> <SPAN class="kw">Lib</SPAN> "user32.dll" (<SPAN class="kw">ByVal</SPAN> vKey <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Integer</SPAN>

<SPAN class="com">' Determine whether the Q key has been pressed or not since the last
' call to the function (assuming this example code has already been run earlier).
' The code runs when button Command1 is pressed.</SPAN>

<SPAN class="kw">Private Sub</SPAN> Command1_Click()
	<SPAN class="kw">Dim</SPAN> keystate <SPAN class="kw">As Integer</SPAN>  <SPAN class="com">' state of the Q key</SPAN>
	
	<SPAN class="com">' Get the state of the Q key as returned by the function.
	' (vbKeyQ is a VB-defined constant for Q's virtual-key code)</SPAN>
	keystate = <B>GetAsyncKeyState</B>(vbKeyQ)
	<SPAN class="com">' Check the &amp;H8000 bit of the return value.</SPAN>
	<SPAN class="kw">If</SPAN> keystate <SPAN class="kw">And</SPAN> &amp;H8000 <SPAN class="kw">Then</SPAN>
		<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> "The Q key has been pressed since the last check."
	<SPAN class="kw">Else</SPAN>
		<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> "The Q key has not been pressed since the last check."
	<SPAN class="kw">End If</SPAN>
<SPAN class="kw">End Sub</SPAN></CODE></PRE></P>

<H2>See Also</H2>
<P><A href="getkeystate.html" tppabs="http://www.vbapi.com/ref/g/getkeystate.html">GetKeyState</A></P>

<H2>Category</H2>
<P><A href="funcc.html#keyboard" tppabs="http://www.vbapi.com/ref/funcc.html#keyboard">Keyboard</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> July 30, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="getasynckeystate.html" tppabs="http://www.vbapi.com/ref/g/getasynckeystate.html">http://www.vbapi.com/ref/g/getasynckeystate.html</A></P>
</BODY>
</HTML>