<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetTempFileName Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetTempFileName function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetTempFileName" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetTempFileName Function</H1>

<P><CODE class="declare">Declare Function GetTempFileName Lib "kernel32.dll" Alias "GetTempFileNameA" (ByVal lpszPath As String, ByVal lpPrefixString As String, ByVal wUnique As Long, ByVal lpTempFileName As String) As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>GetTempFileName</B> generates a filename for a temporary file and optionally creates it for you.  Temporary files are used to store data for short periods of time on the hard drive.  The full filename, including the path, is put into the string variable passed as <VAR>lpTempFileName</VAR>.  The format of the generated filename is path\xxxuuuu.TMP.  path is the path to put the file in, preferably the temporary directory supplied by Windows, which can be gotten through <A href="gettemppath.html" tppabs="http://www.vbapi.com/ref/g/gettemppath.html">GetTempPath</A>.  xxx is the string specified in <VAR>lpPrefixString</VAR>.  uuuu is a hexadecimal number between 0000 and FFFF.  If <VAR>wUnique</VAR> is non-zero, uuuu is the rightmost four digits of the number (in hexadecimal), and the file is not created.  This method will work even if a file with that name already exists.  If <VAR>wUnique</VAR> is zero, uuuu is a random number generated by Windows, and the file is created.  Temporary files always have a .TMP extension.  The function returns the value used for uuuu if successful, or 0 if an error occured.

<DL>
<DT><VAR>lpszPath</VAR><DD>The path to put the temporary file into.  This is preferably the same path gotten from <A href="gettemppath.html" tppabs="http://www.vbapi.com/ref/g/gettemppath.html">GetTempPath</A>.
<DT><VAR>lpPrefixString</VAR><DD>The first three characters of the filename.
<DT><VAR>wUnique</VAR><DD>If non-zero, this number's last four digits in hexidecimal are the last four characters in the filename, and the file is not created.  If zero, the last four characters are generated by Windows, and the file is created.
<DT><VAR>lpTempFileName</VAR><DD>A string that receives the path and filename of the temporary file.
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' Generate a temporary file (path)\api????.TMP, where (path)
' is Windows's temporary file directory and ???? is a randomly assigned unique value.
' Then display the name of the created file on the screen.
Dim temppath As String  ' receives name of temporary file path
Dim tempfile As String  ' receives name of temporary file
Dim slength As Long  ' receives length of string returned for the path
Dim lastfour As Long  ' receives hex value of the randomly assigned ????

' Get Windows's temporary file path
temppath = Space(255)  ' initialize the buffer to receive the path
slength = <A href="gettemppath.html" tppabs="http://www.vbapi.com/ref/g/gettemppath.html">GetTempPath</A>(255, temppath)  ' read the path name
temppath = Left(temppath, slength)  ' extract data from the variable

' Get a uniquely assigned random file
tempfile = Space(255)  ' initialize buffer to receive the filename
lastfour = <B>GetTempFileName</B>(temppath, "api", 0, tempfile)  ' get a unique temporary file name
' (Note that the file is also created for you in this case.)
tempfile = Left(tempfile, InStr(tempfile, vbNullChar) - 1)  ' extract data from the variable
Debug.Print "Temporary filename: "; tempfile</CODE></PRE>

<P><B>See Also:</B> <A href="gettemppath.html" tppabs="http://www.vbapi.com/ref/g/gettemppath.html">GetTempPath</A><BR>
<B>Category:</B> <A href="index.html#files" tppabs="http://www.vbapi.com/ref/index.html#files">Files</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="mailto:rogue953@st-louis.crosswinds.net">rogue953@st-louis.crosswinds.net</A><BR>
This page is at <A href="gettempfilename.html" tppabs="http://www.vbapi.com/ref/g/gettempfilename.html">http://www.vbapi.com/ref/g/gettempfilename.html</A>

</BODY>
</HTML>