<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: SHQueryRecycleBin Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the SHQueryRecycleBin function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,SHQueryRecycleBin" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<META content="Tue, 31 Aug 1999 23:37:00 GMT" http-equiv="Last-Modified">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">

<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>SHQueryRecycleBin Function</H1>

<P><CODE class="declare">Declare Function SHQueryRecycleBin Lib "shell32.dll" Alias "SHQueryRecycleBinA" (ByVal pszRootPath As String, pSHQueryRBInfo As <A href="shqueryrbinfo.html" tppabs="http://www.vbapi.com/ref/s/shqueryrbinfo.html">SHQUERYRBINFO</A>) As Long</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Requires Internet Explorer 4.0 or later with integrated shell installed.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 4.0 or later and Internet Explorer 4.0 or later with integrated shell installed.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>SHQueryRecycleBin</B> retrieves information about how many files (or other items) are currently in the Recycle Bin as well as how much disk space they consume.  This function will work with the Recycle Bin specific to a certain drive, as well as work with the Recycle Bin as considered over the entire system.</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns a non-zero error code.  If successful, the function returns 0.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>pszRootPath</VAR><DD>A path which is on the drive to query the Recycle Bin of.  If this string is empty, the function instead queries all Recycle Bins on the system as a whole.
<DT><VAR>pSHQueryRBInfo</VAR><DD>Receives the number of bytes in the Recycle Bin and the number of items in it.  The <VAR>cbSize</VAR> member of the structure must be initialized before calling the function.
</DL></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

' Display the number of items in the Recycle Bin on the C:
' drive and the size of it.
Dim rbinfo As <A href="shqueryrbinfo.html" tppabs="http://www.vbapi.com/ref/s/shqueryrbinfo.html">SHQUERYRBINFO</A>  ' information about the bin
Dim retval As Long  ' return value

' Initialize the size of the structure.
rbinfo.cbSize = Len(rbinfo)
' Query the contents of C:'s Recycle Bin.
retval = <B>SHQueryRecycleBin</B>("C:\", rbinfo)  ' the path doesn't have to be the root path
' Display the number of items in the Recycle Bin, if the value is
' within Visual Basic's numeric display limits.
If (rbinfo.i64NumItems.LowPart And &amp;H80000000) = &amp;H80000000 Or rbinfo.i64NumItems.HighPart &gt; 0 Then
  Debug.Print "Recycle Bin contains more than 2,147,483,647 items."
Else
  Debug.Print "Recycle Bin contains"; rbinfo.i64NumItems.LowPart; "items."
End If
' Likewise display the number of bytes the Recycle Bin is taking up.
If (rbinfo.i64Size.LowPart And &amp;H80000000) = &amp;H80000000 Or rbinfo.i64Size.HighPart &gt; 0 Then
  Debug.Print "Recycle Bin consumes more than 2,147,483,647 bytes."
Else
  Debug.Print "Recycle Bin consumes"; rbinfo.i64Size.LowPart; "bytes."
End If</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="shemptyrecyclebin.html" tppabs="http://www.vbapi.com/ref/s/shemptyrecyclebin.html">SHEmptyRecycleBin</A></P>

<H2>Category</H2>
<P><A href="funcc.html#shell" tppabs="http://www.vbapi.com/ref/funcc.html#shell">Shell</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> August 31, 1999<BR>
This page is copyright &copy; 1999 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>

<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="shqueryrecyclebin.html" tppabs="http://www.vbapi.com/ref/s/shqueryrecyclebin.html">http://www.vbapi.com/ref/s/shqueryrecyclebin.html</A>
</P>
</BODY>
</HTML>