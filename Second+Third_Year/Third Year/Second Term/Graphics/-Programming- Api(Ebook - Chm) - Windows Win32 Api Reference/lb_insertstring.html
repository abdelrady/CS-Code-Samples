<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: LB_INSERTSTRING Message</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the LB_INSERTSTRING message in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,LB_INSERTSTRING" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>LB_INSERTSTRING Message</H1>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 1.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P>Sending the <B>LB_INSERTSTRING</B> message to a list box inserts a string into it.  The string is placed at the position specified in the parameters, regardless of whether the list box is sorted or not.</P>

<H2>Return Value</H2>
<P>If successful, the message returns the zero-based index of the newly added string's position in the list box.  If there is insufficient space to store the new string, the message returns LB_ERRSTRING.  If some other error occurs, the message returns LB_ERR.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>wParam</VAR><DD>The zero-based index of the position to insert the string in the list box.  If this is -1, the string is added to the end of the list.
<DT><VAR>lParam</VAR><DD>The string to add to the list box.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const"><SPAN class="kw">Const</SPAN> LB_INSERTSTRING = &amp;H181
<SPAN class="kw">Const</SPAN> LB_ERR = -1
<SPAN class="kw">Const</SPAN> LB_ERRSPACE = -2</CODE></PRE></P>

<H2>Example</H2>
<P>When the user clicks button Command1, insert three strings into list box List1.  One string is added to the beginning, one to the third position, and one to the end.  To run this example, place a list box named List1 and a command button named Command1 on a form window.</P>

<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A> <SPAN class="kw">Lib</SPAN> "user32.dll" <SPAN class="kw">Alias</SPAN> "SendMessageA" (<SPAN class="kw">ByVal</SPAN> hWnd <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> Msg _
	<SPAN class="kw">As Long</SPAN>, wParam <SPAN class="kw">As Any</SPAN>, lParam <SPAN class="kw">As Any</SPAN>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Const</SPAN> <B>LB_INSERTSTRING</B> = &amp;H181

<SPAN class="com">' *** Place the following code inside a form window. ***</SPAN>

<SPAN class="kw">Private Sub</SPAN> Command1_Click()
	<SPAN class="kw">Dim</SPAN> retval <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' return value</SPAN>
	
	<SPAN class="com">' Add a string to the beginning of the drop-down box.</SPAN>
	retval = <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A>(List1.hWnd, <B>LB_INSERTSTRING</B>, <SPAN class="kw">ByVal CLng(</SPAN>0<SPAN class="kw">)</SPAN>, <SPAN class="kw">ByVal</SPAN> "First Item")
	<SPAN class="com">' Insert a string at the third position in the drop-down box.</SPAN>
	retval = <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A>(List1.hWnd, <B>LB_INSERTSTRING</B>, <SPAN class="kw">ByVal CLng(</SPAN>2<SPAN class="kw">)</SPAN>, <SPAN class="kw">ByVal</SPAN> "Third Item")
	<SPAN class="com">' Add a string to the end of the drop-down box.</SPAN>
	retval = <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A>(List1.hWnd, <B>LB_INSERTSTRING</B>, <SPAN class="kw">ByVal CLng(</SPAN>-1<SPAN class="kw">)</SPAN>, <SPAN class="kw">ByVal</SPAN> "Last Item")
<SPAN class="kw">End Sub</SPAN>

</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="lb_addstring.html" tppabs="http://www.vbapi.com/ref/l/lb_addstring.html">LB_ADDSTRING</A>, 
<A href="lb_deletestring.html" tppabs="http://www.vbapi.com/ref/l/lb_deletestring.html">LB_DELETESTRING</A>, 
<A href="lb_resetcontent.html" tppabs="http://www.vbapi.com/ref/l/lb_resetcontent.html">LB_RESETCONTENT</A></P>

<H2>Category</H2>
<P><A href="msgc.html#listboxes" tppabs="http://www.vbapi.com/ref/msgc.html#listboxes">List Boxes</A></P>

<P><A href="msga.html" tppabs="http://www.vbapi.com/ref/msga.html">Back to the Message list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> December 17, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="lb_insertstring.html" tppabs="http://www.vbapi.com/ref/l/lb_insertstring.html">http://www.vbapi.com/ref/l/lb_insertstring.html</A></P>
</BODY>
</HTML>