<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: BY_HANDLE_FILE_INFORMATION Structure</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the BY_HANDLE_FILE_INFORMATION structure in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,BY_HANDLE_FILE_INFORMATION" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>BY_HANDLE_FILE_INFORMATION Structure</H1>

<P><PRE><CODE class="tc">Type BY_HANDLE_FILE_INFORMATION
  dwFileAttributes As Long
  ftCreationTime As <A href="filetime.html" tppabs="http://www.vbapi.com/ref/f/filetime.html">FILETIME</A>
  ftLastAccessTime As <A href="filetime.html" tppabs="http://www.vbapi.com/ref/f/filetime.html">FILETIME</A>
  ftLastWriteTime As <A href="filetime.html" tppabs="http://www.vbapi.com/ref/f/filetime.html">FILETIME</A>
  dwVolumeSerialNumber As Long
  nFileSizeHigh As Long
  nFileSizeLow As Long
  nNumberOfLinks As Long
  nFileIndexHigh As Long
  nFileIndexLow As Long
End Type</CODE></PRE>

<P><B>BY_HANDLE_FILE_INFORMATION</B>-type variables hold various pieces of information about a file.  This information includes the file's attributes; its creation, last-access, and last-modified times and dates; the serial number of the disk the file is on; the file's size; the number of links to the file in the file system; and the unique file identifier value.  Notice how the file size and file index, both being 64-bit values, are split into high-order and low-order halves of 32 bits each.  To get the value they represent, you can append the hexadecimal or binary values of the two halves together.  You can also use the formula <VAR>actualvalue</VAR> = <VAR>high_order</VAR> * 2^32 + <VAR>low_order</VAR> to calculate it.

<DL>
<DT><VAR>dwFileAttributes</VAR><DD>One or more of the following flags which specify the file's various attributes:
<DL>
<DT>FILE_ATTRIBUTE_ARCHIVE = &amp;H20<DD>An archive file (which most files are).
<DT>FILE_ATTRIBUTE_COMPRESSED = &amp;H800<DD>A file residing in a compressed drive or directory.
<DT>FILE_ATTRIBUTE_DIRECTORY = &amp;H10<DD>A directory instead of a file.
<DT>FILE_ATTRIBUTE_HIDDEN = &amp;H2<DD>A hidden file, not normally visible to the user.
<DT>FILE_ATTRIBUTE_NORMAL = &amp;H80<DD>An attribute-less file (cannot be combined with other attributes).
<DT>FILE_ATTRIBUTE_READONLY = &amp;H1<DD>A read-only file.
<DT>FILE_ATTRIBUTE_SYSTEM = &amp;H4<DD>A system file, used exclusively by the operating system.
</DL>
<DT><VAR>ftCreationTime</VAR><DD>The time and date of when the file was created.
<DT><VAR>ftLastAccessTime</VAR><DD>The time and date of when the file was last accessed.
<DT><VAR>ftLastWriteTime</VAR><DD>The time and date of when the file was last modified or written to.
<DT><VAR>dwVolumeSerialNumber</VAR><DD>The serial number of the disk which the file is stored on.
<DT><VAR>nFileSizeHigh</VAR><DD>The high-order half of the file's size.
<DT><VAR>nFileSizeLow</VAR><DD>The low-order half of the file's size.
<DT><VAR>nNumberOfLinks</VAR><DD>The number of links to the file in the file system.  In NTFS (Win NT File System), this can be greater than one.  In the FAT or FAT32 system (Win 32s, Win 95/98), this will always be 1.
<DT><VAR>nFileIndexHigh</VAR><DD>The high-order half of a unique 64-bit identifier of the file.
<DT><VAR>nFileIndexLow</VAR><DD>The low-order half of a unique 64-bit identifier of the file.
</DL>

<P><B>Used by:</B> <A href="getfileinformationbyhandle.html" tppabs="http://www.vbapi.com/ref/g/getfileinformationbyhandle.html">GetFileInformationByHandle</A>
<P><A href="structa.html" tppabs="http://www.vbapi.com/ref/structa.html">Go back to the alphabetical Structure listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="by_handle_file_information.html" tppabs="http://www.vbapi.com/ref/b/by_handle_file_information.html">http://www.vbapi.com/ref/b/by_handle_file_information.html</A>

</BODY>
</HTML>