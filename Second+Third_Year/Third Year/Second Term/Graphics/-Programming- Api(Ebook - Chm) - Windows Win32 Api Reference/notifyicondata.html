<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: NOTIFYICONDATA Structure</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the NOTIFYICONDATA structure in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,NOTIFYICONDATA" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>NOTIFYICONSTRUCTURE</H1>

<P><PRE><CODE class="type">Type NOTIFYICONDATA
  cbSize As Long
  hWnd As Long
  uID As Long
  uFlags As Long
  uCallbackMessage As Long
  hIcon As Long
  szTip As String * 64  ' Windows 2000: make this String * 128
  ' The following data members are only valid in Windows 2000!
  ' (uncomment the following lines to use them)
  'dwState As Long
  'dwStateMask As Long
  'szInfo As String * 256
  'uTimeoutOrVersion As Long
  'szInfoTitle As String * 64
  'dwInfoFlags As Long
End Type
  </CODE></PRE></P>

<H2>Description &amp; Usage</H2>
<P>The <B>NOTIFYICONDATA</B> structure stores information used to communicate with an icon in the system tray.  The structure holds data that both identifies and describes settings for the icon in question.  Windows 2000 expands significantly on this structure, adding multiple data members not available in previous versions of Windows.</P>

<H2>Visual Basic-Specific Issues</H2>
<P><B>Windows 2000:</B> Officially, the <VAR>uTimeoutOrVersion</VAR> data member is actually two separate data members, <VAR>uTimeout</VAR> and <VAR>uVersion</VAR>, which occupy the same space within the structure.  Because Visual Basic does not support unions like C++ does, it is necessary to assign a single name to this data member.  Nevertheless, using this pseudonym involves no loss of functionality.</P>

<H2>Data Members</H2>
<P><DL>
<DT><VAR>cbSize</VAR><DD>The size in bytes of the structure.
<DT><VAR>hWnd</VAR><DD>A <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to the window that owns the tray icon.  This window will process any events generated by the icon.
<DT><VAR>uID</VAR><DD>The application-definied identifier that uniquely identifies the tray icon.  This value allows a single window to own multiple tray icons, allowing the window to tell the difference between them.
<DT><VAR>uFlags</VAR><DD>A combination of the following flags specifying which of the subsequent members of the structure contain useful data.  Any data members not identified by a flag will be ignored.
<DL>
<DT>NIF_ICON<DD>The <VAR>hIcon</VAR> data member.
<DT>NIF_MESSAGE<DD>The <VAR>uCallbackMessage</VAR> data member.
<DT>NIF_TIP<DD>The <VAR>szTip</VAR> data member.
<DT>NIF_STATE<DD><B>Windows 2000:</B> The <VAR>dwState</VAR> and <VAR>dwStateMask</VAR> data members.
<DT>NIF_INFO<DD><B>Windows 2000:</B> Use a balloon-style tooltip instead of the regular pop-up tooltip.  The <VAR>szInfo</VAR>, <VAR>szTimeOut</VAR>, <VAR>szInfoTitle</VAR>, and <VAR>dwInfoFlags</VAR> data members are used.
</DL>
<DT><VAR>uCallbackMessage</VAR><DD>An application-defined <A class="def" href="javascript:if(confirm('http://www.vbapi.com/ref/help/glossary.html  \n\nThis file was not retrieved by Teleport Pro, because the server reports that this file cannot be found.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/ref/help/glossary.html#message'" tppabs="http://www.vbapi.com/ref/help/glossary.html#message" rel="glossary">message</A> identifier.  This message is sent to the owning window whenever an event occurs related to the tray icon.  These events are primarily when the mouse moves or clicks over the icon or when it receives keyboard input.  The <VAR>wParam</VAR> parameter will be the application-defined identifier of the tray icon that generated the message.  The <VAR>lParam</VAR> parameter will be the "real" Windows message identifier for the event that occured.
<DT><VAR>hIcon</VAR><DD>A handle to the icon to display in the tray.
<DT><VAR>szTip</VAR><DD>The null-terminated string to use for the icon's standard tooltip text.  This text appears when the mouse cursor hovers over the icon.
<DT><VAR>dwState</VAR><DD><B>Windows 2000:</B> A combination of the following flags specifying the icon's state.  Each flag is an independent toggle.
<DL>
<DT>NIS_HIDDEN<DD>The icon is hidden.
<DT>NIS_SHAREDICON<DD>The icon is shared.
</DL>
<DT><VAR>dwStateMask</VAR><DD><B>Windows 2000:</B> A combination of the above flags that specifies which of the <VAR>dwState</VAR> flags to retrieve or modify.
<DT><VAR>szInfo</VAR><DD><B>Windows 2000:</B> The null-terminated string to use for the icon's balloon-style tooltip.
<DT><VAR>uTimeoutOrVersion</VAR><DD><B>Windows 2000:</B> The timeout value, in milliseconds, for the display of the balloon-style tooltip.  If outside of Windows's allowable range, the timeout value will be "pushed" into the range of valid timeout periods.<BR><BR>
Or, if <A href="shell_notifyicon.html" tppabs="http://www.vbapi.com/ref/s/shell_notifyicon.html">Shell_NotifyIcon</A> had been called with the NIM_VERSION flag, this instead specifies whether to use Windows 95 or Windows 2000 behavior.  By default, Windows 2000 will use different messages in some cases to communicate with the owning window.  For backward compatibility, you should use the older behavior.  This is one of the following flags:
<DL>
<DT>0<DD>Use the Windows 95-style behavior.
<DT>NOTIFYICON_VERSION<DD>Use the Windows 2000-style behavior.
</DL>
<DT><VAR>szInfoTitle</VAR><DD>The null-terminated string to use as the title of the balloon tooltip.  This will appear in boldface above the regular text.
<DT><VAR>dwInfoFlags</VAR><DD>If desired, one of the following flags specifying the icon to display to the left of the balloon tooltip text.  Set this as 0 to not use an icon.
<DL>
<DT>NIIF_WARNING<DD>A warning icon.
<DT>NIIF_ERROR<DD>An error icon.
<DT>NIIF_INFO<DD>An information icon.
</DL>
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const">Const NIF_ICON = &amp;H2
Const NIF_MESSAGE = &amp;H1
Const NIF_TIP = &amp;H4
Const NIF_STATE = &amp;H8
Const NIF_INFO = &amp;H10
Const NIS_HIDDEN = &amp;H1
Const NIS_SHAREDICON = &amp;H2
Const NOTIFYICON_VERSION = &amp;H1
Const NIIF_WARNING = &amp;H30
Const NIIF_ERROR = &amp;H10
Const NIIF_INFO = &amp;H40</CODE></PRE></P>

<H2>Used By</H2>
<P><A href="shell_notifyicon.html" tppabs="http://www.vbapi.com/ref/s/shell_notifyicon.html">Shell_NotifyIcon</A></P>

<P><A href="structa.html" tppabs="http://www.vbapi.com/ref/structa.html">Back to the Structure list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> March 19, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="notifyicondata.html" tppabs="http://www.vbapi.com/ref/n/notifyicondata.html">http://www.vbapi.com/ref/n/notifyicondata.html</A></P>
</BODY>
</HTML>