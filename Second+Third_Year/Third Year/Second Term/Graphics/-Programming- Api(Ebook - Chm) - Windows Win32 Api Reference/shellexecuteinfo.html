<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: SHELLEXECUTEINFO Structure</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the SHELLEXECUTEINFO structure in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,SHELLEXECUTEINFO" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>SHELLEXECUTEINFO Structure</H1>

<P><PRE><CODE class="type"><SPAN class="kw">Type</SPAN> SHELLEXECUTEINFO
	cbSize <SPAN class="kw">As Long</SPAN>
	fMask <SPAN class="kw">As Long</SPAN>
	hwnd <SPAN class="kw">As Long</SPAN>
	lpVerb <SPAN class="kw">As String</SPAN>
	lpFile <SPAN class="kw">As String</SPAN>
	lpParameters <SPAN class="kw">As String</SPAN>
	lpDirectory <SPAN class="kw">As String</SPAN>
	nShow <SPAN class="kw">As Long</SPAN>
	hInstApp <SPAN class="kw">As Long</SPAN>
	lpIDList <SPAN class="kw">As Long</SPAN>
	lpClass <SPAN class="kw">As String</SPAN>
	hkeyClass <SPAN class="kw">As Long</SPAN>
	dwHotKey <SPAN class="kw">As Long</SPAN>
	hIcon <SPAN class="kw">As Long</SPAN>
	hProcess <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">End Type</SPAN></CODE></PRE></P>

<H2>Description &amp; Usage</H2>
<P>The <B>SHELLEXECUTEINFO</B> structure holds the information passed to and from the <A href="shellexecuteex.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteex.html">ShellExecuteEx</A> function.  The structure stores the data telling the function what to do, and also receives data describing the function's result.</P>

<H2>Visual Basic-Specific Issues</H2>
<P></P>

<H2>Data Members</H2>
<P><DL>
<DT><VAR>cbSize</VAR><DD>The size, in bytes, of the structure.
<DT><VAR>fMask</VAR><DD>A combination of the following flags specifying which optional parts of the structure to use, and also specifying other options to use with the structure:
<DL>
<DT>SEE_MASK_CLASSKEY<DD>Use the <VAR>hkeyClass</VAR> member.
<DT>SEE_MASK_CLASSNAME<DD>Use the <VAR>lpClass</VAR> member.
<DT>SEE_MASK_CONNECTNETDRV<DD>Validate the file share and connect it to a drive letter.  <VAR>lpFile</VAR> is the Universal Naming Convention (UNC) pathname of a file on the network.
<DT>SEE_MASK_DOENVSUBST<DD>Expand any environment variables appearing inside <VAR>lpDirectory</VAR> or <VAR>lpFile</VAR>.
<DT>SEE_MASK_FLAG_DDEWAIT<DD>If <A href="shellexecuteex.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteex.html">ShellExecuteEx</A> starts a DDE conversation, wait for that conversation to finish before the function returns.
<DT>SEE_MASK_FLAG_NO_UI<DD>Do not display an error dialog if an error occurs.
<DT>SEE_MASK_HOTKEY<DD>Use the <VAR>dwHotKey</VAR> member.
<DT>SEE_MASK_ICON<DD>Use the <VAR>hIcon</VAR> member.
<DT>SEE_MASK_IDLIST<DD>Use the <VAR>lpIDList</VAR> member.
<DT>SEE_MASK_INVOKEIDLIST<DD>Use the <VAR>lpIDList</VAR> member to invoke an application.
<DT>SEE_MASK_NOCLOSEPROCESS<DD>Use the <VAR>hProcess</VAR> member.
</DL>
<DT><VAR>hwnd</VAR><DD>A <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to the window that is calling <A href="shellexecuteex.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteex.html">ShellExecuteEx</A>, if any.
<DT><VAR>lpVerb</VAR><DD>A string that specifies the action to perform on the file specified by <VAR>lpFile</VAR>.  This may be one of the following strings, although others are possible:
<DL>
<DT>"explore"<DD>If <VAR>lpFile</VAR> is a path name, open it in a Windows Explorer window.
<DT>"open"<DD>Open <VAR>lpFile</VAR> using its associated program.  Opening an executable file runs it.  This is the default action if none is specified.
<DT>"print"<DD>Print <VAR>lpFile</VAR> using its associated program.
</DL>
<DT><VAR>lpFile</VAR><DD>The name of the file to open, print, execute, or whatever is specified by <VAR>lpVerb</VAR>.
<DT><VAR>lpParameters</VAR><DD>Additional parameters to use to perform the action.  This would typically be additional command-line options to use, especially when running an executable file.
<DT><VAR>lpDirectory</VAR><DD>The path name of the working directory to use.  If this is not specified, the current directory is used.
<DT><VAR>nShow</VAR><DD>One of the following flags specifying how to display any window opened as a result of the call to <A href="shellexecuteex.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteex.html">ShellExecuteEx</A>:
<DL>
<DT>SW_HIDE<DD>Hide the window.
<DT>SW_MAXIMIZE<DD>Maximize the window.
<DT>SW_MINIMIZE<DD>Minimize the window.
<DT>SW_RESTORE<DD>Restore the window (not maximized nor minimized).
<DT>SW_SHOW<DD>Show the window.
<DT>SW_SHOWMAXIMIZED<DD>Show the window maximized.
<DT>SW_SHOWMINIMIZED<DD>Show the window minimized.
<DT>SW_SHOWMINNOACTIVE<DD>Show the window minimized but do not activate it.
<DT>SW_SHOWNA<DD>Show the window in its current state but do not activate it.
<DT>SW_SHOWNOACTIVATE<DD>Show the window in its most recent size and position but do not activate it.
<DT>SW_SHOWNORMAL<DD>Show the window and activate it (as usual).
</DL>
<DT><VAR>hInstApp</VAR><DD>If <A href="shellexecuteex.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteex.html">ShellExecuteEx</A> is successful, this receives a handle to the instance of the application that was started.  If the function failed, this receives one of the following flags identifying the error:
<DL>
<DT>SE_ERR_ACCESSDENIED<DD>Access was denied.
<DT>SE_ERR_ASSOCINCOMPLETE<DD>File association information was incomplete.
<DT>SE_ERR_DDEBUSY<DD>The DDE operation is busy.
<DT>SE_ERR_DDEFAIL<DD>The DDE operation failed.
<DT>SE_ERR_DDETIMEOUT<DD>The DDE operation timed out.
<DT>SE_ERR_DLLNOTFOUND<DD>A required DLL was not found.
<DT>SE_ERR_FNF<DD>The file could not be found.
<DT>SE_ERR_NOASSOC<DD>There is no associated program to use to perform the action.
<DT>SE_ERR_OOM<DD>The computer is out of memory.
<DT>SE_ERR_PNF<DD>The path could not be found.
<DT>SE_ERR_SHARE<DD>A shared file cound not be opened.
</DL>
<DT><VAR>lpIDList</VAR><DD>A pointer to an <A href="itemidlist.html" tppabs="http://www.vbapi.com/ref/i/itemidlist.html">ITEMIDLIST</A> structure (PIDL) that identifies the file to execute.  This member is only used if <VAR>fMask</VAR> contains SEE_MASK_IDLIST or SEE_MASK_INVOKEIDLIST.
<DT><VAR>lpClass</VAR><DD>The name of the file class or globally unique identifier (GUID) to use.  This member is only used if <VAR>fMask</VAR> contains SEE_MASK_CLASSNAME.
<DT><VAR>hkeyClass</VAR><DD>A handle to the registry key to use for the file class.  This member is only used if <VAR>fMask</VAR> contains SEE_MASK_CLASSKEY.
<DT><VAR>dwHotKey</VAR><DD>The hot key to associate with the application.  The low-order <A class="def" href="glossary.html#word" tppabs="http://www.vbapi.com/ref/glossary.html#word" rel="glossary">word</A> is the <A href="virtualkeycodes.html" tppabs="http://www.vbapi.com/ref/other/virtualkeycodes.html">virtual-key code</A> of the hot key, and the high-order word is a combination of the following flags specifying the modifier keys to use:
<DL>
<DT>HOTKEYF_ALT<DD>Use the Alt key as a modifier.
<DT>HOTKEYF_CONTROL<DD>Use the Ctrl key as a modifier.
<DT>HOTKEYF_EXT<DD>Use the extended key as a modifier.
<DT>HOTKEYF_SHIFT<DD>Use the Shift key as a modifier.
</DL>
This member is only used if <VAR>fMask</VAR> contains SEE_MASK_HOTKEY.
<DT><VAR>hIcon</VAR><DD>A handle to the icon to use for the file class.  This member is only used if <VAR>fMask</VAR> contains SEE_MASK_ICON.
<DT><VAR>hProcess</VAR><DD>Receives a handle to the process that was started by the call to <A href="shellexecuteex.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteex.html">ShellExecuteEx</A>.  This member is only used if <VAR>fMask</VAR> contains SEE_MASK_NOCLOSEPROCESS.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const"><SPAN class="kw">Const</SPAN> SEE_MASK_CLASSKEY = &amp;H3
<SPAN class="kw">Const</SPAN> SEE_MASK_CLASSNAME = &amp;H1
<SPAN class="kw">Const</SPAN> SEE_MASK_CONNECTNETDRV = &amp;H80
<SPAN class="kw">Const</SPAN> SEE_MASK_DOENVSUBST = &amp;H200
<SPAN class="kw">Const</SPAN> SEE_MASK_FLAG_DDEWAIT = &amp;H100
<SPAN class="kw">Const</SPAN> SEE_MASK_FLAG_NO_UI = &amp;H400
<SPAN class="kw">Const</SPAN> SEE_MASK_HOTKEY = &amp;H20
<SPAN class="kw">Const</SPAN> SEE_MASK_ICON = &amp;H10
<SPAN class="kw">Const</SPAN> SEE_MASK_IDLIST = &amp;H4
<SPAN class="kw">Const</SPAN> SEE_MASK_INVOKEIDLIST = &amp;HC
<SPAN class="kw">Const</SPAN> SEE_MASK_NOCLOSEPROCESS = &amp;H40
<SPAN class="kw">Const</SPAN> SW_HIDE = 0
<SPAN class="kw">Const</SPAN> SW_MAXIMIZE = 3
<SPAN class="kw">Const</SPAN> SW_MINIMIZE = 6
<SPAN class="kw">Const</SPAN> SW_RESTORE = 9
<SPAN class="kw">Const</SPAN> SW_SHOW = 5
<SPAN class="kw">Const</SPAN> SW_SHOWMAXIMIZED = 3
<SPAN class="kw">Const</SPAN> SW_SHOWMINIMIZED = 2
<SPAN class="kw">Const</SPAN> SW_SHOWMINNOACTIVE = 7
<SPAN class="kw">Const</SPAN> SW_SHOWNA = 8
<SPAN class="kw">Const</SPAN> SW_SHOWNOACTIVATE = 4
<SPAN class="kw">Const</SPAN> SW_SHOWNORMAL = 1
<SPAN class="kw">Const</SPAN> SE_ERR_ACCESSDENIED = 5            
<SPAN class="kw">Const</SPAN> SE_ERR_ASSOCINCOMPLETE = 27
<SPAN class="kw">Const</SPAN> SE_ERR_DDEBUSY = 30
<SPAN class="kw">Const</SPAN> SE_ERR_DDEFAIL = 29
<SPAN class="kw">Const</SPAN> SE_ERR_DDETIMEOUT = 28
<SPAN class="kw">Const</SPAN> SE_ERR_DLLNOTFOUND = 32
<SPAN class="kw">Const</SPAN> SE_ERR_FNF = 2                     
<SPAN class="kw">Const</SPAN> SE_ERR_NOASSOC = 31
<SPAN class="kw">Const</SPAN> SE_ERR_OOM = 8                     
<SPAN class="kw">Const</SPAN> SE_ERR_PNF = 3                     
<SPAN class="kw">Const</SPAN> SE_ERR_SHARE = 26
<SPAN class="kw">Const</SPAN> HOTKEYF_ALT = &amp;H4
<SPAN class="kw">Const</SPAN> HOTKEYF_CONTROL = &amp;H2
<SPAN class="kw">Const</SPAN> HOTKEYF_EXT = &amp;H8
<SPAN class="kw">Const</SPAN> HOTKEYF_SHIFT = &amp;H1</CODE></PRE></P>

<H2>Used By</H2>
<P><A href="shellexecuteex.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteex.html">ShellExecuteEx</A></P>

<P><A href="structa.html" tppabs="http://www.vbapi.com/ref/structa.html">Back to the Structure list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> August 26, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="shellexecuteinfo.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteinfo.html">http://www.vbapi.com/ref/s/shellexecuteinfo.html</A></P>
</BODY>
</HTML>