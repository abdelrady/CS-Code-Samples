<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: CHOOSEFONT_TYPE Structure</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the CHOOSEFONT (a.k.a. CHOOSEFONT_TYPE) structure in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,CHOOSEFONT_TYPE,CHOOSEFONT" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<META content="Fri, 20 Aug 1999 03:12:00 GMT" http-equiv="Last-Modified">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">

<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>CHOOSEFONT_TYPE Structure</H1>

<P><PRE><CODE class="type">Type CHOOSEFONT_TYPE
  lStructSize As Long
  hwndOwner As Long
  hDC As Long
  lpLogFont As Long
  iPointSize As Long
  Flags As Long
  rgbColors As Long
  lCustData As Long
  lpfnHook As Long
  lpTemplateName As String
  hInstance As Long
  lpszStyle As String
  nFontType As Integer
  MISSING_ALIGNMENT As Integer
  nSizeMin As Long
  nSizeMax As Long
End Type</CODE></PRE></P>

<H2>Description &amp; Usage</H2>
<P>The <B>CHOOSEFONT_TYPE</B> structure is designed to pass information to and from the Choose Font <A class="def" href="glossary.html#commondialog" tppabs="http://www.vbapi.com/ref/glossary.html#commondialog" rel="glossary">common dialog</A> box.  Its members both specify initialization settings for rendering the box and receive information about the user's selection after the function completes.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>Officially, this structure is called <B>CHOOSEFONT</B>.  However, that violates the case-sensitive name spacing of Visual Basic because Visual Basic cannot then distinguish it from the <A href="choosefont.html" tppabs="http://www.vbapi.com/ref/c/choosefont.html">ChooseFont</A> API function.  The Windows API Guide calls this structure <B>CHOOSEFONT_TYPE</B> to avoid the naming collision.</P>

<H2>Data Members</H2>
<P><DL>
<DT><VAR>lStructSize</VAR><DD>The size in bytes of this structure.
<DT><VAR>hwndOwner</VAR><DD>A <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to the window which is opening the Choose Font common dialog box, if any.
<DT><VAR>hdc</VAR><DD>A handle to a <A class="def" href="glossary.html#devicecontext" tppabs="http://www.vbapi.com/ref/glossary.html#devicecontext" rel="glossary">device context</A> or <A class="def" href="glossary.html#informationcontext" tppabs="http://www.vbapi.com/ref/glossary.html#informationcontext" rel="glossary">information context</A> to the printer to read the printer fonts of.  This must be specified if you want to display printer fonts in the font list.
<DT><VAR>lpLogFont</VAR><DD>A <A class="def" href="glossary.html#pointer" tppabs="http://www.vbapi.com/ref/glossary.html#pointer" rel="glossary">pointer</A> to a memory block which receives the contents of a <A href="logfont.html" tppabs="http://www.vbapi.com/ref/l/logfont.html">LOGFONT</A> structure specifying the attributes of the font the user selected.  Optionally, this data block can also be initialized with the font to select by default in the dialog box.  See the example for <A href="choosefont.html" tppabs="http://www.vbapi.com/ref/c/choosefont.html">ChooseFont</A> for how to obtain this address to a memory block.
<DT><VAR>iPointSize</VAR><DD>The point size of the font, measured in units of <SUP>1</SUP>/<SUB>10</SUB> of a point (for example, 120 means 12 point).
<DT><VAR>Flags</VAR><DD>A combination of the following flags specifying options for creating the Choose Font dialog box:
<DL>
<DT>CF_ANSIONLY<DD>List all fonts using a Windows or Unicode character set.  <B>Note:</B> This flag is obsolete; use CF_SCRIPTSONLY instead.
<DT>CF_APPLY<DD>Display and enable the Apply button.
<DT>CF_BOTH<DD>List all printer and screen fonts.
<DT>CF_EFFECTS<DD>Allow the strikeout, underline, and color attributes to be set.
<DT>CF_ENABLEHOOK<DD>Use the <A class="def" href="glossary.html#hookfunction" tppabs="http://www.vbapi.com/ref/glossary.html#hookfunction" rel="glossary">hook function</A> specified by <VAR>lpfnHook</VAR> to process the Choose Font dialog's <A class="def" href="glossary.html#message" tppabs="http://www.vbapi.com/ref/glossary.html#message" rel="glossary">messages</A>.
<DT>CF_ENABLETEMPLATE<DD>Use the dialog box template specified by <VAR>lpTemplateName</VAR>.
<DT>CF_ENABLETEMPLATEHANDLE<DD>Use the preloaded dialog box template specified by <VAR>hInstance</VAR>.
<DT>CF_FIXEDPITCHONLY<DD>List only fixed-pitch fonts.
<DT>CF_FORCEFONTEXIST<DD>Do not allow the user to select a non-listed font.
<DT>CF_INITTOLOGFONTSTRUCT<DD>Use the settings specified in <VAR>lpLogFont</VAR> to select a default font in the dialog box.
<DT>CF_LIMITSIZE<DD>Limit the point size selection to values between <VAR>nSizeMin</VAR> and <VAR>nSizeMax</VAR> inclusive.
<DT>CF_NOOEMFONTS<DD>Same as CF_NOVECTORFONTS.
<DT>CF_NOFACESEL<DD>Do not select a default font face name for the user.
<DT>CF_NOSCRIPTSEL<DD>Do not select a default script setting for the user.
<DT>CF_NOSIZESEL<DD>Do not select a default point size for the user.
<DT>CF_NOSIMULATIONS<DD>Do not display a sample of the selected font.
<DT>CF_NOSTYLESEL<DD>Do not select a default style for the user.
<DT>CF_NOVECTORFONTS<DD>Do not list vector fonts.
<DT>CF_NOVERTFONTS<DD>Do not list vertically-oriented fonts.
<DT>CF_PRINTERFONTS<DD>List printer fonts.
<DT>CF_SCALABLEONLY<DD>Only list scalable fonts.
<DT>CF_SCREENFONTS<DD>List screen fonts.
<DT>CF_SCRIPTSONLY<DD>List all fonts using a Windows or Unicode character set.
<DT>CF_SELECTSCRIPT<DD>Only list fonts with the proper character set.
<DT>CF_SHOWHELP<DD>Display the Help button.
<DT>CF_TTONLY<DD>Only list TrueType fonts.
<DT>CF_USESTYLE<DD>Use information in <VAR>lpStyle</VAR> to initialize the dialog box.
<DT>CF_WYSIWYG<DD>List only fonts common to the printer and the screen (must be used with CF_BOTH and CF_SCALABLEONLY).
</DL>
<DT><VAR>rgbColors</VAR><DD>The RGB value for the color of the font.
<DT><VAR>lCustData</VAR><DD>An application-defined parameter to pass to the hook function specified by <VAR>lpfnHook</VAR>.
<DT><VAR>lpfnHook</VAR><DD>A pointer to a <A href="cfhookproc.html" tppabs="http://www.vbapi.com/ref/c/cfhookproc.html">CFHookProc</A> hook function used to process the dialog box's messages, if needed.
<DT><VAR>lpTemplateName</VAR><DD>The name of the dialog box template to use, if needed.
<DT><VAR>hInstance</VAR><DD>A handle to the instance of the program that contains the pre-loaded dialog box template to use, if needed.
<DT><VAR>lpszStyle</VAR><DD>Receives a string specifying the selected font's style settings.  If used, this string must be large enough to receive the returned string.
<DT><VAR>nFontType</VAR><DD>One or more of the following flags specifying the type of font that is selected:
<DL>
<DT>BOLD_FONTTYPE<DD>Boldface font.
<DT>ITALIC_FONTTYPE<DD>Italicized font.
<DT>PRINTER_FONTTYPE<DD>Printer font.
<DT>REGULAR_FONTTYPE<DD>Regular font -- i.e., not boldface.
<DT>SCREEN_FONTTYPE<DD>Screen font.
<DT>SIMULATED_FONTTYPE<DD>Font that can be simulated in the dialog box.
</DL>
<DT><VAR>MISSING_ALIGNMENT</VAR><DD>Never set this variable.  It is there only to align the other members of the structure in memory.
<DT><VAR>nSizeMin</VAR><DD>The minimum allowable point size selection, if applicable.
<DT><VAR>nSizeMax</VAR><DD>The maximum allowable point size selection, if applicable.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const">Const CF_ANSIONLY = &amp;H400
Const CF_APPLY = &amp;H200
Const CF_BOTH = &amp;H3
Const CF_EFFECTS = &amp;H100
Const CF_ENABLEHOOK = &amp;H8
Const CF_ENABLETEMPLATE = &amp;H10
Const CF_ENABLETEMPLATEHANDLE = &amp;H20
Const CF_FIXEDPITCHONLY = &amp;H4000
Const CF_FORCEFONTEXIST = &amp;H10000
Const CF_INITTOLOGFONTSTRUCT = &amp;H40
Const CF_LIMITSIZE = &amp;H2000
Const CF_NOOEMFONTS = &amp;H800
Const CF_NOFACESEL = &amp;H80000
Const CF_NOSCRIPTSEL = &amp;H800000
Const CF_NOSIZESEL = &amp;H200000
Const CF_NOSIMULATIONS = &amp;H1000
Const CF_NOSTYLESEL = &amp;H100000
Const CF_NOVECTORFONTS = &amp;H800
Const CF_NOVERTFONTS = &amp;H1000000
Const CF_PRINTERFONTS = &amp;H2
Const CF_SCALABLEONLY = &amp;H20000
Const CF_SCREENFONTS = &amp;H1
Const CF_SCRIPTSONLY = &amp;H400
Const CF_SELECTSCRIPT = &amp;H400000
Const CF_SHOWHELP = &amp;H4
Const CF_TTONLY = &amp;H40000
Const CF_USESTYLE = &amp;H80
Const CF_WYSIWYG = &amp;H8000
Const BOLD_FONTTYPE = &amp;H100
Const ITALIC_FONTTYPE = &amp:H200
Const PRINTER_FONTTYPE = &amp;H4000
Const REGULAR_FONTTYPE = &amp;H400
Const SCREEN_FONTTYPE = &amp;H2000
Const SIMULATED_FONTTYPE = &amp;H8000</CODE></PRE></P>

<H2>Used By</H2>
<P><A href="choosefont.html" tppabs="http://www.vbapi.com/ref/c/choosefont.html">ChooseFont</A></P>

<P><A href="structa.html" tppabs="http://www.vbapi.com/ref/structa.html">Go back to the alphabetical Structure listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> August 19, 1999<BR>
This page is copyright &copy; 1999 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="glossary">Copyright Information</A><BR>

<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="choosefont_type.html" tppabs="http://www.vbapi.com/ref/c/choosefont_type.html">http://www.vbapi.com/ref/c/choosefont_type.html</A>
</P>
</BODY>
</HTML>