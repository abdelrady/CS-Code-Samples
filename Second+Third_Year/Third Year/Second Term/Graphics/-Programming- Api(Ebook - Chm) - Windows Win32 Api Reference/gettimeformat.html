<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetTimeFormat Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetTimeFormat function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetTimeFormat" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<META content="Tue, 04 Jan 2000 04:41:00 GMT" http-equiv="Last-Modified">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">

<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetTimeFormat Function</H1>

<P><CODE class="declare">Declare Function GetTimeFormat Lib "kernel32.dll" Alias "GetTimeFormatA" (ByVal Locale As Long, ByVal dwFlags As Long, lpTime As <A href="systemtime.html" tppabs="http://www.vbapi.com/ref/s/systemtime.html">SYSTEMTIME</A>, ByVal lpFormat As Any, ByVal lpTimeStr As String, ByVal cchTime As Long) As Long</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported. 
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.5 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 1.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>GetTimeFormat</B> formats a string to display a time according to a <A class="def" href="glossary.html#locale" tppabs="http://www.vbapi.com/ref/glossary.html#locale" rel="glossary">locale's</A> settings.  The time can be formatted using either a predefined format or a custom format specified in the parameter list.  The string generated by this function can be used to present a more human-readable way to display a time.</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns 0 (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).  If successful, the function returns the size in bytes of the string placed into the variable passed as <VAR>lpTimeStr</VAR>.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>When passing 0 for the <VAR>lpFormat</VAR> parameter, the expression CLng(0) must be used.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>Locale</VAR><DD>The identifier of the locale to use to format the string as necessary.  If this is 0, the locale of the calling thread is used.  This can also be one of the following flags specifying a default locale:
<DL>
<DT>LOCALE_SYSTEM_DEFAULT<DD>The system's default locale.
<DT>LOCALE_USER_DEFAULT<DD>The user's default locale.
</DL>
<DT><VAR>dwFlags</VAR><DD>A combination of the following flags specifying how to format the time string.  If a format string is passed as <VAR>lpFormat</VAR>, this parameter must be set to 0.
<DL>
<DT>LOCALE_NOUSEROVERRIDE<DD>Use the system's default time format for the specified locale, ignoring any changes to those defaults which the user may have selected.
<DT>LOCALE_USE_CP_ACP<DD>Use the system's ANSI code page for string translation instead of the locale's code page.
<DT>TIME_NOMINUTESORSECONDS<DD>Do not display minutes or seconds.
<DT>TIME_NOSECONDS<DD>Do not display seconds.
<DT>TIME_NOTIMEMARKER<DD>Do not display an AM/PM marker.
<DT>TIME_FORCE24HOURFORMAT<DD>Use a 24-hour time format.
</DL>
<DT><VAR>lpTime</VAR><DD>The time to format as a string.  The members of the structure which specify the date are ignored.
<DT><VAR>lpFormat</VAR><DD>The format template string used to generate the time string.  To use one of the predefined formats, this parameter must be 0.  In a format template string, the following series of characters stand for the following components of the time:
<DL>
<DT>h<DD>Hours without a leading zero for single-digit hours, using a 12-hour clock.
<DT>hh<DD>Hours with a leading zero for single-digit hours, using a 12-hour clock.
<DT>H<DD>Hours without a leading zero for single-digit hours, using a 24-hour clock.
<DT>HH<DD>Hours with a leading zero for single-digit hours, using a 24-hour clock.
<DT>m<DD>Minutes without a leading zero for single-digit minutes.
<DT>mm<DD>Minutes with a leading zero for single-digit minutes.
<DT>s<DD>Seconds without a leading zero for single-digit seconds.
<DT>ss<DD>Seconds with a leading zero for single-digit seconds.
<DT>t<DD>A one-character AM/PM indicator.
<DT>tt<DD>A two-character AM/PM indicator.
</DL>
Any spaces appearing in the template string appear verbatim in the formatted string.  To place any other "fixed" characters or text in the format string, you must enclose the literal text in single quotation marks.
<DT><VAR>lpTimeStr</VAR><DD>Receives the formatted time string.  This must initally be sufficiently long to receive the string.
<DT><VAR>cchTime</VAR><DD>The length of the string passed as <VAR>lpTimeStr</VAR>.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const">Const LOCALE_SYSTEM_DEFAULT = &amp;H400
Const LOCALE_USER_DEFAULT = &amp;H800
Const LOCALE_NOUSEROVERRIDE = &amp;H80000000
Const LOCALE_USE_CP_ACP = &amp;H40000000
Const TIME_NOMINUTESORSECONDS = &amp;H1
Const TIME_NOSECONDS = &amp;H2
Const TIME_NOTIMEMARKER = &amp;H4
Const TIME_FORCE24HOURFORMAT = &amp;H8</CODE></PRE></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

' Display today's time first using a "regular" hours-minutes-
' AM/PM string and then using a "military hours" format (e.g., 8:27 AM is 0827 hours).
Dim today As <A href="systemtime.html" tppabs="http://www.vbapi.com/ref/s/systemtime.html">SYSTEMTIME</A>  ' today's date and time
Dim timestr As String  ' receives the formatted time string
Dim strlen As Long  ' length of the buffer for the formatted time string

' Get today's date and time in the local time zone.
<A href="getlocaltime.html" tppabs="http://www.vbapi.com/ref/g/getlocaltime.html">GetLocalTime</A> today

' Make sufficient room in the buffer to receive the time string.
timestr = Space(255)
' Format today's time as hours-minutes-AM/PM.
strlen = <B>GetTimeFormat</B>(0, TIME_NOSECONDS, today, CLng(0), timestr, Len(timestr))
' Remove the empty space from the formatted time string.
timestr = Left(timestr, strlen)
' Display today's time using that format.
Debug.Print "It is currently "; timestr

' Now make sufficient room once again.
timestr = Space(255)
' Format today's time in the military-esque format.
strlen = <B>GetTimeFormat</B>(0, 0, today, "HHmm 'hours'", timestr, Len(timestr))
' Remove the empty space from the formatted string.
timestr = Left(timestr, strlen)
' Display today's time in aforementioned format.
Debug.Print "It is currently "; timestr</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="getdateformat.html" tppabs="http://www.vbapi.com/ref/g/getdateformat.html">GetDateFormat</A></P>

<H2>Category</H2>
<P><A href="funcc.html#natllang" tppabs="http://www.vbapi.com/ref/funcc.html#natllang">National Language Support</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> January 3, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>

<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="gettimeformat.html" tppabs="http://www.vbapi.com/ref/g/gettimeformat.html">http://www.vbapi.com/ref/g/gettimeformat.html</A>
</P>
</BODY>
</HTML>