<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: SubtractRect Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the SubtractRect function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,SubtractRect" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>SubtractRect Function</H1>

<P><CODE class="declare">Declare Function SubtractRect Lib "user32.dll" (lprcDst As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>, lprcSrc1 As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>, lprcSrc2 As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>) As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>SubtractRect</B> subtracts a smaller rectangle from a larger one.  Rectangle subtraction is defined as follows.  The large and small rectangles must intersect completely along one entire side, neither extanding farther along that side than the other.  In other words, they must share a common side.  If this is true, then all of the large rectangle that is not also part of the small rectangle is also a rectangle.  This rectangle is the subtraction rectangle.  This rectangle is put into the variable passed as <VAR>lprcDst</VAR>.  If the two rectangles fail to meet the criteria, <VAR>lprcDst</VAR> is set equal to the large rectangle and the function returns 0.  If subtraction is possible, the function returns 1.

<DL>
<DT><VAR>lprcDst</VAR><DD>Variable that receives the subtraction rectangle.
<DT><VAR>lprcSrc1</VAR><DD>The large rectangle; that is, the rectangle subtracted from.
<DT><VAR>lprcSrc2</VAR><DD>The small rectange; that is, the rectangle subtracted.
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' A demonstration of rectangle subtract.  target = big - small.
' big = (20,30)-(70,80).  small = (20,30)-(40,80).  Note that the left side of the two rectangles is
' common.  target will be set to (41,30)-(70,80).
Dim target As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>, big As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>, small As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>
Dim retval As Long  ' return value

' Set the big and small rectangles
retval = <A href="setrect.html" tppabs="http://www.vbapi.com/ref/s/setrect.html">SetRect</A>(big, 20, 30, 70, 80)  ' big = (20,30)-(70,80)
retval = <A href="setrect.html" tppabs="http://www.vbapi.com/ref/s/setrect.html">SetRect</A>(small, 20, 30, 40, 80)  ' small = (20,30)-(40,80)

' Subtract small from big and put the result into target
retval = <B>SubtractRect</B>(target, big, small)  ' now target = (41,30)-(70,80)</CODE></PRE>

<P><B>See Also:</B> <A href="intersectrect.html" tppabs="http://www.vbapi.com/ref/i/intersectrect.html">IntersectRect</A>, <A href="unionrect.html" tppabs="http://www.vbapi.com/ref/u/unionrect.html">UnionRect</A><BR>
<B>Category:</B> <A href="index.html#rectangles" tppabs="http://www.vbapi.com/ref/index.html#rectangles">Rectangles</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="subtractrect.html" tppabs="http://www.vbapi.com/ref/s/subtractrect.html">http://www.vbapi.com/ref/s/subtractrect.html</A>

</BODY>
</HTML>