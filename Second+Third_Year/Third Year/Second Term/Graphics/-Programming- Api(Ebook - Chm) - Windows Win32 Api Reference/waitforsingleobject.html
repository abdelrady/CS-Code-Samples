<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: WaitForSingleObject Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the WaitForSingleObject function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,WaitForSingleObject" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>WaitForSingleObject Function</H1>

<P><CODE class="declare"><SPAN class="kw">Declare Function</SPAN> WaitForSingleObject <SPAN class="kw">Lib</SPAN> "kernel32.dll" (<SPAN class="kw">ByVal</SPAN> hHandle <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> dwMilliseconds <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>
</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 1.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>WaitForSingleObject</B> halts program execution temporarily, until either a specified object enters a signaled state or a specified timeout period elapses.  This function allows a program to wait until something else has happened before execution continues.</P>

<H2>Return Value</H2>
<P>The function returns one of the following flags:
<DL>
<DT>WAIT_ABANDONED<DD>The mutex specified by <VAR>hHandle</VAR> was not released by its owning thread before that thread terminated.  The mutex is now owned by the calling thread and is in a nonsignaled state.
<DT>WAIT_FAILED<DD>The function failed.  Use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code.
<DT>WAIT_OBJECT_0<DD>The object specified by <VAR>hHandle</VAR> is in a signaled state.
<DT>WAIT_TIMEOUT<DD>The timeout period has elapsed.
</DL></P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>hHandle</VAR><DD>A <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to the object to wait for to enter into a signaled state.  This handle can refer to one of the following types of objects:
<UL>
<LI>Change Notification
<LI>Console Input
<LI>Event
<LI>Job (is signaled when the job has finished)
<LI><A class="def" href="glossary.html#mutex" tppabs="http://www.vbapi.com/ref/glossary.html#mutex" rel="glossary">Mutex</A>
<LI>Process (is signaled when the process has terminated)
<LI><A class="def" href="glossary.html#semaphore" tppabs="http://www.vbapi.com/ref/glossary.html#semaphore" rel="glossary">Semaphore</A>
<LI><A class="def" href="glossary.html#thread" tppabs="http://www.vbapi.com/ref/glossary.html#thread" rel="glossary">Thread</A> (is signaled when the thread has terminated)
<LI>Waitable timer
</UL>
<DT><VAR>dwMilliseconds</VAR><DD>The timeout interval to wait for.  The function will return (with a value of WAIT_TIMEOUT) if this timeout period elapses, even if the object being waited for has not entered a single state.  This parameter could also be the following value:
<DL>
<DT>INFINITE<DD>Wait forever -- do not use a timeout period.
</DL>
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const"><SPAN class="kw">Const</SPAN> WAIT_ABANDONED = &amp;80
<SPAN class="kw">Const</SPAN> WAIT_FAILED = &amp;HFFFFFFFF
<SPAN class="kw">Const</SPAN> WAIT_OBJECT_0 = &amp;H0
<SPAN class="kw">Const</SPAN> WAIT_TIMEOUT = &amp;H102
<SPAN class="kw">Const</SPAN> INFINITE = &amp;HFFFF</CODE></PRE></P>

<H2>Example</H2>
<P>Open the file "C:\Docs\readme.txt" using whatever program is associated with *.txt files (by default, Notepad).  Wait until the user has closed the window before continuing with the example.  The example begins when the user clicks button Command1.  Obviously, to use this example, you need to place a command button named Command1 on a form window.</P>

<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Type</SPAN> <A href="shellexecuteinfo.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteinfo.html">SHELLEXECUTEINFO</A>
	cbSize <SPAN class="kw">As Long</SPAN>
	fMask <SPAN class="kw">As Long</SPAN>
	hwnd <SPAN class="kw">As Long</SPAN>
	lpVerb <SPAN class="kw">As String</SPAN>
	lpFile <SPAN class="kw">As String</SPAN>
	lpParameters <SPAN class="kw">As String</SPAN>
	lpDirectory <SPAN class="kw">As String</SPAN>
	nShow <SPAN class="kw">As Long</SPAN>
	hInstApp <SPAN class="kw">As Long</SPAN>
	lpIDList <SPAN class="kw">As Long</SPAN>
	lpClass <SPAN class="kw">As String</SPAN>
	hkeyClass <SPAN class="kw">As Long</SPAN>
	dwHotKey <SPAN class="kw">As Long</SPAN>
	hIcon <SPAN class="kw">As Long</SPAN>
	hProcess <SPAN class="kw">As Long</SPAN>
End Type
<SPAN class="kw">Public Const</SPAN> SEE_MASK_NOCLOSEPROCESS = &amp;H40
<SPAN class="kw">Public Const</SPAN> SW_SHOWNORMAL = 1
<SPAN class="kw">Public Declare Function</SPAN> <A href="shellexecuteex.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteex.html">ShellExecuteEx</A> <SPAN class="kw">Lib</SPAN> "shell32.dll" <SPAN class="kw">Alias</SPAN> "ShellExecuteExA" (lpExecInfo <SPAN class="kw">As</SPAN> _
	<A href="shellexecuteinfo.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteinfo.html">SHELLEXECUTEINFO</A>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Const</SPAN> SE_ERR_FNF = 2
<SPAN class="kw">Public Const</SPAN> SE_ERR_NOASSOC = 31
<SPAN class="kw">Public Declare Function</SPAN> <B>WaitForSingleObject</B> <SPAN class="kw">Lib</SPAN> "kernel32.dll" (<SPAN class="kw">ByVal</SPAN> hHandle <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> _
	dwMilliseconds <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Const</SPAN> INFINITE = &amp;HFFFF
<SPAN class="kw">Public Const</SPAN> WAIT_TIMEOUT = &amp;H102

<SPAN class="com">' *** Place the following code inside window Form1. ***</SPAN>
<SPAN class="kw">Private Sub</SPAN> Command1_Click()
	<SPAN class="kw">Dim</SPAN> sei <SPAN class="kw">As</SPAN> <A href="shellexecuteinfo.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteinfo.html">SHELLEXECUTEINFO</A>  <SPAN class="com">' structure used by the function</SPAN>
	<SPAN class="kw">Dim</SPAN> retval <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' return value</SPAN>
	
	<SPAN class="com">' Load the information needed to open C:\Docs\readme.txt
	' into the structure.</SPAN>
	<SPAN class="kw">With</SPAN> sei
		<SPAN class="com">' Size of the structure</SPAN>
		.cbSize = Len(sei)
		<SPAN class="com">' Use the optional hProcess element of the structure.</SPAN>
		.fMask = SEE_MASK_NOCLOSEPROCESS
		<SPAN class="com">' Handle to the window calling this function.</SPAN>
		.hwnd = Form1.hWnd
		<SPAN class="com">' The action to perform: open the file.</SPAN>
		.lpVerb = "open"
		<SPAN class="com">' The file to open.</SPAN>
		.lpFile = "C:\Docs\readme.txt"
		<SPAN class="com">' No additional parameters are needed here.</SPAN>
		.lpParameters = ""
		<SPAN class="com">' The default directory -- not really necessary in this case.</SPAN>
		.lpDirectory = "C:\Docs\"
		<SPAN class="com">' Simply display the window.</SPAN>
		.nShow = SW_SHOWNORMAL
		<SPAN class="com">' The other elements of the structure are either not used
		' or will be set when the function returns.</SPAN>
	<SPAN class="kw">End With</SPAN>
	
	<SPAN class="com">' Open the file using its associated program.</SPAN>
	retval = <A href="shellexecuteex.html" tppabs="http://www.vbapi.com/ref/s/shellexecuteex.html">ShellExecuteEx</A>(sei)
	<SPAN class="kw">If</SPAN> retval = 0 <SPAN class="kw">Then</SPAN>
		<SPAN class="com">' The function failed, so report the error.  Err.LastDllError
		' could also be used instead, if you wish.</SPAN>
		<SPAN class="kw">Select Case</SPAN> sei.hInstApp
		<SPAN class="kw">Case</SPAN> SE_ERR_FNF
			<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> "The file C:\Docs\readme.txt was not found."
		<SPAN class="kw">Case</SPAN> SE_NOASSOC
			<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> "No program is associated with *.txt files."
		<SPAN class="kw">Case Else</SPAN>
			<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> "An unexpected error occured."
		<SPAN class="kw">End Select</SPAN>
	<SPAN class="kw">Else</SPAN>
		<SPAN class="com">' Wait for the opened process to close before continuing.  Instead
		' of waiting once for a time of INFINITE, this example repeatedly checks to see if the
		' is still open.  This allows the DoEvents VB function to be called, preventing
		' our program from appearing to lock up while it waits.</SPAN>
		<SPAN class="kw">Do</SPAN>
			DoEvents
			retval = <B>WaitForSingleObject</B>(sei.hProcess, 0)
		<SPAN class="kw">Loop While</SPAN> retval = WAIT_TIMEOUT
		<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> "Notepad (or whatever program was opened) has just closed."
	<SPAN class="kw">End If</SPAN>		
<SPAN class="kw">End Sub</SPAN></CODE></PRE></P>

<!--<H2>See Also</H2>
<P></P>-->

<H2>Category</H2>
<P><A href="funcc.html#synchronization" tppabs="http://www.vbapi.com/ref/funcc.html#synchronization">Synchronization</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Back to the Function list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> October 29, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="waitforsingleobject.html" tppabs="http://www.vbapi.com/ref/w/waitforsingleobject.html">http://www.vbapi.com/ref/w/waitforsingleobject.html</A></P>
</BODY>
</HTML>