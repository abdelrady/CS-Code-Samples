<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetDateFormat Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetDateFormat function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetDateFormat" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<META content="Sat, 01 Jan 2000 21:58:00 GMT" http-equiv="Last-Modified">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">

<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetDateFormat Function</H1>

<P><CODE class="declare">Declare Function GetDateFormat Lib "kernel32.dll" Alias "GetDateFormatA" (ByVal Locale As Long, ByVal dwFlags As Long, lpDate As <A href="systemtime.html" tppabs="http://www.vbapi.com/ref/s/systemtime.html">SYSTEMTIME</A>, ByVal lpFormat As Any, ByVal lpDateStr As String, ByVal cchDate As Long) As Long</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported. 
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.5 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 1.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>GetDateFormat</B> formats a string to display a date according to a <A class="def" href="glossary.html#locale" tppabs="http://www.vbapi.com/ref/glossary.html#locale" rel="glossary">locale's</A> settings.  The date can be formatted using either a predefined format or a custom format specified in the parameter list.  The string generated by this function can be used to present a more human-readable way to display a date.</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns 0 (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).  If successful, the function returns the size in bytes of the string placed into the variable passed as <VAR>lpDateStr</VAR>.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>When passing 0 for the <VAR>lpFormat</VAR> parameter, the expression CLng(0) must be used.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>Locale</VAR><DD>The identifier of the locale to use to format the string as necessary.  If this is 0, the locale of the calling thread is used.  This can also be one of the following flags specifying a default locale:
<DL>
<DT>LOCALE_SYSTEM_DEFAULT<DD>The system's default locale.
<DT>LOCALE_USER_DEFAULT<DD>The user's default locale.
</DL>
<DT><VAR>dwFlags</VAR><DD>A combination of the following flags specifying how to format the date string.  If a format string is passed as <VAR>lpFormat</VAR>, this parameter must be set to 0.
<DL>
<DT>LOCALE_NOUSEROVERRIDE<DD>Use the system's default date format for the specified locale, ignoring any changes to those defaults which the user may have selected.
<DT>LOCALE_USE_CP_ACP<DD>Use the system's ANSI code page for string translation instead of the locale's code page.
<DT>DATE_SHORTDATE<DD>Format the date string using the short date format.
<DT>DATE_LONGDATE<DD>Format the date string using the long date format.
<DT>DATE_YEARMONTH<DD>Format the date string using the year/month date format.
<DT>DATE_USE_ALT_CALENDAR<DD>If an alternate calendar exists, use the default date format of that calendar to format the date string.
<DT>DATE_LTRREADING<DD>Add marks for left-to-right reading layout.
<DT>DATE_RTLREADING<DD>Add marks for right-to-left reading layout.
</DL>
<DT><VAR>lpDate</VAR><DD>The date to format as a string.  The members of the structure which specify the time are ignored.
<DT><VAR>lpFormat</VAR><DD>The format template string used to generate the date string.  To use one of the predefined formats, this parameter must be 0.  In a format template string, the following series of characters stand for the following components of the date:
<DL>
<DT>d<DD>The day of the month as digits without a leading zero for single-digit days.
<DT>dd<DD>The day of the month as digits with a leading zero for single-digit days.
<DT>ddd<DD>The three-letter abbreviation for the name of the day of the week.
<DT>dddd<DD>The full name of the day of the week.
<DT>M<DD>The month as digits without a leading zero for single-digit months.
<DT>MM<DD>The month as digits with a leading zero for single-digit months.
<DT>MMM<DD>The three-letter abbreviation for the name of the month.
<DT>MMMM<DD>The full name of the month.
<DT>y<DD>The last two digits of the year without a leading zero for years between ??00-??09.
<DT>yy<DD>The last two digits of the year with a leading zero for years between ??00-??09.
<DT>yyyy<DD>All four digits of the year.
<DT>gg<DD>The period/era string, if defined for the locale.  If it is not defined, this string is ignored.
</DL>
Any spaces appearing in the template string appear verbatim in the formatted string.  To place any other "fixed" characters or text in the format string, you must enclose the literal text in single quotation marks.
<DT><VAR>lpDateStr</VAR><DD>Receives the formatted date string.  This must initally be sufficiently long to receive the string.
<DT><VAR>cchDate</VAR><DD>The length of the string passed as <VAR>lpDateStr</VAR>.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const">Const LOCALE_SYSTEM_DEFAULT = &amp;H400
Const LOCALE_USER_DEFAULT = &amp;H800
Const LOCALE_NOUSEROVERRIDE = &amp;H80000000
Const LOCALE_USE_CP_ACP = &amp;H40000000
Const DATE_SHORTDATE = &amp;H1
Const DATE_LONGDATE = &amp;H2
Const DATE_USE_ALT_CALENDAR = &amp;H4
Const DATE_YEARMONTH = &amp;H8
Const DATE_LTRREADING = &amp;H10
Const DATE_RTLREADING = &amp;H20</CODE></PRE></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

' Display today's date first in the default Long Date format and
' then in the standard HTTP date format.
Dim today As <A href="systemtime.html" tppabs="http://www.vbapi.com/ref/s/systemtime.html">SYSTEMTIME</A>  ' today's date and time
Dim datestr As String  ' receives the formatted date string
Dim strlen As Long  ' length of the buffer for the formatted date string

' Get today's date and time in the local time zone.
<A href="getlocaltime.html" tppabs="http://www.vbapi.com/ref/g/getlocaltime.html">GetLocalTime</A> today

' Make sufficient room in the buffer to receive the date string.
datestr = Space(255)
' Format today's date as a Long Date.
strlen = <B>GetDateFormat</B>(0, DATE_LONGDATE, today, CLng(0), datestr, Len(datestr))
' Remove the empty space from the formatted date string.
datestr = Left(datestr, strlen)
' Display today's date as a Long Date.
Debug.Print "Today is "; datestr

' Now make sufficient room once again.
datestr = Space(255)
' Format today's date in the format used in HTTP.
strlen = <B>GetDateFormat</B>(0, 0, today, "ddd',' dd MMM yyyy", datestr, Len(datestr))
' Remove the empty space from the formatted string.
datestr = Left(datestr, strlen)
' Display today's date in the HTTP-style format.
Debug.Print "Today is "; datestr</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="gettimeformat.html" tppabs="http://www.vbapi.com/ref/g/gettimeformat.html">GetTimeFormat</A></P>

<H2>Category</H2>
<P><A href="funcc.html#natllang" tppabs="http://www.vbapi.com/ref/funcc.html#natllang">National Language Support</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> January 1, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>

<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="getdateformat.html" tppabs="http://www.vbapi.com/ref/g/getdateformat.html">http://www.vbapi.com/ref/g/getdateformat.html</A>
</P>
</BODY>
</HTML>