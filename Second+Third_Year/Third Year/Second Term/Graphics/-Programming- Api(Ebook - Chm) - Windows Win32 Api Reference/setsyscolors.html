<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: SetSysColors Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the SetSysColors function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,SetSysColors" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>SetSysColors Function</H1>

<P><CODE class="declare"><SPAN class="kw">Declare Function</SPAN> SetSysColors <SPAN class="kw">Lib</SPAN> "user32.dll" (<SPAN class="kw">ByVal</SPAN> cElements <SPAN class="kw">As Long</SPAN>, lpaElements <SPAN class="kw">As Long</SPAN>, lpaRgbValues <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN></CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>SetSysColors</B> changes the system colors used by Windows.  Windows uses these colors when displaying the typical widgets such as title bars, scroll bars, the desktop, menus, etc.  This function can set multiple different system colors simultaneously, by passing all the new RGB color values in an array.  <B>SetSysColors</B> also notifies all windows of the change, so the color change takes effect immediately.  However, the new colors are not saved after Windows shuts down.

<H2>Return Value</H2>
<P>If successful, the function returns a nonzero value.  If an error occured, the function returns zero (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>cElements</VAR><DD>The number of elements in the arrays passed as <VAR>lpaElements</VAR> and <VAR>lpaRgbValues</VAR>.
<DT><VAR>lpaElements</VAR><DD>An array holding the identifiers of all the system colors to change.  Each element can be one of the following flags, specifying a system color:
<DL>
<DT>COLOR_3DDKSHADOW<DD>The dark shadow color for 3D objects.
<DT>COLOR_3DFACE, COLOR_BTNFACE<DD>The face color for 3D objects.
<DT>COLOR_3DHILIGHT, COLOR_3DHIGHLIGHT, COLOR_BTNHILIGHT, COLOR_BTNHIGHLIGHT<DD>The highlight (opposite of shadow) color for 3D objects.
<DT>COLOR_3DLIGHT<DD>The light (opposite of shadow) color for 3D objects.
<DT>COLOR_3DSHADOW, COLOR_BTNSHADOW<DD>The shadow color for 3D objects.
<DT>COLOR_ACTIVEBORDER<DD>The active window border color.
<DT>COLOR_ACTIVECAPTION<DD>The active window title bar color.  <B>Windows 98, 2000:</B> The color of the left side of the active window title bar gradient, if the gradient effect is used.
<DT>COLOR_APPWORKSPACE<DD>The background color of multiple document interface (MDI) windows.
<DT>COLOR_BACKGROUND, COLOR_DESKTOP<DD>The desktop color.
<DT>COLOR_BTNTEXT<DD>The text color for pushbuttons.
<DT>COLOR_CAPTIONTEXT<DD>The color of window caption text, size boxes, and scroll bar arrow boxes.
<DT>COLOR_GRADIENTACTIVECAPTION<DD><B>Windows 98, 2000:</B> The color of the right side of the active window title bar gradient, if the gradient effect is used.
<DT>COLOR_GRADIENTINACTIVECAPTION<DD><B>Windows 98, 2000:</B> The color of the right side of an inactive window's title bar gradient, if the gradient effect is used.
<DT>COLOR_GRAYTEXT<DD>The color for disabled (grayed-out) text.
<DT>COLOR_HIGHLIGHT<DD>The color used to highlight selected items.
<DT>COLOR_HIGHLIGHTTEXT<DD>The color used for the text of highlighted items.
<DT>COLOR_HOTLIGHT<DD><B>Windows 98, 2000:</B> The color of a hot-tracked item, which is executed with a single click.
<DT>COLOR_INACTIVEBORDER<DD>The color of an inactive window's border.
<DT>COLOR_INACTIVECAPTION<DD>The color of an inactive window's caption.  <B>Windows 98, 2000:</B> The color of the right side of an inactive window's title bar gradient, if the gradient effect is used.
<DT>COLOR_INACTIVECAPTIONTEXT<DD>The color of an inactive window's caption text.
<DT>COLOR_INFOBK<DD>The background color for tooltop controls.
<DT>COLOR_INFOTEXT<DD>The text color for tooltip controls.
<DT>COLOR_MENU<DD>The background color of menus.
<DT>COLOR_MENUTEXT<DD>The color of menu text.
<DT>COLOR_SCROLLBAR<DD>The color of a scroll bar's gray area.
<DT>COLOR_WINDOW<DD>The background color of a window.
<DT>COLOR_WINDOWFRAME<DD>The color of a window frame.
<DT>COLOR_WINDOWTEXT<DD>The color of text in a window.
</DL>
<DT><VAR>lpaRgbValues</VAR><DD>An array of the RGB values of the new system colors to assign.  These elements correspond directly to the elements in <VAR>lpaElements</VAR>.  For example, the first element of this array is the color to use for the system color identified by the first element of <VAR>lpaElements</VAR>, etc.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const"><SPAN class="kw">Const</SPAN> COLOR_3DDKSHADOW = 21
<SPAN class="kw">Const</SPAN> COLOR_3DFACE = COLOR_BTNFACE
<SPAN class="kw">Const</SPAN> COLOR_3DHIGHLIGHT = COLOR_BTNHIGHLIGHT
<SPAN class="kw">Const</SPAN> COLOR_3DHILIGHT = COLOR_BTNHIGHLIGHT
<SPAN class="kw">Const</SPAN> COLOR_3DLIGHT = 22
<SPAN class="kw">Const</SPAN> COLOR_3DSHADOW = COLOR_BTNSHADOW
<SPAN class="kw">Const</SPAN> COLOR_ACTIVEBORDER = 10
<SPAN class="kw">Const</SPAN> COLOR_ACTIVECAPTION = 2
<SPAN class="kw">Const</SPAN> COLOR_APPWORKSPACE = 12
<SPAN class="kw">Const</SPAN> COLOR_BACKGROUND = 1
<SPAN class="kw">Const</SPAN> COLOR_BTNFACE = 15
<SPAN class="kw">Const</SPAN> COLOR_BTNHIGHLIGHT = 20
<SPAN class="kw">Const</SPAN> COLOR_BTNHILIGHT = COLOR_BTNHIGHLIGHT
<SPAN class="kw">Const</SPAN> COLOR_BTNSHADOW = 16
<SPAN class="kw">Const</SPAN> COLOR_BTNTEXT = 18
<SPAN class="kw">Const</SPAN> COLOR_CAPTIONTEXT = 9
<SPAN class="kw">Const</SPAN> COLOR_DESKTOP = COLOR_BACKGROUND
<SPAN class="kw">Const</SPAN> COLOR_GRADIENTACTIVECAPTION = 27
<SPAN class="kw">Const</SPAN> COLOR_GRADIENTINACTIVECAPTION = 28
<SPAN class="kw">Const</SPAN> COLOR_GRAYTEXT = 17
<SPAN class="kw">Const</SPAN> COLOR_HIGHLIGHT = 13
<SPAN class="kw">Const</SPAN> COLOR_HIGHLIGHTTEXT = 14
<SPAN class="kw">Const</SPAN> COLOR_HOTLIGHT = 26
<SPAN class="kw">Const</SPAN> COLOR_INACTIVEBORDER = 11
<SPAN class="kw">Const</SPAN> COLOR_INACTIVECAPTION = 3
<SPAN class="kw">Const</SPAN> COLOR_INACTIVECAPTIONTEXT = 19
<SPAN class="kw">Const</SPAN> COLOR_INFOBK = 24
<SPAN class="kw">Const</SPAN> COLOR_INFOTEXT = 23
<SPAN class="kw">Const</SPAN> COLOR_MENU = 4
<SPAN class="kw">Const</SPAN> COLOR_MENUTEXT = 7
<SPAN class="kw">Const</SPAN> COLOR_SCROLLBAR = 0
<SPAN class="kw">Const</SPAN> COLOR_WINDOW = 5
<SPAN class="kw">Const</SPAN> COLOR_WINDOWFRAME = 6
<SPAN class="kw">Const</SPAN> COLOR_WINDOWTEXT = 8</CODE></PRE></P>

<H2>Example</H2>
<P>Reverse the gradient colors in windows' title bars.  In other words, the left-side gradient color is swapped with the right-side gradient color, for both active and inactive windows.  After making the change, a notification is sent to all windows, to insure that the change takes effect immediately.  Of course, this example won't work properly on Windows 95 or Windows NT 3.1 through 4.0, but you can still see how these two functions are used by looking at the source code.</P>

<P>This example runs when the user clicks command button Command1.  So, to use this example, you must first place a command button named Command1 on a form window.</P>

<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <A href="getsyscolor.html" tppabs="http://www.vbapi.com/ref/g/getsyscolor.html">GetSysColor</A> <SPAN class="kw">Lib</SPAN> "user32.dll" (<SPAN class="kw">ByVal</SPAN> nIndex <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <B>SetSysColors</B> <SPAN class="kw">Lib</SPAN> "user32.dll" (<SPAN class="kw">ByVal</SPAN> cElements <SPAN class="kw">As Long</SPAN>, lpaElements <SPAN class="kw">As Long</SPAN>, _
	lpaRgbValues <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Const</SPAN> COLOR_ACTIVECAPTION = 2
<SPAN class="kw">Public Const</SPAN> COLOR_GRADIENTACTIVECAPTION = 27
<SPAN class="kw">Public Const</SPAN> COLOR_GRADIENTINACTIVECAPTION = 28
<SPAN class="kw">Public Const</SPAN> COLOR_INACTIVECAPTION = 3

<SPAN class="com">' *** Place the following code inside a form window. ***</SPAN>

<SPAN class="kw">Private Sub</SPAN> Command1_Click()
	<SPAN class="kw">Dim</SPAN> activeLeftColor <SPAN class="kw">As Long</SPAN>     <SPAN class="com">' color of left-side gradient of active window title bar</SPAN>
	<SPAN class="kw">Dim</SPAN> activeRightColor <SPAN class="kw">As Long</SPAN>    <SPAN class="com">' color of right-side gradient of active window title bar</SPAN>
	<SPAN class="kw">Dim</SPAN> inactiveLeftColor <SPAN class="kw">As Long</SPAN>   <SPAN class="com">' color of the left-side gradient of inactive window title bar</SPAN>
	<SPAN class="kw">Dim</SPAN> inactiveRightColor <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' color of the right-side gradient of inactive window title bar</SPAN>
	<SPAN class="kw">Dim</SPAN> colorNames(0 <SPAN class="kw">To</SPAN> 3) <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' identifiers of the system colors to change</SPAN>
	<SPAN class="kw">Dim</SPAN> colorRGBs(0 <SPAN class="kw">To</SPAN> 3) <SPAN class="kw">As Long</SPAN>   <SPAN class="com">' RGB values of the system colors to change</SPAN>
	<SPAN class="kw">Dim</SPAN> retval <SPAN class="kw">As Long</SPAN>              <SPAN class="com">' generic return value</SPAN>
	
	<SPAN class="com">' Get the RGB values of the colors used in title bars.</SPAN>
	activeLeftColor = <A href="getsyscolor.html" tppabs="http://www.vbapi.com/ref/g/getsyscolor.html">GetSysColor</A>(COLOR_ACTIVECAPTION)
	activeRightColor = <A href="getsyscolor.html" tppabs="http://www.vbapi.com/ref/g/getsyscolor.html">GetSysColor</A>(COLOR_GRADIENTACTIVECAPTION)
	
	inactiveLeftColor = <A href="getsyscolor.html" tppabs="http://www.vbapi.com/ref/g/getsyscolor.html">GetSysColor</A>(COLOR_INACTIVECAPTION)
	inactiveRightColor = <A href="getsyscolor.html" tppabs="http://www.vbapi.com/ref/g/getsyscolor.html">GetSysColor</A>(COLOR_GRADIENTINACTIVECAPTION)
	
	<SPAN class="com">' Load the arrays with the new values to assign.  Note how we're switching
	' the values used on the left and right sides of the two gradients.</SPAN>
	colorNames(0) = COLOR_ACTIVECAPTION
	colorRGBs(0) = activeRightColor
	
	colorNames(1) = COLOR_GRADIENTACTIVECAPTION
	colorRGBs(1) = activeLeftColor
	
	colorNames(2) = COLOR_INACTIVECAPTION
	colorRGBs(2) = inactiveRightColor
	
	colorNames(3) = COLOR_GRADIENTINACTIVECAPTION
	colorRGBs(3) = inactiveLeftColor
	
	<SPAN class="com">' Change the system color settings as specified above.</SPAN>
	retval = <B>SetSysColors</B>(4, colorNames(0), colorRGBs(0))
<SPAN class="kw">End Sub</SPAN></CODE></PRE></P>

<H2>See Also</H2>
<P><A href="getsyscolor.html" tppabs="http://www.vbapi.com/ref/g/getsyscolor.html">GetSysColor</A></P>

<H2>Category</H2>
<P><A href="funcc.html#systeminformation" tppabs="http://www.vbapi.com/ref/funcc.html#systeminformation">System Information</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Back to the Function list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> September 24, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="setsyscolors.html" tppabs="http://www.vbapi.com/ref/s/setsyscolors.html">http://www.vbapi.com/ref/s/setsyscolors.html</A></P>
</BODY>
</HTML>