<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: WM_RBUTTONDBLCLK Message</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the WM_RBUTTONDBLCLK message in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,WM_RBUTTONDBLCLK" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>WM_RBUTTONDBLCLK Message</H1>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P>The <B>WM_RBUTTONDBLCLK</B> message tells a window that the right mouse button has been double-clicked while the cursor is inside the window's <A class="def" href="glossary.html#clientarea" tppabs="http://www.vbapi.com/ref/glossary.html#clientarea" rel="glossary">client area</A>.  The information sent with the message identifies the cursor postion relative to the window as well as the state of various modifier keys and mouse buttons.  The target window's window procedure processes the message.  When handling the message, the <A href="get_x_lparam.html" tppabs="http://www.vbapi.com/ref/g/get_x_lparam.html">GET_X_LPARAM</A>, <A href="get_y_lparam.html" tppabs="http://www.vbapi.com/ref/g/get_y_lparam.html">GET_Y_LPARAM</A>, and <A href="makepoints.html" tppabs="http://www.vbapi.com/ref/m/makepoints.html">MAKEPOINTS</A> macros can be used to unpack the coordinate information easily.</P>

<H2>Return Value</H2>
<P><B>WM_RBUTTONDBLCLK</B> should always return 0.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>wParam</VAR><DD>A combination of the following flags specifying which modifer keys, if any, are currently depressed:
<DL>
<DT>MK_CONTROL<DD>The Ctrl key is down.
<DT>MK_LBUTTON<DD>The left mouse button is down.
<DT>MK_MBUTTON<DD>The middle mouse button is down.
<DT>MK_RBUTTON<DD>The right mouse button is down.
<DT>MK_SHIFT<DD>The Shift key is down.
<DT>MK_XBUTTON1<DD><B>Windows 2000:</B> The first X button is down.
<DT>MK_XBUTTON2<DD><B>Windows 2000:</B> The second X button is down.
</DL>
<DT><VAR>lParam</VAR><DD>The (x,y) coordinates of the mouse cursor relative to the window.  The low-order <A class="def" href="glossary.html#word" tppabs="http://www.vbapi.com/ref/glossary.html#word" rel="glossary">word</A> contains the x-coordinate, and the high-order word contains the y-coordinate.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const">Const WM_RBUTTONDBLCLK = &amp;H206
Const MK_CONTROL = &amp;H8
Const MK_LBUTTON = &amp;H1
Const MK_MBUTTON = &amp;H10
Const MK_RBUTTON = &amp;H2
Const MK_SHIFT = &amp;H4
Const MK_XBUTTON1 = &amp;H20
Const MK_XBUTTON2 = &amp;H40</CODE></PRE></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

' Make window Form1 think that the right mouse button has been
' double-clicked in its center by sending the appropriate message to it.
Dim xcoord As Long, ycoord As Long  ' x and y coordinates of the faked cursor position
Dim packed As Long  ' the coordinates "packed" into a single 32-bit integer
Dim winrect As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>  ' receives coordinates of the window
Dim retval As Long  ' return value

' First, get the coordinates of window Form1.
retval = <A href="getwindowrect.html" tppabs="http://www.vbapi.com/ref/g/getwindowrect.html">GetWindowRect</A>(Form1.hWnd, winrect)
' Use the coordinates to calculate the midpoint of Form1.
xcoord = (winrect.right - winrect.left) / 2
ycoord = (winrect.bottom - winrect.top) / 2
' Now pack the coordinates into the appropriate words of the value
packed = (ycoord * &amp;H10000) + xcoord

' Make Form1 think the right mouse button was just double-clicked in that position.
retval = <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A>(Form1.hWnd, <A href="wm_rbuttondown.html" tppabs="http://www.vbapi.com/ref/w/wm_rbuttondown.html">WM_RBUTTONDOWN</A>, ByVal CLng(MK_RBUTTON) , ByVal packed)
retval = <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A>(Form1.hWnd, <A href="wm_rbuttonup.html" tppabs="http://www.vbapi.com/ref/w/wm_rbuttonup.html">WM_RBUTTONUP</A>, ByVal CLng(0), ByVal packed)
retval = <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A>(Form1.hWnd, <B>WM_RBUTTONDBLCLK</B>, ByVal CLng(MK_RBUTTON), ByVal packed)
retval = <A href="sendmessage.html" tppabs="http://www.vbapi.com/ref/s/sendmessage.html">SendMessage</A>(Form1.hWnd, <A href="wm_rbuttonup.html" tppabs="http://www.vbapi.com/ref/w/wm_rbuttonup.html">WM_RBUTTONUP</A>, ByVal CLng(0), ByVal packed)</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="wm_lbuttondblclk.html" tppabs="http://www.vbapi.com/ref/w/wm_lbuttondblclk.html">WM_LBUTTONDBLCLK</A>, 
<A href="wm_mbuttondblclk.html" tppabs="http://www.vbapi.com/ref/w/wm_mbuttondblclk.html">WM_MBUTTONDBLCLK</A>, 
<A href="wm_rbuttondown.html" tppabs="http://www.vbapi.com/ref/w/wm_rbuttondown.html">WM_RBUTTONDOWN</A>, 
<A href="wm_rbuttonup.html" tppabs="http://www.vbapi.com/ref/w/wm_rbuttonup.html">WM_RBUTTONUP</A></P>

<H2>Category</H2>
<P><A href="msgc.html#mouse" tppabs="http://www.vbapi.com/ref/msgc.html#mouse">Mouse</A></P>

<P><A href="msga.html" tppabs="http://www.vbapi.com/ref/msga.html">Back to the Message list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> March 19, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="wm_rbuttondblclk.html" tppabs="http://www.vbapi.com/ref/w/wm_rbuttondblclk.html">http://www.vbapi.com/ref/w/wm_rbuttondblclk.html</A></P>
</BODY>
</HTML>