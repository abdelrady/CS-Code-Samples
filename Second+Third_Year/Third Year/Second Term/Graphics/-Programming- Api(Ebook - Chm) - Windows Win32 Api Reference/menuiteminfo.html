<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: MENUITEMINFO Structure</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the MENUITEMINFO structure in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,MENUITEMINFO" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>MENUITEMINFO Structure</H1>

<P><PRE><CODE class="type"><SPAN class="kw">Type</SPAN> MENUITEMINFO
	cbSize <SPAN class="kw">As Long</SPAN>
	fMask <SPAN class="kw">As Long</SPAN>
	fType <SPAN class="kw">As Long</SPAN>
	fState <SPAN class="kw">As Long</SPAN>
	wID <SPAN class="kw">As Long</SPAN>
	hSubMenu <SPAN class="kw">As Long</SPAN>
	hbmpChecked <SPAN class="kw">As Long</SPAN>
	hbmpUnchecked <SPAN class="kw">As Long</SPAN>
	dwItemData <SPAN class="kw">As Long</SPAN>
	dwTypeData <SPAN class="kw">As String</SPAN>
	cch <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">End Type</SPAN></CODE></PRE></P>

<H2>Description &amp; Usage</H2>
<P>The <B>MENUITEMINFO</B> structure holds information that describes a menu item.  This description includes the text of the item, its state (enabled, gray, etc.), and other things relating to its appearance.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>If you need to set <VAR>dwTypeData</VAR> to a <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to a bitmap, a slight modification to the above structure definition must be made.  Change the type of the <VAR>dwTypeData</VAR> data member from "As String" to "As Long".  With that change made, it can now be set to a bitmap handle.</P>

<H2>Data Members</H2>
<P><DL>
<DT><VAR>cbSize</VAR><DD>The size, in bytes, of the structure.
<DT><VAR>fMask</VAR><DD>A combination of the following flags specifying which parts of the structure to use.  Any other data members not specified by a flag will be ignored.
<DL>
<DT>MIIM_STATE<DD>Use the <VAR>fState</VAR> data member.
<DT>MIIM_ID<DD>Use the <VAR>wID</VAR> data member.
<DT>MIIM_SUBMENU<DD>Use the <VAR>hSubMenu</VAR> data member.
<DT>MIIM_CHECKMARKS<DD>Use the <VAR>hbmpChecked</VAR> and <VAR>hbmpUnchecked</VAR> data members.
<DT>MIIM_DATA<DD>Use the <VAR>dwItemData</VAR> data member.
<DT>MIIM_TYPE<DD>Use the <VAR>dwTypeData</VAR> and <VAR>cch</VAR> data members.
</DL>
<DT><VAR>fType</VAR><DD>A combination of the following flags specifying the type of menu item the structure describes:
<DL>
<DT>MFT_BITMAP<DD>The menu item is displayed using a bitmap.  <VAR>dwTypeData</VAR> is a handle to the bitmap to use, and <VAR>cch</VAR> is ignored.  This flag cannot be combined with MFT_SEPARATOR or MFT_STRING.
<DT>MFT_MENUBARBREAK<DD>Place this item on a new row (for a menu bar) or column (for a drop-down menu, submenu, or context menu).  If starting a new column, separate the two columns by a vertical line.
<DT>MFT_MENUBREAK<DD>Same as MFT_MENUBARBREAK, but do not draw a line separating the two columns.
<DT>MFT_OWNERDRAW<DD>Make the menu item owner-drawn.  This makes the owning window completely responsible for drawing the menu item whenever necessary.
<DT>MFT_RADIOCHECK<DD>When checked, place a radio-button mark instead of a check mark next to the menu item.  This signifies a radio-button-type menu item.
<DT>MFT_RIGHTJUSTIFY<DD>For menu bars only, right-justify this item and all other items after it.
<DT>MFT_RIGHTORDER<DD><B>Windows 95, 98, 2000:</B> The menus cascade from right to left, supporting languages that are read from right to left.
<DT>MFT_SEPARATOR<DD>The menu item is a separator bar.  <VAR>dwTypeData</VAR> and <VAR>cch</VAR> are ignored.  This flag cannot be combined with MFT_BITMAP or MFT_STRING.
<DT>MFT_STRING<DD>The menu item is represented by a text string (which may or may not be checked or have a submenu attached).  <VAR>dwTypeData</VAR> is the string to display for the menu item, and <VAR>cch</VAR> is the string's length.  This flag cannot be combined with MFT_BITMAP or MFT_SEPARATOR.
</DL>
<DT><VAR>fState</VAR><DD>A combination of the following flags specifying the menu item's current state:
<DL>
<DT>MFS_CHECKED<DD>A check mark (or radio-button mark) appears next to the menu item.
<DT>MFS_DEFAULT<DD>This item is the default selection for the menu.
<DT>MFS_DISABLED<DD>The menu item is disabled.  Although it is displayed normally, the user cannot select it.
<DT>MFS_ENABLED<DD>The menu item is enabled.
<DT>MFS_GRAYED<DD>The menu item is grayed out.  The user cannot select it.
<DT>MFS_HILITE<DD>The menu item currently has the selection highlight.
<DT>MFS_UNCHECKED<DD>No check mark (or radio-button mark) appears next to the menu item.
<DT>MFS_UNHILITE<DD>The menu item does not currently have the selection highlight.
</DL>
<DT><VAR>wID</VAR><DD>The unique 16-bit identifier of the menu item.
<DT><VAR>hSubMenu</VAR><DD>A handle to the submenu that opens when the menu item is selected.
<DT><VAR>hbmpChecked</VAR><DD>A handle to the bitmap to display next to the menu item when the item is checked.  The bitmap's colors will be inverted when the selection highlight moves over the item.
<DT><VAR>hbmpUnchecked</VAR><DD>A handle to the bitmap to display next to the menu item when the item is not checked.  The bitmap's colors will be inverted when the selection highlight moves over the item.
<DT><VAR>dwItemData</VAR><DD>Program-defined information to associate with the menu item.  This information is not used by Windows.
<DT><VAR>dwTypeData</VAR><DD>If <VAR>fType</VAR> contains MFT_STRING, this is the string to display for the menu item.  If <VAR>fType</VAR> contains MFT_BITMAP, this is a handle to the bitmap used to represent the menu item.
<DT><VAR>cch</VAR><DD>If <VAR>dwTypeData</VAR> is a string, this is the number of characters in that string.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const"><SPAN class="kw">Const</SPAN> MIIM_STATE = &amp;H1
<SPAN class="kw">Const</SPAN> MIIM_ID = &amp;H2
<SPAN class="kw">Const</SPAN> MIIM_SUBMENU = &amp;H4
<SPAN class="kw">Const</SPAN> MIIM_CHECKMARKS = &amp;H8
<SPAN class="kw">Const</SPAN> MIIM_DATA = &amp;H20
<SPAN class="kw">Const</SPAN> MIIM_TYPE = &amp;H10
<SPAN class="kw">Const</SPAN> MFT_BITMAP = &amp;H4
<SPAN class="kw">Const</SPAN> MFT_MENUBARBREAK = &amp;H20
<SPAN class="kw">Const</SPAN> MFT_MENUBREAK = &amp;H40
<SPAN class="kw">Const</SPAN> MFT_OWNERDRAW = &amp;H100
<SPAN class="kw">Const</SPAN> MFT_RADIOCHECK = &amp;H200
<SPAN class="kw">Const</SPAN> MFT_RIGHTJUSTIFY = &amp;H4000
<SPAN class="kw">Const</SPAN> MFT_RIGHTORDER = &amp;H2000
<SPAN class="kw">Const</SPAN> MFT_SEPARATOR = &amp;H800
<SPAN class="kw">Const</SPAN> MFT_STRING = &amp;H0
<SPAN class="kw">Const</SPAN> MFS_CHECKED = &amp;H8
<SPAN class="kw">Const</SPAN> MFS_DEFAULT = &amp;H1000
<SPAN class="kw">Const</SPAN> MFS_DISABLED = &amp;H2
<SPAN class="kw">Const</SPAN> MFS_ENABLED = &amp;H0
<SPAN class="kw">Const</SPAN> MFS_GRAYED = &amp;H1
<SPAN class="kw">Const</SPAN> MFS_HILITE = &amp;H80
<SPAN class="kw">Const</SPAN> MFS_UNCHECKED = &amp;H0
<SPAN class="kw">Const</SPAN> MFS_UNHILITE = &amp;H0</CODE></PRE></P>

<H2>Used By</H2>
<P><A href="getmenuiteminfo.html" tppabs="http://www.vbapi.com/ref/g/getmenuiteminfo.html">GetMenuItemInfo</A>, 
<A href="insertmenuitem.html" tppabs="http://www.vbapi.com/ref/i/insertmenuitem.html">InsertMenuItem</A>, 
<A href="setmenuiteminfo.html" tppabs="http://www.vbapi.com/ref/s/setmenuiteminfo.html">SetMenuItemInfo</A></P>

<P><A href="structa.html" tppabs="http://www.vbapi.com/ref/structa.html">Back to the Structure list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> June 4, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="menuiteminfo.html" tppabs="http://www.vbapi.com/ref/m/menuiteminfo.html">http://www.vbapi.com/ref/m/menuiteminfo.html</A></P>
</BODY>
</HTML>