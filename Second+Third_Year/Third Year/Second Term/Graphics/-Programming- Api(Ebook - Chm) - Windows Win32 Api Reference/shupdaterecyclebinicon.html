<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: SHUpdateRecycleBinIcon Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the SHUpdateRecycleBinIcon function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,SHUpdateRecycleBinIcon" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<META content="Thu, 02 Sep 1999 01:27:00 GMT" http-equiv="Last-Modified">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">

<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>SHUpdateRecycleBinIcon Function</H1>

<P><CODE class="declare">Declare Function SHUpdateRecycleBinIcon Lib "shell32.dll" () As Long</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Requires Internet Explorer 4.0 with integrated shell installed.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 4.0 or later and Internet Explorer 4.0 or later with integrated shell installed.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>SHUpdateRecycleBinIcon</B> updates the Recycle Bin icon on the desktop to reflect the state of the systemwide Recycle Bin.  Since the other Recycle Bin management functions will update this icon on their own, there's almost no reason why your applications would need to call this function explicitly.</P>

<H2>Return Value</H2>
<P>If an error occued, the function returns a non-zero error code.  If successful, the function returns 0.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P>None.</P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

' Delete the contents in the system's Recycle Bin, without
' showing the progress dialog.  If an error occurs, be safe and
' make sure the proper Recyle Bin icon is used.
Dim retval As Long  ' return value

' Delete the contents of the system's Recycle Bin, if the user OKs it.
retval = <A href="shemptyrecyclebin.html" tppabs="http://www.vbapi.com/ref/s/shemptyrecyclebin.html">SHEmptyRecycleBin</A>(Form1.hWnd, "", SHERB_NOPROGRESSUI)

' If an error occured, be overly save and refresh the Recycle Bin
' icon.  This probably isn't necessary, however.
If retval &lt;&gt; 0 Then  ' error
  retval = <B>SHUpdateRecycleBinIcon</B>()
End If</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="shemptyrecyclebin.html" tppabs="http://www.vbapi.com/ref/s/shemptyrecyclebin.html">SHEmptyRecycleBin</A></P>

<H2>Category</H2>
<P><A href="funcc.html#shell" tppabs="http://www.vbapi.com/ref/funcc.html#shell">Shell</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> September 1, 1999<BR>
This page is copyright &copy; 1999 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>

<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="shupdaterecyclebinicon.html" tppabs="http://www.vbapi.com/ref/s/shupdaterecyclebinicon.html">http://www.vbapi.com/ref/s/shupdaterecyclebinicon.html</A>
</P>
</BODY>
</HTML>