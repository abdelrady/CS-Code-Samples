<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: WriteProfileString Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the WriteProfileString function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,WriteProfileString" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>WriteProfileString Function</H1>

<P><CODE class="declare">Declare Function WriteProfileString Lib "kernel32.dll" Alias "WriteProfileStringA" (ByVal lpszSection As String, ByVal lpszKeyName As String, ByVal lpszString As String) As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>WriteProfileString</B> sets a value inside of the WIN.INI file.  This function can also be used to set numerical values if they are in string form, for example using "1" to represent the number 1.  If the section or value does not exist, it will be created.  Note that, since Windows normally handles the WIN.INI file by iself, extreme care should be taken when writing directly to it.  This function if basically a watered-down version of <A href="writeprivateprofilestring.html" tppabs="http://www.vbapi.com/ref/w/writeprivateprofilestring.html">WritePrivateProfileString</A> because, unlike this function, it works with any INI file.  The function returns 0 if an error occurs, or a non-zero value if successful.  Note that INI file support is only provided in Windows for backwards compatibility; using the registry to store information is preferred.

<DL>
<DT><VAR>lpszSection</VAR><DD>The section of WIN.INI to write to.
<DT><VAR>lpszKeyName</VAR><DD>The name of the value to set.
<DT><VAR>lpszString</VAR><DD>The string to set as the value.
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' Set the "Wallpaper" setting in the [Desktop] section of WIN.INI
' to C:\Windows\Clouds.bmp.
' WARNING: Use extreme caution when editing the WIN.INI file, because writing bad data to
' it could have unpredictable and disasterous results to the system!
Dim retval As Long  ' return value

' Set the value.
retval = <B>WriteProfileString</B>("Desktop", "Wallpaper", "C:\Windows\Clouds.bmp")</CODE></PRE>

<P><B>See Also:</B> <A href="getprofilestring.html" tppabs="http://www.vbapi.com/ref/g/getprofilestring.html">GetProfileString</A>, <A href="writeprivateprofilestring.html" tppabs="http://www.vbapi.com/ref/w/writeprivateprofilestring.html">WritePrivateProfileString</A><BR>
<B>Category:</B> <A href="index.html#inifiles" tppabs="http://www.vbapi.com/ref/index.html#inifiles">INI Files</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="writeprofilestring.html" tppabs="http://www.vbapi.com/ref/w/writeprofilestring.html">http://www.vbapi.com/ref/w/writeprofilestring.html</A>

</BODY>
</HTML>