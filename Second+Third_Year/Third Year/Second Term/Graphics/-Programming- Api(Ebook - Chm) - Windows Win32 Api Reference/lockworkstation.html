<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: LockWorkStation Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the LockWorkStation function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,LockWorkStation" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>LockWorkStation Function</H1>

<P><CODE class="declare"><SPAN class="kw">Declare Function</SPAN> LockWorkStation <SPAN class="kw">Lib</SPAN> "user32.dll" () <SPAN class="kw">As Long</SPAN></CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Not Supported.
<LI><B>Windows 98:</B> Not Supported.
<LI><B>Windows NT:</B> Not Supported.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>LockWorkStation</B> locks the computer, preventing anybody from entering input until either the user who locked it or an administrator enters his or her password.  This function does the same thing as though the user had pressed Ctrl+Alt+Del and selected "Lock Workstation."</P>

<H2>Return Value</H2>
<P>If successful, the function returns a non-zero value.  If an error occured, the function returns zero (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P>None.</P>

<H2>Example</H2>
<P>Lock the workstation when the user clicks the command button named cmdLock.  Obviously, to use this example, you must place a command button named cmdLock on a form window.</P>

<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <B>LockWorkStation</B> <SPAN class="kw">Lib</SPAN> "user32.dll" () <SPAN class="kw">As Long</SPAN>

<SPAN class="com">' *** Place the following code inside the form window. ***</SPAN>

<SPAN class="kw">Private Sub</SPAN> cmdLock_Click ()
	<SPAN class="com">' Lock the workstation when this button is clicked.</SPAN>
	
	<SPAN class="kw">Dim</SPAN> retval <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' return value</SPAN>
	
	retval = <B>LockWorkStation</B>()
	<SPAN class="com">' That's all there is to it!</SPAN>
<SPAN class="kw">End Sub</SPAN>

</CODE></PRE></P>

<H2>Category</H2>
<P><A href="funcc.html#shutdown" tppabs="http://www.vbapi.com/ref/funcc.html#shutdown">Shutdown</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Back to the Function list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> December 17, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="lockworkstation.html" tppabs="http://www.vbapi.com/ref/l/lockworkstation.html">http://www.vbapi.com/ref/l/lockworkstation.html</A></P>
</BODY>
</HTML>