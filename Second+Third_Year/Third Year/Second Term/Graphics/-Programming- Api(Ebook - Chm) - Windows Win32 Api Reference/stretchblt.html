<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: StretchBlt Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the StretchBlt function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,StretchBlt" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>StretchBlt Function</H1>

<P><CODE class="declare">Declare Function StretchBlt Lib "gdi32.dll" (ByVal hdc As Long, ByVal x As Long, ByVal y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As Long, ByVal xSrc As Long, ByVal ySrc As Long, ByVal hSrcWidth As Long, ByVal nSrcHeight As Long, ByVal dwRop As Long) As Long</CODE>

<P><B>StretchBlt</B> copies a section of an image from one device to another.  This function also allows you to change the original size and dimensions of the image section, unlike the related function <A href="bitblt.html" tppabs="http://www.vbapi.com/ref/b/bitblt.html">BitBlt</A>.  In addition to using the straight "copy" method, you can specify other ways of copying the image with the <VAR>dwRop</VAR> parameter.  What the function actually does is perform a binary operation on the color of the source and destination pixel to calculate the color of the pixel in the transfered image.  The point you specify as the location of the copied image in the target object will be the upper-left corner of the image portion.  The function returns 0 if the function failed and 1 if it succeeded.

<DL>
<DT><VAR>hDestDC</VAR><DD>The device context of the target object (the one that receives the image piece).
<DT><VAR>x</VAR><DD>The x coordinate of the point to put the image inside the target.
<DT><VAR>y</VAR><DD>The y coordinate of the point to put the image inside the target.
<DT><VAR>nWidth</VAR><DD>The width of the image piece in the target.
<DT><VAR>nHeight</VAR><DD>The height of the image piece in the target.
<DT><VAR>xSrc</VAR><DD>The x coordinate of the upper-left corner of the image piece in the source.
<DT><VAR>ySrc</VAR><DD>The y coordinate of the upper-left corner of the image piece in the source.
<DT><VAR>nSrcWidth</VAR><DD>The width of the image piece in the source.
<DT><VAR>nSrcHeight</VAR><DD>The height of the image piece in the source.
<DT><VAR>dwRop</VAR><DD>Exactly one of the following flags specifying what method to use to copy the source image:
<DL>
<DT>SRCAND = &amp;H8800C6<DD>Logically And the two color values (destination = source And destination).
<DT>SRCCOPY = &amp;HCC0020<DD>Copy the source image exactly (destination = source).
<DT>SRCERASE = &amp;H440328<DD>Logically And the source image and the destination's binary inverse (destination = source And (Not destination).
<DT>SRCINVERT = &amp;H660046<DD>Logically Xor the two color values (destination = source Xor destination).
<DT>SRCPAINT = &amp;HEE0086<DD>Logically Or the two color values (destination = source Or destination).
</DL>
</DL>

<P>
<B>Example:</B>
<PRE><CODE class="example">' Copy a portion of the image in PictureBox1 to PictureBox2 and
' stretch it to triple its original width.  The image's original dimensions are
' 16x32; its new ones are 48x32.
' Source image coordinates: (45,50)-(60,81)
' Target image coordinates: (0,0)-(47,31)

Dim retval As Long  ' function return value

retval = <B>BitBlt</B>(PictureBox2.hdc, 0, 0, 48, 32, PictureBox1.hdc, 45, 50, 16, 32, SRCCOPY)</CODE></PRE>

<P><B>See Also:</B> <A href="bitblt.html" tppabs="http://www.vbapi.com/ref/b/bitblt.html">BitBlt</A><BR>
<B>Category:</B> <A href="index.html#bitmaps" tppabs="http://www.vbapi.com/ref/index.html#bitmaps">Bitmaps</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="stretchblt.html" tppabs="http://www.vbapi.com/ref/s/stretchblt.html">http://www.vbapi.com/ref/s/stretchblt.html</A>

</BODY>
</HTML>