<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetTopWindow Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetTopWindow function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetTopWindow" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetTopWindow Function</H1>

<P><CODE class="declare">Declare Function GetTopWindow Lib "user32.dll" (ByVal hwnd As Long) As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>GetTopWindow</B> returns a handle to the currently active child window of a window.  The active child window is the one that has the focus, and it is usually at the top of all the other children in the Z-order.  This function works even if the parent window is not active.  If an error occurs or the window has no children, the function instead returns 0.  This function is identical to calling <A href="getwindow.html" tppabs="http://www.vbapi.com/ref/g/getwindow.html">GetWindow</A> using the <VAR>GW_CHILD</VAR> relationship.

<DL>
<DT><VAR>hwnd</VAR><DD>The handle of the parent window.  The function will return its active child window.
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' Flash the MDI form window MDIForm1's active child once.
' (In VB, a MDI form has child windows).
Dim active As Long  ' receives handle to the MDI form's active window
Dim retval As Long  ' return value used for flashing the child window

active = <B>GetTopWindow</B>(MDIForm1.hWnd)  ' get the handle of MDIForm1's active child window
If active &lt;&gt; 0 Then  ' don't try to flash if there is no child window
  ' The next three lines flags the window once.
  retval = <A href="flashwindow.html" tppabs="http://www.vbapi.com/ref/f/flashwindow.html">FlashWindow</A>(active, 1): <A href="sleep.html" tppabs="http://www.vbapi.com/ref/s/sleep.html">Sleep</A> 250
  retval = <A href="flashwindow.html" tppabs="http://www.vbapi.com/ref/f/flashwindow.html">FlashWindow</A>(active, 1): <A href="sleep.html" tppabs="http://www.vbapi.com/ref/s/sleep.html">Sleep</A> 250
  retval = <A href="flashwindow.html" tppabs="http://www.vbapi.com/ref/f/flashwindow.html">FlashWindow</A>(active, 0)
End If</CODE></PRE>

<P><B>See Also:</B> <A href="getwindow.html" tppabs="http://www.vbapi.com/ref/g/getwindow.html">GetWindow</A><BR>
<B>Category:</B> <A href="index.html#windows" tppabs="http://www.vbapi.com/ref/index.html#windows">Windows</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="gettopwindow.html" tppabs="http://www.vbapi.com/ref/g/gettopwindow.html">http://www.vbapi.com/ref/g/gettopwindow.html</A>

</BODY>
</HTML>