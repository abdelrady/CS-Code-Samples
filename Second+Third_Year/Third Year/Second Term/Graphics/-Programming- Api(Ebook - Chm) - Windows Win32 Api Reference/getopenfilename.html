<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetOpenFileName Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetOpenFileName function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetOpenFileName" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetOpenFileName Function</H1>

<P><CODE class="declare"><SPAN class="kw">Declare Function</SPAN> GetOpenFileName <SPAN class="kw">Lib</SPAN> "comdlg32.dll" <SPAN class="kw">Alias</SPAN> "GetOpenFileNameA" (lpofn <SPAN class="kw">As</SPAN> <A href="openfilename.html" tppabs="http://www.vbapi.com/ref/o/openfilename.html">OPENFILENAME</A>) <SPAN class="kw">As Long</SPAN></CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 1.0 or later. 
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>GetOpenFileName</B> opens the Open File common dialog dialog box.  All of the settings for creating the dialog, as well as the data returned from it, are placed into the structure passed as <VAR>lpofn</VAR>.  Note that this function does not actually open any file; it merely prompts the user for a file or files to open, and those filenames are given to your program.</P>

<H2>Return Value</H2>
<P>If the user selects one or more files in the dialog box, the function returns a nonzero value.  If an error occured, or if the user merely clicked Cancel, the function returns zero.  Use <A href="commdlgextendederror.html" tppabs="http://www.vbapi.com/ref/c/commdlgextendederror.html">CommDlgExtendedError</A> to get the error code.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>lpofn</VAR><DD>The parameters used to open the dialog box.  Also receives the returned filename(s) and other information about what the user selected.
</DL></P>

<H2>Example</H2>
<P>Use the Open File common dialog box to prompt the user for a *.txt file.  The user's selection is then displayed (the filename, not the file itself).  The dialog box opens when the user clicks button Command1.  So, to use this example, place a command button named Command1 on a form window.</P>

<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Type</SPAN> OPENFILENAME
	lStructSize <SPAN class="kw">As Long</SPAN>
	hwndOwner <SPAN class="kw">As Long</SPAN>
	hInstance <SPAN class="kw">As Long</SPAN>
	lpstrFilter <SPAN class="kw">As String</SPAN>
	lpstrCustomFilter <SPAN class="kw">As String</SPAN>
	nMaxCustomFilter <SPAN class="kw">As Long</SPAN>
	nFilterIndex <SPAN class="kw">As Long</SPAN>
	lpstrFile <SPAN class="kw">As String</SPAN>
	nMaxFile <SPAN class="kw">As Long</SPAN>
	lpstrFileTitle <SPAN class="kw">As String</SPAN>
	nMaxFileTitle <SPAN class="kw">As Long</SPAN>
	lpstrInitialDir <SPAN class="kw">As String</SPAN>
	lpstrTitle <SPAN class="kw">As String</SPAN>
	flags <SPAN class="kw">As Long</SPAN>
	nFileOffset <SPAN class="kw">As Integer</SPAN>
	nFileExtension <SPAN class="kw">As Integer</SPAN>
	lpstrDefExt <SPAN class="kw">As String</SPAN>
	lCustData <SPAN class="kw">As Long</SPAN>
	lpfnHook <SPAN class="kw">As Long</SPAN>
	lpTemplateName <SPAN class="kw">As String</SPAN>
<SPAN class="kw">End Type</SPAN>
<SPAN class="kw">Public Const</SPAN> OFN_FILEMUSTEXIST = &amp;H1000
<SPAN class="kw">Public Const</SPAN> OFN_HIDEREADONLY = &amp;H4
<SPAN class="kw">Public Const</SPAN> OFN_PATHMUSTEXIST = &amp;H800
<SPAN class="kw">Public Declare Function</SPAN> GetOpenFileName <SPAN class="kw">Lib</SPAN> "comdlg32.dll" <SPAN class="kw">Alias</SPAN> "GetOpenFileNameA" (lpofn _
	<SPAN class="kw">As</SPAN> <A href="openfilename.html" tppabs="http://www.vbapi.com/ref/o/openfilename.html">OPENFILENAME</A>) <SPAN class="kw">As Long</SPAN>

<SPAN class="com">' *** Place the following code inside a form window.</SPAN>

<SPAN class="kw">Private Sub</SPAN> Command1_Click()
	<SPAN class="kw">Dim</SPAN> filebox <SPAN class="kw">As</SPAN> <A href="openfilename.html" tppabs="http://www.vbapi.com/ref/o/openfilename.html">OPENFILENAME</A>  <SPAN class="com">' open file dialog structure</SPAN>
	<SPAN class="kw">Dim</SPAN> fname <SPAN class="kw">As String</SPAN>          <SPAN class="com">' filename the user selected</SPAN>
	<SPAN class="kw">Dim</SPAN> result <SPAN class="kw">As</SPAN> <SPAN class="kw">Long</SPAN>           <SPAN class="com">' result of opening the dialog</SPAN>
	
	<SPAN class="com">' Configure how the dialog box will look</SPAN>
	<SPAN class="kw">With</SPAN> filebox
		<SPAN class="com">' Size of the structure.</SPAN>
		.lStructSize = Len(filebox)
		<SPAN class="com">' Handle to window opening the dialog.</SPAN>
       		.hwndOwner = Me.hWnd
		<SPAN class="com">' Handle to calling instance (not needed).</SPAN>
		.hInstance = 0
		<SPAN class="com">' File filters to make available: Text Files and All Files</SPAN>
		.lpstrFilter = "Text Files (*.txt)" &amp; vbNullChar &amp; "*.txt" &amp; vbNullChar &amp; _
			"All Files (*.*)" &amp; vbNullChar &amp; "*.*" &amp; vbNullChar &amp; vbNullChar
		<SPAN class="com">'.lpstrCustomFilter is ignored -- unused string</SPAN>
		.nMaxCustomFilter = 0
		<SPAN class="com">' Default filter is the first one (Text Files, in this case).</SPAN>
		.nFilterIndex = 1
		<SPAN class="com">' No default filename.  Also make room for received
		' path and filename of the user's selection.</SPAN>
		.lpstrFile = Space(256) &amp; vbNullChar
		.nMaxFile = Len(.lpstrFile)
		<SPAN class="com">' Make room for filename of the user's selection.</SPAN>
		.lpstrFileTitle = Space(256) &amp; vbNullChar
		.nMaxFileTitle = Len(.lpstrFileTitle)
		<SPAN class="com">' Initial directory is C:\.</SPAN>
		.lpstrInitialDir = "C:\" & vbNullChar
		<SPAN class="com">' Title of file dialog.</SPAN>
		.lpstrTitle = "Select a File" & vbNullChar
		<SPAN class="com">' The path and file must exist; hide the read-only box.</SPAN>
		.flags = OFN_PATHMUSTEXIST <SPAN class="kw">Or</SPAN> OFN_FILEMUSTEXIST <SPAN class="kw">Or</SPAN> OFN_HIDEREADONLY
		<SPAN class="com">' The rest of the options aren't needed.</SPAN>
		.nFileOffset = 0
		.nFileExtension = 0
		<SPAN class="com">'.lpstrDefExt is ignored -- unused string</SPAN>
		.lCustData = 0
		.lpfnHook = 0
		<SPAN class="com">'.lpTemplateName is ignored -- unused string</SPAN>
	<SPAN class="kw">End With</SPAN>
	
	<SPAN class="com">' Display the dialog box.</SPAN>
	result = <B>GetOpenFileName</B>(filebox)
	<SPAN class="kw">If</SPAN> result &lt;&gt; 0 <SPAN class="kw">Then</SPAN> 
		<SPAN class="com">' Remove null space from the file name.</SPAN>
		fname = Left(filebox.lpstrFile, InStr(filebox.lpstrFile, vbNullChar) - 1)
		<SPAN class="kw">Debug</SPAN>.<SPAN class="kw">Print</SPAN> "The selected file: "; fname
	<SPAN class="kw">End If</SPAN>
<SPAN class="kw">End Sub</SPAN></CODE></PRE></P>

<H2>See Also</H2>
<P><A href="getsavefilename.html" tppabs="http://www.vbapi.com/ref/g/getsavefilename.html">GetSaveFileName</A></P>

<H2>Category</H2>
<P><A href="funcc.html#commondialog" tppabs="http://www.vbapi.com/ref/funcc.html#commondialog">Common Dialog</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> September 24, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="getopenfilename.html" tppabs="http://www.vbapi.com/ref/g/getopenfilename.html">http://www.vbapi.com/ref/g/getopenfilename.html</A></P>
</BODY>
</HTML>