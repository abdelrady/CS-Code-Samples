<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: open MCI Command String</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the 'open' MCI Command String in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,open,MCI" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>open MCI Command String</H1>

<P>"open <VAR>lpszDevice</VAR>, <VAR>lpszOpenFlags</VAR>, <VAR>lpszFlags</VAR>"</P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P>The <B>open</B> MCI command string opens a MCI device, initializing it for further use.  One of the most useful features of <B>open</B> is the ability to assign an alias to a device, which makes referring to a file opened implicitly through a device simpler.  Although in some cases it is not necessary to open a device before using it, it should be done nonetheless.  Once your program is finished using the device, it should close it using the <A href="close.html" tppabs="http://www.vbapi.com/ref/other/mci/close.html">close</A> command string.</P>

<P>All MCI device types recognize the <B>open</B> command string.</P>

<H2>Return Value</H2>
<P>The <B>open</B> command string does not return a value.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>lpszDevice</VAR><DD>The device identifier string of the MCI device or file to open.  When opening a file, it will be manipulated through its typically associated device unless you use the "type" option in <VAR>lpszOpenFlags</VAR> to use a different device.  For example, opening a MIDI file opens it through the sequencer.  If this is "new", then a new resource is created; use the "type" option in <VAR>lpszOpenFlags</VAR> to specify the device type.
<DT><VAR>lpszOpenFlags</VAR><DD>Zero or more of the following options for opening the device:
<DL>
<DT>"<VAR>elementname</VAR>" (digitalvideo)<DD>Specifies the file to load when the device opens.
<DT>"alias <VAR>device_alias</VAR>" (all)<DD>Assigns an alternate name that can be used in subsequent command strings.  This is particularly useful to avoid referring to a lengthy filename multiple times.  The <VAR>device_alias</VAR> can then be used in place of the device ID string.
<DT>"buffer <VAR>buffer_size</VAR>" (waveaudio)<DD>Sets the size of the waveform audio device buffer, in seconds.  Valid values range from 2 to 9 inclusive.
<DT>"parent <VAR>hwnd</VAR>" (digitalvideo, overlay)<DD>Specifies a <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to the parent window for any windows the device may open.  Windows opened by the device will become that window's children.
<DT>"shareable" (all)<DD>Allow this particular instance of the device to be opened multiple times simultaneously, shared among any programs that wish to use it.  However, the MCISEQ and MCIWAVE drivers do not support sharing.
<DT>"style child" (digitalvideo, overlay)<DD>Open a window with the style of a child window.
<DT>"style overlapped" (digitalvideo, overlay)<DD>Open a window with the style of an overlapped (regular) window.
<DT>"style popup" (digitalvideo, overlay)<DD>Open a window with the style of a pop-up window.
<DT>"style <VAR>style_type</VAR>" (digitalvideo, overlay)<DD>Open a window with the specified style.  <VAR>style_type</VAR> is the numerical value of one of the following flags:
<DL>
<DT>SW_HIDE<DD>Hide the window.
<DT>SW_MAXIMIZE<DD>Maximize the window.
<DT>SW_MINIMIZE<DD>Minimize the window.
<DT>SW_RESTORE<DD>Restore the window (not maximized nor minimized).
<DT>SW_SHOW<DD>Show the window.
<DT>SW_SHOWMAXIMIZED<DD>Show the window maximized.
<DT>SW_SHOWMINIMIZED<DD>Show the window minimized.
<DT>SW_SHOWMINNOACTIVE<DD>Show the window minimized but do not activate it.
<DT>SW_SHOWNA<DD>Show the window in its current state but do not activate it.
<DT>SW_SHOWNOACTIVATE<DD>Show the window in its most recent size and position but do not activate it.
<DT>SW_SHOWNORMAL<DD>Show the window and activate it (as usual).
</DL>
<DT>"type <VAR>device_type</VAR>" (all)<DD>When opening a new instance of a device, this specifies the type of device being opened.  Remember that "new" was specified as <VAR>lpszDevice</VAR>.
</DL>
<DT><VAR>lpszFlags</VAR><DD>Zero or more of the following options:
<DL>
<DT>"notify"<DD>When the command finishes, post the <A href="mm_mcinotify.html" tppabs="http://www.vbapi.com/ref/m/mm_mcinotify.html">MM_MCINOTIFY</A> message to the window specified in the call to <A href="mcisendstring.html" tppabs="http://www.vbapi.com/ref/m/mcisendstring.html">mciSendString</A>.
<DT>"wait"<DD>Do not have <A href="mcisendstring.html" tppabs="http://www.vbapi.com/ref/m/mcisendstring.html">mciSendString</A> return until the command finishes.
</DL>
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const"><SPAN class="kw">Const</SPAN> SW_HIDE = 0
<SPAN class="kw">Const</SPAN> SW_MAXIMIZE = 3
<SPAN class="kw">Const</SPAN> SW_MINIMIZE = 6
<SPAN class="kw">Const</SPAN> SW_RESTORE = 9
<SPAN class="kw">Const</SPAN> SW_SHOW = 5
<SPAN class="kw">Const</SPAN> SW_SHOWMAXIMIZED = 3
<SPAN class="kw">Const</SPAN> SW_SHOWMINIMIZED = 2
<SPAN class="kw">Const</SPAN> SW_SHOWMINNOACTIVE = 7
<SPAN class="kw">Const</SPAN> SW_SHOWNA = 8
<SPAN class="kw">Const</SPAN> SW_SHOWNOACTIVATE = 4
<SPAN class="kw">Const</SPAN> SW_SHOWNORMAL = 1</CODE></PRE></P>

<H2>Example</H2>
<P>To run this code, place two command buttons on a form window.  Name one "cmdPlay" and set its Caption to "&amp;Play MIDI File".  Likewise, name the other one "cmdStop" and set its Caption to "&amp;Stop MIDI File".</P>

<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <A href="mcisendstring.html" tppabs="http://www.vbapi.com/ref/m/mcisendstring.html">mciSendString</A> <SPAN class="kw">Lib</SPAN> "winmm.dll" <SPAN class="kw">Alias</SPAN> "mciSendStringA" (<SPAN class="kw">ByVal</SPAN> _
	lpszCommand <SPAN class="kw">As String</SPAN>, <SPAN class="kw">ByVal</SPAN> lpszReturnString <SPAN class="kw">As String</SPAN>, <SPAN class="kw">ByVal</SPAN> cchReturnLength _
	<SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> hwndCallback <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <A href="mcigeterrorstring.html" tppabs="http://www.vbapi.com/ref/m/mcigeterrorstring.html">mciGetErrorString</A> <SPAN class="kw">Lib</SPAN> "winmm.dll" <SPAN class="kw">Alias</SPAN> "mciGetErrorStringA" (<SPAN class="kw">ByVal</SPAN> _
	fdwError <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> lpszErrorText <SPAN class="kw">As String</SPAN>, <SPAN class="kw">ByVal</SPAN> cchErrorText <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>

<SPAN class="com">' Use the MCI to play or stop playback of a MIDI file.  The file C:\Music\canyon.mid
' is opened when the form opens.  The Play and Stop buttons behave as you'd expect.  The
' only potential surprise is that the current position is not reset when playback stops; it
' behaves just as pausing playback would.  The file closes when the form unloads.</SPAN>

<SPAN class="com">' If anything goes wrong in the example, display a message box with
' the MCI error message text.</SPAN>

<SPAN class="kw">Private Sub</SPAN> Form_Load()
	<SPAN class="com">' Open the file "C:\Music\canyon.mid" for later use in the example.
	' Give it an alias of "canyon" so we don't need to refer to the filename again.</SPAN>
	<SPAN class="kw">Dim</SPAN> errcode <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' MCI error code</SPAN>
	
	errcode = <A href="mcisendstring.html" tppabs="http://www.vbapi.com/ref/m/mcisendstring.html">mciSendString</A>("<B>open</B> C:\Music\canyon.mid alias canyon", "", 0, 0)
	<SPAN class="kw">If</SPAN> errcode &lt;&gt; 0 <SPAN class="kw">Then</SPAN> DisplayError errcode
<SPAN class="kw">End Sub</SPAN>

<SPAN class="kw">Private Sub</SPAN> cmdPlay_Click()
	<SPAN class="com">' Begin playback of the MIDI file when this button is pressed.</SPAN>
	<SPAN class="kw">Dim</SPAN> errcode <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' MCI error code</SPAN>
	
	errcode = <A href="mcisendstring.html" tppabs="http://www.vbapi.com/ref/m/mcisendstring.html">mciSendString</A>("<A href="play.html" tppabs="http://www.vbapi.com/ref/other/mci/play.html">play</A> canyon", "", 0, 0)
	<SPAN class="kw">If</SPAN> errcode &lt;&gt; 0 <SPAN class="kw">Then</SPAN> DisplayError errcode
<SPAN class="kw">End Sub</SPAN>

<SPAN class="kw">Private Sub</SPAN> cmdStop_Click()
	<SPAN class="com">' Stop playback of the MIDI file when this button is pressed.
	' The position within the file does not move back to the beginning.</SPAN>
	<SPAN class="kw">Dim</SPAN> errcode <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' MCI error code</SPAN>
	
	errcode = <A href="mcisendstring.html" tppabs="http://www.vbapi.com/ref/m/mcisendstring.html">mciSendString</A>("<A href="stop.html" tppabs="http://www.vbapi.com/ref/other/mci/stop.html">stop</A> canyon", "", 0, 0)
	<SPAN class="kw">If</SPAN> errcode &lt;&gt; 0 <SPAN class="kw">Then</SPAN> DisplayError errcode
<SPAN class="kw">End Sub</SPAN>

<SPAN class="kw">Private Sub</SPAN> Form_Unload(Cancel <SPAN class="kw">As Integer</SPAN>)
	<SPAN class="com">' Close the MIDI file when the form unloads.  This is important, because the
	' MIDI driver can only work with one file at a time.  There's no need to check
	' for an error here, since we're just closing the file.</SPAN>
	<SPAN class="kw">Dim</SPAN> errcode <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' MCI error code</SPAN>
	
	errcode = <A href="mcisendstring.html" tppabs="http://www.vbapi.com/ref/m/mcisendstring.html">mciSendString</A>("<A href="close.html" tppabs="http://www.vbapi.com/ref/other/mci/close.html">close</A> canyon", "", 0, 0)
<SPAN class="kw">End Sub</SPAN>

<SPAN class="kw">Private Sub</SPAN> DisplayError(<SPAN class="kw">ByVal</SPAN> errcode <SPAN class="kw">As Long</SPAN>)
	<SPAN class="com">' This subroutine displays a dialog box with the text of the MCI error.  There's
	' no reason to use the <A href="messagebox.html" tppabs="http://www.vbapi.com/ref/m/messagebox.html">MessageBox</A> API function; VB's MsgBox function will suffice.</SPAN>
	<SPAN class="kw">Dim</SPAN> errstr <SPAN class="kw">As String</SPAN>  <SPAN class="com">' MCI error message text</SPAN>
	<SPAN class="kw">Dim</SPAN> retval <SPAN class="kw">As Long</SPAN>    <SPAN class="com">' return value</SPAN>
	
	<SPAN class="com">' Get a string explaining the MCI error.</SPAN>
	errstr = Space(128)
	retval = <A href="mcigeterrorstring.html" tppabs="http://www.vbapi.com/ref/m/mcigeterrorstring.html">mciGetErrorString</A>(errcode, errstr, Len(errstr))
	<SPAN class="com">' Remove the terminating null and empty space at the end.</SPAN>
	errstr = Left(errstr, InStr(errstr, vbNullChar) - 1)
	
	<SPAN class="com">' Display a simple error message box.</SPAN>
	retval = MsgBox(errstr, vbOKOnly <SPAN class="kw">Or</SPAN> vbCritical)
<SPAN class="kw">End Sub</SPAN></CODE></PRE></P>

<H2>See Also</H2>
<P><A href="close.html" tppabs="http://www.vbapi.com/ref/other/mci/close.html">close</A></P>

<P><A href="index-2.html" tppabs="http://www.vbapi.com/ref/other/mci/index.html">Back to the MCI Command list.</A><BR>
<A href="othera.html" tppabs="http://www.vbapi.com/ref/othera.html">Back to Other API Information.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> August 26, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="open.html" tppabs="http://www.vbapi.com/ref/other/mci/open.html">http://www.vbapi.com/ref/other/mci/open.html</A></P>
</BODY>
</HTML>