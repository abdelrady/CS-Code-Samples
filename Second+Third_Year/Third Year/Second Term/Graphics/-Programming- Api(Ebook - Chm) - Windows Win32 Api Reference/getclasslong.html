<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetClassLong Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetClassLong function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetClassLong" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetClassLong Function</H1>

<P><CODE class="declare"><SPAN class="kw">Declare Function</SPAN> GetClassLong <SPAN class="kw">Lib</SPAN> "user32.dll" <SPAN class="kw">Alias</SPAN> "GetClassLongA" (<SPAN class="kw">ByVal</SPAN> hWnd <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> nIndex <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN></CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 1.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>GetClassLong</B> retrieves a single 32-bit value from the information about the <A class="def" href="glossary.html#windowclass" tppabs="http://www.vbapi.com/ref/glossary.html#windowclass" rel="glossary">window class</A> to which the specified window belongs.  The class's properties may not necessarily match perfectly with the actual properties of the window.  This function can also retrieve a 32-bit value from the extra memory area associated with the window class.</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns 0 (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).  If successful, the function returns the desired 32-bit value.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>hWnd</VAR><DD>A <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to a window which belongs to the class to read a property of.
<DT><VAR>nIndex</VAR><DD>To retrieve a 32-bit value from the class's extra memory, set this to the zero-based offset of the byte to begin reading at.  Valid values are 0 to the number of bytes of extra memory minus 4, inclusive.  To retrieve a 32-bit property of the class, set this to one of the following flags specifying which 32-bit value to retrieve from the window class:
<DL>
<DT>GCW_ATOM<DD>Retrieve the <A class="def" href="glossary.html#atom" tppabs="http://www.vbapi.com/ref/glossary.html#atom" rel="glossary">atom</A> which identifies the window class.
<DT>GCL_CBCLSEXTRA<DD>Retrieve the size in bytes of the extra memory associated with the window class.
<DT>GCL_CBWNDEXTRA<DD>Retrieve the size in bytes of the extra memory associated with each window belonging to the window class.
<DT>GCL_HBRBACKGROUND<DD>Retrieve a handle to the <A class="def" href="glossary.html#brush" tppabs="http://www.vbapi.com/ref/glossary.html#brush" rel="glossary">brush</A> used to paint the backgrounds of windows belonging to the class.
<DT>GCL_HCURSOR<DD>Retrieve a handle to the cursor associated with the class.
<DT>GCL_HICON<DD>Retrieve a handle to the icon associated with the class.
<DT>GCL_HICONSM<DD>Retrieve a handle to the small icon associated with the class.
<DT>GCL_HMODULE<DD>Retrieve a handle to the module which registered the class.
<DT>GCL_MENUNAME<DD>Retrieve a <A class="def" href="glossary.html#pointer" tppabs="http://www.vbapi.com/ref/glossary.html#pointer" rel="glossary">pointer</A> to the string identifying the name of the menu resource associated with the class.
<DT>GCL_STYLE<DD>Retrieve the <A href="index-3.html" tppabs="http://www.vbapi.com/ref/other/classes/index.html">window styles</A> associated with the class.
<DT>GCL_WNDPROC<DD>Retrieve a pointer to the <A href="windowproc.html" tppabs="http://www.vbapi.com/ref/w/windowproc.html">WindowProc</A> <A class="def" href="glossary.html#hookfunction" tppabs="http://www.vbapi.com/ref/glossary.html#hookfunction" rel="glossary">hook function</A> which acts as the window procedure for windows belonging to the window class.
</DL>
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const"><SPAN class="kw">Const</SPAN> GCW_ATOM = -32
<SPAN class="kw">Const</SPAN> GCL_CBCLSEXTRA = -20
<SPAN class="kw">Const</SPAN> GCL_CBWNDEXTRA = -18
<SPAN class="kw">Const</SPAN> GCL_HBRBACKGROUND = -10
<SPAN class="kw">Const</SPAN> GCL_HCURSOR = -12
<SPAN class="kw">Const</SPAN> GCL_HICON = -14
<SPAN class="kw">Const</SPAN> GCL_HMODULE = -16
<SPAN class="kw">Const</SPAN> GCL_MENUNAME = -8
<SPAN class="kw">Const</SPAN> GCL_STYLE = -26
<SPAN class="kw">Const</SPAN> GCL_WNDPROC = -24</CODE></PRE></P>

<H2>Example</H2>
<P>When the user clicks button Command1, draw the icon associated with the parent form window's class in the corner of the client area.  This might not be the icon actually displayed by the window.  Naturally, to use this exampe, you must first place a command button named Command1 on a form window.</P>

<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

<SPAN class="com">' Declarations and such needed for the example:
' (Copy them to the (declarations) section of a module.)</SPAN>
<SPAN class="kw">Public Declare Function</SPAN> <B>GetClassLong</B> <SPAN class="kw">Lib</SPAN> "user32.dll" <SPAN class="kw">Alias</SPAN> "GetClassLongA" (<SPAN class="kw">ByVal</SPAN> hWnd <SPAN class="kw">As Long</SPAN>, _
	<SPAN class="kw">ByVal</SPAN> nIndex <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>
<SPAN class="kw">Public Const</SPAN> GCL_HICON = -14
<SPAN class="kw">Public Declare Function</SPAN> <A href="drawicon.html" tppabs="http://www.vbapi.com/ref/d/drawicon.html">DrawIcon</A> <SPAN class="kw">Lib</SPAN> "user32.dll" (<SPAN class="kw">ByVal</SPAN> hDC <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> x <SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> y _
	<SPAN class="kw">As Long</SPAN>, <SPAN class="kw">ByVal</SPAN> hIcon <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>

<SPAN class="com">' Place the following code inside a form window. ***</SPAN>

<SPAN class="kw">Private Sub</SPAN> Command1_Click ()
	<SPAN class="kw">Dim</SPAN> hIcon <SPAN class="kw">As Long</SPAN>   <SPAN class="com">' handle to the class's icon</SPAN>
	<SPAN class="kw">Dim</SPAN> retval <SPAN class="kw">As Long</SPAN>  <SPAN class="com">' return value</SPAN>
	
	<SPAN class="com">' Retrieve a handle to the class's icon.</SPAN>
	hIcon = <B>GetClassLong</B>(Me.hWnd, GCL_HICON)
	<SPAN class="com">' Draw that icon at coordinate (0,0) on Form1.</SPAN>
	retval = <A href="drawicon.html" tppabs="http://www.vbapi.com/ref/d/drawicon.html">DrawIcon</A>(Me.hDC, 0, 0, hIcon)
<SPAN class="kw">End Sub</SPAN></CODE></PRE></P>

<H2>See Also</H2>
<P><A href="getwindowlong.html" tppabs="http://www.vbapi.com/ref/g/getwindowlong.html">GetWindowLong</A>, 
<A href="setclasslong.html" tppabs="http://www.vbapi.com/ref/s/setclasslong.html">SetClassLong</A></P>

<H2>Category</H2>
<P><A href="funcc.html#windowclasses" tppabs="http://www.vbapi.com/ref/funcc.html#windowclasses">Window Classes</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> October 29, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="getclasslong.html" tppabs="http://www.vbapi.com/ref/g/getclasslong.html">http://www.vbapi.com/ref/g/getclasslong.html</A>
</P>
</BODY>
</HTML>