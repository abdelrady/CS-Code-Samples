<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetSystemMetrics Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetSystemMetrics function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetSystemMetrics" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetSystemMetrics Function</H1>

<P><CODE class="declare">Declare Function GetSystemMetrics Lib "user32.dll" (ByVal nIndex As Long) As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>GetSystemMetrics</B> returns information about various things in Windows.  Most of these deal with the sizes of various objects, such as the screen, icons, cursors, etc.  This function provides information about the system.  The return value of the function depends on the value specified for <VAR>nIndex</VAR>.  Keep in mind that all sizes (such as widths and heights) are measured in pixels.  Also note that some of the metrics have slightly different meanings between Win NT and Win 95/98.

<DL>
<DT><VAR>nIndex</VAR><DD>Exactly one of the following flags specifying which piece of information to return:
<DL>
<DT>SM_ARRANGE = 56<DD><B>Win 95/98 only:</B> Return the method used to display minimized windows.  The return value is a combination of two of the following flags, one specifying a starting position for the minimized icons and another specifying the direction in which new ones are added:
<DL>
<DT>ARW_BOTTOMLEFT = 0<DD>Start placing the icons in the bottom-left corner of the screen.
<DT>ARW_BOTTOMRIGHT = 1<DD>Start placing the icons in the bottom-right corner of the screen.
<DT>ARW_DOWN = 4<DD>Add new icons below existing ones.
<DT>ARW_HIDE = 8<DD>Do not place the icons anywhere on the screen (i.e., hide them).
<DT>ARW_LEFT = 0<DD>Add new icons to the left of existing ones.
<DT>ARW_RIGHT = 4<DD>Add new icons to the right of existing ones.
<DT>ARW_STARTRIGHT = 1<DD>Same as ARW_BOTTOMRIGHT.
<DT>ARW_STARTTOP = 2<DD>Same as ARW_TOPLEFT.
<DT>ARW_TOPLEFT = 2<DD>Start placing the icons in the top-left corner of the screen.
<DT>ARW_TOPRIGHT = 3<DD>Start placing the icons in the top-right corner of the screen.
<DT>ARW_UP = 0<DD>Add new icons above existing ones.
</DL>
<DT>SM_CLEANBOOT = 67<DD><B>Win 95/98 only:</B> Return a value specifying how the computer was booted up.  0 means a normal bootup, 1 means a fail-safe (a.k.a. SafeBoot) bootup, and 2 means a fail-safe bootup with the network installed.
<DT>SM_CMETRICS = 44<DD><B>Win 95/98 only:</B> Return the number of system metrics.
<DT>SM_CMOUSEBUTTONS = 43<DD>Return the number of mouse buttons on the installed mouse, or 0 if no mouse is installed.
<DT>SM_CXBORDER = 5<DD><B>Win NT:</B> Return the width of a window border.  <B>Win 95/98:</B> Return the width of a single window border.
<DT>SM_CXCURSOR = 13<DD><B>Win NT:</B> Return the width of the cursor.  <B>Win 95/98:</B> Return the width of the standard cursor bitmap.
<DT>SM_CXDLGFRAME = 7<DD><B>Win NT only:</B> Return the width of a window frame having a dialog frame style.
<DT>SM_CXDOUBLECLK = 36<DD>The width of the rectangle within which both mouse clicks must be to recognize a double-click.
<DT>SM_CXDRAG = 68<DD>Return the minimum width the cursor must move to begin a drag-and-drop operation.
<DT>SM_CXEDGE = 45<DD><B>Win 95/98 only:</B> Return the width of a 3D window border.
<DT>SM_CXFRAME = 32<DD><B>Win NT only:</B> Return the width of the border of a resizable window.
<DT>SM_CXFULLSCREEN = 16<DD>Return the width of the client area of a full-screen window.
<DT>SM_CXHSCROLL = 21<DD><B>Win 95/98 only:</B> Return the width of an arrow bitmap on a horizontal scrollbar.
<DT>SM_CXHTHUMB = 10<DD>Return the width of the horizontal scrollbar thumb.
<DT>SM_CXICON = 11<DD>Return the default width of an icon.
<DT>SM_CXICONSPACING = 38<DD><B>Win NT:</B> Return the width of the cell used to position icons.  <B>Win 95/98:</B> Return the width of the grid cell for items in a large icon view.
<DT>SM_CXMAXIMIZED = 61<DD><B>Win 95/98 only:</B> Return the default width of a maximized window.
<DT>SM_CXMAXTRACK = 59<DD><B>Win 95/98 only:</B> Return the default maximum width the user is allowed to resize a window to.
<DT>SM_CXMENUCHECK = 71<DD><B>Win 95/98 only:</B> Return the width of the default menu check-mark bitmap.
<DT>SM_CXMENUSIZE = 54<DD><B>Win 95/98 only:</B> Return the width of a menu bar button.
<DT>SM_CXMIN = 28<DD>Return the minimum width of a window.
<DT>SM_CXMINIMIZED = 57<DD><B>Win 95/98 only:</B> Return the width of a normal minimized window.
<DT>SM_CXMINSPACING = 47<DD><B>Win 95/98 only:</B> Return the width of the grid cell rectangle used to position minimized windows.
<DT>SM_CXMINTRACK = 34<DD><B>Win 95/98 only:</B> Return the default minimum width the user is allowed to resizea window to.
<DT>SM_CXSCREEN = 0<DD>Return the width of the screen.
<DT>SM_CXSIZE = 30<DD><B>Win NT:</B> Return the width of a title bar bitmap.  <B>Win 95/98:</B> Return the width of a caption button.
<DT>SM_CXSIZEFRAME = 32<DD><B>Win 95/98 only:</B> Return the width of a thick window frame.
<DT>SM_CXSMICON = 49<DD><B>Win 95/98 only:</B> Return the recommended width for small icons.
<DT>SM_CXSMSIZE = 52<DD><B>Win 95/98 only:</B> Return the width of a small caption button.
<DT>SM_CXVSCROLL = 2<DD><B>Win 95/98 only:</B> Return the width of a vertical scrollbar.
<DT>SM_CYBORDER = 6<DD><B>Win NT:</B> Return the height of a window border.  <B>Win 95/98:</B> Return the height of a single window border.
<DT>SM_CYCAPTION = 4<DD>Return the height of a normal caption area.
<DT>SM_CYCURSOR = 14<DD><B>Win NT:</B> Return the height of the cursor.  <B>Win 95/98:</B> Return the height of the standard cursor bitmap.
<DT>SM_CYDLGFRAME = 8<DD><B>Win NT only:</B> Return the height of a window frame having a dialog frame style.
<DT>SM_CYDOUBLECLK = 37<DD>Return the height of the rectangle within which both mouse clicks must be to recognize a double-click.
<DT>SM_CYDRAG = 69<DD>Return the minimum height the cursor must move to begin a drag-and-drop operation.
<DT>SM_CYEDGE = 46<DD><B>Win 95/98 only:</B> Return the height of a 3D window border.
<DT>SM_CYFRAME = 33<DD><B>Win NT only:</B> Return the height of the border of a resizable window.
<DT>SM_CYFULLSCREEN = 17<DD>Return the height of the client area of a full-screen window.
<DT>SM_CYHSCROLL = 3<DD><B>Win 95/98 only:</B> Return the height of a horizontal scrollbar.
<DT>SM_CYICON = 12<DD>Return the default height of an icon.
<DT>SM_CYICONSPACING = 39<DD><B>Win NT:</B> Return the height of the cell used to position icons.  <B>Win 95/98:</B> Return the height of the grid cell for items in a large icon view.
<DT>SM_CYKANJIWINDOW = 18<DD>Return the height of the Kanji window (for double-byte character set versions of Windows).
<DT>SM_CYMAXIMIZED = 62<DD><B>Win 95/98 only:</B> Return the default height of a maximized window.
<DT>SM_CYMAXTRACK = 60<DD><B>Win 95/98 only:</B> Return the default maximum height the user is allowed to resize a window to.
<DT>SM_CYMENU = 15<DD>Return the height of a single menu bar.
<DT>SM_CYMENUCHECK = 72<DD><B>Win 95/98 only:</B> Return the height of the default menu check-mark bitmap.
<DT>SM_CYMENUSIZE = 55<DD><B>Win 95/98 only:</B> Return the height of a menu bar button.
<DT>SM_CYMIN = 29<DD>Return the minimum height of a window.
<DT>SM_CYMINIMIZED = 58<DD><B>Win 95/98 only:</B> Return the height of a normal minimized window.
<DT>SM_CYMINSPACING = 48<DD><B>Win 95/98 only:</B> Return the height of the grid cell rectangle used to position minimized windows.
<DT>SM_CYMINTRACK = 35<DD><B>Win 95/98 only:</B> Return the default minimum height the user is allowed to resize a window to.
<DT>SM_CYSCREEN = 1<DD>Return the height of the screen.
<DT>SM_CYSIZE = 31<DD><B>Win NT:</B> Return the height of a title bar bitmap.  <B>Win 95/98:</B> Return the height of a caption button.
<DT>SM_CYSIZEFRAME = 33<DD><B>Win 95/98 only:</B> Return the height of a thick window frame.
<DT>SM_CYSMCAPTION = 51<DD><B>Win 95/98 only:</B> Return the height of a small caption area.
<DT>SM_CYSMICON = 50<DD><B>Win 95/98 only:</B> Return the recommended height for small icons.
<DT>SM_CYSMSIZE = 53<DD><B>Win 95/98 only:</B> Return the height of a small caption button.
<DT>SM_CYVSCROLL = 20<DD><B>Win 95/98 only:</B> Return the height of an arrow bitmap on a vertical scrollbar.
<DT>SM_CYVTHUMB = 9<DD>Return the height of a vertical scrollbar thumb.
<DT>SM_DBCSENABLED = 42<DD>Return a non-zero value if the double-byte character set version of USER.EXE is installed, 0 if not.
<DT>SM_DEBUG = 22<DD>Return a non-zero value if the debugging version of USER.EXE is installed, 0 if not.
<DT>SM_MENUDROPALIGNMENT = 40<DD>Return a non-zero value if popup menus appear to the right, 0 if to the left.
<DT>SM_MIDEASTENABLED = 74<DD>Return a non-zero value if the system is enabled to use Hebrew and Arabic languages, 0 if not.
<DT>SM_MOUSEPRESENT = 19<DD>Return a non-zero value if a mouse is installed and present, 0 if not.
<DT>SM_NETWORK = 63<DD>Set the &amp;H1 bit of the return value if a network is installed.  All other bits of the return value are reserved and undefined.
<DT>SM_PENWINDOWS = 41<DD>Return a non-zero value if the Microsoft Windows for Pen computing extensions are installed, 0 if not.
<DT>SM_SECURE = 44<DD>Return a non-zero value if security is present and active, 0 if  not.
<DT>SM_SHOWSOUNDS = 70<DD>Return a non-zero value if the application should show a visual cue for all sounds, 0 if not.
<DT>SM_SLOWMACHINE = 73<DD>Return a non-zero value if the system has a slow, low-end processor, 0 if not.
<DT>SM_SWAPBUTTON = 23<DD>Return a non-zero value if the left and right mouse buttons are swapped, 0 if not.
</DL>
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' Display the screen resolution (size) and some information about the
' configuration of windows.
Dim xres As Long, yres As Long  ' receive x and y resolutions of the display
Dim hasmouse As Long, numbuttons As Long  ' receive presense of mouse and number of buttons
Dim hasnetwork As Long  ' receives info on availability of network

' Display the screen resolution -- i.e., the width and height of the screen.
xres = <B>GetSystemMetrics</B>(SM_CXSCREEN)
yres = <B>GetSystemMetrics</B>(SM_CYSCREEN)
Debug.Print "The display is"; xres; "pixels wide and"; yres; "pixels high."

' Display the number of buttons on the mouse, if a mouse is present.
hasmouse = <B>GetSystemMetrics</B>(SM_MOUSEPRESENT)
numbuttons = <B>GetSystemMetrics</B>(SM_CMOUSEBUTTONS)
If hasmouse = 0 Then
  Debug.Print "No mouse is installed on the system."
Else
  Debug.Print "A mouse with"; numbuttons; "buttons is installed."
End If

' Display whether the system has a network connection installed.
hasnetwork = <B>GetSystemMetrics</B>(SM_NETWORK)
If (hasnetwork And &amp;H1) = &amp;H1 Then  ' check only the information bit
  Debug.Print "A network is configured to be used by Windows."
Else
  Debug.Print "No network is currently configured."
End If</CODE></PRE>

<P><B>See Also:</B> <A href="systemparametersinfo.html" tppabs="http://www.vbapi.com/ref/s/systemparametersinfo.html">SystemParametersInfo</A><BR>
<B>Category:</B> <A href="index.html#accessibility" tppabs="http://www.vbapi.com/ref/index.html#accessibility">Accessibility</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="getsystemmetrics.html" tppabs="http://www.vbapi.com/ref/g/getsystemmetrics.html">http://www.vbapi.com/ref/g/getsystemmetrics.html</A>

</BODY>
</HTML>
