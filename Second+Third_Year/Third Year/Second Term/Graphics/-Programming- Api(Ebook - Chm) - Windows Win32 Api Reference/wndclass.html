<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: WNDCLASS Structure</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the WNDCLASS structure in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,WNDCLASS" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<META content="Sun, 22 Aug 1999 17:04:00 GMT" http-equiv="Last-Modified">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">

<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>WNDCLASS Structure</H1>

<P><PRE><CODE class="type">Type WNDCLASS
  style As Long
  lpfnWndProc As Long
  cbClsExtra As Long
  cbWndExtra As Long
  hInstance As Long
  hIcon As Long
  hCursor As Long
  hbrBackground As Long
  lpszMenuName As String
  lpszClassName As String
End Type</CODE></PRE></P>

<H2>Description &amp; Usage</H2>
<P>The <B>WNDCLASS</B> structure holds most of the information defining a <A class="def" href="glossary.html#windowclass" tppabs="http://www.vbapi.com/ref/glossary.html#windowclass" rel="glossary">window class</A>.  This information is used by any windows which belong to the class.  The only item which this structure does not hold is a <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to the class's small icon.  (The more advanced <A href="wndclassex.html" tppabs="http://www.vbapi.com/ref/w/wndclassex.html">WNDCLASSEX</A> structure does.)</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Data Members</H2>
<P><DL>
<DT><VAR>style</VAR><DD>A combination of the following flags specifying various styles to give to windows which belong to the class:
<DL>
<DT>CS_BYTEALIGNCLIENT<DD>Align the window's <A class="def" href="glossary.html#clientarea" tppabs="http://www.vbapi.com/ref/glossary.html#clientarea" rel="glossary">client area</A> horizontally on the byte boundary.
<DT>CS_BYTEALIGNWINDOW<DD>Align the window horizontally on the byte boundary.
<DT>CS_CLASSDC<DD>Have all windows belonging to the class use a single shared <A class="def" href="glossary.html#devicecontext" tppabs="http://www.vbapi.com/ref/glossary.html#devicecontext" rel="glossary">device context</A> used by all <A class="def" href="glossary.html#thread" tppabs="http://www.vbapi.com/ref/glossary.html#thread" rel="glossary">threads</A>.
<DT>CS_DBLCLKS<DD>Send a double-click <A class="def" href="glossary.html#message" tppabs="http://www.vbapi.com/ref/glossary.html#message" rel="glossary">message</A> to the window procedure whenever the user double-clicks the mouse inside the window.
<DT>CS_GLOBALCLASS<DD>Allow any application to create a window from this class.  (If this flag is not specified, only the instance registering the class is allowed to use it.)  The window class must be defined in a dynamic link library loaded at startup.
<DT>CS_HREDRAW<DD>Redraw the entire window if a movement or size change alters the width of the window's client area.
<DT>CS_NOCLOSE<DD>Disable the Close command on the window's menu.
<DT>CS_OWNDC<DD>Give each window belonging to the class its own device context.
<DT>CS_PARENTDC<DD>Set the clipping region of a child window equal to that of its parent window, allowing the child to draw on the parent.
<DT>CS_SAVEBITS<DD>Save as a bitmap the portion of the screen image obscured by the window.  This bitmap is then used to redraw the screen when the window is removed.  Using this consumes more resources.
<DT>CS_VREDRAW<DD>Redraw the entire window if a movement or size change alters the height of the window's client area.
</DL>
<DT><VAR>lpfnWndProc</VAR><DD>A <A class="def" href="glossary.html#pointer" tppabs="http://www.vbapi.com/ref/glossary.html#pointer" rel="glossary">pointer</A> to the <A href="windowproc.html" tppabs="http://www.vbapi.com/ref/w/windowproc.html">WindowProc</A> <A class="def" href="glossary.html#hookfunction" tppabs="http://www.vbapi.com/ref/glossary.html#hookfunction" rel="glossary">hook function</A> used for the window procedure which processes all of messages of each window belonging to the class.
<DT><VAR>cbClsExtra</VAR><DD>The number of extra bytes to allocate following the window class structure for additional storage.
<DT><VAR>cbWndExtra</VAR><DD>The number of extra bytes to allocate following the window instance structure for additional storage.
<DT><VAR>hInstance</VAR><DD>A handle to the instance which contains the window procedure for the class.
<DT><VAR>hIcon</VAR><DD>A handle to the window class's icon.
<DT><VAR>hCursor</VAR><DD>A handle to the window class's cursor.
<DT><VAR>hbrBackground</VAR><DD>A handle to the <A class="def" href="glossary.html#brush" tppabs="http://www.vbapi.com/ref/glossary.html#brush" rel="glossary">brush</A> used to fill the window's background area.  This can also be one of the following flags specifying the system color to use as the background color:
<DL>
<DT>COLOR_ACTIVEBORDER<DD>The color of an active window's border.
<DT>COLOR_ACTIVECAPTION<DD>The color of an active window's caption.
<DT>COLOR_APPWORKSPACE<DD>The color of an application's workspace.
<DT>COLOR_BACKGROUND<DD>The color of the desktop background.
<DT>COLOR_BTNFACE<DD>The color of a button's face.
<DT>COLOR_BTNHIGHLIGHT<DD>The color of a button's highlight area.
<DT>COLOR_BTNSHADOW<DD>The color of a button's shadow area.
<DT>COLOR_BTNTEXT<DD>The color of a button's text.
<DT>COLOR_CAPTIONTEXT<DD>The color of an active window's caption area's text.
<DT>COLOR_GRAYTEXT<DD>The color of grayed-out text.
<DT>COLOR_HIGHLIGHT<DD>The color of a highlight.
<DT>COLOR_HIGHLIGHTTEXT<DD>The color of text in a highlight.
<DT>COLOR_INACTIVEBORDER<DD>The color of an inactive window's border.
<DT>COLOR_INACTIVECAPTION<DD>The color of an inactive window's caption.
<DT>COLOR_INACTIVECAPTIONTEXT<DD>The color of an inactive window's caption area's text.
<DT>COLOR_MENU<DD>The color of a menu.
<DT>COLOR_MENUTEXT<DD>The color of a menu's text.
<DT>COLOR_SCROLLBAR<DD>The color of a scrollbar.
<DT>COLOR_WINDOW<DD>The color of a window.
<DT>COLOR_WINDOWFRAME<DD>The color of a window's frame.
<DT>COLOR_WINDOWTEXT<DD>The color of a window's text.
</DL>
<DT><VAR>lpszMenuName</VAR><DD>The name of the window class's menu resource, if any.
<DT><VAR>lpszClassName</VAR><DD>The name of the window class.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const">Const CS_BYTEALIGNCLIENT = &amp;H1000
Const CS_BYTEALIGNWINDOW = &amp;H2000
Const CS_CLASSDC = &amp;H40
Const CS_DBLCLKS = &amp;H8
Const CS_HREDRAW = &amp;H2
Const CS_NOCLOSE = &amp;H200
Const CS_OWNDC = &amp;H20
Const CS_PARENTDC = &amp;H80
Const CS_SAVEBITS = &amp;H800
Const CS_VREDRAW = &amp;H1
Const COLOR_ACTIVEBORDER = 10
Const COLOR_ACTIVECAPTION = 2
Const COLOR_APPWORKSPACE = 12
Const COLOR_BACKGROUND = 1
Const COLOR_BTNFACE = 15
Const COLOR_BTNHIGHLIGHT = 20
Const COLOR_BTNSHADOW = 16
Const COLOR_BTNTEXT = 18
Const COLOR_CAPTIONTEXT = 9
Const COLOR_GRAYTEXT = 17
Const COLOR_HIGHLIGHT = 13
Const COLOR_HIGHLIGHTTEXT = 14
Const COLOR_INACTIVEBORDER = 11
Const COLOR_INACTIVECAPTION = 3
Const COLOR_INACTIVECAPTIONTEXT = 19
Const COLOR_MENU = 4
Const COLOR_MENUTEXT = 7
Const COLOR_SCROLLBAR = 0
Const COLOR_WINDOW = 5
Const COLOR_WINDOWFRAME = 6
Const COLOR_WINDOWTEXT = 8</CODE></PRE></P>

<H2>Used By</H2>
<P><A href="getclassinfo.html" tppabs="http://www.vbapi.com/ref/g/getclassinfo.html">GetClassInfo</A>, <A href="registerclass.html" tppabs="http://www.vbapi.com/ref/r/registerclass.html">RegisterClass</A></P>

<P><A href="structa.html" tppabs="http://www.vbapi.com/ref/structa.html">Go back to the alphabetical Structure listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> August 22, 1999<BR>
This page is copyright &copy; 1999 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>

<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="wndclass.html" tppabs="http://www.vbapi.com/ref/w/wndclass.html">http://www.vbapi.com/ref/w/wndclass.html</A>
</P>
</BODY>
</HTML>