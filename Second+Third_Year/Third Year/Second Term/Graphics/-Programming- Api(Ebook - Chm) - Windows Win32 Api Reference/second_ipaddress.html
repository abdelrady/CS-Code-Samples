<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: SECOND_IPADDRESS Macro</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the SECOND_IPADDRESS macro in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,SECOND_IPADDRESS" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>SECOND_IPADDRESS Macro</H1>

<P><PRE><CODE class="macro"><SPAN class="kw">Public Function</SPAN> SECOND_IPADDRESS (<SPAN class="kw">ByVal</SPAN> ipAddress <SPAN class="kw">As Long</SPAN>) <SPAN class="kw">As Long</SPAN>
	SECOND_IPADDRESS = Val("&amp;H" &amp; Mid(Right("00000000" &amp; Hex(ipAddress), 8), 3, 2))
<SPAN class="kw">End Function</SPAN></CODE></PRE></P>

<H2>Description &amp; Usage</H2>
<P><B>SECOND_IPADDRESS</B> extracts the second field (field 1) from an IP address packed inside a 32-bit integer.  The IP address must be in host byte order.</P>

<H2>Return Value</H2>
<P>The macro returns the value of the second field of the IP address.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>Although it may seem unusual to use string operations for what would otherwise be a mathematical computation, it is necessary to implement <B>SECOND_IPADDRESS</B> this way in VB. Other methods to perform this task can fail for large inputs because VB interprets them as negative values, which causes an equivalent mathematical computation to return an unwanted value.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>ipAddress</VAR><DD>The IP address to get the second field of.  The IP address must be packed into a 32-bit integer in host byte order.
</DL></P>


<H2>See Also</H2>
<P><A href="first_ipaddress.html" tppabs="http://www.vbapi.com/ref/f/first_ipaddress.html">FIRST_IPADDRESS</A>, 
<A href="fourth_ipaddress.html" tppabs="http://www.vbapi.com/ref/f/fourth_ipaddress.html">FOURTH_IPADDRESS</A>, 
<A href="third_ipaddress.html" tppabs="http://www.vbapi.com/ref/t/third_ipaddress.html">THIRD_IPADDRESS</A></P>

<P><A href="macroa.html" tppabs="http://www.vbapi.com/ref/macroa.html">Back to the Macro list.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html" rel="index">Back to the Reference section.</A></P>

<HR>

<P><B>Last Modified:</B> October 29, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="second_ipaddress.html" tppabs="http://www.vbapi.com/ref/s/second_ipaddress.html">http://www.vbapi.com/ref/s/second_ipaddress.html</A></P>
</BODY>
</HTML>