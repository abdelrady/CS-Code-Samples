<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: GetPrivateProfileInt Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the GetPrivateProfileInt function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,GetPrivateProfileInt" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>GetPrivateProfileInt Function</H1>

<P><CODE class="declare">Declare Function GetPrivateProfileInt Lib "kernel32.dll" Alias "GetPrivateProfileIntA" (ByVal lpApplicationName As String, ByVal lpKeyName As String, ByVal nDefault As Long, ByVal lpFileName As String) As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>GetPrivateProfileInt</B> reads an integer value from any INI file.  The parameters passed to the function specify which value will be read from.  If successful, the function returns the value read.  If the value you specify does not exist or is a string (i.e., not a number), the value specified as <VAR>nDefault</VAR> is returned.  Note that INI file support is only provided in Windows for backwards compatibility; using the registry to store information is preferred.

<DL>
<DT><VAR>lpApplicationName</VAR><DD>The header of the INI file section the value is in.
<DT><VAR>lpKeyName</VAR><DD>The name of the value to read.
<DT><VAR>nDefault</VAR><DD>The value to return if a valid value cannot be read.  Make it something that would definitely not be read, such as -1.
<DT><VAR>lpFileName</VAR><DD>The filename of the INI file to read from.
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' Read the "version" value under the "[programinfo]" section
' of the INI file C:\MyProgram\config.ini
Dim version As Long  ' receives the value returned from the INI file

' Read the value from the INI file, returning -1 if it can't find the value
version = <B>GetPrivateProfileInt</B>("programinfo", "version", -1, "C:\MyProgram\config.ini")
' Display the result
If version = -1 Then  ' failure
  Debug.Print "Could not read the information from the INI file."
Else
  Debug.Print "Version number:"; version
End If</CODE></PRE>

<P><B>See Also:</B> <A href="getprivateprofilestring.html" tppabs="http://www.vbapi.com/ref/g/getprivateprofilestring.html">GetPrivateProfileString</A>, <A href="getprofileint.html" tppabs="http://www.vbapi.com/ref/g/getprofileint.html">GetProfileInt</A><BR>
<B>Category:</B> <A href="index.html#inifiles" tppabs="http://www.vbapi.com/ref/index.html#inifiles">INI Files</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="getprivateprofileint.html" tppabs="http://www.vbapi.com/ref/g/getprivateprofileint.html">http://www.vbapi.com/ref/g/getprivateprofileint.html</A>

</BODY>
</HTML>