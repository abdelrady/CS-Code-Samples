<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: IntersectRect Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the IntersectRect function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,IntersectRect" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>IntersectRect Function</H1>

<P><CODE class="declare">Declare Function IntersectRect Lib "user32.dll" (lpDestRect As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>, lpSrc1Rect As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>, lpSrc2Rect As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>) As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>IntersectRect</B> creates a rectangle based on the intersecting part of two other rectangles.  The rectangular region where the two source rectangles overlap is the intersection rectangle.  If one or both of the source rectangles are empty or there is no intersection, the function returns 0 and the <VAR>lpDestRect</VAR> rectangle is set to (0,0)-(0,0).  If the source rectangles do overlap, the intersection is put into <VAR>lpDestRect</VAR> and the function returns 1.

<DL>
<DT><VAR>lpDestRect</VAR><DD>The rectangle to be set as the intersection of the two source rectangles.
<DT><VAR>lpSrc1Rect</VAR><DD>The first source rectangle.
<DT><VAR>lpSrc2Rect</VAR><DD>The second source rectangle.
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' Determine if windows Form1 and Form2 are overlapping on the
' screen.  If they don't the intersection rectangle will be empty.
Dim intrect As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>  ' receives the intersection rectangle
Dim window1 As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>, window2 As <A href="rect.html" tppabs="http://www.vbapi.com/ref/r/rect.html">RECT</A>  ' receive rectangles of Form1 and Form2
Dim result As Long  ' will be set to 0 if no intersection, 1 if there is intersection
Dim retval As Long  ' return value for other functions

retval = <A href="getwindowrect.html" tppabs="http://www.vbapi.com/ref/g/getwindowrect.html">GetWindowRect</A>(Form1.hWnd, window1)  ' get Form1's rectangle
retval = <A href="getwindowrect.html" tppabs="http://www.vbapi.com/ref/g/getwindowrect.html">GetWindowRect</A>(Form2.hWnd, window2)  ' get Form2's rectangle
result = <B>IntersectRect</B>(intrect, window1, window2)  ' determine the intersection rectangle
If result = 0  ' in this case, intrect will also be empty
  Debug.Print "Windows Form1 and Form2 are not overlapping on the screen."
Else
  Debug.Print "Windows Form1 and Form2 are overlapping on the screen."
End If</CODE></PRE>

<P><B>See Also:</B> <A href="subtractrect.html" tppabs="http://www.vbapi.com/ref/s/subtractrect.html">SubtractRect</A>, <A href="unionrect.html" tppabs="http://www.vbapi.com/ref/u/unionrect.html">UnionRect</A><BR>
<B>Category:</B> <A href="index.html#rectangles" tppabs="http://www.vbapi.com/ref/index.html#rectangles">Rectangles</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="intersectrect.html" tppabs="http://www.vbapi.com/ref/i/intersectrect.html">http://www.vbapi.com/ref/i/intersectrect.html</A>

</BODY>
</HTML>