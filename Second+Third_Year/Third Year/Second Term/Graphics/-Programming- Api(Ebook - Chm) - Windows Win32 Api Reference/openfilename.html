<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: OPENFILENAME Structure</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the OPENFILENAME structure in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,OPENFILENAME" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>OPENFILENAME Structure</H1>

<P><PRE><CODE class="type"><SPAN class="kw">Type</SPAN> OPENFILENAME
	lStructSize <SPAN class="kw">As Long</SPAN>
	hwndOwner <SPAN class="kw">As Long</SPAN>
	hInstance <SPAN class="kw">As Long</SPAN>
	lpstrFilter <SPAN class="kw">As String</SPAN>
	lpstrCustomFilter <SPAN class="kw">As String</SPAN>
	nMaxCustomFilter <SPAN class="kw">As Long</SPAN>
	nFilterIndex <SPAN class="kw">As Long</SPAN>
	lpstrFile <SPAN class="kw">As String</SPAN>
	nMaxFile <SPAN class="kw">As Long</SPAN>
	lpstrFileTitle <SPAN class="kw">As String</SPAN>
	nMaxFileTitle <SPAN class="kw">As Long</SPAN>
	lpstrInitialDir <SPAN class="kw">As String</SPAN>
	lpstrTitle <SPAN class="kw">As String</SPAN>
	flags <SPAN class="kw">As Long</SPAN>
	nFileOffset <SPAN class="kw">As Integer</SPAN>
	nFileExtension <SPAN class="kw">As Integer</SPAN>
	lpstrDefExt <SPAN class="kw">As String</SPAN>
	lCustData <SPAN class="kw">As Long</SPAN>
	lpfnHook <SPAN class="kw">As Long</SPAN>
	lpTemplateName <SPAN class="kw">As String</SPAN>
<SPAN class="kw">End Type</SPAN></CODE></PRE></P>

<H2>Description &amp; Usage</H2>
<P>The <B>OPENFILENAME</B> structure is used to pass data to and from the <A href="getopenfilename.html" tppabs="http://www.vbapi.com/ref/g/getopenfilename.html">GetOpenFileName</A> and <A href="getsavefilename.html" tppabs="http://www.vbapi.com/ref/g/getsavefilename.html">GetSaveFileName</A> API functions.  It stores both settings used to create the dialog box and the results of the user's selection.</P>

<H2>Visual Basic-Specific Issues</H2>
<P><B>Windows NT, 2000:</B> If you do not use a string in the structure, it is imperative that you <B>not</B> set it to an empty string ("").  If you do not use a string, leave it alone entirely.  Any strings you do use must be explicitly terminated by a null character (vbNullChar).  Failure to do either of these will cause <A href="getopenfilename.html" tppabs="http://www.vbapi.com/ref/g/getopenfilename.html">GetOpenFileName</A> and <A href="getsavefilename.html" tppabs="http://www.vbapi.com/ref/g/getsavefilename.html">GetSaveFileName</A> to fail.  See the examples for those two functions for a demonstration on how strings must be handled.  Of course, following these guidelines still works under Windows 95 and 98, but it isn't necessary.  Your best bet is to follow the NT/2000 requirements so your code works under all versions of Windows.</P>

<H2>Data Members</H2>
<DL>
<DT><VAR>lStructSize</VAR><DD>The size in bytes of the structure.
<DT><VAR>hwndOwner</VAR><DD>A <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to the window opening the file dialog box.
<DT><VAR>hInstance</VAR><DD>If using a dialog box template, this is a handle to the memory block of the dialog box template to use.  If using the default dialog box, set to 0.
<DT><VAR>lpstrFilter</VAR><DD>The entries in the File Type drop box.  The format of the string is "<VAR>name of file type</VAR>" &amp; <VAR>vbNullChar</VAR> &amp; "<VAR>mask</VAR>" &amp; <VAR>vbNullChar</VAR> ... for as many types, where <VAR>name of file type</VAR> is the text that appears in the list and <VAR>mask</VAR> is the extension mask.  The string must end with a double <VAR>vbNullChar</VAR>.
<DT><VAR>lpstrCustomFilter</VAR><DD>Similar to <VAR>lpstrFilter</VAR>, but holds only one file type name/mask pair that specifies a user-defined file type.  If unused, set to an empty string.
<DT><VAR>nMaxCustFilter</VAR><DD>The size in bytes of the string contained in <VAR>lpstrCustomFilter</VAR>.
<DT><VAR>nFilterIndex</VAR><DD>The number (#1, #2, etc.) of data type specified <VAR>lpstrFilter</VAR> should be the default one.
<DT><VAR>lpstrFile</VAR><DD>Set it as a series of blank spaces.  If you want to specify a default filename, set this string to that default filename and pad it with spaces.  Receives the complete path and filename of the file(s) the user selects.  If multiple files are selected, each filename is separated by <VAR>vbNullChar</VAR>, and the entire string will end with a double <VAR>vbNullChar</VAR>.
<DT><VAR>nMaxFile</VAR><DD>The length in characters of <VAR>lpstrFile</VAR>.
<DT><VAR>lpstrFileTitle</VAR><DD>Very similar to <VAR>lpstrFile</VAR>, but only receives the filename of the selected file.  If multiple files are selected, this is not set to any useful data.
<DT><VAR>nMaxFileTitle</VAR><DD>The length in characters of <VAR>lpstrFileTitle</VAR>.
<DT><VAR>lpstrInitialDir</VAR><DD>The default directory to look in.
<DT><VAR>lpstTitle</VAR><DD>The text that appears in the dialog box's title bar.
<DT><VAR>flags</VAR><DD>Zero or more of the following flags specifying how to create the file dialog box.  Some of these flags will be set by the function after the call to reflect the user's selections.
<DL>
<DT>OFN_ALLOWMULTISELECT<DD>Allow the user to select multiple files (Open File dialog box only).
<DT>OFN_CREATEPROMPT<DD>Prompt if a non-existing file is chosen.
<DT>OFN_ENABLEHOOK<DD>Use the function specified by <VAR>lpfnHook</VAR> to process the dialog box's messages.
<DT>OFN_ENABLESIZING<DD><B>Windows 98, 2000:</B> Allow the dialog box to be resized.  This is selected by default unless a hook function or custom template is specified.
<DT>OFN_ENABLETEMPLATE<DD>Use the dialog box template specifed by <VAR>hInstance</VAR> and <VAR>lpTemplateName</VAR>.
<DT>OFN_ENABLETEMPLATEHANDLE<DD>Use the preloaded dialog box template specified by <VAR>hInstance</VAR>.
<DT>OFN_EXPLORER<DD>Use Windows Explorer-like additions to the file dialog box.  This is selected by default unless a hook function or custom template is specified.
<DT>OFN_EXTENSIONDIFFERENT<DD>The function sets this flag if the user selects a file with an extension different than the one specified by <VAR>lpstrDefExt</VAR>.
<DT>OFN_FILEMUSTEXIST<DD>Only allow the selection of existing files.
<DT>OFN_HIDEREADONLY<DD>Hide the Open As Read Only check box (Open File dialog box only).
<DT>OFN_LONGNAMES<DD>Have the file dialog use long file names.  This is automatically specified unless the Explorer-type extensions are not used.
<DT>OFN_NOCHANGEDIR<DD>Don't change Windows's current directory to match the one chosen in the dialog box.
<DT>OFN_NODEREFERENCELINKS<DD>If a shortcut file (.lnk or .pif) is chosen, return the shortcut file itself instead of the file or directory it points to.
<DT>OFN_NOLONGNAMES<DD>Have the file dialog use short (8.3) file names.  This is ignored unless a file dialog without Explorer-type extensions are not used.
<DT>OFN_NONETWORKBUTTON<DD>Hide and disable the Network button in the dialog box.
<DT>OFN_NOREADONLYRETURN<DD>The function sets this flag if the selected file is not read-only (Open File dialog box only).
<DT>OFN_NOTESTFILECREATE<DD>Do not create a test file before the box closes.  Normally, this check is done to verify that the disk exists, that there is sufficient disk space, etc.  However, this check should not be used on a create-nonmodify network share.  Specifying this flag prevents this test from being done.
<DT>OFN_NOVALIDATE<DD>Don't check the filename for invalid characters.
<DT>OFN_OVERWRITEPROMPT<DD>Prompt the user if the chosen file already exists (Save File dialog box only).
<DT>OFN_PATHMUSTEXIST<DD>Only allow the selection of existing paths.
<DT>OFN_READONLY<DD>Check the Open As Read Only box.  This flag is set after the function call if the box is checked after the user clicks OK.
<DT>OFN_SHAREAWARE<DD>Ignore any file sharing violations.
<DT>OFN_SHOWHELP<DD>Show the Help button in the dialog box.  The button sends the <A href="wm_help.html" tppabs="http://www.vbapi.com/ref/w/wm_help.html">WM_HELP</A> message to the hook function specified by the structure.  If no hook function is used, the Help button will do nothing.
</DL>
<DT><VAR>nFileOffet</VAR><DD>Receives the zero-based index specifying where in <VAR>lpstrFile</VAR> the pathname ends and the filename begins.
<DT><VAR>nFileExtension</VAR><DD>Receives the zero-based index specifying where in <VAR>lpstrFile</VAR> the file extension begins.
<DT><VAR>lpstrDefExt</VAR><DD>The default extension of a file (only for the Save dialog box).  If a file is chosen with the *.* mask, the file gets this extension.  Don't include the period.
<DT><VAR>lCustData</VAR><DD>Information to pass to the hook function specified by <VAR>lpfnHook</VAR> whenever it is called.
<DT><VAR>lpfnHook</VAR><DD>A <A class="def" href="glossary.html#pointer" tppabs="http://www.vbapi.com/ref/glossary.html#pointer" rel="glossary">pointer</A> to a <A class="def" href="glossary.html#hookfunction" tppabs="http://www.vbapi.com/ref/glossary.html#hookfunction" rel="glossary">hook function</A> to use to processes the dialog box's messages.  For file dialogs with Explorer-type extensions, this is a pointer to a <A href="ofnhookproc.html" tppabs="http://www.vbapi.com/ref/o/ofnhookproc.html">OFNHookProc</A> hook function.  For file dialogs without those extensions, this is a pointer to a <A href="ofnhookprocoldstyle.html" tppabs="http://www.vbapi.com/ref/o/ofnhookprocoldstyle.html">OFNHookProcOldStyle</A> hook function.  If not using a hook function, set to 0.
<DT><VAR>lpTemplateName</VAR><DD>The name of the dialog box template specified by <VAR>hInstance</VAR>, if needed.
</DL>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const"><SPAN class="kw">Const</SPAN> OFN_ALLOWMULTISELECT = &amp;H200
<SPAN class="kw">Const</SPAN> OFN_CREATEPROMPT = &amp;H2000
<SPAN class="kw">Const</SPAN> OFN_ENABLEHOOK = &amp;H20
<SPAN class="kw">Const</SPAN> OFN_ENABLESIZING = &amp;H800000
<SPAN class="kw">Const</SPAN> OFN_ENABLETEMPLATE = &amp;H40
<SPAN class="kw">Const</SPAN> OFN_ENABLETEMPLATEHANDLE = &amp;H80
<SPAN class="kw">Const</SPAN> OFN_EXPLORER = &amp;H80000
<SPAN class="kw">Const</SPAN> OFN_EXTENSIONDIFFERENT = &amp;H400
<SPAN class="kw">Const</SPAN> OFN_FILEMUSTEXIST = &amp;H1000
<SPAN class="kw">Const</SPAN> OFN_HIDEREADONLY = &amp;H4
<SPAN class="kw">Const</SPAN> OFN_LONGNAMES = &amp;H200000
<SPAN class="kw">Const</SPAN> OFN_NOCHANGEDIR = &amp;H8
<SPAN class="kw">Const</SPAN> OFN_NODEREFERENCELINKS = &amp;H100000
<SPAN class="kw">Const</SPAN> OFN_NOLONGNAMES = &amp;H40000
<SPAN class="kw">Const</SPAN> OFN_NONETWORKBUTTON = &amp;H20000
<SPAN class="kw">Const</SPAN> OFN_NOREADONLYRETURN = &amp;H8000
<SPAN class="kw">Const</SPAN> OFN_NOTESTFILECREATE = &amp;H10000
<SPAN class="kw">Const</SPAN> OFN_NOVALIDATE = &amp;H100
<SPAN class="kw">Const</SPAN> OFN_OVERWRITEPROMPT = &amp;H2
<SPAN class="kw">Const</SPAN> OFN_PATHMUSTEXIST = &amp;H800
<SPAN class="kw">Const</SPAN> OFN_READONLY = &amp;H1
<SPAN class="kw">Const</SPAN> OFN_SHAREAWARE = &amp;H4000
<SPAN class="kw">Const</SPAN> OFN_SHOWHELP = &amp;H10</CODE></PRE></P>

<H2>Used By</H2>
<P><A href="getopenfilename.html" tppabs="http://www.vbapi.com/ref/g/getopenfilename.html">GetOpenFileName</A>, 
<A href="getsavefilename.html" tppabs="http://www.vbapi.com/ref/g/getsavefilename.html">GetSaveFileName</A></P>

<P><A href="structa.html" tppabs="http://www.vbapi.com/ref/structa.html">Go back to the Structure listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> September 24, 2000<BR>
This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="openfilename.html" tppabs="http://www.vbapi.com/ref/o/openfilename.html">http://www.vbapi.com/ref/o/openfilename.html</A></P>
</BODY>
</HTML>