<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: DrawIconEx Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the DrawIconEx function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,DrawIconEx" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<META content="Fri, 06 Aug 1999 01:38:00 GMT" http-equiv="Last-Modified">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">

<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>DrawIconEx Function</H1>

<P><CODE class="declare">Declare Function DrawIconEx Lib "user32.dll" (ByVal hdc As Long, ByVal xLeft As Long, ByVal yTop As Long, ByVal hIcon As Long, ByVal cxWidth As Long, ByVal cyWidth As Long, ByVal istepIfAniCur As Long, ByVal hbrFlickerFreeDraw As Long, ByVal diFlags As Long) As Long</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.5 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Requires Windows CE 1.0 or later.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>DrawIconEx</B> displays either an icon or a cursor (or a single frame of an animated cursor) on a <A class="def" href="glossary.html#device" tppabs="http://www.vbapi.com/ref/glossary.html#device" rel="glossary">device</A>.  The image's position is determined by passing the coordinates of the upper-left corner of the image.  The function can stretch the image in either direction as well as specify other display parameters.</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns 0 (use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).  If successful, the function returns a non-zero value.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>hdc</VAR><DD>A <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to a <A class="def" href="glossary.html#devicecontext" tppabs="http://www.vbapi.com/ref/glossary.html#devicecontext" rel="glossary">device context</A> to the device to draw the icon or cursor on.
<DT><VAR>xLeft</VAR><DD>The x-coordinate of the point to position the upper-left corner of the icon's or cursor's image at.
<DT><VAR>yTop</VAR><DD>The y-coordinate of the point to position the upper-left corner of the icon's or cursor's image at.
<DT><VAR>hIcon</VAR><DD>A handle to the icon or cursor to draw.
<DT><VAR>cxWidth</VAR><DD>The width in pixels to stretch the icon's or cursor's image to.  If this is 0, the image is drawn using either the icon's or cursor's width or the default width of the system, depending on the flags passed as <VAR>diFlags</VAR>.
<DT><VAR>cyWidth</VAR><DD>The height in pixels to stretch the icon's or cursor's image to.  If this is 0, the image is drawn using either the icon's or cursor's height or the default height of the system, depending on the flags passed as <VAR>diFlags</VAR>.
<DT><VAR>istepIfAniCursor</VAR><DD>If <VAR>hIcon</VAR> is a handle to an animated cursor, this specifies the index of the particular frame to draw.  Otherwise, this parameter is ignored.
<DT><VAR>hbrFlickerFreeDraw</VAR><DD>A handle to the <A class="def" href="glossary.html#brush" tppabs="http://www.vbapi.com/ref/glossary.html#brush" rel="glossary">brush</A> to use as the icon's or cursor's background.  The background is added to the icon's or cursor's image using a flicker-free method.  If this parameter is 0, the image is drawn directly onto the device without first adding a background.
<DT><VAR>diFlags</VAR><DD>A combination of the following flags specifying how to draw the icon or cursor:
<DL>
<DT>DI_COMPAT<DD>Draw the icon or cursor using the system default image instead of the user-specified image.
<DT>DI_DEFAULTSIZE<DD>If <VAR>cxWidth</VAR> and <VAR>cyWidth</VAR> are set to 0, draw the icon or cursor using the height and width settings defined by the system metrics.  If this flag is not specified and the two parameters are set to 0, the icon or cursor is drawn using its own dimensions.
<DT>DI_IMAGE<DD>Draw the icon's or cursor's image data onto the device.
<DT>DI_MASK<DD>Draw the icon's or cursor's mask data onto the device.
<DT>DI_NORMAL<DD>Draw the icon or cursor using both its image and mask, as usual.
</DL>
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const">Const DI_COMPAT = &amp;H4
Const DI_DEFAULTSIZE = &amp;H8
Const DI_IMAGE = &amp;H2
Const DI_MASK = &amp;H1
Const DI_NORMAL = &amp;H3</CODE></PRE></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

' Extract all of the regular-sized icons from the file
' C:\MyApp\Prog.exe.  Display them in a row, stretching or shrinking them to
' a width of 32 and a height of 64.  Note how dynamically allocated arrays
' are used to receive the icon handles.  Draw all icons on a light-gray
' background on the window Form1.
Dim hIcons() As Long  ' dynamic array to receive handles to the icons
Dim numicons As Long  ' number of regular icons in the file
Dim hBrush As Long  ' handle to the background brush to use
Dim c As Long  ' counter variable
Dim retval As Long  ' return value

' Determine how many regular icons exist in the file and resize
' the array accordingly.
numicons = <A href="extracticonex.html" tppabs="http://www.vbapi.com/ref/e/extracticonex.html">ExtractIconEx</A>("C:\MyApp\Prog.exe", -1, ByVal 0, ByVal 0, 0)
If numicons = 0 Then
  Debug.Print "No icons found in the file -- aborting."
  End  ' abort the program if failure occurs
End If
ReDim hIcons(0 To numicons - 1) As Long  ' resize the array to hold all the handles
' Get a handle to the stock solid light gray brush to use for the background.
hBrush = <A href="getstockobject.html" tppabs="http://www.vbapi.com/ref/g/getstockobject.html">GetStockObject</A>(LTGRAY_BRUSH)  ' handle to the brush

' Extract all of the icons to display.
retval = <A href="extracticonex.html" tppabs="http://www.vbapi.com/ref/e/extracticonex.html">ExtractIconEx</A>("C:\MyApp\Prog.exe", numicons, hIcons(0), ByVal 0, 0)

' Loop through each icon, displaying it as previously mentioned.
For c = 0 To numicons - 1
  ' The x coordinate equals 32 * c.  The y coordinate is always 0.
  ' Display this particular icon.
  retval = <B>DrawIconEx</B>(Form1.hDC, 32 * c, 0, hIcons(c), 32, 64, 0, hBrush, DI_NORMAL)
  ' Now destroy this icon since we no longer are using it.
  retval = <A href="destroyicon.html" tppabs="http://www.vbapi.com/ref/d/destroyicon.html">DestroyIcon</A>(hIcons(c))
Next c</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="drawicon.html" tppabs="http://www.vbapi.com/ref/d/drawicon.html">DrawIcon</A></P>

<H2>Category</H2>
<P><A href="funcc.html#icons" tppabs="http://www.vbapi.com/ref/funcc.html#icons">Icons</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>
<B>Last Modified:</B> August 5, 1999<BR>
This page is copyright &copy; 1999 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>

<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="drawiconex.html" tppabs="http://www.vbapi.com/ref/d/drawiconex.html">http://www.vbapi.com/ref/d/drawiconex.html</A>
</P>
</BODY>
</HTML>