<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: CommDlgExtendedError Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the CommDlgExtendedError function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,CommDlgExtendedError" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>CommDlgExtendedError Function</H1>

<P><CODE class="declare">Declare Function CommDlgExtendedError Lib "comdlg32.dll" () As Long</CODE>

<P><B>Platforms:</B> Win 32s, Win 95/98, Win NT

<P><B>CommDlgExtendedError</B> returns the error code from the last common dialog box function.  This function does not return error codes for any other API function; for that, use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> instead.  The function's return value is undefined if the last common dialog function call was successful.  If an error with a common dialog function did occur, the return value is exactly one of the following common dialog error flags:
<DL class="ghost">
<DT>CDERR_DIALOGFAILURE = &amp;HFFFF<DD>The function could not open the dialog box.
<DT>CDERR_FINDRESFAILURE = &amp;H6<DD>The function failed to find the desired resource.
<DT>CDERR_GENERALCODES = &amp;H0<DD>The error involved a general common dialog box property.
<DT>CDERR_INITIALIZATION = &amp;H2<DD>The function failed during initialization (probably insufficient memory).
<DT>CDERR_LOADRESFAILURE = &amp;H7<DD>The function failed to load the desired resource.
<DT>CDERR_LOADSTRFAILURE = &amp;H5<DD>The function failed to load the desired string.
<DT>CDERR_LOCKRESFAILURE = &amp;H8<DD>The function failed to lock the desired resource.
<DT>CDERR_MEMALLOCFAILURE = &amp;H9<DD>The function failed to allocate sufficient memory.
<DT>CDERR_MEMLOCKFAILURE = &amp;HA<DD>The function failed to lock the desired memory.
<DT>CDERR_NOHINSTANCE = &amp;H4<DD>The function was not provided with a valid instance handle (if one was required).
<DT>CDERR_NOHOOK = &amp;HB<DD>The function was not provided with a valid hook function handle (if one was required).
<DT>CDERR_NOTEMPLATE = &amp;H3<DD>The function was not provided with a valid template (if one was required).
<DT>CDERR_REGISTERMSGFAIL = &amp;HC<DD>The function failed to successfully register a window message.
<DT>CDERR_STRUCTSIZE = &amp;H1<DD>The function was provided with an invalid structure size.
<DT>CFERR_CHOOSEFONTCODES = &amp;H2000<DD>The error involved the Choose Font common dialog box.
<DT>CFERR_MAXLESSTHANMIN = &amp;H2002<DD>The function was provided with a maximum font size value smaller than the provided minimum font size.
<DT>CFERR_NOFONTS = &amp;H2001<DD>The function could not find any existing fonts.
<DT>FNERR_BUFFERTOOSMALL = &amp;H3003<DD>The function was provided with a filename buffer which was too small.
<DT>FNERR_FILENAMECODES = &amp;H3000<DD>The error involved the Open File or Save File common dialog box.
<DT>FNERR_INVALIDFILENAME = &amp;H3002<DD>The function was provided with or received an invalid filename.
<DT>FNERR_SUBCLASSFAILURE = &amp;H3001<DD>The function had insufficient memory to subclass the list box.
<DT>FRERR_BUFFERLENGTHZERO = &amp;H4001<DD>The function was provided with an invalid buffer.
<DT>FRERR_FINDREPLACECODES = &amp;H4000<DD>The error involved the Find or Replace common dialog box.
<DT>PDERR_CREATEICFAILURE = &amp;H100A<DD>The function failed to create an information context.
<DT>PDERR_DEFAULTDIFFERENT = &amp;H100C<DD>The function was told that the information provided described the default printer, but the default printer's actual settings were different.
<DT>PDERR_DNDMMISMATCH = &amp;H1009<DD>The data in the two data structures describe different printers (i.e., they hold conflicting information).
<DT>PDERR_GETDEVMODEFAIL = &amp;H1005<DD>The printer driver failed to initialize the <A href="devmode.html" tppabs="http://www.vbapi.com/ref/d/devmode.html">DEVMODE</A> structure.
<DT>PDERR_INITFAILURE = &amp;H1006<DD>The function failed during initialization.
<DT>PDERR_LOADDRVFAILURE = &amp;H1004<DD>The function failed to load the desired device driver.
<DT>PDERR_NODEFAULTPRN = &amp;H1008<DD>The function could not find a default printer.
<DT>PDERR_NODEVICES = &amp;H1007<DD>The function could not find any printers.
<DT>PDERR_PARSEFAILURE = &amp;H1002<DD>The function failed to parse the printer-related strings in WIN.INI.
<DT>PDERR_PRINTERCODES = &amp;H1000<DD>The error involved the Print common dialog box.
<DT>PDERR_PRINTERNOTFOUND = &amp;H100B<DD>The function could not find information in WIN.INI about the requested printer.
<DT>PDERR_RETDEFFAILURE = &amp;H1003<DD>The handles to the data structures provided were nonzero even though the function was asked to return information about the default printer.
<DT>PDERR_SETUPFAILURE = &amp;H1001<DD>The function failed to load the desired resources.
</DL>

<P><B>Example:</B>
<PRE><CODE class="example">' Give the Open File dialog box an insufficient buffer size.
' Then display the error code provided.
Dim filebox As <A href="openfilename.html" tppabs="http://www.vbapi.com/ref/o/openfilename.html">OPENFILENAME</A>  ' structure that sets the dialog box
Dim fname As String  ' will receive selected file's name
Dim retval As Long  ' return value
Dim errcode As long  ' receives the error code

' Configure how the dialog box will look
filebox.lStructSize = Len(filebox)  ' the size of the structure
filebox.hwndOwner = Form1.hWnd  ' handle of the form calling the function
filebox.lpstrTitle = "Open File"  ' text displayed in the box's title bar
' The next line sets up the file types drop-box
filebox.lpstrFilter = "Text Files" &amp; vbNullChar &amp; "*.txt" &amp; vbNullChar &amp; "All Files" &amp; vbNullChar &amp; "*.*" &amp; vbNullChar &amp; vbNullChar
filebox.lpstrFile = ""  ' ERROR: an empty buffer!
filebox.nMaxFile = 0  ' length of file and pathname buffer
filebox.lpstrFileTitle = Space(255)  ' initialize buffer that receives filename of file
filebox.nMaxFileTitle = 255  ' length of filename buffer
' Allow only existing files and hide the read-only check box
filebox.flags = OFN_PATHMUSTEXIST Or OFN_FILEMUSTEXIST Or OFN_HIDEREADONLY

' Execute the dialog box
retval = <A href="getopenfilename.html" tppabs="http://www.vbapi.com/ref/g/getopenfilename.html">GetOpenFileName</A>(filebox)
If retval = 0 Then  ' some error occured, or Cancel was pressed
  errcode = <B>CommDlgExtendedError</B>()  ' get the error code for GetOpenFileName
  If errcode = FNERR_BUFFERTOOSMALL Then
    Debug.Print "The buffer provided was too small to hold the filename."
  If errcode = FNERR_INVALIDFILENAME Then
    Debug.Print "An invalid filename was provided."
  ' etc.
  End If
End If</CODE></PRE>

<P><B>See Also:</B> <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A><BR>
<B>Category:</B> <A href="index.html#commondialog" tppabs="http://www.vbapi.com/ref/index.html#commondialog">Common Dialog</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="commdlgextendederror.html" tppabs="http://www.vbapi.com/ref/c/commdlgextendederror.html">http://www.vbapi.com/ref/c/commdlgextendederror.html</A>

</BODY>
</HTML>