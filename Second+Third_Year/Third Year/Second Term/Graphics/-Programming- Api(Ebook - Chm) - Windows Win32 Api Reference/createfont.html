<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: CreateFont Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the CreateFont function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows CE,Windows 2000,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,CreateFont" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<META content="Wed, 13 Oct 1999 17:26:00 GMT" http-equiv="Last-Modified">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">

<LINK href="glossary.html" tppabs="http://www.vbapi.com/ref/glossary.html" rel="glossary">
<LINK href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>CreateFont Function</H1>

<P><CODE class="declare">Declare Function CreateFont Lib "gdi32.dll" Alias "CreateFontA" (ByVal nHeight As Long, ByVal nWidth As Long, ByVal nEscapement As Long, ByVal nOrientation As Long, ByVal fnWeight As Long, ByVal fdwItalic As Long, ByVal fdwUnderline As Long, ByVal fdwStrikeOut As Long, ByVal fdwCharSet As Long, ByVal fdwOutputPrecision As Long, ByVal fdwClipPrecision As Long, ByVal fdwQuality As Long, ByVal fdwPitchAndFamily As Long, ByVal lpszFace As String) As Long</CODE></P>

<H2>Platforms</H2>
<P><UL>
<LI><B>Windows 95:</B> Supported.
<LI><B>Windows 98:</B> Supported.
<LI><B>Windows NT:</B> Requires Windows NT 3.1 or later.
<LI><B>Windows 2000:</B> Supported.
<LI><B>Windows CE:</B> Not Supported.
</UL></P>

<H2>Description &amp; Usage</H2>
<P><B>CreateFont</B> creates a font object, which allows a font with given attributes to be used to draw text on a <A class="def" href="glossary.html#device" tppabs="http://www.vbapi.com/ref/glossary.html#device" rel="glossary">device</A>.  The font created by the function is the one which most closely matches the attributes of the <A class="def" href="glossary.html#logical" tppabs="http://www.vbapi.com/ref/glossary.html#logical" rel="glossary">logical</A> font information passed via the numerous parameters.  After your program is finished using the font, it must be deleted by using <A href="deleteobject.html" tppabs="http://www.vbapi.com/ref/d/deleteobject.html">DeleteObject</A>.</P>

<H2>Return Value</H2>
<P>If an error occured, the function returns 0 (<B>Windows NT, 2000:</B> use <A href="getlasterror.html" tppabs="http://www.vbapi.com/ref/g/getlasterror.html">GetLastError</A> to get the error code).  If successful, the function returns a <A class="def" href="glossary.html#handle" tppabs="http://www.vbapi.com/ref/glossary.html#handle" rel="glossary">handle</A> to the font just created.</P>

<H2>Visual Basic-Specific Issues</H2>
<P>None.</P>

<H2>Parameters</H2>
<P><DL>
<DT><VAR>nHeight</VAR><DD>The height of the font's character cell, in logical units (also known as the em height).  If positive, the font mapper converts this value directly into device units and matches it with the cell height of the possible fonts.  If 0, the font mapper uses a default character height.  If negative, the font mapper converts the absolute value into device units and matches it with the character height of the possible fonts.
<DT><VAR>nWidth</VAR><DD>The average width of the font's characters.  If 0, the font mapper tries to determine the best value.
<DT><VAR>nEscapement</VAR><DD>The angle between the font's baseline and escapement vectors, in units of <SUP>1</SUP>/<SUB>10</SUB> degrees.  <B>Windows 95, 98:</B> This must be equal to <VAR>lfOrientation</VAR>.
<DT><VAR>nOrientation</VAR><DD>The angle between the font's baseline and the device's x-axis, in units of <SUP>1</SUP>/<SUB>10</SUB> degrees.  <B>Windows 95, 98:</B> This must be equal to <VAR>lfEscapement</VAR>.
<DT><VAR>fnWeight</VAR><DD>One of the following flags specifying the boldness (weight) of the font:
<DL>
<DT>FW_DONTCARE<DD>Default weight.
<DT>FW_THIN<DD>Thin weight.
<DT>FW_EXTRALIGHT<DD>Extra-light weight.
<DT>FW_ULTRALIGHT<DD>Same as FW_EXTRALIGHT.
<DT>FW_LIGHT<DD>Light weight.
<DT>FW_NORMAL<DD>Normal weight.
<DT>FW_REGULAR<DD>Same as FW_NORMAL.
<DT>FW_MEDIUM<DD>Medium weight.
<DT>FW_SEMIBOLD<DD>Semi-bold weight.
<DT>FW_DEMIBOLD<DD>Same As FW_SEMIBOLD.
<DT>FW_BOLD<DD>Bold weight.
<DT>FW_EXTRABOLD<DD>Extra-bold weight.
<DT>FW_ULTRABOLD<DD>Same as FW_EXTRABOLD.
<DT>FW_HEAVY<DD>Heavy weight.
<DT>FW_BLACK<DD>Same as FW_HEAVY.
</DL>
<DT><VAR>fdwItalic</VAR><DD>A non-zero value if the font is italicized, 0 if not.
<DT><VAR>fdwUnderline</VAR><DD>A non-zero value if the font is underlined, 0 if not.
<DT><VAR>fdwStrikeOut</VAR><DD>A non-zero value if the font is striked out, 0 if not.
<DT><VAR>fdwCharSet</VAR><DD>Exactly one of the following flags specifying the character set of the font:
<DL>
<DT>ANSI_CHARSET<DD>ANSI character set.
<DT>ARABIC_CHARSET<DD><B>Windows NT, 2000:</B> Arabic character set.
<DT>BALTIC_CHARSET<DD><B>Windows 95, 98:</B> Baltic character set.
<DT>CHINESEBIG5_CHARSET<DD>Chinese Big 5 character set.
<DT>DEFAULT_CHARSET<DD>Default character set.
<DT>EASTEUROPE_CHARSET<DD><B>Windows 95, 98:</B> Eastern European character set.
<DT>GB2312_CHARSET<DD>GB2312 character set.
<DT>GREEK_CHARSET<DD><B>Windows 95, 98:</B> Greek character set.
<DT>HANGEUL_CHARSET<DD>HANDEUL character set.
<DT>HEBREW_CHARSET<DD><B>Windows NT, 2000:</B> Hebrew character set.
<DT>JOHAB_CHARSET<DD><B>Windows 95, 98:</B> Johab character set.
<DT>MAC_CHARSET<DD><B>Windows 95, 98:</B> Mac character set.
<DT>OEM_CHARSET<DD>Original equipment manufacturer (OEM) character set.
<DT>RUSSIAN_CHARSET<DD><B>Windows 95, 98:</B> Russian character set.
<DT>SHIFTJIS_CHARSET<DD>ShiftJis character set.
<DT>SYMBOL_CHARSET<DD>Symbol character set.
<DT>THAI_CHARSET<DD><B>Windows NT, 2000:</B> Thai character set.
<DT>TURKISH_CHARSET<DD><B>Windows 95, 98:</B> Turkish character set.
</DL>
<DT><VAR>fdwOutPrecision</VAR><DD>Exactly one of the following flags specifying the desired precision (closeness of the match) between the logical font ideally described by the structure and the actual logical font.  This value is used by the font mapper to produce the logical font.
<DL>
<DT>OUT_DEFAULT_PRECIS<DD>The default font mapping behavior.
<DT>OUT_DEVICE_PRECIS<DD>Choose a device font if there are multiple fonts in the system with the same name.
<DT>OUT_OUTLINE_PRECIS<DD><B>Windows NT, 2000:</B> Choose a TrueType or other outline-based font.
<DT>OUT_RASTER_PRECIS<DD>Choose a raster font if there are multiple fonts in the system with the same name.
<DT>OUT_STRING_PRECIS<DD>Raster font (used for enumeration only).
<DT>OUT_STROKE_PRECIS<DD><B>Windows 95, 98:</B> Vector font (used for enumeration only).  <B>Windows NT, 2000:</B> TrueType, outline-based, or vector font (used for enumeration only).
<DT>OUT_TT_ONLY_PRECIS<DD>Choose only a TrueType font.
<DT>OUT_TT_PRECIS<DD>Choose a TrueType font if there are multiple fonts in the system with the same name.
</DL>
<DT><VAR>fdwClipPrecision</VAR><DD>Exactly one of the following flags specifying the clipping precision to use when the font's characters must be clipped:
<DL>
<DT>CLIP_DEFAULT_PRECIS<DD>The default clipping behavior.
<DT>CLIP_EMBEDDED<DD>This flag must be set for an embedded read-only font.
<DT>CLIP_LH_ANGLES<DD>The direction of any rotations is determined by the coordinate system (or else all rotations are counterclockwise).
<DT>CLIP_STROKE_PRECIS<DD>Raster, vector, or TrueType font (used for enumeration only).
</DL>
<DT><VAR>fdwQuality</VAR><DD>Exactly one of the following flags specifying the output quality of the logical font as compared to the ideal font:
<DL>
<DT>ANTIALIASED_QUALITY<DD><B>Windows 95, 98, NT 4.0 or later, 2000:</B> The font is always antialiased if possible.
<DT>DEFAULT_QUALITY<DD>The default quality: the appearance of the font does not matter.
<DT>DRAFT_QUALITY<DD>The appearance of the font is less important then in PROOF_QUALITY.
<DT>NONANTIALIASED_QUALITY<DD><B>Windows 95, 98, NT 4.0 or later, 2000:</B> The font is never antialiased.
<DT>PROOF_QUALITY<DD>The quality of the appearance of the font is more important than exactly matching the specified font attributes.
</DL>
<DT><VAR>fdwPitchAndFamily</VAR><DD>A bitwise OR combination of exactly one *_PITCH flag specifying the pitch of the font and exactly one FF_* flag specifying the font face family of the font:
<DL>
<DT>DEFAULT_PITCH<DD>The default pitch.
<DT>FIXED_PITCH<DD>Fixed pitch.
<DT>VARIABLE_PITCH<DD>Variable pitch.
<DT>FF_DECORATIVE<DD>Showy, decorative font face.
<DT>FF_DONTCARE<DD>Do not care about the font face.
<DT>FF_MODERN<DD>Modern font face (monospaced, sans serif font).
<DT>FF_ROMAN<DD>Roman font face (proportional-width, serif font).
<DT>FF_SCRIPT<DD>Script font face which imitates script handwriting.
<DT>FF_SWISS<DD>Swiss font face (proportional-width, sans serif font).
</DL>
<DT><VAR>lpszFace</VAR><DD>The name of the font face to use.
</DL></P>

<H2>Constant Definitions</H2>
<P><PRE><CODE class="const">Const FW_DONTCARE = 0
Const FW_THIN = 100
Const FW_EXTRALIGHT = 200
Const FW_ULTRALIGHT = 200
Const FW_LIGHT = 300
Const FW_NORMAL = 400
Const FW_REGULAR = 400
Const FW_MEDIUM = 500
Const FW_SEMIBOLD = 600
Const FW_DEMIBOLD = 600
Const FW_BOLD = 700
Const FW_EXTRABOLD = 800
Const FW_ULTRABOLD = 800
Const FW_HEAVY = 900
Const FW_BLACK = 900
Const ANSI_CHARSET = 0
Const ARABIC_CHARSET = 178
Const BALTIC_CHARSET = 186
Const CHINESEBIG5_CHARSET = 136
Const DEFAULT_CHARSET = 1
Const EASTEUROPE_CHARSET = 238
Const GB2312_CHARSET = 134
Const GREEK_CHARSET = 161
Const HANGEUL_CHARSET = 129
Const HEBREW_CHARSET = 177
Const JOHAB_CHARSET = 130
Const MAC_CHARSET = 77
Const OEM_CHARSET = 255
Const RUSSIAN_CHARSET = 204
Const SHIFTJIS_CHARSET = 128
Const SYMBOL_CHARSET = 2
Const THAI_CHARSET = 222
Const TURKISH_CHARSET = 162
Const OUT_DEFAULT_PRECIS = 0
Const OUT_DEVICE_PRECIS = 5
Const OUT_OUTLINE_PRECIS = 8
Const OUT_RASTER_PRECIS = 6
Const OUT_STRING_PRECIS = 1
Const OUT_STROKE_PRECIS = 3
Const OUT_TT_ONLY_PRECIS = 7
Const OUT_TT_PRECIS = 4
Const CLIP_DEFAULT_PRECIS = 0
Const CLIP_EMBEDDED = 128
Const CLIP_LH_ANGLES = 16
Const CLIP_STROKE_PRECIS = 2
Const ANTIALIASED_QUALITY = 4
Const DEFAULT_QUALITY = 0
Const DRAFT_QUALITY = 1
Const NONANTIALIASED_QUALITY = 3
Const PROOF_QUALITY = 2
Const DEFAULT_PITCH = 0
Const FIXED_PITCH = 1
Const VARIABLE_PITCH = 2
Const FF_DECORATIVE = 80
Const FF_DONTCARE = 0
Const FF_ROMAN = 16
Const FF_SCRIPT = 64
Const FF_SWISS = 32</CODE></PRE></P>

<H2>Example</H2>
<P><PRE><CODE class="example"><SPAN class="com">' This code is licensed according to the terms and conditions listed <A href="copyrite.html#license" tppabs="http://www.vbapi.com/copyrite.html#license" rel="copyright">here</A>.</SPAN>

' Draw the alphabet in the upper-left corner of window Form1 using
' the goofy Symbol font.
Dim hFont As Long  ' handle to the Symbol font which is created
Dim hOldFont As Long  ' handle to the font previously selected by Form1
Dim retval As Long  ' return value

' Create a font object using the Symbol font.  Only apply boldface
' formatting to the font -- use defaults for most other settings.
hFont = <B>CreateFont</B>(0, 0, 0, 0, FW_BOLD, 0, 0, 0, SYMBOL_CHARSET, OUT_DEFAULT_PRECIS, CLIP_DEFAULT_PRECIS, DEFAULT_QUALITY, DEFAULT_PITCH Or FF_DECORATIVE, "Symbol")

' Select that font for use with Form1, saving the previous selection.
hOldFont = <A href="selectobject.html" tppabs="http://www.vbapi.com/ref/s/selectobject.html">SelectObject</A>(Form1.hDC, hFont)
' Draw the alphabet near the upper-left corner.
retval = <A href="textout.html" tppabs="http://www.vbapi.com/ref/t/textout.html">TextOut</A>(Form1.hDC, 10, 10, "ABCDEFGHIJKLMNOPQRSTUVWXYZ", 26)

' Select the previous font back.
retval = <A href="selectobject.html" tppabs="http://www.vbapi.com/ref/s/selectobject.html">SelectObject</A>(Form1.hDC, hOldFont)
' Delete the font we created to free up resources.
retval = <A href="deleteobject.html" tppabs="http://www.vbapi.com/ref/d/deleteobject.html">DeleteObject</A>(hFont)</CODE></PRE></P>

<H2>See Also</H2>
<P><A href="createfontindirect.html" tppabs="http://www.vbapi.com/ref/c/createfontindirect.html">CreateFontIndirect</A></P>

<H2>Category</H2>
<P><A href="funcc.html#fontstext" tppabs="http://www.vbapi.com/ref/funcc.html#fontstext">Fonts &amp; Text</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P><B>Last Modified:</B> October 13, 1999<BR>
This page is copyright &copy; 1999 Paul Kuliniewicz.  
<A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information</A>  <B>Revised October 29, 2000</B><BR>

<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="createfont.html" tppabs="http://www.vbapi.com/ref/c/createfont.html">http://www.vbapi.com/ref/c/createfont.html</A>
</P>
</BODY>
</HTML>