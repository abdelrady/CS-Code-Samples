<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML lang="en-us">
<HEAD>
<TITLE>Windows API Guide: joyGetNumDevs Function</TITLE>
<META content="vbapi@vbapi.com" name="author">
<META content="Information about the joyGetNumDevs function in the Windows API, geared towards the Visual Basic user." name="description">
<META content="Kuliniewicz,Windows,Windows 95,Windows NT,Windows 98,Windows 32s,32s,API,Application Programming Interface,Programming,Visual Basic,Basic,VB,joyGetNumDevs" name="keywords">
<META content="Omicron HTML Editor" name="generator">
<LINK href="default.css" tppabs="http://www.vbapi.com/css/default.css" rel="stylesheet" type="text/css">
<LINK href="index-1.html" tppabs="http://www.vbapi.com/index.html" rel="home">
</HEAD>
<BODY>

<!-- Begin Adslot1 -->
<CENTER>
<SCRIPT language="JAVASCRIPT">
<!-- hide from older browsers
now = new Date();
my_random = now.getTime();
document.write('<A href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/VBWorldnet/VBAPI/' + my_random + '">');
document.write('<IMG width="468" height="60" border="1" src="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/VBWorldnet/VBAPI/' + my_random + '"></A>');
// -->
</SCRIPT>
</CENTER>
<!-- End Adslot1 -->

<HR>

<H1>joyGetNumDevs Function</H1>

<P><CODE class="declare">Declare Function joyGetNumDevs Lib "winmm.dll" () As Long</CODE>

<P><B>Platforms:</B> Win 95/98

<P><B>joyGetNumDevs</B> returns the number of joysticks that are configured under Windows's Control Panel.  This doesn't necessarily mean that all of them are connected and in working order, but there could be.  The best way to see if a joystick is working is to call <A href="joygetdevcaps.html" tppabs="http://www.vbapi.com/ref/j/joygetdevcaps.html">joyGetDevCaps</A> and check for a return value of 0.

<P><B>Example:</B>
<PRE><CODE class="example">' Determine the number of configured joysticks and the number of
' connected joysticks.  To see if a joystick is connected, try to read information from it and see if
' the attempt is successful or not.
Dim joyinfo As <A href="joycaps.html" tppabs="http://www.vbapi.com/ref/j/joycaps.html">JOYCAPS</A>  ' needed for the function call to see if a joystick works
Dim numjoys As Long  ' receives number of configured joysticks
Dim numexist As Long  ' number of existing joysticks hooked up to the computer
Dim c As Integer  ' counter variable
Dim retval As Long  ' return value for other functions

numjoys = <B>joyGetNumDevs</B>()  ' determine the number of configured joysticks
Debug.Print "There are"; numjoys; "joysticks configured under Windows."
numexist = 0  ' initialize the number of existing joysticks
For c = 0 To numjoys - 1  ' check each joystick (remember Joystick #1's ID = 0, etc.)
  retval = <A href="joygetdevcaps.html" tppabs="http://www.vbapi.com/ref/j/joygetdevcaps.html">joyGetDevCaps</A>(c, joyinfo, Len(joyinfo))  ' try to read information
  If retval = 0 Then numexist = numexist + 1  ' increment counter if the joystick is connected
Next c
Debug.Print "There are"; numexist; "joysticks currently connected to the computer."</CODE></PRE>

<P><B>Category:</B> <A href="index.html#joysticks" tppabs="http://www.vbapi.com/ref/index.html#joysticks">Joysticks</A></P>

<P><A href="funca.html" tppabs="http://www.vbapi.com/ref/funca.html">Go back to the alphabetical Function listing.</A><BR>
<A href="index.html" tppabs="http://www.vbapi.com/ref/index.html">Go back to the Reference section index.</A></P>

<HR>

<P>This page is copyright &copy; 2000 Paul Kuliniewicz.  <A href="copyrite.html" tppabs="http://www.vbapi.com/copyrite.html" rel="copyright">Copyright Information.</A><BR>
<A href="index-1.html" tppabs="http://www.vbapi.com/index.html">Go back to the Windows API Guide home page.</A><BR>
E-mail: <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html'" tppabs="http://www.vbapi.com/email.html">vbapi@vbapi.com</A>  <A href="javascript:if(confirm('http://www.vbapi.com/email.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.vbapi.com/email.html#secure'" tppabs="http://www.vbapi.com/email.html#secure">Send Encrypted E-Mail</A><BR>
This page is at <A href="joygetnumdevs.html" tppabs="http://www.vbapi.com/ref/j/joygetnumdevs.html">http://www.vbapi.com/ref/j/joygetnumdevs.html</A>

</BODY>
</HTML>