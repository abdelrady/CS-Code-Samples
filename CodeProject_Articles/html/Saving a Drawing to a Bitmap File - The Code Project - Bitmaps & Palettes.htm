<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0052)http://www.codeproject.com/bitmap/drawing2bitmap.asp -->
<HTML><HEAD><TITLE>Saving a Drawing to a Bitmap File - The Code Project - Bitmaps & Palettes</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<META content=en-US name=MS.LOCALE>
<META content="A simple way to save a drawing to a bitmap file." 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="Frank Ekpar" name=Author>
<META content="22 Dec 2004 14:56:00 GMT" name=Search.PublishDate>
<META content="18 Jan 2005 14:21:00 GMT" name=Search.RevisedDate><!--<meta name="Search.UserRating"  content="86 %" /> -->
<META 
content="Free source code, Bitmaps &amp; Palettes, Visual C++, MFC, Windows, Drawing, Bitmap, Skin, Image File, Control, Dialog" 
name=keywords>
<META 
content="Article content copyright Frank Ekpar, 2004, everthing else Copyright © CodeProject, 1999-2006, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com><LINK 
href="/favicon.ico" type=image/ico rel=icon><LINK href="/favicon.ico" 
rel="SHORTCUT ICON"><LINK 
href="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/oncopy.js"></SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY oncopy="return copyCode();" text=black vLink=purple aLink=red link=blue 
bgColor=white leftMargin=3 topMargin=3><!-- COPYRIGHT 2006 I/PRO Corporation ALL RIGHTS RESERVED. - Page view auditing -->
<SCRIPT language=JavaScript>
var LSPT="";
LSPT += "?durl=" + escape(document.URL);
LSPT += "&hostname=" + location.hostname;
LSPT += "&url=" + location.pathname;
LSPT += "&query=" + escape(location.search) + escape(location.hash);
LSPT += "&referrer=" + escape(document.referrer);
LSPT += "&browser=" + escape(navigator.appName);
LSPT += "&version=" + escape(navigator.appVersion);
LSPT += "&os=" + escape(navigator.platform);
LSPT += "&xdomain=codeproject.com";
LSPT += "&custid=codeproject";
</SCRIPT>

<SCRIPT language=Javascript>
document.write('<img src=http://'+'content.ipro.com/images/pixel.gif'+LSPT+' height="1" width="1" style="position:absolute; top:0px; left:0px">');
</SCRIPT>
<NOSCRIPT><IMG style="LEFT: 0px; POSITION: absolute; TOP: 0px" height=1 src="" 
width=1> </NOSCRIPT><!-- END I/PRO PAGE TAG -->
<TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <TABLE cellSpacing=1 cellPadding=0 width="100%" bgColor=#ff9900 
        border=0><TBODY>
        <TR>
          <TD vAlign=top><A href="http://www.codeproject.com/"><IMG height=72 
            alt="The Code Project" 
            src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/logo225x72.gif" 
            width=225 border=0></A></TD>
          <TD align=right><SPAN id=AdBanner4>
            <TABLE cellSpacing=0 cellPadding=0>
              <TBODY>
              <TR>
                <TD><A class=AdLink 
                  href="http://www.codeproject.com/script/admentor/ads.asp">View 
                  our advertisers</A></TD>
                <TD align=right><A class=AdLink 
                  href="http://www.codeproject.com/info/mediakit">Advertise with 
                  us</A></TD></TR>
              <TR>
                <TD colSpan=2>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=1806&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FGrid%5F468x60%2Egif&C=False&id=1806&cb=4173886\" alt=\"\" border=0 width=468 height=60></a>");</SCRIPT>
                </TD></TR></TBODY></TABLE></SPAN></TD></TR>
        <TR>
          <TD bgColor=#fbedbb colSpan=2>
            <TABLE cellPadding=3 width="100%" bgColor=#fbedbb border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%"><FONT style="FONT-SIZE: 8pt"><A 
                  href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
                  href="http://www.codeproject.com/?cat=2">MFC / C++</A> 
                  &gt;&gt; <A href="http://www.codeproject.com/bitmap/">Bitmaps 
                  &amp; Palettes</A> &gt;&gt; <A 
                  href="http://www.codeproject.com/bitmap/#Bitmaps">Bitmaps</A></FONT><BR><BR><B><FONT 
                  style="FONT-SIZE: 16pt" size=4>Saving a Drawing to a Bitmap 
                  File</FONT></B><BR><B>By <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?id=1608622">Frank 
                  Ekpar</A> </B><BR><BR><FONT style="FONT-SIZE: 9pt">A simple 
                  way to save a drawing to a bitmap file.&nbsp;</FONT> </TD>
                <TD vAlign=top align=right>
                  <TABLE cellSpacing=0 cellPadding=1 width=200 border=0>
                    <TBODY>
                    <TR vAlign=top>
                      <TD>&nbsp;</TD>
                      <TD class=SmallText>C++ (VC7, VC5, VC6)<BR>Windows 
                        (Win2003, NT4, Win2K, WinXP, Win95, Win98, 
                        WinME)<BR>MFC, Win32, VS (VS5, VS6)<BR>Dev</TD></TR>
                    <TR>
                      <TD>&nbsp;</TD>
                      <TD class=SmallText noWrap>Posted 23 Dec 2004 0:56</TD></TR>
                    <TR>
                      <TD>&nbsp;</TD>
                      <TD class=SmallText>Updated 19 Jan 2005 0:21</TD></TR>
                    <TR vAlign=top>
                      <TD><IMG height=16 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/hlp.gif" 
                        width=16></TD>
                      <TD class=SmallText noWrap><A 
                        href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=1608622">Articles 
                        by this author</A></TD></TR>
                    <TR vAlign=top>
                      <TD></TD>
                      <TD class=SmallText noWrap><B>26,688</B> 
                    views</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE id=tblSiteToolbar cellSpacing=0 cellPadding=1 width="100%" 
            border=0>
              <TBODY>
              <TR>
                <FORM name=Search action=/info/search.asp method=post>
                <TD vAlign=top align=left width="100%">
                  <TABLE cellSpacing=0 cellPadding=1 border=0>
                    <TBODY>
                    <TR vAlign=center>
                      <TD class=smallText><B><FONT 
                        color=white>Search:</FONT></B></TD>
                      <TD class=navbar noWrap><INPUT class=smallText 
                        maxLength=255 size=18 name=target></TD>
                      <TD vAlign=top><SELECT class=smallText name=st> 
                          <OPTION value=kw selected>Articles</OPTION> <OPTION 
                          value=au>Authors</OPTION></SELECT></TD>
                      <TD><INPUT class=formButton type=submit value=Go></TD></TR></TBODY></TABLE></TD></FORM>
                <TD>
                  <DIV id=MenuPos 
                  style="WIDTH: 380px; POSITION: relative; HEIGHT: 20px">
                  <TABLE height=20 cellSpacing=0 cellPadding=2 width=375>
                    <TBODY>
                    <TR>
                      <TD><A class=NavMenuItem 
                        href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                      <TD><A class=NavMenuItem 
                        href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                      <TD><A class=NavMenuItem 
                        href="http://www.codeproject.com/script/comments/forums.asp">Message 
                        Boards</A></TD>
                      <TD><A class=NavMenuItem 
                        href="http://www.codeproject.com/store/">StoreFront</A></TD>
                      <TD><A class=NavMenuItem 
                        href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
            <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

            <SCRIPT 
            src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/cpmenu_var.js" 
            type=text/javascript></SCRIPT>

            <SCRIPT 
            src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/menu10_com.js" 
            type=text/javascript></SCRIPT>
          </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<TABLE cellSpacing=0 cellPadding=1 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD vAlign=top bgColor=#fbedbb rowSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <SCRIPT language=javascript>
function ErrorHandle() {}
window.onerror = ErrorHandle;

function OnNLSubmit(option)
{
	if (option=="up")
		document.subForm.action = "/script/profile/modify.asp?ct=%2Fbitmap%2Fdrawing2bitmap%2Easp";
	else if (option=="in")
		document.subForm.action = "/script/profile/process_logon.asp?ct=%2Fbitmap%2Fdrawing2bitmap%2Easp";
	document.subForm.submit();
	return true;
}
</SCRIPT>

        <TBODY>
        <TR>
          <TD>
            <TABLE cellSpacing=3 cellPadding=0>
              <TBODY>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/support_icon.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.codeproject.com/store/"><B>Ultimate 
                  Combo<BR>MFC tools $449</B></A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/mail.gif" 
                  width=16></TD>
                <TD class=SmallText><A 
                  href="http://www.codeproject.com/script/recommend/form.asp?guid=drawing2bitmap%2Fbitmap12%2F23%2F2004">Send 
                  to a friend</A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD class=InfoBarHeader>My Profile</TD></TR>
              <TR>
                <TD bgColor=black colSpan=2><IMG height=1 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/space.gif" 
                  width=1></TD></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/profile_small.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.codeproject.com/script/profile/modify.asp?ct=/bitmap/drawing2bitmap.asp">My 
                  Settings</A></TD></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/submit_small.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2959938">My 
                  Articles</A></TD></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/bookmarks.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
                  Bookmarks</A></TD></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/logoff_small.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.codeproject.com/script/profile/logoff.asp?ct=/bitmap/drawing2bitmap.asp">Sign 
                  out</A></TD></TR>
              <TR>
                <TD bgColor=black colSpan=2><IMG height=1 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/space.gif" 
                  width=1></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>&nbsp;</TD></TR>
        <TR>
          <TD>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=1779&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FFlexisoft%5F120x600%2EGIF&C=False&id=1779&cb=4173890\" alt=\"\" border=0 width=120 height=600></a>");</SCRIPT>
            <BR></CENTER><BR></TD></TR></TBODY></TABLE></TD>
    <TD width=5 rowSpan=2><IMG height=1 
      src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/space.gif" 
      width=5> </TD>
    <TD align=right width="100%" bgColor=white>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText vAlign=top noWrap>
            <TABLE>
              <TBODY>
              <TR>
                <TD class=smallText bgColor=#ffffff><IMG 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/print.gif" 
                  align=absMiddle> <A 
                  href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?print=true" 
                  target=_print>Print</A></TD>
                <TD class=smallText bgColor=#ffffff><IMG 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/sitebuild_icon.gif" 
                  align=absMiddle><A 
                  href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=drawing2bitmap%2Fbitmap12%2F23%2F2004">Broken 
                  Article?</A></TD>
                <TD class=smallText bgColor=#ffffff><IMG 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/link.gif" 
                  align=absMiddle><A 
                  href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fbitmap%2Fdrawing2bitmap%2Easp&amp;guid=drawing2bitmap%2Fbitmap12%2F23%2F2004">Bookmark</A></TD>
                <TD class=smallText bgColor=#ffffff><IMG 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/mail_small.gif" 
                  align=absMiddle> <A 
                  href="http://www.codeproject.com/bitmap/drawing2bitmap.asp#__comments">Discuss</A></TD></TR></TBODY></TABLE></TD>
          <TD noWrap align=right><A name=__top></A>
            <TABLE>
              <TBODY>
              <TR>
                <TD class=smallText align=right>13 votes for this article.</TD>
                <TD>
                  <TABLE cellSpacing=0 cellPadding=0 border=2>
                    <TBODY>
                    <TR>
                      <TD><IMG height=5 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/red.gif" 
                        width=20 border=0></TD>
                      <TD><IMG height=5 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/red.gif" 
                        width=20 border=0></TD>
                      <TD><IMG height=5 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/red.gif" 
                        width=20 border=0></TD>
                      <TD><IMG height=5 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/red.gif" 
                        width=8 border=0><IMG height=5 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/white.gif" 
                        width=12 border=0></TD>
                      <TD><IMG height=5 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/white.gif" 
                        width=20 border=0></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD class=smallText align=right colSpan=2><A 
                  title="Calculated as rating x Log10(# votes)" 
                  href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                  3.78</A>. Rating: <B>3.39</B> out of 
        5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top width="100%">
      <UL style="MARGIN-RIGHT: 20px; BACKGROUND-COLOR: #eeeeee">
        <LI 
        style="FONT-SIZE: 8pt; LIST-STYLE-IMAGE: url(/images/warning.gif)">You 
        are signed up for one or more <A 
        href="http://www.codeproject.com/script/profile/subscribe.asp">newsletters</A> 
        but unfortunately we are unable to send you emails. Please click <A 
        href="http://www.codeproject.com/script/profile/SendConfirmRequest.asp">here</A> 
        to have an email sent that will allow us to confirm your email 
        address.</LI></UL>
      <DIV id=contentdiv><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/bitmap/drawing2bitmap/drawing2bitmap_demo.zip">Download 
        demo project - 100 Kb</A> 
        <LI><A 
        href="http://www.codeproject.com/bitmap/drawing2bitmap/drawing2bitmap_src.zip">Download 
        source - 15.6 Kb</A> </LI></UL>
      <P><IMG height=431 alt="Sample Image" 
      src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/drawing2bitmap.gif" 
      width=595></P>
      <H2>Introduction</H2>
      <P>We sometimes encounter situations in which we need to save a drawing to 
      a bitmap or other image file formats. For example, if your program edits 
      images by writing text over them or by allowing the user to draw shapes or 
      objects over the images, you might find it convenient to manipulate the 
      images and objects as a single drawing and then save the complete drawing 
      to file.</P>
      <P>This article describes a simple way to save a drawing to a Windows 
      bitmap file. Since the main point of this article is to show how to 
      convert a drawing into an image file, the drawing part of the demo program 
      is quite simple. It allows you to scribble free-hand shapes on a static 
      control within a dialog box. When you are done with the drawing, you click 
      the "Save" button, specify a path name, and then the program saves your 
      entire scribbling to disk as a 24-bit Windows bitmap file.</P>
      <P>A professional application skinning platform we have developed and that 
      is freely downloadable from <A href="http://www.imatronics.com/" 
      target=_blank>here</A> uses some variation of the technique presented in 
      this article to create and edit sophisticated icon images with full 
      alpha-channel transparency support for use in professional application 
      skins.</P>
      <H2>Using the code</H2>
      <P>The demo program is a dialog-based MFC application. All the interesting 
      action takes place in two classes -- the <CODE>CDrawing2BitmapDlg</CODE> 
      class (declared in "<I>Drawing2BitmapDlg.h</I>" and implemented in 
      "<I>Drawing2BitmapDlg.cpp</I>") is the dialog-based application's nerve 
      center while the <CODE>CPath</CODE> class (declared in "<I>Path.h</I>" and 
      implemented in "<I>Path.cpp</I>") represents a drawing segment.</P>
      <H3>Creating the drawing</H3>
      <P>The drawing in the demo program consists of a collection of paths. Each 
      path is an array of serially connected <CODE>CPoint</CODE> objects. When 
      the user clicks the drawing area (represented by a static control), a new 
      path is created. Points are then added to the new path as the user drags 
      the mouse. The current drawing is updated as the user adds points to the 
      current path. Path creation is complete as soon as the user releases the 
      mouse. This process is repeated to add new paths to the drawing.</P>
      <P>The <CODE>CPath</CODE> class encapsulates a segment of a drawing. It is 
      declared in the "<I>Path.h</I>" file and implemented in the 
      "<I>Path.cpp</I>" file. Following is the declaration of the 
      <CODE>CPath</CODE> class.</P><PRE><SPAN class=cpp-comment>//A path is a collection of serailly connected points</SPAN>
<SPAN class=cpp-comment>//The points are stored as CPoint objects in the m_paPointList array</SPAN>
<SPAN class=cpp-keyword>class</SPAN> CPath  
{
<SPAN class=cpp-keyword>public</SPAN>:
    <SPAN class=cpp-comment>//Default constructor. Creates an empty path</SPAN>
    CPath();
    <SPAN class=cpp-comment>//Draws the points in the order in which they were added using the </SPAN>
    <SPAN class=cpp-comment>//currently selected pen or other drawing object</SPAN>
    BOOL Draw(CDC* pDC);
    <SPAN class=cpp-comment>//Adds a new point to the path. Return TRUE if the pPoint input parameter</SPAN>
    <SPAN class=cpp-comment>//is not NULL, FALSE otherweise</SPAN>
    BOOL AddPoint(CPoint* pPoint);
    <SPAN class=cpp-comment>//Retrieves the point at the given index. The index must be greater than</SPAN>
    <SPAN class=cpp-comment>//or equal to zero and less han the current number of points in the path.</SPAN>
    <SPAN class=cpp-comment>//Returns a pointer to the indicated CPoitn object is the index is valid,</SPAN>
    <SPAN class=cpp-comment>//NULL, otherwise</SPAN>
    CPoint* GetPointAt(<SPAN class=cpp-keyword>int</SPAN> nIndex);
    <SPAN class=cpp-comment>//Returns the number of points in this path</SPAN>
    <SPAN class=cpp-keyword>int</SPAN> GetPointCount();
    <SPAN class=cpp-comment>//Default destructor. Deletes the points in this path</SPAN>
    <SPAN class=cpp-keyword>virtual</SPAN> ~CPath();
<SPAN class=cpp-keyword>protected</SPAN>:
    CPtrArray m_paPointList;
};</PRE>
      <P>Within the <CODE>CDrawing2BitmapDlg</CODE> class, path creation takes 
      place in the mouse event message handlers -- <CODE>OnLButtonDown()</CODE>, 
      <CODE>OnMouseMove()</CODE> and <CODE>OnLButtonUp()</CODE>:</P><PRE><SPAN class=cpp-keyword>void</SPAN> CDrawing2BitmapDlg::OnLButtonDown(UINT nFlags, CPoint point) 
{
    <SPAN class=cpp-comment>//See if the mouse is within the drawing surface</SPAN>
    <SPAN class=cpp-keyword>if</SPAN>(m_rDrawingSurface.PtInRect(point) == TRUE)
    {
        <SPAN class=cpp-comment>//Create a new path and add it to our path list</SPAN>
        m_pCurrentPath = <SPAN class=cpp-keyword>new</SPAN> CPath;
        <SPAN class=cpp-keyword>if</SPAN>(m_pCurrentPath != NULL)
        {
            <SPAN class=cpp-comment>//////////////////////////////////////////////////</SPAN>
            m_paPathList.Add(m_pCurrentPath);
            <SPAN class=cpp-comment>//////////////////////////////////////////////////</SPAN>
            m_bIsCreatingPath = TRUE;
            SetCapture();
            CRect rClip;
            DrawingSurface.GetWindowRect(&amp;rClip);
            ClipCursor(&amp;rClip);
        }
    }
    CDialog::OnLButtonDown(nFlags, point);
}


<SPAN class=cpp-keyword>void</SPAN> CDrawing2BitmapDlg::OnMouseMove(UINT nFlags, CPoint point) 
{
    <SPAN class=cpp-keyword>if</SPAN>((m_bIsCreatingPath == TRUE) &amp;&amp; (m_pCurrentPath != NULL))
    {
        <SPAN class=cpp-comment>//Add this point to our current path</SPAN>
        CPoint* pPoint = <SPAN class=cpp-keyword>new</SPAN> CPoint(point);
        <SPAN class=cpp-keyword>if</SPAN>(pPoint != NULL)
        {
            <SPAN class=cpp-comment>//Translate the point to fit within the drawing surface</SPAN>
            pPoint-&gt;Offset(-m_rDrawingSurface.left, -m_rDrawingSurface.top);
            m_pCurrentPath-&gt;AddPoint(pPoint);
        }
        <SPAN class=cpp-comment>//Then update the drawing</SPAN>
        Draw();
    }
    CDialog::OnMouseMove(nFlags, point);
}


<SPAN class=cpp-keyword>void</SPAN> CDrawing2BitmapDlg::OnLButtonUp(UINT nFlags, CPoint point) 
{
    <SPAN class=cpp-keyword>if</SPAN>(m_bIsCreatingPath == TRUE)
    {
        <SPAN class=cpp-comment>//Release the mouse and input focus</SPAN>
        m_bIsCreatingPath = FALSE;
        ReleaseCapture();
        ClipCursor(NULL);
    }
    CDialog::OnLButtonUp(nFlags, point);
}</PRE>
      <H3>Painting the drawing to screen</H3>
      <P>The location of the static control -- <CODE>DrawingSurface</CODE> -- 
      used to represent the drawing area is calculated in the 
      <CODE>OnInitDialog()</CODE> member function of the 
      <CODE>CDrawing2BitmapDlg</CODE> class. In the <CODE>OnInitDialog()</CODE> 
      function implementation, the size of <CODE>DrawingSurface</CODE> control 
      is used to create a bitmap (DIB section) to hold the drawing. Actual 
      drawing of the current collection of paths takes place in the 
      <CODE>Draw()</CODE> member function. First, a memory device context is 
      created. Next, the bitmap that we wish to draw to is selected into the 
      memory device context. Finally, the background color and the current path 
      collection are drawn to the memory device context which is in turn blotted 
      to the static control representing the drawing surface.</P>
      <P>Here is the code that creates the bitmap (in the 
      <CODE>OnInitDialog</CODE> function) and does the actual drawing (in the 
      <CODE>Draw</CODE> function):</P><PRE>BOOL CDrawing2BitmapDlg::OnInitDialog()
{
    CDialog::OnInitDialog();

    <SPAN class=cpp-comment>// Add "About..." menu item to system menu.</SPAN>

    <SPAN class=cpp-comment>// IDM_ABOUTBOX must be in the system command range.</SPAN>
    ASSERT((IDM_ABOUTBOX &amp; <SPAN class=cpp-literal>0xFFF0</SPAN>) == IDM_ABOUTBOX);
    ASSERT(IDM_ABOUTBOX &lt; <SPAN class=cpp-literal>0xF000</SPAN>);

    CMenu* pSysMenu = GetSystemMenu(FALSE);
    <SPAN class=cpp-keyword>if</SPAN> (pSysMenu != NULL)
    {
        CString strAboutMenu;
        strAboutMenu.LoadString(IDS_ABOUTBOX);
        <SPAN class=cpp-keyword>if</SPAN> (!strAboutMenu.IsEmpty())
        {
            pSysMenu-&gt;AppendMenu(MF_SEPARATOR);
            pSysMenu-&gt;AppendMenu(MF_STRING, IDM_ABOUTBOX, strAboutMenu);
        }
    }

    <SPAN class=cpp-comment>// Set the icon for this dialog.  The framework does this automatically</SPAN>
    <SPAN class=cpp-comment>//  when the application's main window is not a dialog</SPAN>
    SetIcon(m_hIcon, TRUE);         <SPAN class=cpp-comment>// Set big icon</SPAN>
    SetIcon(m_hIcon, FALSE);        <SPAN class=cpp-comment>// Set small icon</SPAN>
    <SPAN class=cpp-comment>/////////////////////////////////////////////////////////</SPAN>
    <SPAN class=cpp-comment>//Get the drawing surface and create a corresponding </SPAN>
    <SPAN class=cpp-comment>//bitmap with the same dimensions</SPAN>
    DrawingSurface.GetWindowRect(&amp;m_rDrawingSurface);
    ScreenToClient(&amp;m_rDrawingSurface);
    CDC* pDC = GetDC();
    <SPAN class=cpp-keyword>if</SPAN>(pDC != NULL)
    {
        BMIH.biSize = <SPAN class=cpp-keyword>sizeof</SPAN>(BITMAPINFOHEADER);
        BMIH.biBitCount = <SPAN class=cpp-literal>24</SPAN>;
        BMIH.biPlanes = <SPAN class=cpp-literal>1</SPAN>;
        BMIH.biCompression = BI_RGB;
        BMIH.biWidth = m_rDrawingSurface.Width();
        BMIH.biHeight = m_rDrawingSurface.Height();
        BMIH.biSizeImage = ((((BMIH.biWidth * BMIH.biBitCount) 
                           + <SPAN class=cpp-literal>31</SPAN>) &amp; ~<SPAN class=cpp-literal>31</SPAN>) &gt;&gt; <SPAN class=cpp-literal>3</SPAN>) * BMIH.biHeight;
        m_hDrawingSurface = CreateDIBSection(pDC-&gt;GetSafeHdc(), 
                 (CONST BITMAPINFO*)&amp;BMIH, DIB_RGB_COLORS, 
                 (<SPAN class=cpp-keyword>void</SPAN>**)&amp;m_pDrawingSurfaceBits, NULL, <SPAN class=cpp-literal>0</SPAN>);
        ReleaseDC(pDC);
    }
    <SPAN class=cpp-comment>////////////////////////////////////////////////////////</SPAN>
    <SPAN class=cpp-keyword>if</SPAN>((m_hDrawingSurface == NULL) || 
       (m_pDrawingSurfaceBits == NULL))
    {
        <SPAN class=cpp-comment>//We could not create the bitmap -- quit</SPAN>
        AfxMessageBox(IDS_BITMAP_NOT_CREATED_ERROR_MESSAGE, 
                                      MB_OK | MB_ICONSTOP);
        PostQuitMessage(<SPAN class=cpp-literal>0</SPAN>);
    }
    <SPAN class=cpp-comment>////////////////////////////////////////////////////////</SPAN>
    <SPAN class=cpp-keyword>return</SPAN> TRUE;
    <SPAN class=cpp-comment>// return TRUE  unless you set the focus to a control</SPAN>
}


<SPAN class=cpp-keyword>void</SPAN> CDrawing2BitmapDlg::Draw()
{
    CDC* pDC = GetDC();
    <SPAN class=cpp-keyword>if</SPAN>(pDC != NULL)
    {
        CDC dcMem;
        <SPAN class=cpp-comment>//Create a memory dc and select the drawing surface into it</SPAN>
        <SPAN class=cpp-keyword>if</SPAN>(dcMem.CreateCompatibleDC(pDC) == TRUE)
        {
            HBITMAP hOldBitmap = 
              (HBITMAP)SelectObject(dcMem.GetSafeHdc(), 
              m_hDrawingSurface);
            <SPAN class=cpp-comment>/////////////////////////////////////////////</SPAN>
            <SPAN class=cpp-comment>//Once out drawing surface has been selected </SPAN>
            <SPAN class=cpp-comment>//into the memory dc, we can draw anything </SPAN>
            <SPAN class=cpp-comment>//and have it all nicely collected </SPAN>
            <SPAN class=cpp-comment>//in our bitmap for future use</SPAN>
            <SPAN class=cpp-comment>//Fill up the background</SPAN>
            dcMem.FillSolidRect(<SPAN class=cpp-literal>0</SPAN>, <SPAN class=cpp-literal>0</SPAN>, m_rDrawingSurface.Width(), 
                   m_rDrawingSurface.Height(), m_crBackgroundColor);
            <SPAN class=cpp-comment>//Now create and select the pen into </SPAN>
            <SPAN class=cpp-comment>//the memory dc, extract the paths and draw them</SPAN>
            CPen ThePen(m_nPenStyle, m_nPenWidth, m_crPenColor);
            CPen* pOldPen = dcMem.SelectObject(&amp;ThePen);

            <SPAN class=cpp-keyword>int</SPAN> nPathCount = m_paPathList.GetSize();
            <SPAN class=cpp-keyword>for</SPAN>(<SPAN class=cpp-keyword>int</SPAN> i = <SPAN class=cpp-literal>0</SPAN>; i &lt; nPathCount; i++)
            {
                CPath* pPath = (CPath*)m_paPathList.GetAt(i);
                <SPAN class=cpp-keyword>if</SPAN>(pPath != NULL)
                    pPath-&gt;Draw(&amp;dcMem);
            }
            dcMem.SelectObject(pOldPen);
            <SPAN class=cpp-comment>//Now blit our memory drawing to the static control's rectangle</SPAN>
            BOOL bResult = BitBlt(pDC-&gt;GetSafeHdc(), 
                                  m_rDrawingSurface.left,
                                  m_rDrawingSurface.top,
                                  m_rDrawingSurface.Width(),
                                  m_rDrawingSurface.Height(),
                                  dcMem.GetSafeHdc(),
                                  <SPAN class=cpp-literal>0</SPAN>,
                                  <SPAN class=cpp-literal>0</SPAN>,
                                  SRCCOPY);
            <SPAN class=cpp-comment>//And deselect the drawing surface</SPAN>
            SelectObject(dcMem.GetSafeHdc(), hOldBitmap);
            <SPAN class=cpp-comment>//////////////////////////////////////////////////</SPAN>
        }
        ReleaseDC(pDC);
    }
}</PRE>
      <H3>Saving the drawing to a bitmap file</H3>
      <P>When the user clicks the "Save..." button, the <CODE>OnSave</CODE> 
      function is called to have the bitmap representing the drawing saved to a 
      Windows bitmap file. The following source code illustrates:</P><PRE><SPAN class=cpp-keyword>void</SPAN> CDrawing2BitmapDlg::OnSave() 
{
    CString szFilter;
    szFilter.LoadString(IDS_WINDOWS_BITMAP_FILES);
    <SPAN class=cpp-comment>//Display the "Save As" dialog for the user to specify a path name</SPAN>
    CFileDialog dlg(FALSE, DEFAULT_BITMAP_FILE_EXTENSION, 
        DEFAULT_BITMAP_FILE_NAME, OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT, 
        szFilter, NULL);
    <SPAN class=cpp-keyword>if</SPAN>(dlg.DoModal() == IDOK)
    {
        CString szPathName = dlg.GetPathName();
        <SPAN class=cpp-comment>//Create a new file for writing</SPAN>
        FILE *pFile = fopen(szPathName, <SPAN class=cpp-string>"wb"</SPAN>);
        <SPAN class=cpp-keyword>if</SPAN>(pFile == NULL)
        {
            AfxMessageBox(IDS_FILE_CREATE_ERROR_MESSAGE);
            <SPAN class=cpp-keyword>return</SPAN>;
        }
        BITMAPFILEHEADER bmfh;
        <SPAN class=cpp-keyword>int</SPAN> nBitsOffset = <SPAN class=cpp-keyword>sizeof</SPAN>(BITMAPFILEHEADER) + BMIH.biSize; 
        LONG lImageSize = BMIH.biSizeImage;
        LONG lFileSize = nBitsOffset + lImageSize;
        bmfh.bfType = 'B'+('M'&lt;&lt;<SPAN class=cpp-literal>8</SPAN>);
        bmfh.bfOffBits = nBitsOffset;
        bmfh.bfSize = lFileSize;
        bmfh.bfReserved1 = bmfh.bfReserved2 = <SPAN class=cpp-literal>0</SPAN>;
        <SPAN class=cpp-comment>//Write the bitmap file header</SPAN>
        UINT nWrittenFileHeaderSize = fwrite(&amp;bmfh, <SPAN class=cpp-literal>1</SPAN>, 
                     <SPAN class=cpp-keyword>sizeof</SPAN>(BITMAPFILEHEADER), pFile);
        <SPAN class=cpp-comment>//And then the bitmap info header</SPAN>
        UINT nWrittenInfoHeaderSize = fwrite(&amp;BMIH, 
               <SPAN class=cpp-literal>1</SPAN>, <SPAN class=cpp-keyword>sizeof</SPAN>(BITMAPINFOHEADER), pFile);
        <SPAN class=cpp-comment>//Finally, write the image data itself </SPAN>
        <SPAN class=cpp-comment>//-- the data represents our drawing</SPAN>
        UINT nWrittenDIBDataSize = 
             fwrite(m_pDrawingSurfaceBits, <SPAN class=cpp-literal>1</SPAN>, lImageSize, pFile);

        fclose(pFile);
    }
}</PRE>
      <H2>Conclusion</H2>
      <P>The technique described here is a simple way to convert a drawing into 
      a bitmap file. Although a simple collection of paths has been used to 
      illustrate the technique, any drawing could be saved to a bitmap file 
      using this technique.</P>
      <P>Sophisticated results can be obtained by applying this technique to 
      more complex drawings. Cute Skin -- a professional application skinning 
      framework allowing you to generate visually stunning professional 
      applications at the click of a button uses this technique to create full 
      32-bit alpha-channel capable icons. You can download a free trial copy of 
      Cute Skin from <A href="http://www.imatronics.com/" target=_blank>our 
      website</A>.</P><!-- Article Ends --></DIV>
      <H2>Frank Ekpar</H2>
      <TABLE width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText noWrap><BR></TD>
          <TD class=smallText width="100%">
            <P class=smallText>Click <A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=1608622">here</A> 
            to view Frank Ekpar's online profile.</P></TD></TR></TBODY></TABLE><BR>
      <TABLE cellPadding=4 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD width="100%">
            <H2>Other popular articles:</H2>
            <UL>
              <LI><A href="http://www.codeproject.com/bitmap/DFB_vs_DIB.asp">DFB 
              vs. DIB</A><BR><SPAN class=smalltext>The difference between DFB 
              and DIB.</SPAN>
              <LI><A 
              href="http://www.codeproject.com/bitmap/specialfx.asp">Really cool 
              visual FX</A><BR><SPAN class=smalltext>A set of classes for doing 
              stunning visual effects, including water, plasma and fire.</SPAN>
              <LI><A 
              href="http://www.codeproject.com/bitmap/pjaimage.asp">CPJAImage - 
              Yet another image drawing class</A><BR><SPAN class=smalltext>A 
              class that draws an image with various options - transparently, 
              disabled or grayscale, centered on or stretched to fit a given 
              rectangle.</SPAN>
              <LI><A 
              href="http://www.codeproject.com/bitmap/cximage.asp">CxImage</A><BR><SPAN 
              class=smalltext>CxImage is a C++ class to load, save, display, 
              transform BMP, JPEG, GIF, PNG, TIFF, MNG, ICO, PCX, TGA, WMF, 
              WBMP, JBG, J2K images.</SPAN></LI></UL></TD>
          <TD width=360>
            <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=786&cb=4173891\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</SCRIPT>
          </TD></TR></TBODY></TABLE>
      <FORM action=/script/rating/code/app/insert_vote.asp method=post><INPUT 
      type=hidden value=drawing2bitmap/bitmap12/23/2004 name=vote_name> <INPUT 
      type=hidden value=/bitmap/drawing2bitmap.asp name=goal> 
      <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
        border=0><TBODY>
        <TR>
          <TD width="100%">
            <TABLE cellSpacing=0 cellPadding=4 width="100%" bgColor=#fbedbb 
            border=0>
              <TBODY>
              <TR>
                <TD class=smalltext vAlign=center>[<A 
                  href="http://www.codeproject.com/bitmap/drawing2bitmap.asp#__top">Top</A>]</TD>
                <TD vAlign=center noWrap align=right><I><B>Rate this Article 
                  for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; <I>Poor</I><INPUT 
                  type=radio value=1 name=rate><INPUT type=radio value=2 
                  name=rate><INPUT type=radio value=3 name=rate><INPUT 
                  type=radio value=4 name=rate><INPUT type=radio value=5 
                  name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=1804&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FGrid%5F120x60%2Egif&C=False&id=1804&cb=4173893\" alt=\"\" border=0 width=120 height=60></a>");</SCRIPT>
            </CENTER><BR></TD>
          <TD vAlign=top noWrap align=middle><SPAN id=AdBanner5>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=1480&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FXoreax%5F468x60%5Fred%2Egif&C=False&id=1480&cb=4173888\" alt=\"Xoreax cuts VS build times by up to 90%\" border=0 width=468 height=60></a>");</SCRIPT>
            </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><A 
name=__comments></A>
<SCRIPT language=JavaScript>
function MsgCategoryForm(MemberID, MsgID, MsgType)
{
	document.write("Rate this message: ");
	document.write("<a href='#xx" + MsgID.toString() + "xx' onclick='CatMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + MsgVoteGood.toString() + ")'>Good " + MsgType + "</a> ");
	document.write("<a href='#xx" + MsgID.toString() + "xx' onclick='CatMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + MsgVoteBad.toString() + ")'>Bad " + MsgType + "</a> ");
	document.write("<a href='#xx" + MsgID.toString() + "xx' onclick='CatMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + MsgVoteWrong.toString() + ")'>Innapropriate / Offtopic</a> ");
	document.write("<a href='#xx" + MsgID.toString() + "xx' onclick='CatMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + MsgVoteOffensive.toString() + ")'>Offensive</a> ");
}
function CatMsg(userid, msgid, Category) 
{ 
	open("/script/comments/vote.asp?js=1&user="+userid.toString()+"&msg="+msgid.toString()+"&score="+Category.toString() ,"helpful","toolbar=no,resizable=yes,scrollbars=yes,directories=no,menubar=no,width=300,height=200");
	return false;
}
</SCRIPT>

<SCRIPT language=JavaScript>
function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString() + "' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	document.write(" (out of 5)");
	document.writeln("</span>");
}

// bit is wrapped in a <span> or something with the id of "vote99999" where 99999 is the message ID
function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
            if ( req.responseText.match(/You have already voted/) )
               status.innerHTML = "<b style='color:red'>Sorry, can't vote twice... <img src='/script/images/smiley_wink.gif'></b>";
            else
               status.innerHTML = "<b>Voted: " + score + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status)
      return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

<SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

<DIV id=_MessageBoard onclick=SwitchMessage(event)>
<TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 border=0>
  <TBODY>
  <TR>
    <TD width="100%">
      <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
      bgColor=#ff9900 border=0>
        <FORM 
        action=/script/comments/app/do_filtermessages.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627 
        method=post>
        <TBODY>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" bgColor=white 
            border=0>
              <TBODY>
              <TR bgColor=#fbedbb>
                <TD class=smalltext noWrap><A 
                  href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                  height=16 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/forum_faq.gif" 
                  width=16 align=absMiddle border=0> <B>FAQ</B></A>&nbsp;</TD>
                <TD class=smalltext vAlign=top noWrap align=right>Noise 
                  tolerance <SELECT class=smalltext size=1 name=noise><OPTION 
                    value=1>Very High</OPTION> <OPTION value=2>High</OPTION> 
                    <OPTION value=3 selected>Medium</OPTION> <OPTION 
                    value=4>Low</OPTION> <OPTION value=5>Very 
                  low</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD class=smalltext vAlign=center noWrap align=right 
                  colSpan=2><A 
                  href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=137627"><IMG 
                  height=15 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/forum_search.gif" 
                  width=16 border=0> Search comments</A> &nbsp;</TD>
                <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
              <TR bgColor=#ff9900>
                <TD width="100%">&nbsp;</TD>
                <TD class=smalltext vAlign=top noWrap align=right>View <SELECT 
                  class=smalltext size=1 name=expand><OPTION value=0>Normal 
                    (slow)</OPTION> <OPTION value=2>Preview (slow)</OPTION> 
                    <OPTION value=5 selected>Message View</OPTION> <OPTION 
                    value=6>Topic View</OPTION> <OPTION value=1>Thread 
                    View</OPTION> <OPTION value=3>Expanded (Supporters 
                    only)</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD class=smalltext vAlign=top noWrap>Per page <SELECT 
                  class=smalltext size=1 name=perpage><OPTION 
                    value=10>10</OPTION> <OPTION value=25 selected>25</OPTION> 
                    <OPTION value=50>50</OPTION></SELECT></TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
        <TR bgColor=#fbedbb>
          <TD><A name=xx0xx></A>
            <TABLE cellPadding=2 width="100%" bgColor=#fbedbb border=0>
              <TBODY>
              <TR>
                <TD class=messagetitle><IMG height=16 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/forum_newmsg.gif" 
                  width=16 align=top border=0><A class=HoverLink 
                  title="Add a new message to the discussions" 
                  href="http://www.codeproject.com/script/comments/user_new.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627" 
                  target=_top name=HoverNL><B>New Message</B></A></TD>
                <TD class=messagetitle>Msgs 1 to 8 of 8 (Total: 8) (<A 
                  href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;forumid=137627">Refresh</A>)</TD>
                <TD noWrap align=right><FONT class=messagetitle><SPAN 
                  class=HoverLink>First</SPAN> <SPAN class=HoverLink>Prev</SPAN> 
                  <SPAN class=HoverLink>Next</SPAN> <SPAN 
                  class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
              </FONT></TD></TR></TBODY></TABLE></TD></TR>
        <TR bgColor=white>
          <TD>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=messagetitle width="100%">Subject&nbsp;</TD>
                      <TD class=messagetitle noWrap width=140>Author&nbsp;</TD>
                      <TD style="WIDTH: 9em" noWrap align=right 
                        width=120><FONT 
                    class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1 border=0></TD></TR>
              <TR id=1377765_h0 bgColor=#fef9e7>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx1377765xx></A><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_general.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD class=messagetitle width="100%"><A 
                        class=messagetitle id=DynMessLink 
                        href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;forumid=137627&amp;select=1377765#xx1377765xx" 
                        name=1377765><B>Change Pen features</B></A></TD>
                      <TD vAlign=bottom><A 
                        href="http://www.codeproject.com/script/profile/whos_who.asp?id=2724085"><IMG 
                        title="Click for User Profile" height=15 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/userinfo.gif" 
                        width=14 border=0></A>&nbsp;</TD>
                      <TD noWrap width=140><FONT 
                        class=messagetitle><B>Cauro</B>&nbsp;</FONT></TD>
                      <TD style="WIDTH: 9em" noWrap align=right 
                        width=120><FONT class=messagetitle><B>11:36 20 Feb 
                        '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=1377765_h1 style="DISPLAY: none">
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_blank.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD width="100%" bgColor=#d5eaff>
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Frank,<BR>very nice article!<BR>I would like to 
                                ask you if it's possible to draw a path with a 
                                pen of one colour and the next one with another 
                                colour, so let's say to define for every path a 
                                different colour for the 
                                pen?<BR><BR>Thankfully,<BR>Mauro<BR><BR>P.S.It 
                                it's possible to you, can you answer me at: 
                                <BR>mauro.caule-nonst@st.com 
                                <BR><BR>Mauro<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1377765">Reply</A>][<A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1377765">Email</A>][<A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;tid=1377765&amp;forumid=137627&amp;select=1377765#xx1377765xx">View 
                                Thread</A>][<A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?msg=1377765#xx1377765xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2724085,1377765);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1 border=0></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900><IMG height=1 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1></TD></TR>
              <TR id=1284993_h0 bgColor=#fef9e7>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx1284993xx></A><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_general.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD class=messagetitle width="100%"><A 
                        class=messagetitle id=DynMessLink 
                        href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;forumid=137627&amp;select=1284993#xx1284993xx" 
                        name=1284993><B>Could you explain a little bit on the 
                        image size calculation</B></A></TD>
                      <TD vAlign=bottom><A 
                        href="http://www.codeproject.com/script/profile/whos_who.asp?id=157146"><IMG 
                        title="Click for User Profile" height=15 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/userinfo.gif" 
                        width=14 border=0></A>&nbsp;</TD>
                      <TD noWrap width=140><FONT 
                        class=messagetitle><B>amonlee</B>&nbsp;</FONT></TD>
                      <TD style="WIDTH: 9em" noWrap align=right 
                        width=120><FONT class=messagetitle><B>1:25 20 Nov 
                        '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=1284993_h1 style="DISPLAY: none">
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_blank.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD width="100%" bgColor=#d5eaff>
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hello,<BR><BR>I don't 
                                understand the number you are using on the 
                                calulation of image 
                                size.<BR><BR>((((BMIH.biWidth * BMIH.biBitCount) 
                                + 31) &amp; ~31) &gt;&gt; 3) * 
                                BMIH.biHeight;<BR><BR>why 31 and 3? could you 
                                please explain me this formula?<BR><BR>Thank you 
                                very much.<BR><BR><BR>--------------------<BR>o~ 
                                o~ <BR>o~ o~<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1284993">Reply</A>][<A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1284993">Email</A>][<A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;tid=1284993&amp;forumid=137627&amp;select=1284993#xx1284993xx">View 
                                Thread</A>][<A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?msg=1284993#xx1284993xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(157146,1284993);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1 border=0></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900><IMG height=1 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1></TD></TR>
              <TR id=1250533_h0 bgColor=#fef9e7>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx1250533xx></A><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_general.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD class=messagetitle width="100%"><A 
                        class=messagetitle id=DynMessLink 
                        href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;forumid=137627&amp;select=1250533#xx1250533xx" 
                        name=1250533><B>nWrittenFileHeaderSize 
                      variable</B></A></TD>
                      <TD vAlign=bottom><A 
                        href="http://www.codeproject.com/script/profile/whos_who.asp?id=1740082"><IMG 
                        title="Click for User Profile" height=15 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/userinfo.gif" 
                        width=14 border=0></A>&nbsp;</TD>
                      <TD noWrap width=140><FONT class=messagetitle><B>Alex 
                        Cutovoi</B>&nbsp;</FONT></TD>
                      <TD style="WIDTH: 9em" noWrap align=right 
                        width=120><FONT class=messagetitle><B>12:37 11 Oct 
                        '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=1250533_h1 style="DISPLAY: none">
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_blank.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD width="100%" bgColor=#d5eaff>
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Frank, 
                                i don't understand the reason that did 
                                this:<BR>UINT nWrittenFileHeaderSize = 
                                fwrite(&amp;bmfh, 1, sizeof(BITMAPFILEHEADER), 
                                pFile);<BR><BR>Why you assgin the value in the 
                                "nWrittenFileHeaderSize" variable. Where it's 
                                used and why and the others in their respective 
                                values?<BR><BR><BR>Thanks 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1250533">Reply</A>][<A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1250533">Email</A>][<A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;tid=1250533&amp;forumid=137627&amp;select=1250533#xx1250533xx">View 
                                Thread</A>][<A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?msg=1250533#xx1250533xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1740082,1250533);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1 border=0></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900><IMG height=1 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1></TD></TR>
              <TR id=1166721_h0 bgColor=#fef9e7>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx1166721xx></A><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_general.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD class=messagetitle width="100%"><A 
                        class=messagetitle id=DynMessLink 
                        href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;forumid=137627&amp;select=1166721#xx1166721xx" 
                        name=1166721><B>how to open bitmap file?</B></A></TD>
                      <TD vAlign=bottom><A 
                        href="http://www.codeproject.com/script/profile/whos_who.asp?id=1465936"><IMG 
                        title="Click for User Profile" height=15 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/userinfo.gif" 
                        width=14 border=0></A>&nbsp;</TD>
                      <TD noWrap width=140><FONT 
                        class=messagetitle><B>AgnesChiu</B>&nbsp;</FONT></TD>
                      <TD style="WIDTH: 9em" noWrap align=right 
                        width=120><FONT class=messagetitle><B>23:57 18 Jul 
                        '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=1166721_h1 style="DISPLAY: none">
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_blank.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD width="100%" bgColor=#d5eaff>
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Frank,<BR><BR>Can u guide me how to open bitmap 
                                file in order to modify the bitmap 
                                drawing?<BR><BR>Thank 
                                you<BR><BR>Cheers,<BR>Agnes 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1166721">Reply</A>][<A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1166721">Email</A>][<A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;tid=1166721&amp;forumid=137627&amp;select=1166721#xx1166721xx">View 
                                Thread</A>][<A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?msg=1166721#xx1166721xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1465936,1166721);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=6 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1 border=0></TD></TR>
              <TR id=1308512_h0 bgColor=#fef9e7>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx1308512xx></A><IMG height=1 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/ind.gif" 
                        width=18><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_general.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD class=messagetitle width="100%"><A 
                        class=messagetitle id=DynMessLink 
                        href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;forumid=137627&amp;select=1308512#xx1308512xx" 
                        name=1308512>Re: how to open bitmap file?</A></TD>
                      <TD vAlign=bottom><A 
                        href="http://www.codeproject.com/script/profile/whos_who.asp?id=1416228"><IMG 
                        title="Click for User Profile" height=15 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/userinfo.gif" 
                        width=14 border=0></A>&nbsp;</TD>
                      <TD noWrap width=140><FONT class=messagetitle>fan wei 
                        fang&nbsp;</FONT></TD>
                      <TD style="WIDTH: 9em" noWrap align=right 
                        width=120><FONT class=messagetitle>5:18 16 Dec 
                        '05&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=1308512_h1 style="DISPLAY: none">
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD><IMG height=1 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/ind.gif" 
                        width=18><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_blank.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD width="100%" bgColor=#d5eaff>
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Try 
                                CxImage, dude. Have fun <IMG 
                                src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/smiley_smile.gif" 
                                align=absMiddle> <BR><BR>Then I kiss Ur eyes and 
                                thank God we're 
                                together<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1308512">Reply</A>][<A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1308512">Email</A>][<A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;tid=1166721&amp;forumid=137627&amp;select=1308512#xx1308512xx">View 
                                Thread</A>][<A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?msg=1308512#xx1308512xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1416228,1308512);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1 border=0></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900><IMG height=1 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1></TD></TR>
              <TR id=1040932_h0 bgColor=#fef9e7>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx1040932xx></A><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_general.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD class=messagetitle width="100%"><A 
                        class=messagetitle id=DynMessLink 
                        href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;forumid=137627&amp;select=1040932#xx1040932xx" 
                        name=1040932><B>Drawing in OnPaint()</B></A></TD>
                      <TD vAlign=bottom><A 
                        href="http://www.codeproject.com/script/profile/whos_who.asp?id=1704463"><IMG 
                        title="Click for User Profile" height=15 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/userinfo.gif" 
                        width=14 border=0></A>&nbsp;</TD>
                      <TD noWrap width=140><FONT 
                        class=messagetitle><B>Ash329</B>&nbsp;</FONT></TD>
                      <TD style="WIDTH: 9em" noWrap align=right 
                        width=120><FONT class=messagetitle><B>0:14 17 Feb 
                        '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=1040932_h1 style="DISPLAY: none">
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_blank.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD width="100%" bgColor=#d5eaff>
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Frank,<BR>Nice article.<IMG 
                                src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/rose.gif" 
                                align=absMiddle><BR>Can u plz guide me about 
                                what to do if the drawing is done in OnPaint() 
                                method of a dialog, through the methods like 
                                LineTo(), Arc(), Ellipse(), TextOut() 
                                etc.<BR><BR>How can we modify this code to 
                                handle those sort of 
                                things?<BR><BR>Thankfully,<BR><BR>Ash329 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1040932">Reply</A>][<A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1040932">Email</A>][<A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;tid=1040932&amp;forumid=137627&amp;select=1040932#xx1040932xx">View 
                                Thread</A>][<A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?msg=1040932#xx1040932xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(1704463,1040932);</SCRIPT>
                                 
                    </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1 border=0></TD></TR>
              <TR height=1>
                <TD bgColor=#ff9900><IMG height=1 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1></TD></TR>
              <TR id=1015865_h0 bgColor=#fef9e7>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx1015865xx></A><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_general.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD class=messagetitle style="COLOR: #aa0000" 
                        width="100%"><A class=messagetitle id=DynMessLink 
                        style="COLOR: #aa0000" 
                        href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;forumid=137627&amp;select=1015865#xx1015865xx" 
                        name=1015865><B>bug</B></A></TD>
                      <TD vAlign=bottom><A 
                        href="http://www.codeproject.com/script/profile/whos_who.asp?id=78972"><IMG 
                        title="Click for User Profile" height=15 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/userinfo.gif" 
                        width=14 border=0></A>&nbsp;</TD>
                      <TD noWrap width=140><FONT class=messagetitle 
                        style="COLOR: #aa0000"><B>F5Tiger</B>&nbsp;</FONT></TD>
                      <TD style="WIDTH: 9em" noWrap align=right 
                        width=120><FONT class=messagetitle 
                        style="COLOR: #aa0000"><B>9:19 14 Jan 
                        '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=1015865_h1 style="DISPLAY: none">
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_blank.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD width="100%" bgColor=#d5eaff>
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>There 
                                is a little bug: if you click (down and up) with 
                                no mouse moving, then you click-down and move 
                                the mouse, the application crashes.<BR>Solution: 
                                add this check to the CPath::Draw method 
                                :<BR>if( m_paPointList.GetSize() &lt;= 0 ) 
                                <BR>return FALSE;<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1015865">Reply</A>][<A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1015865">Email</A>][<A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;tid=1015865&amp;forumid=137627&amp;select=1015865#xx1015865xx">View 
                                Thread</A>][<A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?msg=1015865#xx1015865xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(78972,1015865);</SCRIPT>
                                 
                    </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=6 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1 border=0></TD></TR>
              <TR id=1019182_h0 bgColor=#fef9e7>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD bgColor=white><A name=xx1019182xx></A><IMG height=1 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/ind.gif" 
                        width=18><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_general.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD class=messagetitle width="100%"><A 
                        class=messagetitle id=DynMessLink 
                        href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;forumid=137627&amp;select=1019182#xx1019182xx" 
                        name=1019182>Re: bug</A></TD>
                      <TD vAlign=bottom><A 
                        href="http://www.codeproject.com/script/profile/whos_who.asp?id=740344"><IMG 
                        title="Click for User Profile" height=15 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/userinfo.gif" 
                        width=14 border=0></A>&nbsp;</TD>
                      <TD noWrap width=140><FONT 
                        class=messagetitle>Code@Imatronics&nbsp;</FONT></TD>
                      <TD style="WIDTH: 9em" noWrap align=right 
                        width=120><FONT class=messagetitle>3:57 19 Jan 
                        '05&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=1019182_h1 style="DISPLAY: none">
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD><IMG height=1 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/ind.gif" 
                        width=18><IMG 
                        src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_blank.gif" 
                        align=absMiddle>&nbsp;</TD>
                      <TD width="100%" bgColor=#d5eaff>
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                F5Tiger,<BR><BR>Thanks a lot for pointing out 
                                the bug. <BR><BR>I have fixed the bug and 
                                updated the source code and demo project. 
                                <BR><BR>You can now download the corrected 
                                source code and demo project using the links at 
                                the beginning of this article.<BR><BR>Many 
                                thanks.<BR><BR>Frank.<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1019182">Reply</A>][<A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/bitmap/drawing2bitmap.asp&amp;df=100&amp;forumid=137627&amp;select=1019182">Email</A>][<A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?df=100&amp;tid=1015865&amp;forumid=137627&amp;select=1019182#xx1019182xx">View 
                                Thread</A>][<A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/bitmap/drawing2bitmap.asp?msg=1019182#xx1019182xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 1.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(740344,1019182);</SCRIPT>
                                 
                    </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 
                  src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/t.gif" 
                  width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR bgColor=#fbedbb>
          <TD>
            <TABLE cellPadding=2 width="100%">
              <TBODY>
              <TR>
                <TD class=messagetitle>Last Visit: 10:35 Sunday 4th June, 
                2006</TD>
                <TD noWrap align=right><FONT class=messagetitle><SPAN 
                  class=HoverLink>First</SPAN> <SPAN class=HoverLink>Prev</SPAN> 
                  <SPAN class=HoverLink>Next</SPAN> <SPAN 
                  class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
<P class=smallText><IMG 
src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_general.gif" 
align=absMiddle> General comment &nbsp;&nbsp; <IMG 
src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_info.gif" 
align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_question.gif" 
align=absMiddle> Question &nbsp;&nbsp; <IMG 
src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_answer.gif" 
align=absMiddle> Answer &nbsp;&nbsp; <IMG 
src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_game.gif" 
align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/news_sticky.gif" 
align=absMiddle> Admin message</P><BR>
<TABLE cellSpacing=5 width="100%">
  <TBODY>
  <TR vAlign=top>
    <TD><FONT style="FONT-SIZE: 7pt" size=1><A 
      href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
      href="http://www.codeproject.com/?cat=2">MFC / C++</A> &gt;&gt; <A 
      href="http://www.codeproject.com/bitmap/">Bitmaps &amp; Palettes</A> 
      &gt;&gt; <A href="http://www.codeproject.com/bitmap/#Bitmaps">Bitmaps</A> 
      <BR>Updated: 19 Jan 2005 0:21 </FONT></TD>
    <TD align=right><FONT style="FONT-SIZE: 7pt" size=1>Article content 
      copyright Frank Ekpar, 2004<BR>everything else Copyright © <A 
      href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2006</A>. 
      <BR>Web13 | <A href="http://www.codeproject.com/info/MediaKit">Advertise 
      on The Code Project</A> | <A 
      href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
  </FONT></TD></TR></TBODY></TABLE><BR>
<CENTER>
<TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
  <TBODY>
  <TR>
    <TD bgColor=#ff9900 height=1><IMG height=1 
      src="Saving a Drawing to a Bitmap File - The Code Project - Bitmaps &amp; Palettes_files/space.gif"></TD></TR>
  <TR>
    <TD align=middle><FONT size=1><A 
      href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  <A 
      href="http://www.aspalliance.com/">ASP Alliance</A>  <A 
      href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
      href="http://www.developersdex.com/">Developersdex</A>  <A 
      href="http://www.devguru.com/">DevGuru</A>  <A 
      href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
      href="http://www.planet-source-code.com/">Planet Source Code</A>  <A 
      href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
</FONT></TD></TR></TBODY></TABLE></CENTER></BODY></HTML>
