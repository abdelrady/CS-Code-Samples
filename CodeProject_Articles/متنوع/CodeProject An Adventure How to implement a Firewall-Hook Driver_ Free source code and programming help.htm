<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0047)http://www.codeproject.com/KB/IP/FwHookDrv.aspx -->
<HTML><HEAD><TITLE>CodeProject: An Adventure: How to implement a Firewall-Hook Driver?. Free source code and programming help</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="Firewall-Hook driver is a completely unknown method to develop simple packet filtering applications. With this article, I want to tell you how this driver works and what you need to do to use it in your applications.; Author: Jess O.; Section: Internet / Network; Chapter: General Programming" 
name=Description>
<META 
content="VC6, Win2K, WinXP, Win2003, VS6, C, MFC, Dev, Beginner,Internet / Network,General Programming,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("www.codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if(top!=self)top.location.href=location.href; if(typeof(DemoUrl)!="undefined")document.write(unescape('%3Cme')+'ta http'+'-equiv="re' +'fresh" con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/apiresults.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/JobsSummaryRetriever.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/jquery-1.2.6.min.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/jxs.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/rateitem.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/bookmark.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function MarkAns(MemberID,MsgID,QID) {
 document.write(unescape("%3Cdiv class=\"CallOut\"%3E"));
 document.write("Was this a good answer to your question? ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+", "+MsgID.toString()+",6,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"correct\" border=\"0\" align=\"absmiddle\" /%3E Yes%3C/a%3E"));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+","+MsgID.toString()+",7,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"correct\" style=\"margin-left:10px\" border=\"0\" align=\"absmiddle\" /%3E No%3C/a%3E"));
 document.write(unescape("%3C/div%3E"));
}
function MsgVFrm(MemberID,MsgID,GB,gp,bp,mt){
 if(!GB)document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"5":"1")+unescape(",0);\"%3E"));
 if(GB) document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;"); else for(var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"vote this message a " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ",0)\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"1":"5")+unescape(",0);\"%3E"));
 if(GB)document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" border=\"0\" alt=\"vote 5\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;&nbsp; "); else document.write(unescape("%3Cbr /%3E")); document.writeln(unescape("[%3Ca href='#xx") + MsgID.toString() +"xx' title='Report as Abuse' onclick='return ReportMsg(" + MemberID.toString());
 document.writeln(", " + MsgID.toString() + unescape(",-2)'%3EReport Message%3C/a%3E]"));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?"))
  return RateMsg(userid, msgid, score, 0);
 else return false;
}
function RateMsg(memberid, msgid, score, questionId) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4){
   if (req.status == 200){
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match&&match[1])?match[1]:"An error occured" + unescape("%3C/b%3E");
   } else
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString()+"&qid="+questionId.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK 
href="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/ForumClassicIE6.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" type=image/ico rel="shortcut icon">
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            id=ctl00_Logo 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; WIDTH: 225px; HEIGHT: 90px; BORDER-RIGHT-WIDTH: 0px" 
            alt="The Code Project" 
            src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/logo225x90.gif"></A></TD>
          <TD class=HeaderBanner align=right width="100%">
            <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d8228%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252fsoftlayer_CP_1110_728x90.gif%26C%3dFalse%26adid%3d8228%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22728%22%20height%3d%2290%22%3e%3c%2fa%3e"));</SCRIPT>
          </TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">5,644,149 
                  members and growing! (16,295 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">Abdelrady_FCIS</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx">My 
                  Settings</A> | <A id=ctl00_MemberMenu_MyCodeProject 
                  href="http://www.codeproject.com/script/Membership/MyCodeProject.aspx"><B>My 
                  CodeProject</B></A> | <A id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/fave.gif" 
                  width=16 align=absMiddle border=0> My Bookmarks</A> | <A 
                  id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2fIP%2fFwHookDrv.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD noWrap><A href="http://www.codeproject.com/">Home</A></TD>
                <TD>&nbsp; </TD>
                <TD style="FONT-WEIGHT: normal" noWrap align=right>Current 
                  Site:</TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/">C++ / .NET</A></TD>
                <TD noWrap><A href="http://java.codeproject.com/">Java</A></TD>
                <TD noWrap><A href="http://sql.codeproject.com/">SQL</A></TD>
                <TD noWrap><A href="http://lamp.codeproject.com/">Linux / 
                  Unix</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus>
                  <DIV id=MenuPos 
                  style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=380>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
                        Board</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
            Programming</A> » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/IP/">Internet / Network</A> » <A 
            id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/IP/index.aspx?#Internet / Network - Proxy / Firewall">Proxy 
            / Firewall</A> <SPAN class=ArticleBeginner 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Beginner</SPAN> <SPAN 
            id=ctl00_ArticleTopHeader_LicenceTerms></SPAN><BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>An Adventure: How to 
            implement a Firewall-Hook Driver?</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=61114">Jess 
            O.</A></B><BR><BR><SPAN class=ArticleTopDescr 
            id=ctl00_ArticleTopHeader_ArticleDescr>Firewall-Hook driver is a 
            completely unknown method to develop simple packet filtering 
            applications. With this article, I want to tell you how this driver 
            works and what you need to do to use it in your applications.</SPAN> 
          </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>C, VC6, C++Windows, 
            Win2K, WinXP, Win2003, MFC, VS6, Visual Studio, 
            Dev</SPAN><BR><BR><SPAN style="WIDTH: 14ex">Posted</SPAN>: <B>28 Oct 
            2004</B><BR><SPAN style="WIDTH: 14ex">Updated</SPAN>: <B>28 Oct 
            2004</B> <BR><SPAN style="WIDTH: 14ex">Views</SPAN>: 
            <B>108,749</B><BR><SPAN style="WIDTH: 14ex">Bookmarked</SPAN>: 
            <B>110 times</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar" 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px">
      <TABLE cellPadding=2>
        <TBODY>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/Info_24.png" 
            width=24></TD>
          <TD><A 
            href="http://www.codeproject.com/script/Awards/Competition.aspx?cid=286">Mobile 
            Developer Contest</A></TD></TR>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/MonthlyComp.png" 
            width=24 align=middle></TD>
          <TD><A id=ctl00_Announcements_CompLink 
            href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
            Competition</A></TD></TR></TBODY></TABLE></DIV><IMG id=ctl00_JobSummary_Li 
      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
      src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/animated_loading_blue.gif" 
      name=Li> 
      <DIV id=ctl00_JobSummary_Th style="DISPLAY: none" name="Th"></DIV>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2 style="DISPLAY: none">
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3 style="DISPLAY: none">
      <DIV class=MI id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4 style="DISPLAY: none">
      <DIV class=MI id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5 style="DISPLAY: none">
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6>
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MIS id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV>
      <DIV class=MI id=Section128><A 
      href="http://www.codeproject.com/KB/testing/">Testing and QA</A></DIV>
      <DIV class=MI id=Section126><A 
      href="http://www.codeproject.com/KB/codegen/">Code 
      Generation</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter12');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=12">Third 
      Party Products</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter12 style="DISPLAY: none">
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section124><A 
      href="http://www.codeproject.com/KB/solution-center/">Solution 
      Center</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
Board</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/kb/Showcase/">Product Showcase</A></DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/WhitePapers">WhitePapers / 
      Webcasts</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/Acresso">InstallShield 
      2009</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/APress">Apress 
      Bookstore</A></DIV><BR>
      <DIV style="MARGIN-BOTTOM: 10px; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d3487%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252fcp_daily_150x80.gif%26C%3dFalse%26adid%3d3487%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22150%22%20height%3d%2280%22%3e%3c%2fa%3e"));</SCRIPT>
      </DIV>
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6677%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252finnovaysys_docX_160x600.gif%26C%3dFalse%26adid%3d6677%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22160%22%20height%3d%22600%22%3e%3c%2fa%3e"));</SCRIPT>
    </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION> <OPTION value=s>Jobs</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top width="100%">
            <TABLE>
              <TBODY></TBODY></TABLE>
            <DIV class=SmallText><IMG style="VERTICAL-ALIGN: middle" height=16 
            alt=print 
            src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/print.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
            href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?display=Print">Print</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Broken Article?" 
            src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/report.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_BrokenLnk 
            href="http://www.codeproject.com/script/Articles/Report.aspx?aid=8675">Report 
            Article</A> &nbsp; <IMG style="VERTICAL-ALIGN: middle" alt=Watch 
            src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/watchon.png"> 
            <A class="" id=ctl00_ArticleHeaderLinks_ArticleBmkWatch_WatchMe 
            onclick="return watchMe(8675, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=8675&amp;obtid=2&amp;bma=AddWatch" 
            name=bmw_8675_2>Watch</A> <SPAN class=TinyText 
            id=ctl00_ArticleHeaderLinks_ArticleBmkWatch_StatusMsg 
            style="VISIBILITY: hidden" name="bmw_8675_2"></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Bookmark 
            src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/link.png" 
            width=16> <A class="" 
            id=ctl00_ArticleHeaderLinks_ArticleBmk_BookmarkMe 
            onclick="return bookmarkMe(8675, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=8675&amp;obtid=2&amp;bma=AddBookmark" 
            name=bm_8675_2>Bookmark</A> <SPAN class=TinyText 
            id=ctl00_ArticleHeaderLinks_ArticleBmk_StatusMsg 
            style="VISIBILITY: hidden" name="bm_8675_2"></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Discuss 
            src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/discuss.gif" 
            width=15> <A 
            href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx#_comments">Discuss</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Recommend Article" 
            src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/mail.gif" 
            width=16>&nbsp;<A id=ctl00_ArticleHeaderLinks_Recommend 
            href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=8675">Send&nbsp;to&nbsp;a&nbsp;friend</A> 
            </DIV></TD>
          <TD style="WIDTH: 100px; WHITE-SPACE: nowrap; TEXT-ALIGN: right">
            <TABLE id=CurRat>
              <TBODY>
              <TR>
                <TD>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=SmallText id=ctl00_ArticleRating_VL 
                      style="WHITE-SPACE: nowrap" align=right><SPAN 
                        id=ctl00_ArticleRating_VoteLabel>52 votes for this 
                        Article.</SPAN></TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=1>
                          <TBODY>
                          <TR>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD noWrap width=20 bgColor=white height=7><IMG 
                              height=7 
                              src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/red.gif" 
                              width=15 align=center 
                        border=0></TD></TR></TBODY></TABLE><SPAN class=SmallText 
                        id=ctl00_ArticleRating_Votes></SPAN></TD></TR>
                    <TR id=ctl00_ArticleRating_PopularityRow>
                      <TD class=SmallText align=right colSpan=2><A 
                        id=ctl00_ArticleRating_PopularityLnk 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                        8.19</A> <SPAN 
                        id=ctl00_ArticleRating_PopularityLbl></SPAN><SPAN 
                        id=ratingVal>Rating: <B>4.77</B> out of 
                    5</SPAN></TD></TR></TBODY></TABLE></TD>
                <TD>
                  <DIV>
                  <TABLE class=HistTable 
                  title="Voting Distribution. Recent data only">
                    <TBODY>
                    <TR>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>1</TD>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>2</TD>
                      <TD><IMG title="2 votes, 3.8%" height=1 
                        alt="2 votes, 3.8%" 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>3</TD>
                      <TD><IMG title="6 votes, 11.5%" height=2 
                        alt="6 votes, 11.5%" 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>4</TD>
                      <TD><IMG title="44 votes, 84.6%" height=20 
                        alt="44 votes, 84.6%" 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/pollcol.gif" 
                        width=10 
              border=0><BR>5</TD></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/IP/FwHookDrv/FwHookDrv_src.zip">Download 
        source files - 103 Kb</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/IP/FwHookDrv/FwHookDrv_bin.zip">Download 
        demo project - 20.5 Kb</A> </LI></UL>
      <P><IMG height=373 alt="Sample Image - FwHookDrv.jpg" src="" 
width=600></P>
      <H2>Introduction</H2>
      <P>Probably, Firewall-Hook driver is one of the most undocumented methods 
      a developer can use to develop packet filtering applications in Windows 
      systems. Microsoft doesn't give any documentation about it, and the only 
      place where you can learn something is in the DDK header files 
      (<I>ipFirewall.h</I>). In fact, when I installed the Windows 2000 DDK, I 
      was very surprised when I found this <I>.h</I> (and its contents!) because 
      no documentation about the existence of Firewall hook could be read. In 
      the next versions of DDK, Microsoft adds a few documentation about it: 
      "this method exists but it is not recommended to implement".</P>
      <P>However, because it's an easy method to implement firewall solutions, I 
      think it is interesting to know how Firewall-Hook drivers work.</P>
      <H2>The Firewall-Hook Driver</H2>
      <P>I don't understand why Microsoft doesn't recommend the development of 
      Firewall-Hook drivers. It's true that I never recommend it when you want 
      to develop a complete firewall solution, but for small applications, it 
      can be a good alternative. Basically, a Firewall-Hook driver can do the 
      same work that a Filter Hook driver can do (see my article<A 
      href="http://www.codeproject.com/internet/drvfltip.asp"> "Developing 
      Firewalls for Windows 2000/XP"</A>, to get more information) but with less 
      restrictions.</P>
      <P>If you remember, Filter-Hook driver only allows one filter function 
      installed in the system. If one application already uses this 
      functionality, your application doesn't work. With Firewall-Hook driver, 
      you don't have this problem. You can install all filter functions you 
      need. Each filter function has a priority assigned, so the system will 
      call one function after another (in priority order) until a function 
      returns "DROP PACKET". If all functions return "ALLOW PACKET", the packet 
      will be allowed. You can imagine it as a chain of filter functions. This 
      chain is broken when one of them returns "DROP PACKET". The order of each 
      function in the chain is given by its priority value.</P>
      <P align=center><IMG height=338 alt="Chained function figure" src="" 
      width=578></P>
      <P>In the figure, I represent the next process:</P>
      <OL>
        <LI>A packet is received in your host. IP driver has the list of filter 
        functions ordered by priority (the function with more priority is Filter 
        Function 1). 
        <LI>First, IP driver passes the packet to the highest priority filter 
        function and waits for the return value. 
        <LI>Filter function 1 returns "ALLOW PACKET". 
        <LI>Because Filter function 1 allows the packet, IP driver passes the 
        packet to the next filter function: Filter function 2. 
        <LI>In this case, Filter function 2 returns "DROP PACKET". So, IP driver 
        drops the packet and does not continue calling the next filter 
        functions. </LI></OL>
      <P>Another problem you can find with Filter-Hook drivers is that for sent 
      packets, you can't access packet content data. However, you can access all 
      data with a Firewall-Hook driver. The structure of data received in a 
      Firewall-Hook filter function is more complex than the one received in 
      Filter-Hook driver. It's more similar to the structure of packets you can 
      find in a NDIS driver, where the total packet is composed by a chain of 
      buffers. But be patient, we can learn more about it later.</P>
      <P>As Filter-Hook driver, Firewall-Hook driver is only a kernel mode 
      driver used to install a callback function (but Firewall-Hook driver 
      installs a callback in IP driver). In fact, the process to install a 
      Firewall-Hook driver is similar to the one used to install a Filter-Hook 
      driver. Inside <I>ipFirewall.h</I> file, you can find the next lines:</P><PRE><SPAN class=code-keyword>typedef</SPAN> <SPAN class=code-keyword>struct</SPAN> _IP_SET_FIREWALL_HOOK_INFO 
{ 
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Packet filter callout. 
</SPAN>    IPPacketFirewallPtr FirewallPtr;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Priority of the hook
</SPAN>    UINT Priority;

       <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if TRUE then ADD else DELETE 
</SPAN>       <SPAN class=code-SDKkeyword>BOOLEAN</SPAN> Add;
} IP_SET_FIREWALL_HOOK_INFO, *PIP_SET_FIREWALL_HOOK_INFO;   
 
<SPAN class=code-preprocessor>#define</SPAN> DD_IP_DEVICE_NAME L\\<A class=code-string href="http://www.codeproject.com/KB/IP/<span">"</SPAN><SPAN class=code-string>file://Ip/"</SPAN>&gt;Device\\Ip</A> 
<SPAN class=code-preprocessor>#define</SPAN> _IP_CTL_CODE(function, method, access) \ 
        CTL_CODE(FSCTL_IP_BASE, function, method, access) 
<SPAN class=code-preprocessor>#define</SPAN> IOCTL_IP_SET_FIREWALL_HOOK \ 
        _IP_CTL_CODE(<SPAN class=code-digit>12</SPAN>, METHOD_BUFFERED, FILE_WRITE_ACCESS)</PRE>
      <P>These lines give you an idea about how to install a callback function. 
      You have only to fill a <CODE>IP_SET_FIREWALL_HOOK_INFO</CODE> structure 
      with the data of your callback function and install it sending the 
      <CODE>IOCTL IOCTL_IP_SET_FIREWALL_HOOK</CODE> to the IP device. Easy, if 
      you have worked with drivers and if you have worked with documented 
      Filter-Hook drivers before. An important parameter about this structure is 
      the field <CODE>Priority</CODE>. Each field contains the priority of the 
      filter function, greater as greater is this value.</P><PRE>PDEVICE_OBJECT ipDeviceObject=NULL; 
IP_SET_FIREWALL_HOOK_INFO filterData; 

<SPAN class=code-comment>//</SPAN><SPAN class=code-comment>..... 
</SPAN>
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Init structure filterData.
</SPAN>FirewallPtr = filterFunction; 
filterData.Priority = <SPAN class=code-digit>1</SPAN>; 
filterData.Add = TRUE; 

<SPAN class=code-comment>//</SPAN><SPAN class=code-comment>.... 
</SPAN>
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Send the commando to ip driver
</SPAN>IoCallDriver(ipDeviceObject, irp);</PRE>
      <P>If you want to uninstall a filter function, you can use the same code 
      but putting <CODE>FALSE</CODE> value into <CODE>filterData.Add</CODE>.</P>
      <H2>The Filter Function</H2>
      <P>The filter function for a Firewall-Hook driver is more complex than 
      that used in Filter-Hook drivers. Therefore, the complexity grows because 
      there isn’t documentation about the function and its parameters. The 
      function has the following signature:</P><PRE>FORWARD_ACTION cbFilterFunction(VOID **pData, 
                                     UINT RecvInterfaceIndex, 
                                     UINT *pSendInterfaceIndex, 
                                     UCHAR *pDestinationType, 
                                     VOID *pContext, 
                                     UINT ContextLength, 
                                     <SPAN class=code-keyword>struct</SPAN> IPRcvBuf **pRcvBuf);</PRE>
      <P>With patience and using debugging methods (and interpreting the name of 
      the parameters :)), I get the following information about these 
      parameters:</P>
      <TABLE cellSpacing=0 cellPadding=0 width=600 border=2>
        <TBODY>
        <TR>
          <TD bgColor=#fbedbb><CODE>pData</CODE></TD>
          <TD><CODE>*pData</CODE> points to a (<CODE><SPAN 
            class=code-keyword>struct</SPAN> IPRcvBuf *</CODE>) structure with 
            packet buffer. </TD></TR>
        <TR>
          <TD bgColor=#fbedbb><CODE>RecvInterfaceIndex</CODE></TD>
          <TD>Interface where the data is received.</TD></TR>
        <TR>
          <TD bgColor=#fbedbb><CODE>pSendInterfaceIndex</CODE></TD>
          <TD>Pointer to unsigned <CODE><SPAN 
            class=code-keyword>int</SPAN></CODE> containing the value of the 
            index where data is sent. Although it is a pointer, changing this 
            value doesn't get the packet to be rerouted :(.</TD></TR>
        <TR>
          <TD bgColor=#fbedbb><CODE>pDestinationType</CODE></TD>
          <TD>Pointer to unsigned <CODE><SPAN 
            class=code-keyword>int</SPAN></CODE> with destination type: local 
            network, remote, broadcast, multicast, etc.</TD></TR>
        <TR>
          <TD bgColor=#fbedbb><CODE>pContext</CODE></TD>
          <TD>Point to a <CODE>FIREWALL_CONTEXT_T</CODE> structure where you 
            can find information about the packet as if the packet is incoming 
            or outgoing packet.</TD></TR>
        <TR>
          <TD bgColor=#fbedbb><CODE>ContextLength</CODE></TD>
          <TD>Size of buffer pointed by <CODE>pContext</CODE>. Its value is 
            always <CODE><SPAN 
            class=code-keyword>sizeof</SPAN>(FIREWALL_CONTEXT_T)</CODE>.</TD></TR>
        <TR>
          <TD bgColor=#fbedbb><CODE>pRcvBuf</CODE></TD>
          <TD><CODE>*pRcvBuf</CODE> points always to 
        <CODE>NULL</CODE>.</TD></TR></TBODY></TABLE>
      <P>This information can be changed in future Windows versions because no 
      official documentation is available. I only guarantee that this is the 
      meaning of these fields that I obtained from my tests in Windows 2000 and 
      Windows XP.</P>
      <P>For each packet, our function will be called, and depending on the 
      value it returns, the packet will be dropped or will be passed. The values 
      you can return in the filter function are:</P>
      <TABLE cellSpacing=0 cellPadding=0 width=600 border=2>
        <TBODY>
        <TR>
          <TD bgColor=#fbedbb><CODE>FORWARD</CODE></TD>
          <TD>The packet is allowed.</TD></TR>
        <TR>
          <TD bgColor=#fbedbb><CODE>DROP</CODE></TD>
          <TD>The packet is dropped.</TD></TR>
        <TR>
          <TD bgColor=#fbedbb><CODE>ICMP_ON_DROP</CODE></TD>
          <TD>The packet is dropped and a ICMP packet is sent to remote 
            machine.</TD></TR></TBODY></TABLE>
      <H2>Unchaining Buffers</H2>
      <P>In Firewall-Hook filter function, you don’t receive the buffer directly 
      with packet header and packet content as in Filter-Hook driver. After some 
      tests, I got to know the internal structure of the buffer. As I said 
      before, the sent/received packet is passed in the parameter 
      <CODE>pData</CODE>. <CODE>*pData</CODE> points to a <CODE>IPRcvBuf</CODE> 
      structure:</P><PRE><SPAN class=code-keyword>struct</SPAN> IPRcvBuf 
{
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Point to the next buffer in the chain
</SPAN>    <SPAN class=code-keyword>struct</SPAN> IPRcvBuf *ipr_next;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Always 0 
</SPAN>    UINT ipr_owner;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Buffer data 
</SPAN>    UCHAR *ipr_buffer;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Buffer data size
</SPAN>    UINT ipr_size;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> In my tests always a pointer to NULL.
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Maybe the system could use MDLs instead of IPRcvBuf structures (but
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> i never have seen it).
</SPAN>    PMDL ipr_pMdl;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Always a pointer to NULL.
</SPAN>    UINT *ipr_pClientCnt;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Always a pointer to NULL.
</SPAN>    UCHAR *ipr_RcvContext;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Always 0. I suppose this field is a offset into buffer data
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> but because I haven't a value different from 0, I can affirm it.
</SPAN>    UINT ipr_RcvOffset;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> In Windows 2003 DDK the name of this field have changed to flags.
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> In my tests I always get 0 value for local traffic and 2 for remote.
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> It's the only thing I can tell you about this field.
</SPAN>       ULONG ipr_promiscuous;
};</PRE>
      <P>For our purpose, we only have to know the fields <CODE>ipr_next</CODE>, 
      <CODE>ipr_buffer</CODE> and <CODE>ipr_size</CODE>. The field 
      <CODE>ipr_buffer</CODE> contains <CODE>ipr_size</CODE> bytes of the 
      packet. However, the entire packet need not be in one buffer and the 
      system can chain several buffers. For this reason, the field 
      <CODE>ipr_next</CODE> is used. This field points to the next structure 
      with data of the packet. We have the entire packet when in the data 
      structure the field <CODE>ipr_next</CODE> points to <CODE>NULL</CODE>. So, 
      we find in Firewall-Hook drivers a chained buffer structure as we can see 
      in NDIS drivers. In my tests, for all received packets, the function 
      receives only one structure with all the data in its buffer, and for sent 
      packets, I find several chained buffers where each one contains 
      information about one protocol. I mean, if I send an ICMP packet, for 
      example, there are three chained buffers: one with IP header, one with 
      ICMP header, and another with data. However, as we must do with NDIS 
      drivers, we must not rely on how the system fills the buffers.</P>
      <P>In the next figure, you can see an example of how a packet is built in 
      Firewall-Hook driver:</P>
      <P align=center><IMG height=255 alt="Chained buffers figure" src="" 
      width=556></P>
      <P>As a simple, you can see in the next code how get a lineal buffer with 
      packet content from the chained buffers:</P><PRE><SPAN class=code-keyword>char</SPAN> *pPacket = NULL;
<SPAN class=code-keyword>int</SPAN> iBufferSize;
<SPAN class=code-keyword>struct</SPAN> IPRcvBuf *pBuffer = (<SPAN class=code-keyword>struct</SPAN> IPRcvBuf *) *pData;

<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> First, I calculate the total size of the packet
</SPAN>iBufferSize = buffer-<SPAN class=code-keyword>&gt;</SPAN>ipr_size;
<SPAN class=code-keyword>while</SPAN>(pBuffer-<SPAN class=code-keyword>&gt;</SPAN>ipr_next != NULL)
{
    pBuffer = pBuffer-<SPAN class=code-keyword>&gt;</SPAN>ipr_next;
    iBufferSize += pBuffer-<SPAN class=code-keyword>&gt;</SPAN>ipr_size;
}

<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Reserve memory to the lineal buffer.
</SPAN>pPacket = (<SPAN class=code-keyword>char</SPAN> *) ExAllocatePool(NonPagedPool, iBufferSize);
<SPAN class=code-keyword>if</SPAN>(pPacket != NULL)
{
    <SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> iOffset = <SPAN class=code-digit>0</SPAN>;
    pBuffer = (<SPAN class=code-keyword>struct</SPAN> IPRcvBuf *) *pData;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> we are going to copy each buffer of the chain in the lineal buffer.
</SPAN>    memcpy(pPacket, pBuffer-<SPAN class=code-keyword>&gt;</SPAN>ipr_buffer, pBuffer-<SPAN class=code-keyword>&gt;</SPAN>ipr_size);
    <SPAN class=code-keyword>while</SPAN>(pBuffer-<SPAN class=code-keyword>&gt;</SPAN>ipr_next != NULL)
    { 
        iOffset += pBuffer-<SPAN class=code-keyword>&gt;</SPAN>ipr_size;
        pBuffer = pBbuffer-<SPAN class=code-keyword>&gt;</SPAN>ipr_next;
        memcpy(pPacket + iOffset, pBuffer-<SPAN class=code-keyword>&gt;</SPAN>ipr_buffer, 
                                  pBbuffer-<SPAN class=code-keyword>&gt;</SPAN>ipr_size);
    } 
}</PRE>
      <P>And for all curious people (and before you ask me about it :P), you can 
      modify data of the packets, on your own risk. There isn't any tool to do 
      this type of software, for doing something like it, I recommend you to 
      implement a NDIS IM driver or a TDI Filter driver. I didn't test it so 
      much but I wouldn't rely very much in the stability of a Firewall Hook 
      driver that change packet content. Why? Because we don't know how IP 
      driver manages these buffers and what risks will modify them. In a few 
      words, my recommendation: see, but not touch.</P>
      <H2>Join Time!</H2>
      <P>Well, now we know the syntax of the filter function and we know the 
      format of the packet passed to it. Now, we only have to know how to join 
      these two things to get a packet filtering application. The method I have 
      used is to try to define a filter function similar to the one used in 
      Filter-Hook driver because it's easier to understand. Because the 
      parameters passed to the filter functions in these drivers are different, 
      for Firewall-Hook, I implement an intermediate function (the real 
      Firewall-Hook filter function) that wraps the filter function. I mean, as 
      the Firewall-Hook filter function, I use a function that processes the 
      packet, copy it in a lineal buffer, and pass it to the filter function. 
      With this piece of code, I think you will understand it better:</P><PRE>FORWARD_ACTION cbFilterFunction(VOID **pData,
                                     UINT RecvInterfaceIndex, 
                                     UINT *pSendInterfaceIndex, 
                                     UCHAR *pDestinationType, 
                                     VOID *pContext, 
                                     UINT ContextLength, 
                                     <SPAN class=code-keyword>struct</SPAN> IPRcvBuf **pRcvBuf)
{
    FORWARD_ACTION result = FORWARD;
    <SPAN class=code-keyword>char</SPAN> *pPacket = NULL;
    <SPAN class=code-keyword>int</SPAN> iBufferSize;
    <SPAN class=code-keyword>struct</SPAN> IPRcvBuf *pBbuffer =(<SPAN class=code-keyword>struct</SPAN> IPRcvBuf *) *pData;
    PFIREWALL_CONTEXT_T fwContext = (PFIREWALL_CONTEXT_T)pContext;

    IPHeader *pIpHeader;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Convert chained buffer to lineal buffer as we see before.
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> This won't be the fastest code but
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> will help us to understand better the method.
</SPAN>
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> ...........
</SPAN>
    pIpHeader = (IPHeader *)pPacket;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Call the real filter function and return result     
</SPAN>    result = FilterPacket(pPacket,
                          <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> length in bytes = ipp-&gt;headerLength * (32 bits/8) 
</SPAN>                          pPacket + (pIpHeader -<SPAN class=code-keyword>&gt;</SPAN>headerLength * <SPAN class=code-digit>4</SPAN>), 
                          iBufferSize - (pIpHeader -<SPAN class=code-keyword>&gt;</SPAN>headerLength * <SPAN class=code-digit>4</SPAN>), 
                          (fwContext != NULL) ? fwContext-<SPAN class=code-keyword>&gt;</SPAN>Direction: <SPAN class=code-digit>0</SPAN>, 
                          RecvInterfaceIndex, 
                          (pSendInterfaceIndex != NULL) ? *pSendInterfaceIndex : <SPAN class=code-digit>0</SPAN>);

    <SPAN class=code-keyword>return</SPAN> result;
}</PRE>
      <H2>The Code</H2>
      <P>You can recognize the application of this article quickly. Yes, the GUI 
      is exactly the one I used with my Filter Hook driver. Why? Because I have 
      developed an easy packet filtering application that I use to test all 
      firewalling methods I develop. In this way, I have a common GUI for all of 
      them, that offer the user the same functionality, but at the lower level, 
      work too different. I have different versions of this application (with 
      minimum changes) to test my Filter-Hook driver, Firewall-Hook driver, LSP 
      DLL, TDI filter driver, NDIS drivers... So, I think the methods are easy 
      to understand. Few changes in GUI application, and you want to understand 
      only the new method used.</P>
      <P>As in my other article, this application only implements packet 
      filtering. So many people asked me about adding some extra functionality 
      as packet logging, install as service... But I want to follow the idea of 
      offering methods, not solutions. If you want to add some of these extra 
      functionalities, I am enchanted :). You can contact me to ask all 
      questions you need.</P>
      <H2>Conclusion</H2>
      <P>Well, once time I have wrote this article, it's yours. I hope you can 
      learn from it so much as I did. Enjoy it!!</P><!-- Article Ends --><!-- Main Page Contents End --></DIV>
      <FORM id=aspnetForm 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
      name=aspnetForm action=FwHookDrv.aspx method=post>
      <DIV><INPUT id=__VIEWSTATE type=hidden 
      value=/wEPDwULLTEwMDUyNjYzMjhkZPzJJvsEawHsK6Q9H9anb3rG/gQx 
      name=__VIEWSTATE> </DIV>
      <H2>License</H2>
      <DIV id=ctl00_LicenseTerms>
      <P>This article has no explicit license attached to it but may contain 
      usage terms in the article text or the download files themselves. If in 
      doubt please contact the author via the discussion board below.</P>
      <P>A list of licenses authors might use can be found <A 
      href="http://www.codeproject.com/info/Licenses.aspx">here</A></P></DIV>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=61114">Jess 
            O.</A></B><BR><BR>
            <CENTER><IMG id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
            src=""></CENTER><BR><SPAN class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>To summarize: learn, learn, learn... and then try to remember 
            something I.... I don't Know what i have to remember...<BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow>
                <TD class=SmallText noWrap>Occupation: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Web 
                  Developer</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt=Spain src="" width=16> 
            Spain</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular Internet / Network articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/AsyncSocketServerandClien.aspx">An 
              Asynchronous Socket Server and Client</A>
              <DIV class=SmallText>An asynchronous socket server and client with 
              encryption and compression.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/MyDownloader.aspx">MyDownloader: 
              A Multi-thread C# Segmented Download Manager</A>
              <DIV class=SmallText>Sample application that manages multiple 
              segmented downloads and supports HTTP, FTP and YouTube video 
              downloads</DIV>
              <LI><A href="http://www.codeproject.com/KB/IP/ndk.aspx">Network 
              Development Kit 2.0</A>
              <DIV class=SmallText>Network Development Kit is a set of simple 
              classes for a client-server architecture.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/drvfltip.aspx">Developing 
              Firewalls for Windows 2000/XP</A>
              <DIV class=SmallText>An article about developing Firewalls for 
              Windows 2000/XP</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/iocp_server_client.aspx">A 
              simple IOCP Server/Client Class</A>
              <DIV class=SmallText>This source code uses the advanced IOCP 
              technology which can efficiently serve multiple clients. It also 
              presents some solutions to practical problems that arise with the 
              IOCP programming API, and provides a simple echo client/server 
              with file transfer.</DIV></LI></UL></TD>
          <TD>
            <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d8172%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252f20082-300x250.png%26C%3dFalse%26adid%3d8172%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22300%22%20height%3d%22250%22%3e%3c%2fa%3e"));</SCRIPT>
          </TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
var socialLinks = new social();
socialLinks.addtoMethod=1;
socialLinks.DrawLinks("socialLinks", document.location.href, escape(document.title), 100, 0, "SmallText Bold", "AddTo");
</SCRIPT>
      </DIV>
      <TABLE class=RatingBar id=ctl00_RateArticleRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD id=ctl00_RateArticle_VoteResultDiv noWrap align=right 
                width="100%"><SPAN id=voteRes></SPAN><IMG id=loaderImg 
                  style="DISPLAY: none" height=16 alt=loading... 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/ajax-loader.gif" 
                  width=16> </TD>
                <TD class=SmallText id=voteTbl style="WHITE-SPACE: nowrap" 
                align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px; WHITE-SPACE: nowrap"><I><B>Rate 
                        this Article for us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm noWrap 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn onclick="return rateItem(8675,2);" type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV><INPUT id=__EVENTVALIDATION type=hidden 
      value=/wEWCAKRk4/TCALAlMXDBwLBlMXDBwLClMXDBwLDlMXDBwLElMXDBwLP+++tCwK5upDkC/skuGFKdn8NkB0EHHwJD4uZvIqw 
      name=__EVENTVALIDATION> </DIV></FORM>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d8049%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252fNAVTEQ_468x60.gif%26C%3dFalse%26adid%3d8049%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22468%22%20height%3d%2260%22%3e%3c%2fa%3e"));</SCRIPT>
      <IFRAME src="res://D:\WINDOWS.0\system32\shdoclc.dll/dnserror.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD>
            <FORM 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fIP%2fFwHookDrv.aspx&amp;fid=121826 
            method=get><INPUT type=hidden value=121826 name=fid><INPUT 
            type=hidden value=?floc=%2fKB%2fIP%2fFwHookDrv.aspx&amp;fid=121826 
            name=currentQS><INPUT type=hidden value=/KB/IP/FwHookDrv.aspx 
            name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 alt=FAQ 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/forum_faq.gif" 
                  width=16 align=middle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 alt=Search 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/forum_search.gif" 
                  width=16 align=top border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=121826">Search 
                  Messages</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=SetOpt></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></FORM></TD></TR>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 alt=new 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/forum_newmsg.gif" 
                  width=16 align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;floc=/KB/IP/FwHookDrv.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 25 of 108 (Total in Forum: 108) (<A 
                  href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next</A></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0><!-- Column Headers -->
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2599143_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2599143xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2599143#xx2599143xx" 
                        name=2599143>More than one NIC</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=917009">W 
                        M Suleiman</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:53 16 
                        Jun '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2599143_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello <BR>First i want to thank 
                                you for your effort, it's so great.<BR>i'm 
                                loading the driver on a PC with 3 NICs but the 
                                driver is able to see traffic on the first NIC 
                                only.<BR>my question is can i control the NIC i 
                                want to filter packets on?<BR><BR>Thank you 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2599143&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2599143&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2599143">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2599143">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2599143&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2599143 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(917009,2599143,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2472311_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2472311xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2472311#xx2472311xx" 
                        name=2472311>can't run FirewallApp project</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4837192">chandrika2111</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">21:44 
                        18 Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2472311_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>i can't run the project i get 
                                errors like <BR>WINVER not defined. Defaulting 
                                to 0x0502 (Windows Server 2003),<BR>warning 
                                C4996: 'CWinApp::Enable3dControls' was declared 
                                deprecated <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2472311&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2472311&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2472311">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2472311">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2472311&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2472311 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4837192,2472311,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2421848_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2421848xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2421848#xx2421848xx" 
                        name=2421848>Verey good jop.... thanks</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2804396">Al-Shaikhly</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:23 10 
                        Feb '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2421848_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi... I've read all your articles 
                                , it's very useful , thanks.<BR>I worked in my 
                                master project, can you help me by some notes, 
                                or code about capturing manipulating the HDLC 
                                layer. thanks in advance. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2421848&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2421848&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2421848">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2421848">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2421848&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2421848 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(2804396,2421848,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2398215_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2398215xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2398215#xx2398215xx" 
                        name=2398215>Build error</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=593337">Khey</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:53 22 
                        Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2398215_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I have Visual Studio 2005, 
                                installed Windows Driver Development Kit (DDK) 
                                for Windows Server 2003 Service Pack 1 (SP1), 
                                Windows XP, and Windows 2000.<BR><BR>When I 
                                build this project, I receive 
                                error:<BR><BR>Windows has triggered a breakpoint 
                                in FirewallApp.exe.<BR><BR>This may be due to a 
                                corruption of the heap, and indicates a bug in 
                                FirewallApp.exe or any of the DLLs it has 
                                loaded.<BR><BR>What could be wrong? 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2398215&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2398215&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2398215">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2398215">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2398215&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2398215 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(593337,2398215,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2398470_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2398470xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2398470#xx2398470xx" 
                        name=2398470>Re: Build error</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=593337">Khey</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:10 22 
                        Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2398470_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Blahh, I just had to copy 
                                FwHookDrv.sys into debug directory. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2398470&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2398470&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2398215">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2398470">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2398470&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2398470 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(593337,2398470,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2246899_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2246899xx></A><IMG height=16 alt=Question 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2246899#xx2246899xx" 
                        name=2246899>Can I get packets in or out my 
                      computer?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4030282">MD84</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:42 27 
                        Sep '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2246899_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I want built an appication that 
                                can sniff packets in and out my computer. I saw 
                                in your code have a function can do that. But I 
                                don't know how to change it to use in catch 
                                packets on runtime.How I can stop or start the 
                                process sniff packet when I want. Thanks 
<BR><BR>
                                <DIV class=ForumSig>AS84</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2246899&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2246899&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2246899">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2246899">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2246899&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2246899 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(4030282,2246899,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2180746_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2180746xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2180746#xx2180746xx" 
                        name=2180746>Drop All ip , but Alow some ip</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=162957">acob</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">18:29 
                        13 Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2180746_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Thank you for your source <BR>I 
                                have developed small firewall program which will 
                                be used in our office.<BR>we need to prevent all 
                                internet access except one site <BR><BR>so i add 
                                '0.0.0.0 --- drop' and then '218.38.148.244 --- 
                                alow'<BR>in this case all packet 
                                blocked<BR><BR>and i add '218.38.148.244 --- 
                                alow' and then '0.0.0.0 --- drop'<BR>in this 
                                case all packet blocked too<BR><BR>thank for 
                                your reading <BR>and I will wait for help 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2180746&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2180746&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2180746">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2180746">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2180746&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2180746 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(162957,2180746,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2179350_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2179350xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2179350#xx2179350xx" 
                        name=2179350>Good Artice</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=83880">thomas_tom99</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:12 13 
                        Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2179350_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>[Message Deleted due to 
                                spam]<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2179350&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2179350&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2179350">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2179350">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2179350&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2179350 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(83880,2179350,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2100784_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2100784xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2100784#xx2100784xx" 
                        name=2100784>spyware ip blacklist</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4219513">fmoran</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:56 26 
                        Jun '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2100784_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi, i need a ip blacklist for 
                                spyware blocking.<BR>I found a lot of sites 
                                containing blacklist for spam blocking, but I 
                                can't find any for spyware.<BR>Please, help me. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2100784&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2100784&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2100784">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2100784">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2100784&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2100784 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4219513,2100784,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2098687_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2098687xx></A><IMG height=16 alt=Question 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2098687#xx2098687xx" 
                        name=2098687>NT 4.0 compability</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4265196">Navascues</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:42 25 
                        Jun '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2098687_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hi all,<BR><BR>Is this applicable 
                                <B>only</B> in Windows 2000 and 
                                higher?<BR><BR>There is no ipfirewall.h header 
                                in NT DDK but I have readed that it's possible 
                                to use some newer libs in NT drivers... like 
                                ntstrsafe.lib. <BR><BR>Thanks for these 
                                articles, Jesús Oliva and codeproject people do 
                                a great job.<BR><BR>Julián <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2098687&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2098687&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2098687">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2098687">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2098687&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2098687 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4265196,2098687,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2050132_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2050132xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2050132#xx2050132xx" 
                        name=2050132>ip packet queueing</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1765270">ermancetin</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:55 23 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2050132_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>How can we queue the ip packets 
                                with giving them priorities? <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2050132&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2050132&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2050132">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2050132">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2050132&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2050132 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1765270,2050132,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2038907_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2038907xx></A><IMG height=16 alt=Question 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=2038907#xx2038907xx" 
                        name=2038907>Vista can not work????</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2270130">Swhsu</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:15 16 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2038907_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I tested it on vista, but it dont 
                                work.<BR>Why it can not work on vista??? 
                                <BR>Help me, please. Thanks <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2038907&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=2038907&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=2038907">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=2038907">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2038907&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2038907 
                                style="WHITE-SPACE: nowrap">1.60/5 (7 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(2270130,2038907,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1981956_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1981956xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1981956#xx1981956xx" 
                        name=1981956>It dont work</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3681889">hoanglinh9466</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:48 10 
                        Apr '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1981956_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I tested and it dont work, i think 
                                it does not change any thing <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1981956&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1981956&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1981956">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1981956">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1981956&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1981956 
                                style="WHITE-SPACE: nowrap">4.00/5 (2 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3681889,1981956,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1815540_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1815540xx></A><IMG height=16 alt=Question 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1815540#xx1815540xx" 
                        name=1815540>Block - unblock</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=462745">Jake123456</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">2:59 22 
                        Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1815540_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><BR>Hi,<BR><BR>This is very nice 
                                application!<BR><BR>I tried it and it works a 
                                bit odd:<BR><BR>- I block at first rule all tcp 
                                traffic<BR>- now I try to open all ports to DNS 
                                server and to a address<BR>- it does not 
                                open<BR><BR>What I have done wrong<IMG 
                                alt=Confused src="" align=top><BR><BR>Thanks in 
                                Advance,<BR>Jake <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1815540&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1815540&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1815540">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1815540">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1815540&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1815540 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(462745,1815540,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1798031_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1798031xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1798031#xx1798031xx" 
                        name=1798031>:-(</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3550505">valyuch</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:53 10 
                        Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1798031_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Filter Hook Driver doesn't work 
                                under Windows 2003 Server... <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1798031&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1798031&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1798031">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1798031">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1798031&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1798031 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3550505,1798031,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1794582_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1794582xx></A><IMG height=16 alt=Question 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1794582#xx1794582xx" 
                        name=1794582>Error loading filter driver.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3607311">muadnem</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">14:08 7 
                        Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1794582_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I think I got the pre-compiled exe 
                                and sys to work one time.<BR><BR>After that I 
                                have had no luck using either precompiled or 
                                source (can't compile the driver myself yet 
                                since I haven't the DDK). I keep getting "Error 
                                loading filter driver." Even if I put it in 
                                system32.<BR><BR><BR>I swear this thing worked 
                                once from precompiled. Now, starting from 
                                seemingly scratch, it's always throwing that 
                                error. Reboots galoor, reinstall of C++, 
                                deleting all traces of FwHook... still no 
                                good.<BR><BR><BR>Any idea as to why I am getting 
                                this behavior. I tried VC++ and VC++ w/ sp6 on 
                                the compiles.<BR><BR>Something seems to not be 
                                getting cleaned up.. or 
                                something.<BR><BR><BR>Please help. <IMG 
                                alt=Smile 
                                src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top> 
                                Thanks<BR><BR><BR><BR><BR><BR><BR>J<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1794582&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1794582&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1794582">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1794582">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1794582&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1794582 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3607311,1794582,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F1800184_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1800184xx></A><IMG height=16 alt=Answer 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1800184#xx1800184xx" 
                        name=1800184>Re: Error loading filter driver.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1150030">wylekyoti</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">19:18 
                        11 Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1800184_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I ran into the same problem. After 
                                much debugging I found that the service was out 
                                there running, so it fails to create the service 
                                again because its already there. You'll need to 
                                stop the service (programatically), delete the 
                                service (programatically), and then you'll be 
                                able to create it again.<BR><BR>After you've 
                                done so, make sure to update you code to be 
                                robust to these kinds of errors, because they 
                                will rear their ugle head again when you stop 
                                the kill the firewall from the debugger. Good 
                                Luck. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1800184&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1800184&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1794582">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1800184">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1800184&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1800184 
                                style="WHITE-SPACE: nowrap">2.67/5 (3 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(1150030,1800184,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F1800228_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx1800228xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1800228#xx1800228xx" 
                        name=1800228>Re: Error loading filter driver.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3607311">muadnem</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:24 
                        11 Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1800228_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I was just running the demo 
                                code.<BR><BR>I was assuming it cleaned up after 
                                itself.<BR><BR>I will give it another go here 
                                soon.<BR><BR><BR>Thanks for the 
                                help.<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1800228&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1800228&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1794582">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1800228">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1800228&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1800228 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3607311,1800228,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1794484_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1794484xx></A><IMG height=16 alt=Question 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1794484#xx1794484xx" 
                        name=1794484>What type does the driver expect the IP 
                        address to be in?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=249816">Siso</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:51 7 
                        Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1794484_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello Jesus - great job on the fw 
                                code.<BR><BR>My question to you is 
                                this:<BR><BR>The IPFilter struct declares an IP 
                                addy to be of type ULONG, but the main form 
                                accepts the input as a string 
                                obviously.<BR><BR>What are you doing to force it 
                                into a ULONG? I see you are doing some sort of 
                                octet conversion...why are you doing this? Is 
                                this something Microsoft defined as the input 
                                format?<BR><BR>If so, could you please direct me 
                                to the documentation?<BR><BR>Thanks and good 
                                work.<BR><BR>Salim <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1794484&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1794484&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1794484">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1794484">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1794484&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1794484 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(249816,1794484,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1604871_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1604871xx></A><IMG height=16 alt=Question 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1604871#xx1604871xx" 
                        name=1604871>use the FwHookDrv.sys with VB6.0</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1822582">Darkcu</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:35 1 
                        Aug '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1604871_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hey,<BR><BR>how can i use this 
                                driver with VB6.0?<BR><BR>just entering an IP 
                                and port and click go... <IMG alt=Confused 
                                src="" align=top><BR><BR>thanx a lot! 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1604871&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1604871&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1604871">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1604871">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1604871&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1604871 
                                style="WHITE-SPACE: nowrap">1.75/5 (3 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(1822582,1604871,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1556127_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1556127xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1556127#xx1556127xx" 
                        name=1556127>Range for port filtering</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2727760">kaukau</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:03 30 
                        Jun '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1556127_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>How can i modify the code to able 
                                to filter a range of port (ex.port 
                                1024-5699)...not only one single port for every 
                                rule input?<IMG alt=Confused src="" align=top> 
                                <BR><BR>thanx <BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1556127&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1556127&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1556127">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1556127">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1556127&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1556127 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(2727760,1556127,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1523600_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1523600xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1523600#xx1523600xx" 
                        name=1523600>Hey</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2951179">Satya_wolverine</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:38 8 
                        Jun '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1523600_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Iam intrested in using your driver 
                                can you explain to me in a little detail how to 
                                use it please. I dont mean to say this 
                                explanation was sufficient but a comprehensive 
                                explanation would be of more help Thanks 
                                <BR><IMG alt=Smile 
                                src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top> <BR><BR><BR>with regard Satya 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1523600&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1523600&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1523600">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1523600">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1523600&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1523600 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(2951179,1523600,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1504981_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1504981xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1504981#xx1504981xx" 
                        name=1504981>error in compiling driver</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2757260">rachappa 
                        bandi</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:03 26 
                        May '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1504981_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>That ipfirewall.h header files i 
                                am not able to get it. Microsoft says it can be 
                                get it through CD. if any one can send me a ddk 
                                header files,lib files and dll. i hav use that 
                                in my driver compilation <BR><BR>rachappa 
                                bandi<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1504981&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1504981&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1504981">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1504981">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1504981&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1504981 
                                style="WHITE-SPACE: nowrap">1.67/5 (3 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(2757260,1504981,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1438274_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1438274xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1438274#xx1438274xx" 
                        name=1438274>I need ddk, please help me</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1308738">vnsaoden</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">18:39 5 
                        Apr '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1438274_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>everyone has ddk , please send to 
                                me ; my email 
                                :zzzthosanzzz@yahoo.com.vn.<BR>thank you very 
                                <BR><BR>xxxx<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1438274&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1438274&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1438274">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1438274">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1438274&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1438274 
                                style="WHITE-SPACE: nowrap">2.75/5 (4 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(1308738,1438274,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F1452243_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1452243xx></A><IMG height=16 alt=General 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;select=1452243#xx1452243xx" 
                        name=1452243>Re: I need ddk, please help me</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1302852">cau_chu</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:26 17 
                        Apr '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1452243_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Can bo DDK loai gi. Co nhieu bo 
                                DDK lam,vi du bo DDK cho XP,DDK cho win2K,ddk 
                                cho winnt. Co moi bo DDK cho XP thi tim tren 
                                mang hoi kho,con cac bo DDK kia thi rat de 
                                tim.Bo DDK cho XP la 138Mb,con bo DDK cho win2k 
                                la 65.7Mb nen rat tien ko the gui cho ban dc.Ko 
                                can thiet phai dung bo DDk cho XP dau,xai cai 
                                win2k la dc roi.cai nay search 1 luc la ra y 
                                ma.File day la win2kddk.exe.<BR>Good 
                                luck<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1452243&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=121826&amp;select=1452243&amp;floc=/KB/IP/FwHookDrv.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;tid=1438274">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=121826&amp;msg=1452243">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1452243&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1452243 
                                style="WHITE-SPACE: nowrap">2.00/5 (4 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(1302852,1452243,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Friday, October 31, 2008 2:13 PM &nbsp; &nbsp; 
                  Last Update:Friday, November 14, 2008 8:32 AM</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><B>1</B><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>2</A><A class=Frm_HL 
                  href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;fr=51#xx0xx" 
                  name=Frm_HoverNL>3</A><A class=Frm_HL 
                  href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;fr=76#xx0xx" 
                  name=Frm_HoverNL>4</A> <A class=Frm_HL 
                  href="http://www.codeproject.com/KB/IP/FwHookDrv.aspx?fid=121826&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next 
      »</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 alt=General 
      src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_general.gif" 
      width=16 align=top> General &nbsp;&nbsp; <IMG height=16 alt=News 
      src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_news.gif" 
      width=16 align=top> News &nbsp;&nbsp; <IMG height=16 alt=Question 
      src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_question.gif" 
      width=16 align=top> Question &nbsp;&nbsp; <IMG height=16 alt=Answer 
      src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_answer.gif" 
      width=16 align=top> Answer &nbsp;&nbsp; <IMG height=16 alt=Joke 
      src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_joke.gif" 
      width=16 align=top> Joke &nbsp;&nbsp; <IMG height=16 alt=Rant 
      src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_rant.gif" 
      width=16 align=top> Rant &nbsp;&nbsp; <IMG height=16 alt=Admin 
      src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/msg_admin.gif" 
      width=16 align=top> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=8675">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy</A> | <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 28 Oct 2004<BR>Editor: <A 
            id=ctl00_ArticleEditor 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=28970">Smitha 
            Vijayan</A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2004 by Jess 
            O.<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2008 
            <BR>Web18 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE>
      <CENTER></CENTER></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE><BR>
<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject An Adventure How to implement a Firewall-Hook Driver_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
new HVMenu(new menu_NavbarConfig());
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
$(document).ready(function() {RetrieveJobsSummary('Th', 'Li',8675,2,64,"4,80,159,175,23,24,26,51,107,184,118,152");});
//]]></SCRIPT>
</BODY></HTML>
