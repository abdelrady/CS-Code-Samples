<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0047)http://www.codeproject.com/audio/mididemocp.asp -->
<HTML><HEAD><TITLE>MCI Midi class - The Code Project - Audio and Video</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=ISO-8859-1">
<META content=en-US name=MS.LOCALE>
<META 
content="A tiny and very easy to use C++ class to play *.WAV, *.MID and *.RMI files" 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content=AXELMUELLER name=Author>
<META content="14 Jul 2003 14:00:00 GMT" name=Search.PublishDate>
<META content="14 Jul 2003 14:00:00 GMT" name=Search.RevisedDate>
<META 
content="Free source code, , Visual C++, MFC, Windows, Midi, MCI, DirectX, Wav" 
name=keywords>
<META 
content="Article content copyright AXELMUELLER, 2003, everthing else Copyright © CodeProject, 1999-2007, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="The Code Project" 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK href="/favicon.ico" 
type=image/ico rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="MCI Midi class - The Code Project - Audio and Video_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="MCI Midi class - The Code Project - Audio and Video_files/oncopy.js"></SCRIPT>

<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
if (typeof(DemoUrl) != "undefined")
	document.write('<me' + 'ta http' + '-equiv="re' + 'fresh" con' + 'tent="1;url=' + DemoUrl + '">');
</SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white>
<SCRIPT 
src="MCI Midi class - The Code Project - Audio and Video_files/urchin.js" 
type=text/javascript>
</SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-1735123-1";
urchinTracker();
</SCRIPT>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="MCI Midi class - The Code Project - Audio and Video_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3762&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FWholeTomato%5FRefRename%5F728x90%2Egif&C=False&id=3762&cb=1601054\" alt=\"The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you.\" border=0 width=728 height=90></a>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">4,547,385 members and 
            growing! &nbsp; 10,366 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2959938">abdelrady2030 
            </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/audio/mididemocp.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2959938">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/audio/mididemocp.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=8">Architect</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=9">SQL</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=1">All Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 300px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=300>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="MCI Midi class - The Code Project - Audio and Video_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="MCI Midi class - The Code Project - Audio and Video_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=2">MFC/C++</A> &gt;&gt; <A 
            href="http://www.codeproject.com/audio/">Audio and Video</A> 
            &gt;&gt; <A 
            href="http://www.codeproject.com/audio/#General">General</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">MCI Midi 
            class</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=99950">AXELMUELLER</A></B>. 
            <BR><BR>
            <DIV style="FONT-SIZE: 12px">A tiny and very easy to use C++ class 
            to play *.WAV, *.MID and *.RMI files</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C++ (VC7.1, VC7, 
            VC6)<BR>Windows (WinXP, Win2K, Win95, NT4, Win98, WinME)<BR>MFC, 
            Win32, VS (VS6)<BR>Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>15 Jul 
            2003</B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: 
            <B>52,020</B> </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <DIV class=FeatureBlockHeader>Announcements</DIV>
            <DIV class="FeatureBlockContent RHFeatureBar">
            <DIV style="PADDING-TOP: 3px"><IMG style="MARGIN-LEFT: 0px" 
            height=16 alt=Jobs 
            src="MCI Midi class - The Code Project - Audio and Video_files/staff_sm.gif" 
            width=12 align=absMiddle> <A 
            href="http://www.codeproject.com/info/jobs/">http://www.codeproject.com/info/jobs/</A></DIV>
            <DIV style="PADDING-TOP: 3px"><IMG style="MARGIN-LEFT: 0px" 
            height=20 alt=Comp 
            src="MCI Midi class - The Code Project - Audio and Video_files/prize_winner_sm.gif" 
            width=10 align=absMiddle> <A 
            href="http://www.codeproject.com/script/competitions/monthly/">Monthly 
            Competition</A></DIV></DIV>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=4034&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Finnerworkings%5F160x600%2Egif&C=False&id=4034&cb=1601068\" alt=\"\" border=0 width=160 height=600></a>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="MCI Midi class - The Code Project - Audio and Video_files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="MCI Midi class - The Code Project - Audio and Video_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/audio/mididemocp.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="MCI Midi class - The Code Project - Audio and Video_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=MidiDemoCp%2Faudio7%2F15%2F2003">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="MCI Midi class - The Code Project - Audio and Video_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Faudio%2Fmididemocp%2Easp&amp;guid=MidiDemoCp%2Faudio7%2F15%2F2003">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="MCI Midi class - The Code Project - Audio and Video_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/audio/mididemocp.asp#__comments">Discuss</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="MCI Midi class - The Code Project - Audio and Video_files/mail.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/script/recommend/form.asp?guid=MidiDemoCp%2Faudio7%2F15%2F2003">Send 
                        to a friend</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>8 votes for this 
                      article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="MCI Midi class - The Code Project - Audio and Video_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="MCI Midi class - The Code Project - Audio and Video_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="MCI Midi class - The Code Project - Audio and Video_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="MCI Midi class - The Code Project - Audio and Video_files/red.gif" 
                              width=8 border=0><IMG height=5 
                              src="MCI Midi class - The Code Project - Audio and Video_files/white.gif" 
                              width=12 border=0></TD>
                            <TD><IMG height=5 
                              src="MCI Midi class - The Code Project - Audio and Video_files/white.gif" 
                              width=20 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        3.09</A>. Rating: <B>3.42</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <UL class=download>
              <LI><A 
              href="http://www.codeproject.com/audio/MidiDemoCp/MidiDemo_Appl.zip">Download 
              demo project - 21.7 Kb </A>(contains the Midi samples) 
              <LI><A 
              href="http://www.codeproject.com/audio/MidiDemoCp/MidiDemo_Src.zip">Download 
              source - 19.3 Kb</A> </LI></UL>
            <P><IMG height=93 
            src="MCI Midi class - The Code Project - Audio and Video_files/Screenshot.gif" 
            width=438 border=0></P>
            <H2>Introduction</H2>
            <P><CODE>cSound</CODE> is a really tiny and very easy to use C++ 
            class to play *.WAV, *.MID and *.RMI files. You can add it to your 
            project without changes. To play a Wave, Midi or Riff-Midi file you 
            need only one function call! This class uses MCI, it does NOT 
            require DirectX. It will run under Windows 95 / 98 / ME / NT / 2000 
            / XP.
            <P>It will play Midi via the Midi Mapper.&nbsp; Which Midi device is 
            used by the mapper depends on the settings in your Control Panel 
            --&gt; MultiMedia. Try the different devices, they sound extremely 
            different !!! I added some specific Midi files to the download to 
            check. The Main Demo project is written in MFC but the 
            <CODE>cSound</CODE> class is completely free of MFC. 
            <H2>Midi without DirectX</H2>
            <P>If you search the internet for source code to play Midi you will 
            find a lot which require DirectX to be installed on the users 
            computer. 
            <H3>Advantages of using DirectX to play Midi </H3>
            <OL>
              <LI>If you select the DirectX Microsoft Synthesizer (default 
              device) it will be possible that multiple applications can play 
              Midi at once. 
              <LI>If you have a very CHEAP sound card, the Microsoft Synthesizer 
              will sound better than the driver of your soundcard. </LI></OL>
            <H3>Disadvantages of using DirectX to play Midi </H3>
            <OL>
              <LI>Every user of your software needs to have DirectX installed. 
              On Windows 95 and NT he will always have to update Direct X. Users 
              of Windows 98 and 2000 will also need to update DirectX if your 
              application requires DirectX 7 or 8. The download of DirectX is 
              unacceptable for modem users (&gt; 12 Megabyte) 
              <LI>The documentation of DirectX in the MSDN is poor, poor, poor ! 
              And if you even want to write for an older DirectX version (like 5 
              or 6) to allow users of Windows 98 and 2000 to use your 
              application without updating DirectX you will find NOTHING about 
              that in the actual MSDN ! Microsoft completely removed the older 
              documentations ! 
              <LI>When your application initializes DirectX a dozen of DLLs is 
              loaded which consume about 4 Megabytes of RAM. On a Pentium 100 
              this loading of DLLs takes 3 seconds. 
              <LI>After playing a Midi file DirectX does NOT automatically free 
              the used Midi device. This means that other applications (e.g. 
              WinAmp) can NOT access it. Your software has to take care to 
              remove the port after playing the file. The problem is that the 
              sound is played asynchronously and you don't know when DirectX 
              will finish to play. To find out in advance the length of a Midi 
              sound is very complicated because the tempo can change multiple 
              times in a Midi file. So you could check with a timer in certain 
              intervals if the sound is still playing 
              (<CODE>IDirectMusicPerformance::IsPlaying()</CODE>) and than 
              remove the port - but this is awkward ! 
              <LI>If you have a middle-class or a good soundcard (like 
              Soundblaster live) you will find that the Microsoft Synthesizer 
              (default device) sounds awful ! You have to insert extra code 
              (<CODE>IDirectMusic::EnumPort()</CODE>), a combo box, code to 
              store the user settings etc. to allow the user to choose a Midi 
              device, which sounds better. My <CODE>cSound</CODE> class does not 
              need that because it uses the device, which the user has selected 
              in the Control Panel. </LI></OL>
            <H2>Using the code</H2>
            <P>Calling cSound cannot be easier. It's only one function call: 
            <P><CODE>cSound::PlaySoundFile(Path);</CODE> 
            <H2>The <I>cMidiDemoDlg.h</I> file</H2><PRE><SPAN class=cpp-keyword>private</SPAN>:
    cSound i_Sound;
</PRE>
            <H2>The <I>cMidiDemoDlg.cpp</I> file</H2><PRE><SPAN class=cpp-keyword>void</SPAN> CMidiDemoDlg::PlayMidiOrWav(<SPAN class=cpp-keyword>char</SPAN> *p_s8PathToSoundFile) 
{
    <SPAN class=cpp-keyword>char</SPAN> s8_Buf[<SPAN class=cpp-literal>300</SPAN>];
    DWORD u32_Err;
    <SPAN class=cpp-keyword>if</SPAN> (u32_Err=i_Sound.PlaySoundFile(p_s8PathToSoundFile))
    {
             <SPAN class=cpp-comment>// errors defined in cSound.h</SPAN>
             <SPAN class=cpp-keyword>if</SPAN> (u32_Err == ERR_INVALID_FILETYPE)     
               strcpy(s8_Buf, <SPAN class=cpp-string>"This filetype is not supported !"</SPAN>);
        <SPAN class=cpp-keyword>else</SPAN> <SPAN class=cpp-keyword>if</SPAN> (u32_Err == ERR_PLAY_WAV)             
               strcpy(s8_Buf, <SPAN class=cpp-string>"Windows could not play the Wav file !"</SPAN>);
        <SPAN class=cpp-keyword>else</SPAN> <SPAN class=cpp-keyword>if</SPAN> (u32_Err == MCIERR_SEQ_NOMIDIPRESENT) 
              strcpy(s8_Buf, <SPAN class=cpp-string>"There is no Midi device installed or"</SPAN> 
                  <SPAN class=cpp-string>" it is used by another application!"</SPAN>);
        <SPAN class=cpp-keyword>else</SPAN>
        {
            <SPAN class=cpp-comment>// translate errors from WinError.h</SPAN>
            <SPAN class=cpp-keyword>if</SPAN> (!FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM, <SPAN class=cpp-literal>0</SPAN>, 
               u32_Err, <SPAN class=cpp-literal>0</SPAN>, s8_Buf, <SPAN class=cpp-keyword>sizeof</SPAN>(s8_Buf), <SPAN class=cpp-literal>0</SPAN>))
            {
                <SPAN class=cpp-comment>// translate errors from MMsystem.h</SPAN>
                <SPAN class=cpp-keyword>if</SPAN> (!mciGetErrorString(u32_Err, s8_Buf, <SPAN class=cpp-keyword>sizeof</SPAN>(s8_Buf)))
                {
                    sprintf(s8_Buf, <SPAN class=cpp-string>"Error %d"</SPAN>, u32_Err);
                }
            }
        }

        MessageBox(s8_Buf, <SPAN class=cpp-string>"Error"</SPAN>, MB_ICONSTOP);
    }
}
</PRE>
            <H2>The cSound class</H2><PRE><SPAN class=cpp-preprocessor>#include "Mmsystem.h"</SPAN>

<SPAN class=cpp-preprocessor>#define  ERR_INVALID_FILETYPE 50123</SPAN>
<SPAN class=cpp-preprocessor>#define  ERR_PLAY_WAV         50124</SPAN>

<SPAN class=cpp-keyword>class</SPAN> cSound
{
<SPAN class=cpp-keyword>public</SPAN>:
    cSound();
    <SPAN class=cpp-keyword>virtual</SPAN>   ~cSound();

    DWORD      PlaySoundFile(<SPAN class=cpp-keyword>char</SPAN> *p_s8File);
    <SPAN class=cpp-keyword>void</SPAN>       StopSoundFile();
};
</PRE>
            <H2>The <I>cSound.cpp</I> file</H2><PRE><SPAN class=cpp-comment>/****************************************
       Plays Wav or (Riff) Midi file
****************************************/</SPAN>

DWORD cSound::PlaySoundFile(<SPAN class=cpp-keyword>char</SPAN> *p_s8File)
{
    <SPAN class=cpp-comment>// It is important to check if the file exists !</SPAN>
    <SPAN class=cpp-comment>// On Windows NT PlaySound() returns TRUE </SPAN>
    <SPAN class=cpp-comment>// even if the file does not exist !</SPAN>
    <SPAN class=cpp-comment>// Then PlaySound() makes the PC speaker beep !!!</SPAN>
    
    <SPAN class=cpp-comment>// mciSendString("open...") also gives an absolutely </SPAN>
    <SPAN class=cpp-comment>// stupid error message</SPAN>
    <SPAN class=cpp-comment>// if the file does not exist !</SPAN>

    DWORD u32_Attr = ::GetFileAttributes(p_s8File);
    <SPAN class=cpp-keyword>if</SPAN> (u32_Attr == <SPAN class=cpp-literal>0xFFFFFFFF</SPAN> || (u32_Attr &amp; 
            FILE_ATTRIBUTE_DIRECTORY)) 
        <SPAN class=cpp-keyword>return</SPAN> ERROR_FILE_NOT_FOUND;


    <SPAN class=cpp-comment>// Get file extension</SPAN>
    <SPAN class=cpp-keyword>char</SPAN> *p_s8Ext = strrchr(p_s8File, '.');
    <SPAN class=cpp-keyword>if</SPAN>  (!p_s8Ext)
        <SPAN class=cpp-keyword>return</SPAN> ERR_INVALID_FILETYPE;
    

    <SPAN class=cpp-keyword>if</SPAN> (stricmp(p_s8Ext, <SPAN class=cpp-string>".wav"</SPAN>) == <SPAN class=cpp-literal>0</SPAN>)
    {
        StopSoundFile();
        
        <SPAN class=cpp-comment>// PlaySound() is very primitive: no Error Code available</SPAN>
        <SPAN class=cpp-keyword>if</SPAN> (!PlaySound(p_s8File, <SPAN class=cpp-literal>0</SPAN>, SND_FILENAME | SND_ASYNC))
            <SPAN class=cpp-keyword>return</SPAN> ERR_PLAY_WAV;

        <SPAN class=cpp-keyword>return</SPAN> <SPAN class=cpp-literal>0</SPAN>;
    }
    

    DWORD u32_Err;
    <SPAN class=cpp-keyword>if</SPAN> (!stricmp(p_s8Ext, <SPAN class=cpp-string>".mid"</SPAN>) || !stricmp(p_s8Ext, <SPAN class=cpp-string>".midi"</SPAN>)
           || !stricmp(p_s8Ext, <SPAN class=cpp-string>".rmi"</SPAN>))
    {
        StopSoundFile();

        <SPAN class=cpp-keyword>static</SPAN> <SPAN class=cpp-keyword>char</SPAN> s8_LastFile[MAX_PATH] = <SPAN class=cpp-string>""</SPAN>;

        <SPAN class=cpp-comment>// the mciSendString("open...") command is slow </SPAN>
        <SPAN class=cpp-comment>// (on Windows NT, 2000 and XP) </SPAN>
        <SPAN class=cpp-comment>// so we call it only if necessary</SPAN>
        <SPAN class=cpp-keyword>if</SPAN> (strcmp(s8_LastFile, p_s8File) != <SPAN class=cpp-literal>0</SPAN>)
        {
            strcpy(s8_LastFile, p_s8File);

            mciSendString(<SPAN class=cpp-string>"close all"</SPAN>, <SPAN class=cpp-literal>0</SPAN>, <SPAN class=cpp-literal>0</SPAN>, <SPAN class=cpp-literal>0</SPAN>);

            <SPAN class=cpp-keyword>char</SPAN> s8_Buf[<SPAN class=cpp-literal>300</SPAN>];
            sprintf(s8_Buf, 
             <SPAN class=cpp-string>"open \"</SPAN>%s\<SPAN class=cpp-string>" type sequencer alias MidiDemo"</SPAN>, 
             p_s8File);

            <SPAN class=cpp-keyword>if</SPAN> (u32_Err=mciSendString(s8_Buf, <SPAN class=cpp-literal>0</SPAN>, <SPAN class=cpp-literal>0</SPAN>, <SPAN class=cpp-literal>0</SPAN>))
                <SPAN class=cpp-keyword>return</SPAN> u32_Err;
        }

        <SPAN class=cpp-keyword>if</SPAN> (u32_Err=mciSendString(<SPAN class=cpp-string>"play MidiDemo from 0"</SPAN>, <SPAN class=cpp-literal>0</SPAN>, <SPAN class=cpp-literal>0</SPAN>, <SPAN class=cpp-literal>0</SPAN>))
        {
            <SPAN class=cpp-comment>// replace stupid error messages</SPAN>
            <SPAN class=cpp-keyword>if</SPAN> (u32_Err == <SPAN class=cpp-literal>2</SPAN>) u32_Err = MCIERR_SEQ_NOMIDIPRESENT;
            <SPAN class=cpp-keyword>return</SPAN> u32_Err;
        }

        <SPAN class=cpp-keyword>return</SPAN> <SPAN class=cpp-literal>0</SPAN>;
    }

    <SPAN class=cpp-keyword>return</SPAN> ERR_INVALID_FILETYPE;
}



<SPAN class=cpp-comment>/**************************************************
       Stops the currently playing Wav and Midi
***************************************************/</SPAN>

<SPAN class=cpp-keyword>void</SPAN> cSound::StopSoundFile()
{
    PlaySound(<SPAN class=cpp-literal>0</SPAN>, <SPAN class=cpp-literal>0</SPAN>, SND_PURGE); <SPAN class=cpp-comment>// Stop Wav</SPAN>

    mciSendString(<SPAN class=cpp-string>"stop MidiDemo"</SPAN>, <SPAN class=cpp-literal>0</SPAN>, <SPAN class=cpp-literal>0</SPAN>, <SPAN class=cpp-literal>0</SPAN>); <SPAN class=cpp-comment>// Stop Midi</SPAN>
}

</PRE>
            <H2>Known bugs in Windows NT, 2000 and XP </H2>
            <OL>
              <LI>On Windows NT, 2000 and XP the first note of a Midi song is 
              omitted in playing if the song does not begin with a rest of at 
              least a quarter note !! (The Midi sample-files added to the 
              download all begin with a rest) 
              <LI>On Windows NT, 2000 and XP the <CODE>mciSendString(<SPAN 
              class=cpp-string>"open..."</SPAN>)</CODE> command is extremely 
              slow 
              <LI>Only on Windows XP<CODE> mciSendString(<SPAN 
              class=cpp-string>"open..."</SPAN>)</CODE> gives a stupid error 
              message if the Midi device is occupied by another application. 
              (<CODE>MCIERR_SEQ_NOMIDIPRESENT</CODE> instead of 
              <CODE>MCIERR_SEQ_PORT_INUSE</CODE>) 
              <CODE>mciGetErrorString()</CODE> translates this to "No Midi 
              hardware available or no drivers installed" !! </LI></OL>
            <H2>Another Midi Player using the MMSystem Interface</H2>
            <P>In the MSDN you find a sample code which also plays Midi files 
            without DirectX. (search for "MidiPlyr") It uses the 
            <CODE>midiOutxxx()</CODE> and <CODE>midiStreamxxx()</CODE> Interface 
            of <I>WinMM.Dll</I> (This interface is also used by WinAmp). The 
            bugs in Windows 2000 and XP described above do not affect MidiPlyr. 
            It works perfectly on all platforms. But this sample code is 
            <B>EXTREMELY</B> complex. (and written in pure C) 
            <H2>Midi class using DirectX 8</H2>
            <P>If you still want a DirectX Midi Player (which also supports 
            3D-Sound, special effects etc) download cMidiMusic (C++) from <A 
            href="http://www.codeproject.com/audio/cmidimusic.asp?target=cmidimusic" 
            target=_blank>http://www.codeproject.com/audio/cmidimusic.asp?target=cmidimusic</A> 
            (It requires DirectX 8) <!-- Article Ends --></P></DIV></SPAN>
            <SCRIPT 
            src="MCI Midi class - The Code Project - Audio and Video_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>AXELMUELLER</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><BR></TD>
                <TD class=smallText>
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=99950">here</A> 
                  to view AXELMUELLER's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular Audio and Video articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/audio/avicapwrp.asp">CAviCap 
                    and CFrameGrabber - wrappers for AVICap Window</A>
                    <DIV class=smallText>AVICap wrappers to ease real-time video 
                    processing and single frame capture</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/audio/midiwrapper.asp">Wrapper 
                    Library for Windows MIDI API</A>
                    <DIV class=smallText>A small library encapsulating the 
                    Windows MIDI API</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/audio/twaintest.asp">A C++ 
                    Wrapper for TWAIN</A>
                    <DIV class=smallText>A C++ wrapper for TWAIN. Allows you to 
                    implement a scanning interface.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/audio/mpegaudioinfo.asp">MPEG 
                    Audio Frame Header</A>
                    <DIV class=smallText>An article about the MPEG audio frame 
                    header.</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=3941&cb=1601071\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</SCRIPT>
                </TD></TR></TBODY></TABLE>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden value=MidiDemoCp/audio7/15/2003 
            name=vote_name> <INPUT type=hidden value=/audio/mididemocp.asp 
            name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/audio/mididemocp.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <DIV style="MARGIN: 10px"><SPAN id=AdBanner5>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2913&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FSoftwareVerify%5F468x60%5Fv8%2Egif&C=False&id=2913&cb=1601058\" alt=\"\" border=0 width=468 height=60></a>");</SCRIPT>
            </SPAN></DIV></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="MCI Midi class - The Code Project - Audio and Video_files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=16204"><IMG 
                              height=15 
                              src="MCI Midi class - The Code Project - Audio and Video_files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION 
                              value=3>Expanded</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="MCI Midi class - The Code Project - Audio and Video_files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 6 of 6 (Total: 6) 
                              (<A 
                              href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;forumid=16204">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MCI Midi class - The Code Project - Audio and Video_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1028882_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1028882xx></A><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;forumid=16204&amp;select=1028882#xx1028882xx" 
                                name=1028882><B>MCI start pos 
                                problem</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1700234"><IMG 
                                title="Click for User Profile" height=15 
                                src="MCI Midi class - The Code Project - Audio and Video_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>wanders</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>13:58 1 
                                Feb 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1028882_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I'm 
                                using MCI to playback MIDI for a game. Having 
                                all my music parts in the same midi file has 
                                worked great till Win XP, where suddenly 
                                MCI_OPEN delays proportional to the file size, 
                                in my case 20 seconds to load.<BR><BR>Resorting 
                                to DirectMusic to solve the problem but would do 
                                fine with the low level API found in WINMM.DLL 
                                which works perfectly without any delays and 
                                wont require DirectX 8+ to run.<BR><BR>Here's 
                                the problem. When setting a start position the 
                                music doesn't start where it should. Having 
                                checked the exact time position in a several 
                                midi editors, setting the start pos doesn't 
                                work, even if adjusting the position +- a few 
                                seconds. This worked fine in earlier versions of 
                                MCI, Win 95/98.<BR><BR>Any help appreciated. 
                                <IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/smiley_confused.gif" 
                                align=absMiddle> 
                                <BR><BR>wanders<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=1028882">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=1028882">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;tid=1028882&amp;forumid=16204&amp;select=1028882#xx1028882xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=1028882#xx1028882xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=1028882#xx1028882xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1700234,1028882);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MCI Midi class - The Code Project - Audio and Video_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="MCI Midi class - The Code Project - Audio and Video_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=861239_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx861239xx></A><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;forumid=16204&amp;select=861239#xx861239xx" 
                                name=861239><B>Bug fix</B></A></TD>
                                <TD vAlign=bottom noWrap><IMG height=13 
                                alt="Unconfirmed/Anonymous posting" 
                                src="MCI Midi class - The Code Project - Audio and Video_files/usersuss.gif" 
                                width=15></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Actin</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>19:14 25 
                                Jun 
                            '04</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=861239_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>This 
                                was useful code. With some experimentation, I 
                                figured out why it skips the first quarter note: 
                                it takes a moment for the midi to rewind. If 
                                it's critical, you can replace the 
                                command<BR><BR>mciSendString("play MidiDemo from 
                                0", 0, 0, 
                                0);<BR><BR>with<BR><BR>mciSendString("seek 
                                MidiDemo to start wait", 0, 0, 
                                0);<BR>mciSendString("play MidiDemo", 0, 0, 
                                0);<BR><BR>and the problem will not occur, 
                                although there will be a slight pause. Thanks 
                                again! <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=861239">Reply</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;tid=861239&amp;forumid=16204&amp;select=861239#xx861239xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=861239#xx861239xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=861239#xx861239xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=861239">Modify</A> 
                                | <A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=861239">Delete</A>]<BR>
                                <SCRIPT language=Javascript>MsgVoteForm(0,861239);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MCI Midi class - The Code Project - Audio and Video_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="MCI Midi class - The Code Project - Audio and Video_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=737734_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx737734xx></A><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;forumid=16204&amp;select=737734#xx737734xx" 
                                name=737734><B>Woo</B></A></TD>
                                <TD vAlign=bottom noWrap><IMG height=13 
                                alt="Unconfirmed/Anonymous posting" 
                                src="MCI Midi class - The Code Project - Audio and Video_files/usersuss.gif" 
                                width=15></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Anonymous</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>20:11 11 
                                Feb 
                            '04</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=737734_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Even my 
                                kid sister can write a class to play [insert 
                                format here] via MCI. That particular (super 
                                high level) API has been around for what... 10 
                                years? <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=737734">Reply</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;tid=737734&amp;forumid=16204&amp;select=737734#xx737734xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=737734#xx737734xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=737734#xx737734xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 1.8 (2 
                                votes).
                                <SCRIPT language=Javascript>MsgVoteForm(0,737734);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MCI Midi class - The Code Project - Audio and Video_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="MCI Midi class - The Code Project - Audio and Video_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=552977_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx552977xx></A><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aaaaaa" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aaaaaa" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;forumid=16204&amp;select=552977#xx552977xx" 
                                name=552977><B>Resource files</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=68081"><IMG 
                                title="Click for User Profile" height=15 
                                src="MCI Midi class - The Code Project - Audio and Video_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aaaaaa"><B>Mykel</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aaaaaa"><B>17:08 15 Jul 
                                '03</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=552977_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>First 
                                of all: Congratulations this is a very nice 
                                class <IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/rose.gif" 
                                align=absMiddle><BR><BR>But for my usage, there 
                                is one important feature missing at the moment: 
                                The ability to play WAV oder especially MIDI 
                                files from implemented resource files. For WAV 
                                files it's no big deal, cause there are some 
                                real nice functions implemented... but not for 
                                MIDI.<BR><BR>If I release a program I don't like 
                                to add the pure WAV/MIDI files, but I want to 
                                add them as a resource. Sure if you want to make 
                                winamp-like app the existing features are enough 
                                and the right choice. But if you just want to 
                                play a MIDI in the about box, it would be better 
                                to play it from a resource...<BR><BR>Just a 
                                small suggestion for a new version... but great 
                                job anyway !! <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=552977">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=552977">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;tid=552977&amp;forumid=16204&amp;select=552977#xx552977xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=552977#xx552977xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=552977#xx552977xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (4 
                                votes).
                                <SCRIPT language=Javascript>MsgVoteForm(68081,552977);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="MCI Midi class - The Code Project - Audio and Video_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1774848_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1774848xx></A><IMG 
                                height=1 
                                src="MCI Midi class - The Code Project - Audio and Video_files/ind.gif" 
                                width=18><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;forumid=16204&amp;select=1774848#xx1774848xx" 
                                name=1774848>Re: Resource files</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2582056"><IMG 
                                title="Click for User Profile" height=15 
                                src="MCI Midi class - The Code Project - Audio and Video_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>jus199&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>22:31 24 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1774848_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="MCI Midi class - The Code Project - Audio and Video_files/ind.gif" 
                                width=18><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent><BR><BR><BR>How would you 
                                go about playing a file as a resource???? 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=1774848">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=1774848">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;tid=552977&amp;forumid=16204&amp;select=1774848#xx1774848xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=1774848#xx1774848xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=552977#xx552977xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2582056,1774848);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="MCI Midi class - The Code Project - Audio and Video_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1787316_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1787316xx></A><IMG 
                                height=1 
                                src="MCI Midi class - The Code Project - Audio and Video_files/ind.gif" 
                                width=36><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;forumid=16204&amp;select=1787316#xx1787316xx" 
                                name=1787316>Re: Resource files</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=68081"><IMG 
                                title="Click for User Profile" height=15 
                                src="MCI Midi class - The Code Project - Audio and Video_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>mykel&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>5:55 3 Dec 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1787316_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="MCI Midi class - The Code Project - Audio and Video_files/ind.gif" 
                                width=36><IMG 
                                src="MCI Midi class - The Code Project - Audio and Video_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Checkout this 
                                article:<BR><A 
                                href="http://www.codeguru.com/cpp/g-m/multimedia/article.php/c1573/" 
                                rel=nofollow>http://www.codeguru.com/cpp/g-m/multimedia/article.php/c1573/</A>[<A 
                                href="http://www.codeguru.com/cpp/g-m/multimedia/article.php/c1573/" 
                                target=_blank rel=nofollow>^</A>] <BR><BR>
                                <DIV 
                                class=ForumSig>cheers,<BR>mykel<BR><BR><CODE>If 
                                they give you lined paper, write the other 
                                way!</CODE></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=1787316">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/audio/mididemocp.asp&amp;df=100&amp;forumid=16204&amp;select=1787316">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?df=100&amp;tid=552977&amp;forumid=16204&amp;select=1787316#xx1787316xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=1787316#xx1787316xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/audio/mididemocp.asp?msg=552977#xx552977xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(68081,1787316);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="MCI Midi class - The Code Project - Audio and Video_files/t.gif" 
                              width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=#fbedbb>
                      <TD>
                        <TABLE cellPadding=2 width="100%">
                          <TBODY>
                          <TR>
                            <TD class=messagetitle>Last Visit: 4:07 Saturday 
                              29th September, 2007</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="MCI Midi class - The Code Project - Audio and Video_files/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="MCI Midi class - The Code Project - Audio and Video_files/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="MCI Midi class - The Code Project - Audio and Video_files/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="MCI Midi class - The Code Project - Audio and Video_files/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="MCI Midi class - The Code Project - Audio and Video_files/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="MCI Midi class - The Code Project - Audio and Video_files/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 15 Jul 2003 </TD>
                <TD class=SmallText align=right>Article content copyright 
                  AXELMUELLER, 2003<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2007</A>. <BR>Web15 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <SCRIPT 
      src="MCI Midi class - The Code Project - Audio and Video_files/front.asp" 
      type=text/javascript></SCRIPT>
      <BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="MCI Midi class - The Code Project - Audio and Video_files/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  
            <A href="http://aspalliance.com/">ASP Alliance</A>  <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
            href="http://www.developersdex.com/">Developersdex</A>  <A 
            href="http://www.devguru.com/">DevGuru</A>  <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A>  
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
