<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0056)http://www.codeproject.com/KB/audio-video/cswavplay.aspx -->
<HTML><HEAD><TITLE>CodeProject: A low-level audio player in C#. Free source code and programming help</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="This article describes a sample application that uses the waveout API in C#.; Author: Ianier Munoz; Section: Audio and Video; Chapter: Multimedia" 
name=Description>
<META 
content=".NET 1.0, Win2K, WinXP, VS.NET2002, C#, Dev, Intermediate,Audio and Video,Multimedia,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject A low-level audio player in C#_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject A low-level audio player in C#_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("www.codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if(top!=self)top.location.href=location.href; if(typeof(DemoUrl)!="undefined")document.write(unescape('%3Cme')+'ta http'+'-equiv="re' +'fresh" con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/jxs.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/bookmark.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/rateitem.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/jquery-1.2.6.min.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function MarkAns(MemberID,MsgID,QID) {
 document.write(unescape("%3Cdiv class=\"CallOut\"%3E"));
 document.write("Was this a good answer to your question? ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+", "+MsgID.toString()+",6,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"correct\" border=\"0\" align=\"absmiddle\" /%3E Yes%3C/a%3E"));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+","+MsgID.toString()+",7,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"correct\" style=\"margin-left:10px\" border=\"0\" align=\"absmiddle\" /%3E No%3C/a%3E"));
 document.write(unescape("%3C/div%3E"));
}
function MsgVFrm(MemberID,MsgID,GB,gp,bp,mt){
 if(!GB)document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"5":"1")+unescape(",0);\"%3E"));
 if(GB) document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;"); else for(var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"vote this message a " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ",0)\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"1":"5")+unescape(",0);\"%3E"));
 if(GB)document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" border=\"0\" alt=\"vote 5\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;&nbsp; "); else document.write(unescape("%3Cbr /%3E")); document.writeln(unescape("[%3Ca href='#xx") + MsgID.toString() +"xx' title='Report as Abuse' onclick='return ReportMsg(" + MemberID.toString());
 document.writeln(", " + MsgID.toString() + unescape(",-2)'%3EReport Message%3C/a%3E]"));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?"))
  return RateMsg(userid, msgid, score, 0);
 else return false;
}
function RateMsg(memberid, msgid, score, questionId) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4){
   if (req.status == 200){
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match&&match[1])?match[1]:"An error occured" + unescape("%3C/b%3E");
   } else
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString()+"&qid="+questionId.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK 
href="CodeProject A low-level audio player in C#_ Free source code and programming help_files/ForumClassicIE6.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" type=image/ico rel="shortcut icon">
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            id=ctl00_Logo 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; WIDTH: 225px; HEIGHT: 90px; BORDER-RIGHT-WIDTH: 0px" 
            alt="The Code Project" 
            src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/logo225x90.gif"></A></TD>
          <TD class=HeaderBanner align=right width="100%"><IFRAME 
            src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/ServeHTML.htm" 
            frameBorder=0 width=728 scrolling=no height=90></IFRAME></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">5,536,936 
                  members and growing! (17,029 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">Abdelrady_FCIS</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx">My 
                  Settings</A> | <A id=ctl00_MemberMenu_MyCodeProject 
                  href="http://www.codeproject.com/script/Membership/MyCodeProject.aspx"><B>My 
                  CodeProject</B></A> | <A id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/fave.gif" 
                  width=16 align=absMiddle border=0> My Bookmarks</A> | <A 
                  id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2faudio-video%2fcswavplay.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD noWrap><A href="http://www.codeproject.com/">Home</A></TD>
                <TD>&nbsp; </TD>
                <TD style="FONT-WEIGHT: normal" noWrap align=right>Current 
                  Site:</TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/">C++ / .NET</A></TD>
                <TD noWrap><A href="http://java.codeproject.com/">Java</A></TD>
                <TD noWrap><A href="http://sql.codeproject.com/">SQL</A></TD>
                <TD noWrap><A href="http://lamp.codeproject.com/">Linux / 
                  Unix</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus>
                  <DIV id=MenuPos 
                  style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=380>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
                        Board</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A> 
            » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/audio-video/">Audio and 
            Video</A> » <A id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/audio-video/index.aspx?#Audio and Video - Audio">Audio</A> 
            <SPAN class=ArticleIntermediate 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Intermediate</SPAN> <SPAN 
            id=ctl00_ArticleTopHeader_LicenceTerms></SPAN><BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>A low-level audio player in 
            C#</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=90428">Ianier 
            Munoz</A></B><BR><BR><SPAN class=ArticleTopDescr 
            id=ctl00_ArticleTopHeader_ArticleDescr>This article describes a 
            sample application that uses the waveout API in C#.</SPAN> </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>C#Windows, .NET, .NET 
            1.0, Win2K, WinXPVS.NET2002, Visual Studio, Dev</SPAN><BR><BR><SPAN 
            style="WIDTH: 14ex">Posted</SPAN>: <B>11 Dec 2002</B><BR><SPAN 
            style="WIDTH: 14ex">Updated</SPAN>: <B>27 Aug 2003</B> <BR><SPAN 
            style="WIDTH: 14ex">Views</SPAN>: <B>292,128</B><BR><SPAN 
            style="WIDTH: 14ex">Bookmarked</SPAN>: <B>117 times</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar" 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px">
      <TABLE cellPadding=2>
        <TBODY>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/Info_24.png" 
            width=24 align=middle></TD>
          <TD><A id=ctl00_Announcements_CompLink 
            href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
            Competition</A></TD></TR></TBODY></TABLE></DIV>
      <DIV class=FeatureBlockHeader style="MARGIN-TOP: 7px">Want a new 
Job?</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <UL class=InfoList>
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=132">ASP.NET/AJAX 
        Web Game Developer: 37 Signals Environment</A> at Hive7 in United States
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=50">Senior 
        .NET Programmer/Architect</A> at Greater Than Solutions in United States
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=93">Lead 
        Graphical User Interface Developer</A> at ECTPay in United States
        <LI><A href="http://www.codeproject.com/script/Jobs/List.aspx">View 
        Latest Jobs...</A></LI></UL></DIV>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2 style="DISPLAY: none">
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3>
      <DIV class=MIS id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4 style="DISPLAY: none">
      <DIV class=MI id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5 style="DISPLAY: none">
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV>
      <DIV class=MI id=Section126><A 
      href="http://www.codeproject.com/KB/codegen/">Code 
      Generation</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter12');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=12">Third 
      Party Products</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter12 style="DISPLAY: none">
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section124><A 
      href="http://www.codeproject.com/KB/solution-center/">Solution 
      Center</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
Board</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/kb/Showcase/">Product Showcase</A></DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/WhitePapers">WhitePapers / 
      Webcasts</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/Acresso">InstallShield 
      2009</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/APress">Apress 
      Bookstore</A></DIV><BR>
      <DIV style="MARGIN-BOTTOM: 10px; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6247%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fcp_daily_150x80.gif%26C%3dFalse%26adid%3d6247%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22150%22%20height%3d%2280%22%3e%3c%2fa%3e"));</SCRIPT>
      </DIV>
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d7713%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252fmilestone_RIMM2023-BBDC_Code-Project_160x600.gif%26C%3dFalse%26adid%3d7713%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22160%22%20height%3d%22600%22%3e%3c%2fa%3e"));</SCRIPT>
    </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION> <OPTION value=s>Jobs</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top width="100%">
            <TABLE>
              <TBODY></TBODY></TABLE>
            <DIV class=SmallText><IMG style="VERTICAL-ALIGN: middle" height=16 
            alt=print 
            src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/print.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
            href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?display=Print">Print</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Broken Article?" 
            src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/report.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_BrokenLnk 
            href="http://www.codeproject.com/script/Articles/Report.aspx?aid=3352">Report 
            Article</A> &nbsp; <IMG style="VERTICAL-ALIGN: middle" alt=Watch 
            src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/watchon.png"> 
            <A class="" id=ctl00_ArticleHeaderLinks_ArticleBmkWatch_WatchMe 
            onclick="return watchMe(3352, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3352&amp;obtid=2&amp;bma=AddWatch" 
            name=bmw_3352_2>Watch</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Bookmark 
            src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/link.png" 
            width=16> <A class="" 
            id=ctl00_ArticleHeaderLinks_ArticleBmk_BookmarkMe 
            onclick="return bookmarkMe(3352, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=3352&amp;obtid=2&amp;bma=AddBookmark" 
            name=bm_3352_2>Bookmark</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Discuss 
            src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/discuss.gif" 
            width=15> <A 
            href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx#_comments">Discuss</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Recommend Article" 
            src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/mail.gif" 
            width=16>&nbsp;<A id=ctl00_ArticleHeaderLinks_Recommend 
            href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=3352">Send&nbsp;to&nbsp;a&nbsp;friend</A> 
            </DIV></TD>
          <TD style="WIDTH: 100px; WHITE-SPACE: nowrap; TEXT-ALIGN: right">
            <TABLE id=CurRat>
              <TBODY>
              <TR>
                <TD>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=SmallText id=ctl00_ArticleRating_VL 
                      style="WHITE-SPACE: nowrap" align=right><SPAN 
                        id=ctl00_ArticleRating_VoteLabel>59 votes for this 
                        Article.</SPAN></TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=1>
                          <TBODY>
                          <TR>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD noWrap width=20 bgColor=white height=7><IMG 
                              height=7 
                              src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/red.gif" 
                              width=8 align=center 
                      border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=ctl00_ArticleRating_PopularityRow>
                      <TD class=SmallText align=right colSpan=2><A 
                        id=ctl00_ArticleRating_PopularityLnk 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                        7.83</A> <SPAN 
                        id=ctl00_ArticleRating_PopularityLbl></SPAN><SPAN 
                        id=ratingVal>Rating: <B>4.42</B> out of 
                    5</SPAN></TD></TR></TBODY></TABLE></TD>
                <TD>
                  <DIV>
                  <TABLE class=HistTable 
                  title="Voting Distribution. Recent data only">
                    <TBODY>
                    <TR>
                      <TD><IMG title="3 votes, 5.1%" height=1 
                        alt="3 votes, 5.1%" 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>1</TD>
                      <TD><IMG title="2 votes, 3.4%" height=1 
                        alt="2 votes, 3.4%" 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>2</TD>
                      <TD><IMG title="1 vote, 1.7%" height=1 
                        alt="1 vote, 1.7%" 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>3</TD>
                      <TD><IMG title="6 votes, 10.2%" height=2 
                        alt="6 votes, 10.2%" 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>4</TD>
                      <TD><IMG title="47 votes, 79.7%" height=20 
                        alt="47 votes, 79.7%" 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/pollcol.gif" 
                        width=10 
              border=0><BR>5</TD></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/audio-video/cswavplay/cswavplay_src.zip">Download 
        source files - 12 Kb</A></LI></UL>
      <P><IMG height=82 alt="Sample Image - cswavplay.gif" 
      src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/cswavplay.gif" 
      width=256></P>
      <H2>Introduction</H2>
      <P>It is no news that the .NET framework does not include any classes for 
      dealing with sound. Some people have worked around this limitation by 
      wrapping high-level system components, such as Windows Media Player or 
      DirectShow, into .NET-friendly libraries. However, most of these libraries 
      are designed in such a way that they cannot be used to manipulate audio 
      samples on the fly because they do not give you access to the actual sound 
      data.</P>
      <P>When developing applications that deal with such <I>low-level</I> 
      issues, the most commonly used technologies are DirectSound and the 
      waveout API. This article describes a sample application that uses the 
      waveout API in C# through Interop to play a WAV file in a continuous 
      loop.</P>
      <H2>Using the code</H2>
      <P>Most of the work in the sample application is carried out by two 
      classes: <CODE lang=cs>WaveStream</CODE> and <CODE 
      lang=cs>WaveOutPlayer</CODE>.</P>
      <P>The <CODE lang=cs>WaveStream</CODE> class extends <CODE 
      lang=cs>System.IO.Stream</CODE> and implements the necessary code to read 
      audio samples from a WAV file. The constructor reads the file header and 
      extracts all the relevant information including the actual length of the 
      stream and the format of the audio samples, which is exposed through the 
      <CODE lang=cs>Format</CODE> property.</P>
      <P>One important thing to note is that seeking operations in the <CODE 
      lang=cs>WaveStream</CODE> class are relative to the sound data stream. 
      This way you don't have to care about the length of the header or about 
      those extra bytes at the end of the stream that don't belong to the audio 
      data chunk. Seeking to 0 will cause the next read operation to start at 
      the beginning of the audio data.</P>
      <P>The <CODE lang=cs>WaveOutPlayer</CODE> class is where the most 
      interesting things happen. For the sake of simplicity, the interface of 
      this class has been reduced to the strict minimum. There are no Start, 
      Stop or Pause methods. Creating an instance of <CODE 
      lang=cs>WaveOutPlayer</CODE> will cause the system to start streaming 
      immediately.</P>
      <P>Let's have a look at the code that creates the <CODE 
      lang=cs>WaveOutPlayer</CODE> instance. As you can see, the constructor 
      takes five parameters:</P><PRE lang=cs><SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> Play()
{
    Stop();
    <SPAN class=code-keyword>if</SPAN> (m_AudioStream != <SPAN class=code-keyword>null</SPAN>)
    {
        m_AudioStream.Position = <SPAN class=code-digit>0</SPAN>;
        m_Player = <SPAN class=code-keyword>new</SPAN> WaveLib.WaveOutPlayer(-1, m_Format, <SPAN class=code-digit>16384</SPAN>, <SPAN class=code-digit>3</SPAN>, 
            <SPAN class=code-keyword>new</SPAN> WaveLib.BufferFillEventHandler(Filler));
    }
}
</PRE>
      <P>The first parameter is the ID of the wave device that you want to use. 
      The value -1 represents the default system device, but if your system has 
      more than one sound card, then you can pass any number from 0 to the 
      number of installed sound cards minus one to select a particular 
      device.</P>
      <P>The second parameter is the format of the audio samples. In this 
      example, the format is taken directly from the wave stream.</P>
      <P>The third and forth parameters are the size of the internal wave 
      buffers and the number of buffers to allocate. You should set these to 
      reasonable values. Smaller buffers will give you less latency, but the 
      audio may stutter if your computer is not fast enough.</P>
      <P>The fifth and last parameter is a delegate that will be called 
      periodically as internal audio buffers finish playing, so that you can 
      feed them with new sound data. In the sample application we just read 
      audio data from the wave stream, like this:</P><PRE lang=cs><SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> Filler(<SPAN class=code-SDKkeyword>IntPtr</SPAN> data, <SPAN class=code-keyword>int</SPAN> size)
{
    <SPAN class=code-keyword>byte</SPAN>[] b = <SPAN class=code-keyword>new</SPAN> <SPAN class=code-keyword>byte</SPAN>[size];
    <SPAN class=code-keyword>if</SPAN> (m_AudioStream != <SPAN class=code-keyword>null</SPAN>)
    {
        <SPAN class=code-keyword>int</SPAN> pos = <SPAN class=code-digit>0</SPAN>;
        <SPAN class=code-keyword>while</SPAN> (pos &lt; size)
        {
            <SPAN class=code-keyword>int</SPAN> toget = size - pos;
            <SPAN class=code-keyword>int</SPAN> got = m_AudioStream.Read(b, pos, toget);
            <SPAN class=code-keyword>if</SPAN> (got &lt; toget)
                m_AudioStream.Position = <SPAN class=code-digit>0</SPAN>; <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> loop if the file ends
</SPAN>            pos += got;
        }
    }
    <SPAN class=code-keyword>else</SPAN>
    {
        <SPAN class=code-keyword>for</SPAN> (<SPAN class=code-keyword>int</SPAN> i = <SPAN class=code-digit>0</SPAN>; i &lt; b.Length; i++)
            b[i] = <SPAN class=code-digit>0</SPAN>;
    }
    System.Runtime.InteropServices.Marshal.Copy(b, <SPAN class=code-digit>0</SPAN>, data, size);
}
</PRE>
      <P>Please note that this delegate may be called from any internal thread 
      created by the <CODE lang=cs>WaveOutPlayer</CODE> object, so if you want 
      to call into your Windows Forms objects you should use the <CODE 
      lang=cs>Invoke</CODE> mechanism.</P>
      <P>To stop playing, just call <CODE lang=cs>Dispose</CODE> on the player 
      object, like this:</P><PRE lang=cs><SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> Stop()
{
    <SPAN class=code-keyword>if</SPAN> (m_Player != <SPAN class=code-keyword>null</SPAN>)
    <SPAN class=code-keyword>try</SPAN>
    {
        m_Player.Dispose();
    }
    <SPAN class=code-keyword>finally</SPAN>
    {
        m_Player = <SPAN class=code-keyword>null</SPAN>;
    }
}
</PRE>
      <H2>Conclusion</H2>
      <P>This sample demonstrates how to use the waveout API from C#. This is 
      useful for applications that require more control on the audio stream 
      compared to what other higher level libraries offer. Typical examples are 
      applications that generate or modify audio samples on the fly, such as 
      digital effect processors.</P>
      <P>A modified version of this sample that implements support for DirectX 
      plug-ins is included in the Adapt-X SDK, which is a commercial product 
      that can be found at <A href="http://www.chronotron.com/" 
      target=_blank>http://www.chronotron.com/</A>.</P>
      <H2>History</H2>
      <P>Update 28 Aug 03 - <FONT size=2>Fixed a bug related to reading the WAV 
      file header.</P></FONT><!-- Article Ends --><!-- Main Page Contents End --></DIV>
      <FORM id=aspnetForm 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
      name=aspnetForm action=cswavplay.aspx method=post>
      <DIV><INPUT id=__VIEWSTATE type=hidden 
      value=/wEPDwULLTEwMDUyNjYzMjhkZAoVDRg8b0lwzb0Q1ywQ2kQEmf0y 
      name=__VIEWSTATE> </DIV>
      <H2>License</H2>
      <DIV id=ctl00_LicenseTerms>
      <P>This article has no explicit license attached to it but may contain 
      usage terms in the article text or the download files themselves. If in 
      doubt please contact the author via the discussion board below.</P>
      <P>A list of licenses authors might use can be found <A 
      href="http://www.codeproject.com/info/Licenses.aspx">here</A></P></DIV>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=90428">Ianier 
            Munoz</A></B><BR><BR>
            <CENTER><IMG id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
            src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/{6B071346-39D0-4461-8A1D-C0CDE6FC749E}.gif"></CENTER><BR><SPAN 
            class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>Ianier Munoz lives in France and works as a senior consultant 
            and analyst for an international consulting firm. His specialty is 
            in multimedia applications, and he has authored some popular 
            software, such as American DJ's Pro-Mix, Chronotron and 
            Adapt-X.<BR><BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow>
                <TD class=SmallText noWrap>Occupation: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Web 
                  Developer</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt=Luxembourg 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/LU.gif" 
                  width=16> 
      Luxembourg</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular Audio and Video articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/audio-video/Motion_Detection.aspx">Motion 
              Detection Algorithms</A>
              <DIV class=SmallText>Some approaches to detect motion in a video 
              stream.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/audio-video/cameraviewer.aspx">Camera 
              Vision - video surveillance on C#</A>
              <DIV class=SmallText>A C# video surveillance application, which 
              allows monitoring several IP cameras simultaneously.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/audio-video/face_detection.aspx">Face 
              Detection C++ Library with Skin and Motion Analysis</A>
              <DIV class=SmallText>The article demonstrates face detection SSE 
              optimized C++ library for color and gray scale data with skin 
              detection, motion estimation for faster processing, small sized 
              SVM and NN rough face prefiltering, PCA/LDA/ICA/any dimensionality 
              reduction/projection and final NN classification</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/audio-video/avifilewrapper.aspx">A 
              Simple C# Wrapper for the AviFile Library</A>
              <DIV class=SmallText>Edit AVI files in .NET.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/audio-video/avicapwrp.aspx">CAviCap 
              and CFrameGrabber - wrappers for AVICap Window</A>
              <DIV class=SmallText>AVICap wrappers to ease real-time video 
              processing and single frame capture</DIV></LI></UL></TD>
          <TD><IFRAME 
            src="E:\html_new\codeproject\CodeProject A low-level audio player in C#_ Free source code and programming help_files\ServeHTML(1).htm" 
            frameBorder=0 width=300 scrolling=no 
        height=250></IFRAME></TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
var socialLinks = new social();
socialLinks.addtoMethod=1;
socialLinks.DrawLinks("socialLinks", document.location.href, escape(document.title), 100, 0, "SmallText Bold", "AddTo");
</SCRIPT>
      </DIV>
      <TABLE class=RatingBar id=ctl00_RateArticleRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD id=ctl00_RateArticle_VoteResultDiv noWrap align=right 
                width="100%"><SPAN id=voteRes></SPAN><IMG id=loaderImg 
                  style="DISPLAY: none" height=16 alt=loading... 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/ajax-loader.gif" 
                  width=16> </TD>
                <TD class=SmallText id=voteTbl style="WHITE-SPACE: nowrap" 
                align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px; WHITE-SPACE: nowrap"><I><B>Rate 
                        this Article for us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm noWrap 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn onclick="return rateItem(3352,2);" type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV><INPUT id=__EVENTVALIDATION type=hidden 
      value=/wEWCALqvdQnAsCUxcMHAsGUxcMHAsKUxcMHAsOUxcMHAsSUxcMHAs/7760LArm6kOQLl0iLQuSIE5ZCGj3gnZYZm3Hcv4c= 
      name=__EVENTVALIDATION> </DIV></FORM>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d7451%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252fappdev_cp.vs08.46860.gif%26C%3dFalse%26adid%3d7451%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22468%22%20height%3d%2260%22%3e%3c%2fa%3e"));</SCRIPT>
      <IFRAME 
      src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/ServeLinks.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD>
            <FORM 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2faudio-video%2fcswavplay.aspx&amp;fid=13779 
            method=get><INPUT type=hidden value=13779 name=fid><INPUT 
            type=hidden 
            value=?floc=%2fKB%2faudio-video%2fcswavplay.aspx&amp;fid=13779 
            name=currentQS><INPUT type=hidden 
            value=/KB/audio-video/cswavplay.aspx name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 alt=FAQ 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/forum_faq.gif" 
                  width=16 align=middle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 alt=Search 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/forum_search.gif" 
                  width=16 align=top border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=13779">Search 
                  Messages</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=SetOpt></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></FORM></TD></TR>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 alt=new 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/forum_newmsg.gif" 
                  width=16 align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;floc=/KB/audio-video/cswavplay.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 25 of 142 (Total in Forum: 142) (<A 
                  href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next</A></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0><!-- Column Headers -->
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2714979_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2714979xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2714979#xx2714979xx" 
                        name=2714979>Can't download</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=5318239">Jörgen 
                        Ellberg</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:54 9 
                        Sep '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2714979_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I find this article intresting, 
                                but I can not download the code.<BR>Is the code 
                                missing?<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2714979&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2714979&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2714979">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2714979">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2714979&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2714979 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(5318239,2714979,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2683559_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2683559xx></A><IMG height=16 alt=Question 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2683559#xx2683559xx" 
                        name=2683559>progress bar help</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=5428912">towerturtle</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">16:28 
                        18 Aug '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2683559_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I want to set the max value of a 
                                progress bar to the length in seconds of the 
                                sound I loaded in System.Media.soundPlayer. how 
                                do I do that?<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2683559&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2683559&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2683559">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2683559">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2683559&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2683559 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(5428912,2683559,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2677254_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2677254xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2677254#xx2677254xx" 
                        name=2677254>WMA player</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=5432490">monchi8687</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:05 
                        13 Aug '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2677254_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi. does anyone have a c++ code 
                                for a simple wma audio player? any help is 
                                greatly appreciated.<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2677254&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2677254&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2677254">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2677254">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2677254&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2677254 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(5432490,2677254,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2649992_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2649992xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2649992#xx2649992xx" 
                        name=2649992>Listener</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=5105684">bethany</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:22 24 
                        Jul '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2649992_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hey everybody,<BR>By using this 
                                code the application I have developed able to 
                                play and record audio/music. But it does not 
                                have a listener like what is available in socket 
                                programming. I need your help on how I will 
                                proceed to develop the listener.<BR>Thanks in 
                                advance!<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2649992&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2649992&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2649992">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2649992">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2649992&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2649992 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(5105684,2649992,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2589122_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2589122xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2589122#xx2589122xx" 
                        name=2589122>Playing once</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=166999">moserwi</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:52 9 
                        Jun '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2589122_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Problem: to deactivate the loop 
                                forces the WaveLib.WaveOutPlayer to stop 
                                immediately. that means that the very last part 
                                of the stream will not be played.<BR><BR>This is 
                                definitively the wrong way.<BR><BR>int got = 
                                m_AudioStream.Read(b, pos, toget);<BR>//if (got 
                                &lt; toget)<BR>//{<BR>//m_AudioStream.Position = 
                                0; // loop if the file ends<BR>//} <BR>pos += 
                                got;<BR><BR>A Solution would be really good for 
                                me as I want to create a very small application 
                                for an Windows Mobile Pro.<BR><BR>Thank you. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2589122&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2589122&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2589122">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2589122">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2589122&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2589122 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(166999,2589122,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2624935_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2624935xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2624935#xx2624935xx" 
                        name=2624935>Re: Playing once</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3776184">xavier.fischer</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:27 4 
                        Jul '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2624935_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi moserwi,<BR><BR>I wanted to do 
                                the same. And found a solution. The purpose is 
                                to add a "Loop" checkbox on the MainForm to 
                                enable/disable looping feature live.<BR><BR>I 
                                have added a member variable m_Loop and its 
                                get/set property to WaveOutPlayer.<BR>Added the 
                                loop argument to constructor.<BR><BR><PRE><BR>public class WaveOutPlayer : IDisposable<BR>{<BR>    //...<BR>    private bool m_Loop;<BR><BR>	public bool Loop<BR>        {<BR>            get { return m_Loop; }<BR>            set { m_Loop = value; }<BR>        }<BR><BR>	//..<BR><BR>        public WaveOutPlayer(int device, WaveFormat format, int bufferSize, int bufferCount, BufferFillEventHandler fillProc)<BR>            : this(device, format, bufferSize, bufferCount, true, fillProc)<BR>        {<BR>        }<BR><BR>        public WaveOutPlayer(int device, WaveFormat format, int bufferSize, int bufferCount, bool loop, BufferFillEventHandler fillProc)<BR>        {<BR>            m_Loop = loop;<BR>            m_zero = format.BitsPerSample == 8 ? (byte)128 : (byte)0;<BR>            m_FillProc = fillProc;<BR>            WaveOutHelper.Try(WaveNative.waveOutOpen(out m_WaveOut, device, format, m_BufferProc, 0, WaveNative.CALLBACK_FUNCTION));<BR>            AllocateBuffers(bufferSize, bufferCount);<BR>            m_Thread = new Thread(new ThreadStart(ThreadProc));<BR>            m_Thread.Start();<BR>        }<BR>}<BR></PRE><BR><BR>Then 
                                the delegated needed to be changed in order to 
                                be notified when the stream had finished 
                                playing.<BR><BR><PRE><BR>internal class WaveOutHelper<BR>{<BR>	// ...<BR>	public delegate void BufferFillEventHandler(IntPtr data, int size, ref bool finished);<BR>	//..<BR>}<BR></PRE><BR><BR>The 
                                Filler proc in MainForm had to match the 
                                delegate signature and needed to set "finished" 
                                variable to true when playing was done.<BR><BR><PRE><BR>private void Filler(IntPtr data, int size, ref bool finished)<BR>{<BR>    byte[] b = new byte[size];<BR>    if (m_AudioStream != null)<BR>    {<BR>        int pos = 0;<BR>        while (pos &lt; size)<BR>        {<BR>            int toget = size - pos;<BR>            int got = m_AudioStream.Read(b, pos, toget);<BR>            if (got &lt; toget)<BR>            {<BR>                finished = true; // notify end of playing<BR>                m_AudioStream.Position = 0; // loop if the file ends<BR>            }<BR>            pos += got;<BR>        }<BR>    }<BR>    else<BR>    {<BR>        for (int i = 0; i &lt; b.Length; i++)<BR>            b[i] = 0;<BR>    }<BR>    System.Runtime.InteropServices.Marshal.Copy(b, 0, data, size);<BR>}<BR></PRE><BR><BR>The 
                                playing thread had just to set its m_Finished 
                                variable to true only when m_Loop was 
                                false.<BR><BR><PRE><BR>private void ThreadProc()<BR>{<BR>    while (!m_Finished)<BR>    {<BR>        Advance();<BR>        if (m_FillProc != null &amp;&amp; !m_Finished)<BR>        {<BR>            m_FillProc(m_CurrentBuffer.Data, m_CurrentBuffer.Size, ref m_Finished);<BR>            if (m_Finished &amp;&amp; m_Loop)<BR>                m_Finished = false;<BR>        }<BR>        else<BR>        {<BR>            // zero out buffer<BR>            byte v = m_zero;<BR>            byte[] b = new byte[m_CurrentBuffer.Size];<BR>            for (int i = 0; i &lt; b.Length; i++)<BR>                b[i] = v;<BR>            Marshal.Copy(b, 0, m_CurrentBuffer.Data, b.Length);<BR><BR>        }<BR>        m_CurrentBuffer.Play();<BR>    }<BR>    WaitForAllBuffers();<BR>}<BR></PRE><BR><BR>I 
                                modified the Play procedure in order to pass the 
                                checkbox value to the WaveOutPlayer constructor. 
                                And everything works ok.<BR><BR><PRE><BR>private void Play()<BR>{<BR>    Stop();<BR>    if (m_AudioStream != null)<BR>    {<BR>        m_AudioStream.Position = 0;<BR>        m_Player = new WaveLib.WaveOutPlayer(-1, m_Format, BUFFER_SIZE, 3, chkLoop.Checked, new WaveLib.BufferFillEventHandler(Filler));<BR>    }<BR>}<BR></PRE><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2624935&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2624935&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2589122">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2624935">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2624935&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2624935 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3776184,2624935,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2517755_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2517755xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2517755#xx2517755xx" 
                        name=2517755>end of recording</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=5105684">bethany</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:03 22 
                        Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2517755_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>how can I stop when the incoming 
                                signal ends?<BR>10Q <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2517755&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2517755&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2517755">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2517755">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2517755&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2517755 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(5105684,2517755,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2514703_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2514703xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2514703#xx2514703xx" 
                        name=2514703>Program Errors on play</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4843375">Derek 
                        Bartram</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">10:39 
                        19 Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2514703_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I'm actually having a lot of 
                                issues with playing any wav file in a WPF 
                                application, so i've been looking around for a 
                                demo that plays sound in any form that I can 
                                modify for my needs.<BR><BR>When I run your 
                                program and open a file and then press play I 
                                get the following error;<BR><BR>{"Object 
                                reference not set to an instance of an 
                                object."}<BR>at 
                                WaveLib.WaveNative.waveOutOpen(IntPtr&amp; 
                                hWaveOut, Int32 uDeviceID, WaveFormat lpFormat, 
                                WaveDelegate dwCallback, Int32 dwInstance, Int32 
                                dwFlags)<BR>at WaveLib.WaveOutPlayer..ctor(Int32 
                                device, WaveFormat format, Int32 bufferSize, 
                                Int32 bufferCount, BufferFillEventHandler 
                                fillProc) in 
                                C:\Temp\wavplayer\cswavplay\WaveOut.cs:line 
                                148<BR>at cswavplay.MainForm.Play() in 
                                C:\Temp\wavplayer\cswavplay\MainForm.cs:line 
                                182<BR>at 
                                cswavplay.MainForm.PlayButton_Click(Object 
                                sender, EventArgs e) in 
                                C:\Temp\wavplayer\cswavplay\MainForm.cs:line 
                                231<BR>at 
                                System.Windows.Forms.Control.OnClick(EventArgs 
                                e)<BR>at 
                                System.Windows.Forms.Button.OnMouseUp(MouseEventArgs 
                                mevent)<BR>at 
                                System.Windows.Forms.Control.WmMouseUp(Message&amp; 
                                m, MouseButtons button, Int32 clicks)<BR>at 
                                System.Windows.Forms.Control.WndProc(Message&amp; 
                                m)<BR>at 
                                System.Windows.Forms.ButtonBase.WndProc(Message&amp; 
                                m)<BR>at 
                                System.Windows.Forms.Button.WndProc(Message&amp; 
                                m)<BR>at 
                                System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message&amp; 
                                m)<BR>at 
                                System.Windows.Forms.NativeWindow.DebuggableCallback(IntPtr 
                                hWnd, Int32 msg, IntPtr wparam, IntPtr 
                                lparam)<BR>at 
                                System.Windows.Forms.UnsafeNativeMethods.DispatchMessageW(MSG&amp; 
                                msg)<BR>at 
                                System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(Int32 
                                dwComponentID, Int32 reason, Int32 
                                pvLoopData)<BR>at 
                                System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(Int32 
                                reason, ApplicationContext context)<BR>at 
                                System.Windows.Forms.Application.ThreadContext.RunMessageLoop(Int32 
                                reason, ApplicationContext context)<BR>at 
                                cswavplay.MainForm.Main() in 
                                C:\Temp\wavplayer\cswavplay\MainForm.cs:line 
                                133<BR>at 
                                System.AppDomain._nExecuteAssembly(Assembly 
                                assembly, String[] args)<BR>at 
                                Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()<BR>at 
                                System.Threading.ExecutionContext.Run(ExecutionContext 
                                executionContext, ContextCallback callback, 
                                Object state)<BR>at 
                                System.Threading.ThreadHelper.ThreadStart()<BR><BR>The 
                                file plays correctly in my windows media player 
                                (11.0.6001.6336).<BR>Incidently the file I tried 
                                was chimes.wav found in the windows\media folder 
                                (although it happens with all files I 
                                try).<BR><BR>I'm running on Windows Server 2008 
                                RC0 x64<BR><BR>Any help would be appreated, 
                                thanks.<BR><BR>Ps. Before you suggest 
                                MediaPlayer in the System.Windows.Media 
                                namespace that doesn't work either, you hear no 
                                sound but no errors or exceptions, however an 
                                entry appears in the windows mixer for the 
                                application. Very odd and a little frustrating. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2514703&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2514703&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2514703">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2514703">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2514703&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2514703 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4843375,2514703,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2507374_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2507374xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2507374#xx2507374xx" 
                        name=2507374>PCM Audio is not compressed using 
                        WriteSample</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4068207">Member 
                        4068207</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">22:03 
                        14 Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2507374_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR><BR>I have searched these 
                                articles and googled for hours but have found no 
                                clue to this.<BR><BR>I created to build wmv 
                                video from bitmaps and uncompressed PCM audio 
                                stream. The XML used for SetProfile is attached 
                                below. This profile is set up for PCM audio. 
                                Otherwise, if I don't set it up that way, the 
                                audio stream fails to be written to the 
                                WMV.<BR><BR>My challenge is that the resultant 
                                WMV file contains UNCOMPRESSED audio. <BR><BR>1. 
                                Isn't WriteSample supposed to compress the audio 
                                samples I write in?<BR><BR>2. The audio plays 
                                but the filesize indicates that the audio is not 
                                compressed and file-&gt;properties of WM Player 
                                shows NO audio codec.<BR><BR>3. I guess the 
                                profile XML is for specifying the format of what 
                                data will be written using WriteSample but how 
                                do you specify how the sample will be 
                                compressed?<BR><BR>Thank you in 
                                advance.<BR><BR><PROFILE 
                                version="458752"><BR>name="Video" 
                                <BR>guid="{045880DC-34B6-4CA9-A326-73557ED143F3}"<BR>description="Use 
                                this profile for duel view Commercial 
                                clips."&gt; <BR><STREAMCONFIG 
                                majortype="{73647561-0000-0010-8000-00AA00389B71}"><BR>streamnumber="1" 
                                <BR>streamname="Audio Stream" 
                                <BR>inputname="Audio" <BR>bitrate="32000" 
                                <BR>bufferwindow="-1"&gt; <BR><WMMEDIATYPE 
                                subtype="{00000001-0000-0010-8000-00AA00389B71}"><BR>bfixedsizesamples="1" 
                                <BR>btemporalcompression="0" 
                                <BR>lsamplesize="2"&gt; <BR><WAVEFORMATEX 
                                wformattag="1"><BR>nChannels="1" 
                                <BR>nSamplesPerSec="12000" 
                                <BR>nAvgBytesPerSec="24000" <BR>nBlockAlign="2" 
                                <BR>wBitsPerSample="16" 
                                <BR>codecdata="008800001700001E0000"/&gt; 
                                <BR></WAVEFORMATEX></WMMEDIATYPE><BR></STREAMCONFIG><BR><STREAMCONFIG 
                                majortype="{73646976-0000-0010-8000-00AA00389B71}"><BR>streamnumber="2" 
                                <BR>streamname="Video Stream" 
                                <BR>inputname="Video" <BR>bitrate="256000" 
                                <BR>bufferwindow="-1"&gt; <BR><VIDEOMEDIAPROPS 
                                maxkeyframespacing="80000000"><BR>quality="0"/&gt; 
                                <BR><WMMEDIATYPE 
                                subtype="{31564D57-0000-0010-8000-00AA00389B71}"><BR>bfixedsizesamples="0" 
                                <BR>btemporalcompression="1" 
                                <BR>lsamplesize="0"&gt; <BR><VIDEOINFOHEADER 
                                dwbitrate="256000"><BR>dwbiterrorrate="0" 
                                <BR>avgtimeperframe="666666"&gt; <BR><RCSOURCE 
                                left="0"><BR>top="0" <BR>right="640" 
                                <BR>bottom="264"/&gt; <BR><RCTARGET 
                                left="0"><BR>top="0" <BR>right="540" 
                                <BR>bottom="200"/&gt; <BR><BITMAPINFOHEADER 
                                biwidth="540"><BR>biheight="200" 
                                <BR>biplanes="1" <BR>bibitcount="24" 
                                <BR>bicompression="WMV1" <BR>bisizeimage="0" 
                                <BR>bixpelspermeter="0" <BR>biypelspermeter="0" 
                                <BR>biclrused="0" <BR>biclrimportant="0"/&gt; 
                                <BR></BITMAPINFOHEADER></RCTARGET></RCSOURCE></VIDEOINFOHEADER><BR></WMMEDIATYPE><BR></VIDEOMEDIAPROPS></STREAMCONFIG><BR></PROFILE><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2507374&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2507374&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2507374">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2507374">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2507374&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2507374 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4068207,2507374,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2500633_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2500633xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2500633#xx2500633xx" 
                        name=2500633>Just use SoundPlayer?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=36440">Paul 
                        Shaffer</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">14:23 9 
                        Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2500633_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>using(SoundPlayer player = new 
                                SoundPlayer(outStream))<BR>{<BR>player.PlaySync();<BR>} 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2500633&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2500633&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2500633">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2500633">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2500633&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2500633 
                                style="WHITE-SPACE: nowrap">1.00/5 (2 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(36440,2500633,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote HdUnSel " id=F2588920_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2588920xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2588920#xx2588920xx" 
                        name=2588920>Re: Just use SoundPlayer?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=166999">moserwi</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:52 9 
                        Jun '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2588920_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Well Yes but I Think the Theme was 
                                LowLevel! - Works with Mobiles too! 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2588920&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2588920&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2500633">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2588920">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2588920&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2588920 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(166999,2588920,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2281839_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2281839xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2281839#xx2281839xx" 
                        name=2281839>Thanks!</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1858641">geekisi77</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">15:52 
                        21 Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2281839_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Thank you for this! I'm not too 
                                familiar with native APIs, so I plugged in your 
                                code to create a little thing that tells me how 
                                many minutes have passed on so many minutes to 
                                the hour (e.g. 5 turns into 5 minutes, so 4:00, 
                                4:05, etc.).<BR><BR>It's funny, because I found 
                                out that there's also the System.Speech class 
                                for what I really wanted to do.<BR><BR>Still, 
                                it's nice that I can play a sound every X 
                                minutes (on the hour) AND say some custom text 
                                of whatever I want. <BR><BR>
                                <DIV class=ForumSig>Gustavo</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2281839&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2281839&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2281839">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2281839">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2281839&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2281839 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1858641,2281839,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2279672_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2279672xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2279672#xx2279672xx" 
                        name=2279672>How to pause while recording</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2940487">rajvijay</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">2:12 19 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2279672_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I am having the apppliation for 
                                recording..but i can do recording as start and 
                                stop. I want the c#.net code for pause 
                                functionallity..if anybody knows please help me 
                                out.. <BR><BR>
                                <DIV class=ForumSig>i am raj</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2279672&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2279672&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2279672">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2279672">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2279672&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2279672 
                                style="WHITE-SPACE: nowrap">2.67/5 (3 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(2940487,2279672,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2193569_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2193569xx></A><IMG height=16 alt=Question 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2193569#xx2193569xx" 
                        name=2193569>question about wav using</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4403023">headburster</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">2:33 22 
                        Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2193569_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello,<BR><BR>I have a question 
                                about wav using. I am beginner in C#, I never 
                                used that language before...<BR>Your code is 
                                very interesting, but unfortunally for me, he 
                                doesn't give me keys for the problem I have. In 
                                fact, I want to create an FFT spectral diagram 
                                from a wav file. I find the Exocortex.DSP dll 
                                which work fine, but I just need to "transform a 
                                wave file in a float tab". I am sure it exists a 
                                very simple C# functionnaly to do that, but I 
                                can't find it...<BR><BR>Can you help 
                                me?<BR><BR>Thanks in advance<BR><BR>Matthieu 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2193569&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2193569&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2193569">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2193569">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2193569&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2193569 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4403023,2193569,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2023962_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2023962xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2023962#xx2023962xx" 
                        name=2023962>ArgumentException -&gt; Windows Mobile 
                        5.0</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3880853">user140378</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:51 7 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2023962_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Has anybody ever tried to run this 
                                class on Windows Mobile ?<BR>You have to change 
                                winmm.dll to mscorlib.dll then it should 
                                work.<BR><BR>But it doesn't. <BR><BR><BR>After 
                                some time of looping a short wave (22050hz, 
                                8Bits, mono): <BR>When I click on "start" 
                                (sometime the sound becomes first "strange" 
                                before the exeption occures , what seems to me 
                                like overwritten unmanaged memory. 
                                )<BR><BR>-&gt; System.ArgumentException" in 
                                mscorlib.dll <BR><BR>System.ArgumentException: 
                                ArgumentException<BR>at 
                                System.PInvoke.EE.Runtime_InteropServices_GCHandle_InternalGet()<BR>at 
                                System.Runtime.InteropServices.GCHandle.get_Target()<BR>at 
                                WaveLib.WaveOutBuffer.WaveOutProc()<BR><BR>A 
                                strange Bug, my code and this Code seems to me 
                                al right. I really don't know why this 
                                happens.<BR>After installing ".net compact 
                                framework service pack 2" I can debug is at 
                                least, prior that Visual Studio crashed while 
                                debugging.<BR><BR><BR><BR>My Code is 
                                simple:<BR>--- Snip ---------<BR><BR>void 
                                OnPlayNewData(IntPtr data, int 
                                size)<BR>{<BR>byte[] tmpData = new 
                                byte[size];<BR>if ((_waveData.Position + size) 
                                &gt;= _waveData.Length)<BR>{ 
                                <BR>_waveData.Seek(0,SeekOrigin.Begin); 
                                //loop<BR>}<BR>_waveData.Read(tmpData, 0, 
                                size);<BR>Marshal.Copy(tmpData, 0, data, 
                                size);<BR>}<BR><BR>private void 
                                button1_Click(object sender, EventArgs 
                                e)<BR>{<BR>WaveLib.WaveStream tmpStream = new 
                                WaveLib.WaveStream("/debug.wav");<BR>byte[] buff 
                                = new 
                                byte[tmpStream.Length];<BR>tmpStream.Read(buff, 
                                0, 
                                Convert.ToInt32(tmpStream.Length));<BR>_waveData.Write(buff, 
                                0, 
                                Convert.ToInt32(tmpStream.Length));<BR>_player = 
                                new WaveLib.WaveOutPlayer(-1, _format, 40 * 160, 
                                3,<BR>new 
                                WaveLib.BufferFillEventHandler(OnPlayNewData));<BR>}<BR><BR>--- 
                                Snip----<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2023962&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2023962&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2023962">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2023962">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2023962&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2023962 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3880853,2023962,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F2045430_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2045430xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2045430#xx2045430xx" 
                        name=2045430>Re: ArgumentException -&gt; Windows Mobile 
                        5.0</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3599297">eelioss</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:21 
                        20 May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2045430_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><BR><A 
                                href="http://msdn2.microsoft.com/en-us/library/aa446573.aspx">http://msdn2.microsoft.com/en-us/library/aa446573.aspx</A>[<A 
                                title="New Window" 
                                href="http://msdn2.microsoft.com/en-us/library/aa446573.aspx" 
                                target=_blank>^</A>]a&gt;]<BR><BR>You have a lot 
                                of information about playing and recording 
                                sounds in Windows Mobile...<BR><BR>Does your 
                                code run in your PC with winmm.dll? First you 
                                should check it... <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2045430&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2045430&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2023962">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2045430">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2045430&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2045430 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3599297,2045430,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2210234_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2210234xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2210234#xx2210234xx" 
                        name=2210234>Re: ArgumentException -&gt; Windows Mobile 
                        5.0</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2883133">wimpos</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:47 3 
                        Sep '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2210234_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>for windows mobile 5.0 you have to 
                                change winmm.dll to coredll.dll 
                                !!<BR><BR>regards <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2210234&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2210234&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2023962">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2210234">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2210234&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2210234 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(2883133,2210234,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2010962_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2010962xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2010962#xx2010962xx" 
                        name=2010962>Magic number</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1601890">Gilesb</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:30 28 
                        Apr '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2010962_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>What is the magic number 16384 in 
                                MainForm.cs<BR><BR>It should be the buffer size 
                                but if I make it bigger or smaller It sounds 
                                very nasty! <BR><BR>On further investigation it 
                                can be made bigger or smaller but must be an 
                                even number <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2010962&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2010962&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2010962">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2010962">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2010962&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2010962 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1601890,2010962,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F2014033_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2014033xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2014033#xx2014033xx" 
                        name=2014033>Re: Magic number</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=90428">Ianier 
                        Munoz</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">22:01 
                        30 Apr '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2014033_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi Gilesb,<BR><BR>It's the buffer 
                                size <B>in bytes</B>. The buffer size should be 
                                set so that it can hold an integer number of 
                                samples (i.e. the size must be a multiple of the 
                                <CODE>nBlockAlign</CODE> field in the 
                                <CODE>WaveLib.WaveFormat 
                                structure</CODE>).<BR>Using any power of 2 is 
                                convenient because sample sizes are typically 
                                also a power of two. In your case, try 32768 or 
                                65536.<BR>Regards,<BR><BR><BR>
                                <DIV class=ForumSig>Ianier Munoz<BR><A 
                                href="http://www.chronotron.com/" 
                                target=blank>http://www.chronotron.com/</A><BR></DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2014033&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2014033&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=2010962">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2014033">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2014033&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2014033 
                                style="WHITE-SPACE: nowrap">1.50/5 (2 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(90428,2014033,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1945791_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1945791xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=1945791#xx1945791xx" 
                        name=1945791>noise filterring system</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3931156">hassan0531</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">2:29 17 
                        Mar '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1945791_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>dear friends,<BR>I am IT student 
                                now i am doing a kind of research project."noise 
                                filterring system" in c# so, if you know how we 
                                can solve this problem plz e-mail me 
                                hassan0531@yahoo.com<BR><BR>thank 
                                you<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=1945791&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=1945791&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=1945791">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=1945791">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1945791&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1945791 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3931156,1945791,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1800980_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1800980xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=1800980#xx1800980xx" 
                        name=1800980>QBasic Music Support?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=52123">Vasudevan 
                        Deepak Kumar</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:16 12 
                        Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1800980_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>If you recall, we have full 
                                musical note support in QBasic as discussed 
                                here. <A 
                                href="http://lavanyadeepak.blogspot.com/2006/11/catching-musical-relaxation-in-dos.html">http://lavanyadeepak.blogspot.com/2006/11/catching-musical-relaxation-in-dos.html</A>[<A 
                                title="New Window" 
                                href="http://lavanyadeepak.blogspot.com/2006/11/catching-musical-relaxation-in-dos.html" 
                                target=_blank>^</A>]<BR><BR>I am quite curious 
                                if we can try bringing in this feature with 
                                WaveIn and WaveOut API. Otherwise, I don't think 
                                C# has direct notes play support. <BR><BR>
                                <DIV class=ForumSig>Vasudevan Deepak Kumar<BR><A 
                                href="http://www.lavanyadeepak.tk/">Personal 
                                Homepage</A><BR><A 
                                href="http://lavanyadeepak.blogspot.com/">Tech 
                                Gossips</A></DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=1800980&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=1800980&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=1800980">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=1800980">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1800980&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1800980 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(52123,1800980,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1731849_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1731849xx></A><IMG height=16 alt=General 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=1731849#xx1731849xx" 
                        name=1731849>A question plz</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3099647">AdyXP</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:27 29 
                        Oct '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1731849_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR>I'd like to ask about the 
                                refill function what is used for exactly 
                                ???<BR>and the last line of code in it 
                                specifically ????<BR><BR>Thanks so much. 
                                <BR><BR>AdyXP<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=1731849&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=1731849&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=1731849">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=1731849">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1731849&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1731849 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3099647,1731849,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1590864_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1590864xx></A><IMG height=16 alt=Question 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=1590864#xx1590864xx" 
                        name=1590864>Waveform (Audio Signal)</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=167251">Erakis</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">15:16 
                        22 Jul '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1590864_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi. <BR><BR>First, I thank you so 
                                much for this great article <IMG alt=Smile 
                                src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top><BR>However, I would like to know if 
                                is there a way to get current play <BR>position 
                                and draw the wave form (audio signals) as it's 
                                playing.<BR><BR>Thank Mr Ianier Munoz. 
                                <BR><BR><BR>-- modified at 15:55 Monday 24th 
                                July, 2006<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=1590864&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=1590864&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=1590864">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=1590864">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1590864&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1590864 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(167251,1590864,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F2035544_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2035544xx></A><IMG height=16 alt=Answer 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2035544#xx2035544xx" 
                        name=2035544>Re: Waveform (Audio Signal)</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3599297">eelioss</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:47 14 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2035544_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi, I've got the same question... 
                                <BR><BR>I thought a way (I'll tried to explain 
                                it... I'm spanish and my english isn't very 
                                good): In WaveOutBuffer, we define a boolean 
                                called Playing (we set it in true when 
                                waveoutWrite(...) is called, and false when 
                                OnCompleted() is called). Too, we have to define 
                                in WaveOutBuffer an integer (FilePosition) that 
                                indicate the actual position in the file. 
                                <BR>Now, in WaveOutPlayer we define a method 
                                called int AudioPointer()... here we look for 
                                the playing buffer and return its 
                                FilePosition...<BR>It works, but I thing that 
                                it's too slow (each time we have to look over 
                                all the linked list).<BR><BR>Maybe a way using 
                                the AutoResetEvent for the synchronizing of 
                                threads?<BR><BR>Thanks Mr.Munoz.<BR><BR>P.D:I'm 
                                making a multichannel audio software for the 
                                university... Erakis, my email is 
                                eelioss@hotmail.com (you can add me in your 
                                MSN), maybe I can help you with the waveform 
                                displaying.<BR>Bye! <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2035544&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2035544&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=1590864">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2035544">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2035544&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2035544 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3599297,2035544,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F2074837_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2074837xx></A><IMG height=16 alt=Answer 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;select=2074837#xx2074837xx" 
                        name=2074837>The way for getting the current play 
                        position</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3599297">eelioss</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:49 9 
                        Jun '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2074837_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>You have to add this lines in the 
                                WaveNative.cs<BR><BR>[DllImport(mmdll)]<BR>public 
                                static extern int waveOutGetPosition(IntPtr 
                                hWaveOut, ref MMTIME pmmt, int 
                                uSize);<BR><BR>And to define this struct in the 
                                same 
                                class:<BR><BR>[StructLayout(LayoutKind.Sequential, 
                                CharSet = CharSet.Auto)]<BR>public struct 
                                MMTIME<BR>{<BR>public int wType;<BR>public int 
                                u;<BR>public int x;<BR>}<BR><BR>(I tried to made 
                                it of this way <A 
                                href="http://msdn2.microsoft.com/en-us/library/ms712191.aspx">http://msdn2.microsoft.com/en-us/library/ms712191.aspx</A>[<A 
                                title="New Window" 
                                href="http://msdn2.microsoft.com/en-us/library/ms712191.aspx" 
                                target=_blank>^</A>] but I wasn't able of create 
                                the union. Someone could help me?)<BR><BR>And 
                                the following constants: <BR>public const int 
                                TIME_MS = 0x0001; // time in milliseconds 
                                <BR>public const int TIME_SAMPLES = 0x0002; // 
                                number of wave samples public const int 
                                TIME_BYTES = 0x0004; // current byte offset 
                                <BR>...<BR>So, when you want to get de current 
                                position you have to write this:<BR><BR>MMTIME a 
                                = new MMTIME();<BR>a.wType = 
                                WaveNative.TIME_BYTES;<BR>if 
                                (m_WaveOut!=IntPtr.Zero)<BR>WaveNative.waveOutGetPosition(m_WaveOut,ref 
                                a, Marshal.SizeOf(a));<BR><BR>the value "a.u" 
                                containt the current position in 
                                bytes.<BR><BR>You could to create a property in 
                                WaveOutPlayer called Position:<BR><BR>public 
                                long Position<BR>{<BR>get<BR>{<BR>MMTIME a = new 
                                MMTIME();<BR>a.wType = 
                                WaveNative.TIME_BYTES;<BR>if 
                                (m_WaveOut!=IntPtr.Zero)<BR>WaveNative.waveOutGetPosition(m_WaveOut,ref 
                                a, Marshal.SizeOf(a));<BR>return 
                                a.u;<BR>}<BR>}<BR><BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2074837&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13779&amp;select=2074837&amp;floc=/KB/audio-video/cswavplay.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;tid=1590864">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13779&amp;msg=2074837">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2074837&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2074837 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3599297,2074837,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Tuesday, September 30, 2008 3:10 AM &nbsp; 
                  &nbsp; Last Update:Wednesday, October 8, 2008 3:59 PM</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><B>1</B><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>2</A><A class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;fr=51#xx0xx" 
                  name=Frm_HoverNL>3</A><A class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;fr=76#xx0xx" 
                  name=Frm_HoverNL>4</A><A class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;fr=101#xx0xx" 
                  name=Frm_HoverNL>5</A> <A class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/cswavplay.aspx?fid=13779&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next 
      »</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 alt=General 
      src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_general.gif" 
      width=16 align=top> General &nbsp;&nbsp; <IMG height=16 alt=News 
      src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_news.gif" 
      width=16 align=top> News &nbsp;&nbsp; <IMG height=16 alt=Question 
      src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_question.gif" 
      width=16 align=top> Question &nbsp;&nbsp; <IMG height=16 alt=Answer 
      src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_answer.gif" 
      width=16 align=top> Answer &nbsp;&nbsp; <IMG height=16 alt=Joke 
      src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_joke.gif" 
      width=16 align=top> Joke &nbsp;&nbsp; <IMG height=16 alt=Rant 
      src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_rant.gif" 
      width=16 align=top> Rant &nbsp;&nbsp; <IMG height=16 alt=Admin 
      src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/msg_admin.gif" 
      width=16 align=top> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=3352">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy</A> | <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 27 Aug 2003<BR>Editor: <A 
            id=ctl00_ArticleEditor 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1">Chris 
            Maunder</A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2002 by Ianier 
            Munoz<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2008 
            <BR>Web20 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE>
      <CENTER></CENTER></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE><BR>
<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject A low-level audio player in C#_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
new HVMenu(new menu_NavbarConfig());
//]]></SCRIPT>
</BODY></HTML>
