<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0056)http://www.codeproject.com/KB/audio-video/waveInFFT.aspx -->
<HTML><HEAD><TITLE>CodeProject: FFT of waveIn audio signals. Free source code and programming help</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="An article on using the Fast Fourier Transform on audio signals.; Author: Fred Ackers; Section: Audio and Video; Chapter: Multimedia" 
name=Description>
<META 
content="VC6, VC7, VC7.1, Win2K, WinXP, Win2003, VS.NET2003, VS6, MFC, Dev, Intermediate,Audio and Video,Multimedia,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("www.codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if(top!=self)top.location.href=location.href; if(typeof(DemoUrl)!="undefined")document.write(unescape('%3Cme')+'ta http'+'-equiv="re' +'fresh" con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/jxs.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/bookmark.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/rateitem.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/jquery-1.2.6.min.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function MarkAns(MemberID,MsgID,QID) {
 document.write(unescape("%3Cdiv class=\"CallOut\"%3E"));
 document.write("Was this a good answer to your question? ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+", "+MsgID.toString()+",6,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"correct\" border=\"0\" align=\"absmiddle\" /%3E Yes%3C/a%3E"));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+","+MsgID.toString()+",7,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"correct\" style=\"margin-left:10px\" border=\"0\" align=\"absmiddle\" /%3E No%3C/a%3E"));
 document.write(unescape("%3C/div%3E"));
}
function MsgVFrm(MemberID,MsgID,GB,gp,bp,mt){
 if(!GB)document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"5":"1")+unescape(",0);\"%3E"));
 if(GB) document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;"); else for(var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"vote this message a " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ",0)\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"1":"5")+unescape(",0);\"%3E"));
 if(GB)document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" border=\"0\" alt=\"vote 5\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;&nbsp; "); else document.write(unescape("%3Cbr /%3E")); document.writeln(unescape("[%3Ca href='#xx") + MsgID.toString() +"xx' title='Report as Abuse' onclick='return ReportMsg(" + MemberID.toString());
 document.writeln(", " + MsgID.toString() + unescape(",-2)'%3EReport Message%3C/a%3E]"));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?"))
  return RateMsg(userid, msgid, score, 0);
 else return false;
}
function RateMsg(memberid, msgid, score, questionId) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4){
   if (req.status == 200){
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match&&match[1])?match[1]:"An error occured" + unescape("%3C/b%3E");
   } else
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString()+"&qid="+questionId.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK 
href="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/ForumClassicIE6.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" type=image/ico rel="shortcut icon">
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            id=ctl00_Logo 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; WIDTH: 225px; HEIGHT: 90px; BORDER-RIGHT-WIDTH: 0px" 
            alt="The Code Project" 
            src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/logo225x90.gif"></A></TD>
          <TD class=HeaderBanner align=right width="100%"><IFRAME 
            src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/ServeHTML.htm" 
            frameBorder=0 width=728 scrolling=no height=90></IFRAME></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">5,536,936 
                  members and growing! (16,854 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">Abdelrady_FCIS</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx">My 
                  Settings</A> | <A id=ctl00_MemberMenu_MyCodeProject 
                  href="http://www.codeproject.com/script/Membership/MyCodeProject.aspx"><B>My 
                  CodeProject</B></A> | <A id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/fave.gif" 
                  width=16 align=absMiddle border=0> My Bookmarks</A> | <A 
                  id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2faudio-video%2fwaveInFFT.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD noWrap><A href="http://www.codeproject.com/">Home</A></TD>
                <TD>&nbsp; </TD>
                <TD style="FONT-WEIGHT: normal" noWrap align=right>Current 
                  Site:</TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/">C++ / .NET</A></TD>
                <TD noWrap><A href="http://java.codeproject.com/">Java</A></TD>
                <TD noWrap><A href="http://sql.codeproject.com/">SQL</A></TD>
                <TD noWrap><A href="http://lamp.codeproject.com/">Linux / 
                  Unix</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus>
                  <DIV id=MenuPos 
                  style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=380>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
                        Board</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A> 
            » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/audio-video/">Audio and 
            Video</A> » <A id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/audio-video/index.aspx?#Audio and Video - Audio">Audio</A> 
            <SPAN class=ArticleIntermediate 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Intermediate</SPAN> <SPAN 
            id=ctl00_ArticleTopHeader_LicenceTerms></SPAN><BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>FFT of waveIn audio 
            signals</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=24814">Fred 
            Ackers</A></B><BR><BR><SPAN class=ArticleTopDescr 
            id=ctl00_ArticleTopHeader_ArticleDescr>An article on using the Fast 
            Fourier Transform on audio signals.</SPAN> </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>VC6, VC7, VC7.1, 
            C++Windows, Win2K, WinXP, Win2003, MFC, VS.NET2003, VS6, Visual 
            Studio, Dev</SPAN><BR><BR><SPAN style="WIDTH: 14ex">Posted</SPAN>: 
            <B>25 Apr 2004</B><BR><SPAN style="WIDTH: 14ex">Updated</SPAN>: <B>3 
            Apr 2007</B> <BR><SPAN style="WIDTH: 14ex">Views</SPAN>: 
            <B>177,718</B><BR><SPAN style="WIDTH: 14ex">Bookmarked</SPAN>: 
            <B>147 times</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar" 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px">
      <TABLE cellPadding=2>
        <TBODY>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/Info_24.png" 
            width=24 align=middle></TD>
          <TD><A id=ctl00_Announcements_CompLink 
            href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
            Competition</A></TD></TR></TBODY></TABLE></DIV>
      <DIV class=FeatureBlockHeader style="MARGIN-TOP: 7px">Want a new 
Job?</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <UL class=InfoList>
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=153">Senior 
        Software Engineer - Server Solutions</A> at Vital Images in United 
States
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=164">SharePoint 
        .Net Developer</A> at IEM in United States
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=50">Senior 
        .NET Programmer/Architect</A> at Greater Than Solutions in United States
        <LI><A href="http://www.codeproject.com/script/Jobs/List.aspx">View 
        Latest Jobs...</A></LI></UL></DIV>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2 style="DISPLAY: none">
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3>
      <DIV class=MIS id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4 style="DISPLAY: none">
      <DIV class=MI id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5 style="DISPLAY: none">
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV>
      <DIV class=MI id=Section126><A 
      href="http://www.codeproject.com/KB/codegen/">Code 
      Generation</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter12');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=12">Third 
      Party Products</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter12 style="DISPLAY: none">
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section124><A 
      href="http://www.codeproject.com/KB/solution-center/">Solution 
      Center</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
Board</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/kb/Showcase/">Product Showcase</A></DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/WhitePapers">WhitePapers / 
      Webcasts</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/Acresso">InstallShield 
      2009</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/APress">Apress 
      Bookstore</A></DIV><BR>
      <DIV style="MARGIN-BOTTOM: 10px; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d7689%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252fPDClogo.png%26C%3dFalse%26adid%3d7689%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22150%22%20height%3d%2280%22%3e%3c%2fa%3e"));</SCRIPT>
      </DIV>
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d7873%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252fAcresso_IS_banner160x600_Sept08.gif%26C%3dFalse%26adid%3d7873%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22160%22%20height%3d%22600%22%3e%3c%2fa%3e"));</SCRIPT>
    </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION> <OPTION value=s>Jobs</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top width="100%">
            <TABLE>
              <TBODY></TBODY></TABLE>
            <DIV class=SmallText><IMG style="VERTICAL-ALIGN: middle" height=16 
            alt=print 
            src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/print.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
            href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?display=Print">Print</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Broken Article?" 
            src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/report.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_BrokenLnk 
            href="http://www.codeproject.com/script/Articles/Report.aspx?aid=6855">Report 
            Article</A> &nbsp; <IMG style="VERTICAL-ALIGN: middle" alt=Watch 
            src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/watchon.png"> 
            <A class="" id=ctl00_ArticleHeaderLinks_ArticleBmkWatch_WatchMe 
            onclick="return watchMe(6855, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=6855&amp;obtid=2&amp;bma=AddWatch" 
            name=bmw_6855_2>Watch</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Bookmark 
            src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/link.png" 
            width=16> <A class="" 
            id=ctl00_ArticleHeaderLinks_ArticleBmk_BookmarkMe 
            onclick="return bookmarkMe(6855, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=6855&amp;obtid=2&amp;bma=AddBookmark" 
            name=bm_6855_2>Bookmark</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Discuss 
            src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/discuss.gif" 
            width=15> <A 
            href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx#_comments">Discuss</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Recommend Article" 
            src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/mail.gif" 
            width=16>&nbsp;<A id=ctl00_ArticleHeaderLinks_Recommend 
            href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=6855">Send&nbsp;to&nbsp;a&nbsp;friend</A> 
            </DIV></TD>
          <TD style="WIDTH: 100px; WHITE-SPACE: nowrap; TEXT-ALIGN: right">
            <TABLE id=CurRat>
              <TBODY>
              <TR>
                <TD>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=SmallText id=ctl00_ArticleRating_VL 
                      style="WHITE-SPACE: nowrap" align=right><SPAN 
                        id=ctl00_ArticleRating_VoteLabel>57 votes for this 
                        Article.</SPAN></TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=1>
                          <TBODY>
                          <TR>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD noWrap width=20 bgColor=white height=7><IMG 
                              height=7 
                              src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/red.gif" 
                              width=8 align=center 
                      border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=ctl00_ArticleRating_PopularityRow>
                      <TD class=SmallText align=right colSpan=2><A 
                        id=ctl00_ArticleRating_PopularityLnk 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                        7.68</A> <SPAN 
                        id=ctl00_ArticleRating_PopularityLbl></SPAN><SPAN 
                        id=ratingVal>Rating: <B>4.38</B> out of 
                    5</SPAN></TD></TR></TBODY></TABLE></TD>
                <TD>
                  <DIV>
                  <TABLE class=HistTable 
                  title="Voting Distribution. Recent data only">
                    <TBODY>
                    <TR>
                      <TD><IMG title="2 votes, 3.5%" height=1 
                        alt="2 votes, 3.5%" 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>1</TD>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>2</TD>
                      <TD><IMG title="5 votes, 8.8%" height=2 
                        alt="5 votes, 8.8%" 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>3</TD>
                      <TD><IMG title="12 votes, 21.1%" height=6 
                        alt="12 votes, 21.1%" 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>4</TD>
                      <TD><IMG title="38 votes, 66.7%" height=20 
                        alt="38 votes, 66.7%" 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/pollcol.gif" 
                        width=10 
              border=0><BR>5</TD></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/audio-video/waveInFFT/waveinFFT_demo.zip">Download 
        demo project - 33.3 KB</A> </LI></UL>
      <P><IMG height=357 alt="Sample Image - waveInFFT.jpg" 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/waveInFFT.jpg" 
      width=486></P>
      <P><IMG height=357 alt="Sample Image - waveInFFT_microeq.jpg" 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/waveInFFT_microeq.jpg" 
      width=486></P>
      <P><IMG height=357 alt="Sample Image - waveInFFT_Oscilliscope.jpg" 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/waveInFFT_Oscilliscope.jpg" 
      width=486></P>
      <P><IMG height=357 alt="Sample Image - waveInFFT_peak.jpg" 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/waveInFFT_peak.jpg" 
      width=486></P>
      <P><IMG height=357 alt="Sample Image - waveInFFT_peakalt.jpg" 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/waveInFFT_peakalt.jpg" 
      width=486></P>
      <P><IMG height=357 alt="Sample Image - waveInFFT_PixelGram.jpg" 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/waveInFFT_PixelGram.jpg" 
      width=486></P>
      <P><IMG height=357 alt="Sample Image - waveInFFT_spectrum.jpg" 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/waveInFFT_spectrum.jpg" 
      width=486></P>
      <H2>Introduction</H2>
      <P>The Fast Fourier Transform (FFT) allows users to view the spectrum 
      content of an audio signal. The FFT code presented here was written by <A 
      href="http://www.intersrv.com/~dcross/fft.html" target=_blank>Don 
      Cross</A>, his homepage appears to have subsequently been taken down. 
      Rather than explain the mathematical theory of the FFT, I will attempt to 
      explain its usefulness as it relates to audio signals.</P>
      <P>The FFT allows users to obtain the spectral makeup of an audio signal, 
      obtain the decibels of its various frequencies, or obtain the intensity of 
      its various frequencies. Spectral viewers (shown in the image above), 
      Equalizers, or VU-Meters may all use the FFT in order to display their 
      results. The difference between them then depends upon one of a couple of 
      equations that take the real and imaginary components of the FFT, and 
      return either the intensity or decibel levels to be used in the graphed 
      result. The following code takes both the real and imaginary components of 
      the FFT result, and returns the intensity and decibels.</P><PRE><SPAN class=code-keyword>inline</SPAN> <SPAN class=code-keyword>double</SPAN> GetFrequencyIntensity(<SPAN class=code-keyword>double</SPAN> re, <SPAN class=code-keyword>double</SPAN> im)
{
    <SPAN class=code-keyword>return</SPAN> sqrt((re*re)+(im*im));
}
<SPAN class=code-preprocessor>#define</SPAN> mag_sqrd(re,im) (re*re+im*im)
<SPAN class=code-preprocessor>#define</SPAN> Decibels(re,im) ((re == <SPAN class=code-digit>0</SPAN> &amp;&amp; im == <SPAN class=code-digit>0</SPAN>) ? (<SPAN class=code-digit>0</SPAN>) : 
        <SPAN class=code-digit>10</SPAN>.<SPAN class=code-digit>0</SPAN> * log10(<SPAN class=code-keyword>double</SPAN>(mag_sqrd(re,im))))
<SPAN class=code-preprocessor>#define</SPAN> Amplitude(re,im,len) (GetFrequencyIntensity(re,im)/(len))
<SPAN class=code-preprocessor>#define</SPAN> AmplitudeScaled(re,im,len,scale) ((<SPAN class=code-keyword>int</SPAN>)Amplitude(re,im,len)%scale)</PRE>
      <P>The FFT uses the audio signal as its real component, and uses a 
      <CODE>NULL</CODE> pointer for its imaginary component indicating that the 
      imaginary data does not exist. Upon its return, the FFT will return both 
      the real and imaginary data components based upon the data given as the 
      real component. The is mirrored with the return samples so that 
      <CODE><SPAN class=code-digit>0</SPAN>-FFT_LEN/2</CODE> contains the data, 
      and <CODE>FFT_LEN/2</CODE> to <CODE>FFT_LEN</CODE> contains a reverse of 
      the data. This mistake was corrected in my code. The code that performs 
      the FFT follows:</P><PRE>    DWORD nCount = <SPAN class=code-digit>0</SPAN>;
    <SPAN class=code-keyword>for</SPAN> (DWORD dw = <SPAN class=code-digit>0</SPAN>; dw <SPAN class=code-keyword>&lt;</SPAN> FFT_LEN; dw++)
    {
        {
            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>copy audio signal to fft real component for left channel
</SPAN>            finleft[nCount] = (<SPAN class=code-keyword>double</SPAN>)((<SPAN class=code-keyword>short</SPAN>*)pwh-<SPAN class=code-keyword>&gt;</SPAN>lpData)[dw++];
            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>copy audio signal to fft real component for right channel
</SPAN>            finright[nCount++] = (<SPAN class=code-keyword>double</SPAN>)((<SPAN class=code-keyword>short</SPAN>*)pwh-<SPAN class=code-keyword>&gt;</SPAN>lpData)[dw];
        }
    }
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>Perform FFT on left channel
</SPAN>    fft_double(FFT_LEN/2,<SPAN class=code-digit>0</SPAN>,finleft,NULL,fout,foutimg);
    <SPAN class=code-keyword>float</SPAN> re,im,fmax=-<SPAN class=code-digit>99999</SPAN>.9f,fmin=99999.9f;
    <SPAN class=code-keyword>for</SPAN>(<SPAN class=code-keyword>int</SPAN> i=1;i <SPAN class=code-keyword>&lt;</SPAN> FFT_LEN/4-<SPAN class=code-digit>1</SPAN>;i++)
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>Use FFT_LEN/4 since the data is mirrored within the array.
</SPAN>    {
        re = fout[i];
        im = foutimg[i];
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>get amplitude and scale to 0..256 range
</SPAN>        fdraw[i]=AmplitudeScaled(re,im,FFT_LEN/2,<SPAN class=code-digit>256</SPAN>);
        <SPAN class=code-keyword>if</SPAN> (fdraw[i] <SPAN class=code-keyword>&gt;</SPAN> fmax)
        {
            fmax = fdraw[i];
        }
        <SPAN class=code-keyword>if</SPAN> (fdraw[i] <SPAN class=code-keyword>&lt;</SPAN> fmin)
        {
            fmin = fdraw[i];
        }
    }
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>Use this to send the average band amplitude to something
</SPAN>    <SPAN class=code-keyword>int</SPAN> nAvg, nBars=16, nCur = <SPAN class=code-digit>0</SPAN>;
    <SPAN class=code-keyword>for</SPAN>(<SPAN class=code-keyword>int</SPAN> i=1;i <SPAN class=code-keyword>&lt;</SPAN> FFT_LEN/4;i++)
    {
        nAvg = <SPAN class=code-digit>0</SPAN>;
        <SPAN class=code-keyword>for</SPAN> (<SPAN class=code-keyword>int</SPAN> n=0; n <SPAN class=code-keyword>&lt;</SPAN> nBars; n++)
        {
            nAvg += (<SPAN class=code-keyword>int</SPAN>)fdraw[i];
        }
        nAvg /= nBars;
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>Send data here to something,
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>nothing to send it to so we print it.
</SPAN>        TRACE(<SPAN class=code-string>"</SPAN><SPAN class=code-string>Average for Bar#%d is %d\n"</SPAN>,nCur++,nAvg);
        i+=nBars-<SPAN class=code-digit>1</SPAN>;
    }
    DataHolder* pDataHolder = (DataHolder*)lpData;
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Draw left channel
</SPAN>    CFrequencyGraph* pPeak = (CFrequencyGraph*)pDataHolder-<SPAN class=code-keyword>&gt;</SPAN>pData;
    <SPAN class=code-keyword>if</SPAN> (::IsWindow(pPeak-<SPAN class=code-keyword>&gt;</SPAN>GetSafeHwnd()))
    {
        pPeak-<SPAN class=code-keyword>&gt;</SPAN>SetYRange(<SPAN class=code-digit>0</SPAN>,<SPAN class=code-digit>256</SPAN>);
        pPeak-<SPAN class=code-keyword>&gt;</SPAN>Update(FFT_LEN/4,fdraw);
    }
    
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Perform FFT on right channel
</SPAN>    fmax=-<SPAN class=code-digit>99999</SPAN>.9f,fmin=99999.9f;
    fft_double(FFT_LEN/2,<SPAN class=code-digit>0</SPAN>,finright,NULL,fout,foutimg);
    fdraw[<SPAN class=code-digit>0</SPAN>] = fdraw[FFT_LEN/4] = <SPAN class=code-digit>0</SPAN>;
    <SPAN class=code-keyword>for</SPAN>(i=1;i <SPAN class=code-keyword>&lt;</SPAN> FFT_LEN/4-<SPAN class=code-digit>1</SPAN>;i++)
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>Use FFT_LEN/4 since the data is mirrored within the array.
</SPAN>    {
        re = fout[i];
        im = foutimg[i];
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>get Decibels in 0-110 range
</SPAN>        fdraw[i] = Decibels(re,im);
        <SPAN class=code-keyword>if</SPAN> (fdraw[i] <SPAN class=code-keyword>&gt;</SPAN> fmax)
        {
            fmax = fdraw[i];
        }
        <SPAN class=code-keyword>if</SPAN> (fdraw[i] <SPAN class=code-keyword>&lt;</SPAN> fmin)
        {
            fmin = fdraw[i];
        }
    }
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>Draw right channel
</SPAN>    CFrequencyGraph* pPeak2 = (CFrequencyGraph*)pDataHolder-<SPAN class=code-keyword>&gt;</SPAN>pData2;
    <SPAN class=code-keyword>if</SPAN> (::IsWindow(pPeak2-<SPAN class=code-keyword>&gt;</SPAN>GetSafeHwnd()))
    {
        pPeak2-<SPAN class=code-keyword>&gt;</SPAN>SetNumberOfSteps(<SPAN class=code-digit>50</SPAN>);
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>Use updated dynamic range for scaling
</SPAN>        pPeak2-<SPAN class=code-keyword>&gt;</SPAN>SetYRange((<SPAN class=code-keyword>int</SPAN>)fmin,(<SPAN class=code-keyword>int</SPAN>)fmax);
        pPeak2-<SPAN class=code-keyword>&gt;</SPAN>Update(FFT_LEN/4,fdraw);
    }</PRE>
      <P>This code is contained in a callback function that is called every time 
      the <CODE>waveIn</CODE> functions return with updated audio signal data. 
      The code that actually performs the FFT looks like:</P><PRE><SPAN class=code-keyword>void</SPAN> fft_double (<SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> p_nSamples, <SPAN class=code-keyword>bool</SPAN> p_bInverseTransform, 
    <SPAN class=code-keyword>double</SPAN> *p_lpRealIn, <SPAN class=code-keyword>double</SPAN> *p_lpImagIn, 
    <SPAN class=code-keyword>double</SPAN> *p_lpRealOut, <SPAN class=code-keyword>double</SPAN> *p_lpImagOut)
{

    <SPAN class=code-keyword>if</SPAN>(!p_lpRealIn || !p_lpRealOut || !p_lpImagOut) <SPAN class=code-keyword>return</SPAN>;


    <SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> NumBits;
    <SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> i, j, k, n;
    <SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> BlockSize, BlockEnd;

    <SPAN class=code-keyword>double</SPAN> angle_numerator = <SPAN class=code-digit>2</SPAN>.<SPAN class=code-digit>0</SPAN> * PI;
    <SPAN class=code-keyword>double</SPAN> tr, ti;

    <SPAN class=code-keyword>if</SPAN>( !IsPowerOfTwo(p_nSamples) )
    {
        <SPAN class=code-keyword>return</SPAN>;
    }

    <SPAN class=code-keyword>if</SPAN>( p_bInverseTransform ) angle_numerator = -angle_numerator;

    NumBits = NumberOfBitsNeeded ( p_nSamples );


    <SPAN class=code-keyword>for</SPAN>( i=0; i <SPAN class=code-keyword>&lt;</SPAN> p_nSamples; i++ )
    {
        j = ReverseBits ( i, NumBits );
        p_lpRealOut[j] = p_lpRealIn[i];
        p_lpImagOut[j] = (p_lpImagIn == NULL) ? <SPAN class=code-digit>0</SPAN>.<SPAN class=code-digit>0</SPAN> : p_lpImagIn[i];
    }


    BlockEnd = <SPAN class=code-digit>1</SPAN>;
    <SPAN class=code-keyword>for</SPAN>( BlockSize = <SPAN class=code-digit>2</SPAN>; BlockSize <SPAN class=code-keyword>&lt;</SPAN>= p_nSamples; BlockSize <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>&lt;</SPAN>= <SPAN class=code-digit>1</SPAN> )
    {
        <SPAN class=code-keyword>double</SPAN> delta_angle = angle_numerator / (<SPAN class=code-keyword>double</SPAN>)BlockSize;
        <SPAN class=code-keyword>double</SPAN> sm2 = sin ( -<SPAN class=code-digit>2</SPAN> * delta_angle );
        <SPAN class=code-keyword>double</SPAN> sm1 = sin ( -delta_angle );
        <SPAN class=code-keyword>double</SPAN> cm2 = cos ( -<SPAN class=code-digit>2</SPAN> * delta_angle );
        <SPAN class=code-keyword>double</SPAN> cm1 = cos ( -delta_angle );
        <SPAN class=code-keyword>double</SPAN> w = <SPAN class=code-digit>2</SPAN> * cm1;
        <SPAN class=code-keyword>double</SPAN> ar[<SPAN class=code-digit>3</SPAN>], ai[<SPAN class=code-digit>3</SPAN>];

        <SPAN class=code-keyword>for</SPAN>( i=0; i <SPAN class=code-keyword>&lt;</SPAN> p_nSamples; i += BlockSize )
        {

            ar[<SPAN class=code-digit>2</SPAN>] = cm2;
            ar[<SPAN class=code-digit>1</SPAN>] = cm1;

            ai[<SPAN class=code-digit>2</SPAN>] = sm2;
            ai[<SPAN class=code-digit>1</SPAN>] = sm1;

            <SPAN class=code-keyword>for</SPAN> ( j=i, n=0; n <SPAN class=code-keyword>&lt;</SPAN> BlockEnd; j++, n++ )
            {

                ar[<SPAN class=code-digit>0</SPAN>] = w*ar[<SPAN class=code-digit>1</SPAN>] - ar[<SPAN class=code-digit>2</SPAN>];
                ar[<SPAN class=code-digit>2</SPAN>] = ar[<SPAN class=code-digit>1</SPAN>];
                ar[<SPAN class=code-digit>1</SPAN>] = ar[<SPAN class=code-digit>0</SPAN>];

                ai[<SPAN class=code-digit>0</SPAN>] = w*ai[<SPAN class=code-digit>1</SPAN>] - ai[<SPAN class=code-digit>2</SPAN>];
                ai[<SPAN class=code-digit>2</SPAN>] = ai[<SPAN class=code-digit>1</SPAN>];
                ai[<SPAN class=code-digit>1</SPAN>] = ai[<SPAN class=code-digit>0</SPAN>];

                k = j + BlockEnd;
                tr = ar[<SPAN class=code-digit>0</SPAN>]*p_lpRealOut[k] - ai[<SPAN class=code-digit>0</SPAN>]*p_lpImagOut[k];
                ti = ar[<SPAN class=code-digit>0</SPAN>]*p_lpImagOut[k] + ai[<SPAN class=code-digit>0</SPAN>]*p_lpRealOut[k];

                p_lpRealOut[k] = p_lpRealOut[j] - tr;
                p_lpImagOut[k] = p_lpImagOut[j] - ti;

                p_lpRealOut[j] += tr;
                p_lpImagOut[j] += ti;

            }
        }

        BlockEnd = BlockSize;

    }


    <SPAN class=code-keyword>if</SPAN>( p_bInverseTransform )
    {
        <SPAN class=code-keyword>double</SPAN> denom = (<SPAN class=code-keyword>double</SPAN>)p_nSamples;

        <SPAN class=code-keyword>for</SPAN> ( i=0; i <SPAN class=code-keyword>&lt;</SPAN> p_nSamples; i++ )
        {
            p_lpRealOut[i] /= denom;
            p_lpImagOut[i] /= denom;
        }
    }

}</PRE>
      <P>And it requires the following supporting functions:</P><PRE><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment>////////////////////////////////////////////////////////
</SPAN><SPAN class=code-comment>//</SPAN><SPAN class=code-comment> check is a number is a power of 2
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment>////////////////////////////////////////////////////////
</SPAN>
<SPAN class=code-keyword>bool</SPAN> IsPowerOfTwo( <SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> p_nX )
{

    <SPAN class=code-keyword>if</SPAN>( p_nX <SPAN class=code-keyword>&lt;</SPAN> <SPAN class=code-digit>2</SPAN> ) <SPAN class=code-keyword>return</SPAN> <SPAN class=code-keyword>false</SPAN>;

    <SPAN class=code-keyword>if</SPAN>( p_nX &amp; (p_nX-<SPAN class=code-digit>1</SPAN>) ) <SPAN class=code-keyword>return</SPAN> <SPAN class=code-keyword>false</SPAN>;

    <SPAN class=code-keyword>return</SPAN> <SPAN class=code-keyword>true</SPAN>;

}


<SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment>////////////////////////////////////////////////////////
</SPAN><SPAN class=code-comment>//</SPAN><SPAN class=code-comment> return needed bits for fft
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment>////////////////////////////////////////////////////////
</SPAN>
<SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> NumberOfBitsNeeded( <SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> p_nSamples )
{

    <SPAN class=code-keyword>int</SPAN> i;

    <SPAN class=code-keyword>if</SPAN>( p_nSamples <SPAN class=code-keyword>&lt;</SPAN> <SPAN class=code-digit>2</SPAN> )
    {
        <SPAN class=code-keyword>return</SPAN> <SPAN class=code-digit>0</SPAN>;
    }

    <SPAN class=code-keyword>for</SPAN> ( i=0; ; i++ )
    {
        <SPAN class=code-keyword>if</SPAN>( p_nSamples &amp; (<SPAN class=code-digit>1</SPAN> <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>&lt;</SPAN> i) ) <SPAN class=code-keyword>return</SPAN> i;
    }

}



<SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment>////////////////////////////////////////////////////////
</SPAN><SPAN class=code-comment>//</SPAN><SPAN class=code-comment> ?
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment>////////////////////////////////////////////////////////
</SPAN>
<SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> ReverseBits(<SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> p_nIndex, <SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> p_nBits)
{

    <SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> i, rev;

    <SPAN class=code-keyword>for</SPAN>(i=rev=0; i <SPAN class=code-keyword>&lt;</SPAN> p_nBits; i++)
    {
        rev = (rev <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>&lt;</SPAN> <SPAN class=code-digit>1</SPAN>) | (p_nIndex &amp; <SPAN class=code-digit>1</SPAN>);
        p_nIndex <SPAN class=code-keyword>&gt;</SPAN><SPAN class=code-keyword>&gt;</SPAN>= <SPAN class=code-digit>1</SPAN>;
    }

    <SPAN class=code-keyword>return</SPAN> rev;
}



<SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment>////////////////////////////////////////////////////////
</SPAN><SPAN class=code-comment>//</SPAN><SPAN class=code-comment> return a frequency from the basefreq and num of samples
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment>////////////////////////////////////////////////////////
</SPAN>
<SPAN class=code-keyword>double</SPAN> Index_to_frequency(<SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> p_nBaseFreq, 
    <SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> p_nSamples, <SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>int</SPAN> p_nIndex)
{

    <SPAN class=code-keyword>if</SPAN>(p_nIndex <SPAN class=code-keyword>&gt;</SPAN>= p_nSamples)
    {
        <SPAN class=code-keyword>return</SPAN> <SPAN class=code-digit>0</SPAN>.<SPAN class=code-digit>0</SPAN>;
    }
    <SPAN class=code-keyword>else</SPAN> <SPAN class=code-keyword>if</SPAN>(p_nIndex <SPAN class=code-keyword>&lt;</SPAN>= p_nSamples/2)
    {
        <SPAN class=code-keyword>return</SPAN> ( (<SPAN class=code-keyword>double</SPAN>)p_nIndex / 
                 (<SPAN class=code-keyword>double</SPAN>)p_nSamples * p_nBaseFreq );
    }
    <SPAN class=code-keyword>else</SPAN>
    {
        <SPAN class=code-keyword>return</SPAN> ( -(<SPAN class=code-keyword>double</SPAN>)(p_nSamples-p_nIndex) / 
                  (<SPAN class=code-keyword>double</SPAN>)p_nSamples * p_nBaseFreq );
    }

}</PRE>
      <P>The included sample class, <CODE>CFrequencyGraph</CODE>, will draw a 
      sample EQ, peak meter, and spectral graph using the frequency intensity. 
      Hopefully, this serves as a decent introduction to the uses and basics of 
      the Fast Fourier Transform for audio signals. Other functions of the FFT 
      include using it in combination with a <A 
      href="http://www.gamedev.net/reference/programming/features/beatdetection/" 
      target=_blank>Beat Detection Algorithm</A> to detect beats in an audio 
      signal. Another page with useful FFT information is located at <A 
      href="http://www.dsptutor.freeuk.com/jsanalyser/FFTSpectrumAnalyser.html" 
      target=_blank>FFT Spectrum Analyser</A>.</P>
      <P>This article uses <CODE>waveIn*</CODE> functions to retrieve the 
      soundcard's data from the playing source. Therefore, you must manually 
      open your soundcard properties and change the recording source to use 
      mono/stereo mix or waveIn as the selected recording line. Also, if you set 
      the playback wave option to <CODE><SPAN 
      class=code-keyword>false</SPAN></CODE>, this will override the recording 
      options and no sound will appear. For information about doing an inverse 
      FFT for transforming frequencies into an audio signal, please do a Google 
      search on "Inverse FFT" or "IFFT".</P>
      <H2>History</H2>
      <UL>
        <LI>Version 1.3: Fixed Spectrum drawing, Changed Pixelgram color, 
        changed Process routine to match new Recording parameters. 
        <LI>Version 1.2: Fixed many drawing bugs, changed to use amplitude 
        scaled and decibels.</LI></UL><!-- Article Ends --><!-- Main Page Contents End --></DIV>
      <FORM id=aspnetForm 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
      name=aspnetForm action=waveInFFT.aspx method=post>
      <DIV><INPUT id=__VIEWSTATE type=hidden 
      value=/wEPDwULLTEwMDUyNjYzMjhkZJPhcSF/k84ySxmuwdaYdmmkM2DY 
      name=__VIEWSTATE> </DIV>
      <H2>License</H2>
      <DIV id=ctl00_LicenseTerms>
      <P>This article has no explicit license attached to it but may contain 
      usage terms in the article text or the download files themselves. If in 
      doubt please contact the author via the discussion board below.</P>
      <P>A list of licenses authors might use can be found <A 
      href="http://www.codeproject.com/info/Licenses.aspx">here</A></P></DIV>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=24814">Fred 
            Ackers</A></B><BR><BR>
            <CENTER><IMG id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
            src=""></CENTER><BR><SPAN class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType>Supporter</SPAN> 
          </TD>
          <TD>Programming using MFC and ATL for almost 12 years now. Currently 
            studying Operating System implementation as well as Image 
            processing. Previously worked on DSP and the use of FFT for audio 
            application. Programmed using ADO, ODBC, ATL, COM, MFC for shell 
            interfacing, databasing tasks, Internet items, and customization 
            programs.<BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow>
                <TD class=SmallText noWrap>Occupation: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Web 
                  Developer</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt="United States" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/US.gif" 
                  width=16> United 
        States</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular Audio and Video articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/audio-video/Motion_Detection.aspx">Motion 
              Detection Algorithms</A>
              <DIV class=SmallText>Some approaches to detect motion in a video 
              stream.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/audio-video/cameraviewer.aspx">Camera 
              Vision - video surveillance on C#</A>
              <DIV class=SmallText>A C# video surveillance application, which 
              allows monitoring several IP cameras simultaneously.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/audio-video/face_detection.aspx">Face 
              Detection C++ Library with Skin and Motion Analysis</A>
              <DIV class=SmallText>The article demonstrates face detection SSE 
              optimized C++ library for color and gray scale data with skin 
              detection, motion estimation for faster processing, small sized 
              SVM and NN rough face prefiltering, PCA/LDA/ICA/any dimensionality 
              reduction/projection and final NN classification</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/audio-video/avifilewrapper.aspx">A 
              Simple C# Wrapper for the AviFile Library</A>
              <DIV class=SmallText>Edit AVI files in .NET.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/audio-video/avicapwrp.aspx">CAviCap 
              and CFrameGrabber - wrappers for AVICap Window</A>
              <DIV class=SmallText>AVICap wrappers to ease real-time video 
              processing and single frame capture</DIV></LI></UL></TD>
          <TD>
            <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6194%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fTallCompReaderControl300x250.gif%26C%3dFalse%26adid%3d6194%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22300%22%20height%3d%22250%22%3e%3c%2fa%3e"));</SCRIPT>
          </TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
var socialLinks = new social();
socialLinks.addtoMethod=1;
socialLinks.DrawLinks("socialLinks", document.location.href, escape(document.title), 100, 0, "SmallText Bold", "AddTo");
</SCRIPT>
      </DIV>
      <TABLE class=RatingBar id=ctl00_RateArticleRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD id=ctl00_RateArticle_VoteResultDiv noWrap align=right 
                width="100%"><SPAN id=voteRes></SPAN><IMG id=loaderImg 
                  style="DISPLAY: none" height=16 alt=loading... 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/ajax-loader.gif" 
                  width=16> </TD>
                <TD class=SmallText id=voteTbl style="WHITE-SPACE: nowrap" 
                align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px; WHITE-SPACE: nowrap"><I><B>Rate 
                        this Article for us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm noWrap 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn onclick="return rateItem(6855,2);" type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV><INPUT id=__EVENTVALIDATION type=hidden 
      value=/wEWCAKclq2BDwLAlMXDBwLBlMXDBwLClMXDBwLDlMXDBwLElMXDBwLP+++tCwK5upDkCy6Cz9S9aDGBHJZtiKB0SrncXIpg 
      name=__EVENTVALIDATION> </DIV></FORM>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center"><IFRAME 
      src="res://D:\WINDOWS.0\system32\shdoclc.dll/dnserror.htm" frameBorder=0 
      width=468 scrolling=no height=60></IFRAME><IFRAME 
      src="res://D:\WINDOWS.0\system32\shdoclc.dll/dnserror.htm" frameBorder=0 
      width=300 scrolling=no height=60></IFRAME></DIV><A name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD>
            <FORM 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2faudio-video%2fwaveInFFT.aspx&amp;fid=39693 
            method=get><INPUT type=hidden value=39693 name=fid><INPUT 
            type=hidden 
            value=?floc=%2fKB%2faudio-video%2fwaveInFFT.aspx&amp;fid=39693 
            name=currentQS><INPUT type=hidden 
            value=/KB/audio-video/waveInFFT.aspx name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 alt=FAQ 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/forum_faq.gif" 
                  width=16 align=middle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 alt=Search 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/forum_search.gif" 
                  width=16 align=top border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=39693">Search 
                  Messages</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=SetOpt></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></FORM></TD></TR>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 alt=new 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/forum_newmsg.gif" 
                  width=16 align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;floc=/KB/audio-video/waveInFFT.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 25 of 145 (Total in Forum: 145) (<A 
                  href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next</A></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0><!-- Column Headers -->
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2709639_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2709639xx></A><IMG height=16 alt=Question 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2709639#xx2709639xx" 
                        name=2709639>a few question about play wave file with 
                        DirectSound and display spectrum.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1982172">jacky_zz</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">23:23 4 
                        Sep '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2709639_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hi, i got a <A 
                                href="http://www.codeproject.com/KB/audio-video/DirectSoundAudioStream.aspx" 
                                target=_blank><B>program</B></A> from 
                                codeproject which playes wave file with 
                                directsound. and i want to modify it and add 
                                spectrum support to it. but i got some 
                                questiones about it, can you help me resolve 
                                it?<BR><BR><B>question one:</B><BR>the program 
                                open wave file and read wave file information to 
                                struct WAVEFORMATEX, the members of it like 
                                wFormatTag=1, nChannels=2, nSamplesPerSec=44100, 
                                nAvgBytesPerSec=176400, nBlockAlign=4, 
                                wBitsPerSample=16, cbSize=0. then program 
                                initial DirectSoundBuffer's size as 176400, we 
                                must set size to 176400, it can be set any 
                                number?<BR><BR><B>question two:</B><BR>i add 
                                code to log DirectSoundBuffer's current play 
                                position and current write position to listbox 
                                control, the max value displayed in it which 
                                each of them may big than 176400, how can i get 
                                right start postion what i want to sample the 
                                buffer?<BR>code like:<BR><PRE>DWORD dwCurPlayPos, dwCurWritePos;<BR>m_lpDSB-&gt;GetCurrentPosition(&amp;dwCurPlayPos, &amp;dwCurWritePos);</PRE><BR><BR><B>question 
                                three:</B><BR>if i get right start postion of 
                                buffer, what right sample size may be 
                                suggest?<BR><BR>code modified by me can download 
                                <A 
                                href="http://lixin.aicoding.cn/dsoundplay.zip" 
                                target=_blank><B>here</B></A>.<BR><BR>regards,<BR>jacky_zz<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2709639&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2709639&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2709639">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2709639">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2709639&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2709639 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1982172,2709639,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2636817_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2636817xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2636817#xx2636817xx" 
                        name=2636817>Question about scaling the amplitude</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47572">tabor25</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:36 14 
                        Jul '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2636817_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello,<BR><BR>i don't understand, 
                                why the mod-operator % and not the div-operator 
                                / is used for scaling the 
                                amplitude:<BR><BR>#define 
                                AmplitudeScaled(re,im,len,scale) 
                                ((int)Amplitude(re,im,len)%scale)<BR><BR>Maybe 
                                someone can answer this 
                                question?<BR><BR><BR>Best 
                                regards,<BR>Tabor25<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2636817&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2636817&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2636817">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2636817">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2636817&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2636817 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(47572,2636817,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2405010_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2405010xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2405010#xx2405010xx" 
                        name=2405010>[Message Deleted]</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=51457">Danny 
                        Rodriguez</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:09 
                        27 Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2405010_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>[Message Deleted]<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2405010&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2405010&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2405010">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2405010">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2405010&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2405010 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(51457,2405010,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2383877_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2383877xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2383877#xx2383877xx" 
                        name=2383877>xcode version</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4832565">eoghancunneen</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:25 9 
                        Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2383877_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I was wondering if anyone has 
                                attempting to integrate the above code into an 
                                xcode project?<BR>If so, what ammendments have 
                                you made?<BR>Cheers<BR>Eoghan <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2383877&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2383877&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2383877">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2383877">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2383877&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2383877 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4832565,2383877,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2332877_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2332877xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2332877#xx2332877xx" 
                        name=2332877>for another condition</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4688741">aa_esa</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">21:07 
                        23 Nov '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2332877_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi....<BR><BR>your article is 
                                great....<BR>it's very useful for me. but i have 
                                a question for you..<BR>can the source code add 
                                by sound from using sound card??<BR>so the 
                                result is waveform from the sound by using sound 
                                card.<BR><BR>I really appreciate it if you can 
                                help me. because it can help<BR>finish my task. 
                                please.....<BR><BR>thank you.... <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2332877&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2332877&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2332877">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2332877">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2332877&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2332877 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(4688741,2332877,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2179505_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2179505xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2179505#xx2179505xx" 
                        name=2179505>use many cpu percenge</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3639985">shallopquan</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:15 13 
                        Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2179505_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>use many cpu percenge 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2179505&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2179505&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2179505">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2179505">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2179505&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2179505 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3639985,2179505,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2165365_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2165365xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2165365#xx2165365xx" 
                        name=2165365>re</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3364915">Leon.Minos</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">21:39 2 
                        Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2165365_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>thank u for the detail,your 
                                ultilitis reference about it was very clear and 
                                avaliable。 <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2165365&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2165365&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2165365">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2165365">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2165365&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2165365 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3364915,2165365,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote Rt HdUnSel " id=F2163095_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2163095xx></A><IMG height=16 alt=Question 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2163095#xx2163095xx" 
                        name=2163095>VisualC++ Error</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2123916">edguardian</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">14:45 1 
                        Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2163095_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Thank you everybody, can someone 
                                help me please, i downloaded the code and tried 
                                to compile with, visual C++ 6.0 but i get this 
                                error, any idea of how fix 
                                it:<BR><BR>--------------------Configuration: 
                                waveInFFT - Win32 
                                Debug-------------------<BR>Compiling...<BR>waveInFFTDlg.cpp<BR>C:\waveinFFT_demo\waveInFFTDlg.cpp(143) 
                                : error C2374: 'i' : redefinition; multiple 
                                initialization<BR>C:\waveinFFT_demo\waveInFFTDlg.cpp(125) 
                                : see declaration of 
                                'i'<BR>C:\waveinFFT_demo\waveInFFTDlg.cpp(169) : 
                                error C2374: 'i' : redefinition; multiple 
                                initialization<BR>C:\waveinFFT_demo\waveInFFTDlg.cpp(125) 
                                : see declaration of 'i'<BR>Error executing 
                                cl.exe.<BR>waveInFFT.exe - 2 error(s), 0 
                                warning(s)<BR><BR><BR>ED<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2163095&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2163095&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2163095">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2163095">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2163095&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2163095 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(2123916,2163095,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2167858_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2167858xx></A><IMG height=16 alt=Answer 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2167858#xx2167858xx" 
                        name=2167858>Re: VisualC++ Error</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=supporter height=16 alt=supporter 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/supporter_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=24814">Fred 
                        Ackers</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:19 4 
                        Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2167858_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Rename one of the variables "i" to 
                                another letter, perhaps "j", change the use of 
                                "i" within the following "for" loop from i to j, 
                                and that should fix the problem. I do not have 
                                Visual C++ 6.0 so I can not test the code on 
                                that compiler. <BR><BR>
                                <DIV class=ForumSig>Nothing is impossible, It's 
                                merely a matter of finding an answer to the 
                                question of HOW? ... And answering that question 
                                is usually the most difficult part of the 
                                job!!!</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2167858&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2167858&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2163095">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2167858">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2167858&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2167858 
                                style="WHITE-SPACE: nowrap">4.00/5 (2 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(24814,2167858,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2055238_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2055238xx></A><IMG height=16 alt=Question 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2055238#xx2055238xx" 
                        name=2055238>Poor audio quality</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2595839">ChrisMitchell_</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">22:23 
                        26 May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2055238_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi really useful programme. Just 
                                trying to have a go at some simple DSP. Quick 
                                question, if you print the audio sample values 
                                "(double)((short*)pwh-&gt;lpData)[dw++];" to a 
                                text file and load it up into a sound editor, 
                                adobe audition can take plain text input, so can 
                                matlab, and set the sampling rate to 44100, as 
                                defined in the programme's sampling rate, the 
                                audio you are doing the FFT on plays back at the 
                                wrong speed (speed up) and is of poor, but 
                                audible, quality. Any ideas why there is a 
                                difference in the sampling rate and why the 
                                audio recording is so noisy. 
                                <BR><BR><BR><BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2055238&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2055238&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2055238">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2055238">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2055238&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2055238 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(2595839,2055238,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2058742_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2058742xx></A><IMG height=16 alt=Answer 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2058742#xx2058742xx" 
                        name=2058742>Re: Poor audio quality</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=supporter height=16 alt=supporter 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/supporter_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=24814">Fred 
                        Ackers</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">15:32 
                        29 May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2058742_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>The noise in the recording, which 
                                you probably noticed by the program display when 
                                no audio is playing, has to do with the 
                                recording properties. Depending upon what sound 
                                card a person is using, there may or may not be 
                                a Wave/MP3 line in the recording properties. 
                                Otherwise the selected recording line, (and even 
                                if there is a wave line) is usually set to 
                                "Stereo" or "What U Hear" or some such term. In 
                                effect what this does is combine all the 
                                recording lines into one source. This includes 
                                feedback from the Mic Line. If you can try 
                                selecting the WAVE/MP3 line in the recording 
                                options of your sound card. That should take 
                                care of the issue. If you select that line, you 
                                will notice the program no longer displays any 
                                noise when no audio is playing. If you do not 
                                have such a line in your volume control 
                                recording options, then I do not know what you 
                                can do other than changing the program from 
                                waveIn recording, to waveOut playing but that 
                                will require extensive changes. <BR><BR>
                                <DIV class=ForumSig>Nothing is impossible, It's 
                                merely a matter of finding an answer to the 
                                question of HOW? ... And answering that question 
                                is usually the most difficult part of the 
                                job!!!</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2058742&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2058742&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2055238">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2058742">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2058742&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2058742 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(24814,2058742,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2060217_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2060217xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2060217#xx2060217xx" 
                        name=2060217>Re: Poor audio quality [modified]</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2595839">ChrisMitchell_</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:59 
                        30 May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2060217_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi Fred, thanks for the help 
                                although this is not the case, I have tested it 
                                to be sure. All are muted apart from the 
                                microphone I am trying to record off and the 
                                value comes out distorted, not just with added 
                                low level noise. This manifests itself audible 
                                like distortion as if the sound card was being 
                                overdriven (the input was too loud) expect it is 
                                not reaching the max values of the buffers 2 
                                bytes per samples for the 16 bit sample 
                                resolution and is within the normal recording 
                                levels for the device. Any more ideas would be 
                                greatfuly recieved. I have ran a sweeping sin 
                                wav through and got frequency components addeded 
                                that arn't in the original. I also ran through a 
                                fixed 100 Hz signal and found that what ever is 
                                in each buffer does not produce a continous sine 
                                wav. ie. when it starts a new set of 1024 
                                samples it does not follow on from the old ones 
                                (for example with max and mins. 1 0 -1 0 ... [up 
                                to 1023 then] ... 0 (does not follow and does to 
                                something it shouldn't) 0 -1 ....). This sounded 
                                like a buffer problem to me, so I upped the 
                                number of buffers being used from 16 (as per the 
                                original code) to 300 which decreases the 
                                frequent occurance of these errors. Any 
                                ideas?<BR><BR><BR><BR><BR>-- modified at 19:48 
                                Wednesday 30th May, 2007 <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2060217&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2060217&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2055238">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2060217">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2060217&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2060217 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(2595839,2060217,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2062281_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx2062281xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2062281#xx2062281xx" 
                        name=2062281>Re: Poor audio quality</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=supporter height=16 alt=supporter 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/supporter_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=24814">Fred 
                        Ackers</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">15:51 
                        31 May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2062281_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>The very reason is what you 
                                stated.<BR>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>ChrisMitchell_ wrote:</DIV>the 
                                microphone I am trying to record off 
                                </BLOCKQUOTE><BR><BR>Microphones have inherent 
                                distortion in them on most systems. Try using a 
                                line in or wave file as input instead of 
                                microphone.<BR><BR><BR>
                                <DIV class=ForumSig>Nothing is impossible, It's 
                                merely a matter of finding an answer to the 
                                question of HOW? ... And answering that question 
                                is usually the most difficult part of the 
                                job!!!</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2062281&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2062281&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2055238">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2062281">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2062281&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2062281 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(24814,2062281,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2103583_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2103583xx></A><IMG height=16 alt=Question 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=2103583#xx2103583xx" 
                        name=2103583>Re: Poor audio quality</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1280808">bquintero</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">21:27 
                        27 Jun '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2103583_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Something seems severely wrong in 
                                this entire demo. I wouldn't recommend use this 
                                as a basis for anyone learning FFT or beat 
                                detection.<BR><BR>1) The code below does almost 
                                nothing since 'nAvg' is calculating the average 
                                of the same number 'fdraw[i]'.<BR>2) 'i' is 
                                incremented in the loop statement AND in the 
                                body of the loop inexplicably<BR>3) Even if you 
                                mute all audio input devices, you'll still get 
                                garbage.<BR><BR><BR><PRE><BR><CODE>	<BR>for(int i=1;i &lt; FFT_LEN/4;i++)<BR>{<BR>	nAvg = 0;<BR>	for (int n=0; n &lt; nBars; n++)<BR>	{<BR>		nAvg += (int)fdraw[i];<BR>	}<BR>	nAvg /= nBars;<BR>	//Send data here to something,<BR>	//nothing to send it to so we print it.<BR>	TRACE("Average for Bar#%d is %d\n",nCur++,nAvg);<BR>	i+=nBars-1;<BR>}<BR></CODE><BR></PRE><BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2103583&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=2103583&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=2055238">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=2103583">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2103583&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2103583 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1280808,2103583,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1977459_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1977459xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=1977459#xx1977459xx" 
                        name=1977459>Thank you</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1734385">DanMax</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">2:05 6 
                        Apr '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1977459_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I just wanted to say thanks for 
                                posting this project. I have only just started 
                                with C/C++ , and this project has been a great 
                                help .as I said before in my last post I wanted 
                                to get this to work with an audio file , its 
                                taken me a few weeks but I have now got a small 
                                program that runs in a dos box ,it reads and 
                                audio file and writes out the FFT data to a text 
                                file. this is something I have needed for some 
                                time but I had no way of knowing how to do it . 
                                but thanks to you and a few late nights I have 
                                learnt how to make it work. I still have a few 
                                small bits to sort out in my program but its 
                                well on its way to being 100% ready . I would 
                                not have been able to do it with out your 
                                waveinfft project to get me started so Fred 
                                thank you very much <IMG alt=Smile 
                                src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top> ...<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1977459&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1977459&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=1977459">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=1977459">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1977459&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1977459 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1734385,1977459,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1967956_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1967956xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=1967956#xx1967956xx" 
                        name=1967956>Number of channels?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3794077">jakeparks</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:08 
                        30 Mar '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1967956_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Very nice demo! <BR><BR>One 
                                question, though. In the code, you specify the 
                                number of channels is 1 (in both the PCMFORMAT 
                                and WAVEFORMATEX structs). However, you are 
                                still reading data from the both the left and 
                                right channels. Why did you not specify the 
                                number of channels as 2? What would have been 
                                the difference (if any) if 2 channels were 
                                specified?<BR><BR>Thanks. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1967956&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1967956&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=1967956">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=1967956">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1967956&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1967956 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3794077,1967956,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F1969232_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1969232xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=1969232#xx1969232xx" 
                        name=1969232>Re: Number of channels?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=supporter height=16 alt=supporter 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/supporter_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=24814">Fred 
                        Ackers</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">16:03 
                        31 Mar '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1969232_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>jakeparks wrote:</DIV>Why did you 
                                not specify the number of channels as 2? 
                                </BLOCKQUOTE><BR><BR>This was a minor oversite 
                                on my part. I corrected the issue, and made a 
                                few other changes, like changing the FFT size 
                                and correcting the spectrum display. I have 
                                submitted the code and it should be available in 
                                a few days. <BR><BR>
                                <DIV class=ForumSig>Nothing is impossible, It's 
                                merely a matter of finding an answer to the 
                                question of HOW? ... And answering that question 
                                is usually the most difficult part of the 
                                job!!!</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1969232&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1969232&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=1967956">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=1969232">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1969232&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1969232 
                                style="WHITE-SPACE: nowrap">2.25/5 (3 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(24814,1969232,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1971705_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx1971705xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=1971705#xx1971705xx" 
                        name=1971705>Re: Number of channels?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3794077">jakeparks</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">16:50 2 
                        Apr '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1971705_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>It seems true, however, that even 
                                if you specify the number of channels as 1, that 
                                the data from the left and right channels are 
                                interleaved. What then, if any, is the result of 
                                specifying the number of channels as 1? Does it 
                                really not matter at all? <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1971705&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1971705&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=1967956">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=1971705">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1971705&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1971705 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3794077,1971705,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F1973473_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx1973473xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=1973473#xx1973473xx" 
                        name=1973473>Re: Number of channels?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=supporter height=16 alt=supporter 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/supporter_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=24814">Fred 
                        Ackers</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">13:02 3 
                        Apr '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1973473_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>The number of channels specified 
                                in the WAVEFORMATEX structure makes a 
                                difference. The is sent to the waveInOpen 
                                function to tell the input how to format the 
                                data that we will retrieve. If one channel is 
                                specified, the data returned in the WAVEHDR 
                                buffer is for one channel only, if two channels 
                                are specified, then the data returned is 
                                interleaved for two channels. Attempting to 
                                extract two channels from one channel data would 
                                cause an issue such as:<BR><BR>One channel data 
                                10101010<BR>Left extracted 1111<BR>Right 
                                Extracted 0000<BR><BR>instead of:<BR>Two channel 
                                left 10101010<BR>Two channel right 10101010 
                                <BR><BR>
                                <DIV class=ForumSig>Nothing is impossible, It's 
                                merely a matter of finding an answer to the 
                                question of HOW? ... And answering that question 
                                is usually the most difficult part of the 
                                job!!!</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1973473&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1973473&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=1967956">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=1973473">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1973473&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1973473 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(24814,1973473,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1966467_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1966467xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=1966467#xx1966467xx" 
                        name=1966467>Don Cross reference</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=654975">stug</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:18 
                        29 Mar '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1966467_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Nice app fred, thanks<BR><BR>Here 
                                is an active link to a Don Cross page which may 
                                be of interest this project's 
                                users,<BR>http://groovit.disjunkt.com/analog/time-domain/timefilt.html<BR><BR>It 
                                contains a link to FFTW.org which is also a good 
                                FFT resource.<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1966467&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1966467&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=1966467">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=1966467">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1966467&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1966467 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(654975,1966467,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1963929_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1963929xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=1963929#xx1963929xx" 
                        name=1963929>What frequencies do the frequency bands 
                        correspond to?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3385560">conor20</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:07 
                        28 Mar '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1963929_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi Fred,<BR><BR>Do you know what 
                                frequencies the groupings of the FFT results 
                                correspond to?<BR><BR>Or even the frequency 
                                range of the entire FFT 
                                output?<BR><BR>Thanks.<BR>Conor. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1963929&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1963929&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=1963929">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=1963929">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1963929&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1963929 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3385560,1963929,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1965411_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1965411xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=1965411#xx1965411xx" 
                        name=1965411>Re: What frequencies do the frequency bands 
                        correspond to?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3385560">conor20</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:41 29 
                        Mar '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1965411_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Just to elaborate on my question; 
                                The range would be from 0Hz to Fmax where Fmax 
                                is given by <BR><BR>the sample rate / 
                                2.<BR><BR>The sample rate as set in the 
                                constructor of the recorder is 11025Hz which 
                                suggests the FFT has a range from 0 to 5.5KHz. I 
                                am almost positive this is not the case however 
                                after testing the FFT one some isolated 
                                recordings of different instruments. A human 
                                voice has a frequency range of about 350Hz 
                                somewhere between 85Hz to 1.1KHz, yet when the 
                                FFT is performed on a human voice, it shows 
                                frequencies in the upper bands (about 5KHz). 
                                Surely, even the harmonics of the voice couldn't 
                                stretch this far.<BR><BR>Hence, I think maybe 
                                I'm wrong about the sample rate being 11025. 
                                Could you help me out?<BR>If you could reply 
                                quickly, I'd really appreciate 
                                it.<BR><BR>Thanks.<BR>Conor. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1965411&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1965411&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=1963929">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=1965411">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1965411&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1965411 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3385560,1965411,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1966197_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx1966197xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=1966197#xx1966197xx" 
                        name=1966197>Re: What frequencies do the frequency bands 
                        correspond to?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=supporter height=16 alt=supporter 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/supporter_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=24814">Fred 
                        Ackers</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">14:34 
                        29 Mar '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1966197_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I am not sure exactly what the 
                                human voice response range is, but I do know 
                                that the telephone system cuts off part of the 
                                voice, and they have a frequency range of 0 to 
                                4Khz. Though I have heard that the voice will 
                                range above 5KHz sometimes. <BR><BR>
                                <DIV class=ForumSig>Nothing is impossible, It's 
                                merely a matter of finding an answer to the 
                                question of HOW? ... And answering that question 
                                is usually the most difficult part of the 
                                job!!!</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1966197&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1966197&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=1963929">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=1966197">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1966197&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1966197 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(24814,1966197,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1972668_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx1972668xx></A><IMG height=16 alt=General 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=1972668#xx1972668xx" 
                        name=1972668>Re: What frequencies do the frequency bands 
                        correspond to?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3385560">conor20</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:49 3 
                        Apr '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1972668_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>One last question..<BR><BR>When I 
                                change the frequency in the Recorder constructor 
                                (m_PcmFormat.dwSampleRate = 11025<IMG alt=Wink 
                                src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/smiley_wink.gif" 
                                align=top> to say, 44100, this obviously changes 
                                the sample rate for the microphone. I'm not 
                                actually using the microphone to collect samples 
                                though, I've changed the code so it's now taking 
                                them from wav files. <BR><BR>It seems to slow 
                                the machine down a lot, which suggests that more 
                                FFT's are being performed(44100 as opposed to 
                                11025 a second). Is this the case? If so, where 
                                in the code does this occur? The fft_double 
                                routine is called in Process() but this doesn't 
                                seem to be dependant in any way on the sample 
                                rate which is why I can't see why it's slowing 
                                down so much.<BR><BR>It must have something to 
                                do with the dwSampleRate but I just can't find 
                                where. I'm guessing maybe the sound device is 
                                returning more, 44100 times a second instead of 
                                11025 times (when the sample rate is changed to 
                                44100Hz), and this callback calls the FFT 
                                routine, but I'm not sure as I can't find it in 
                                the code.<BR><BR>Thanks. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1972668&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1972668&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=1963929">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=1972668">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1972668&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1972668 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3385560,1972668,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F1973448_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=88><A 
                        name=xx1973448xx></A><IMG height=16 alt=Answer 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;select=1973448#xx1973448xx" 
                        name=1973448>Re: What frequencies do the frequency bands 
                        correspond to?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=supporter height=16 alt=supporter 
                        src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/supporter_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=24814">Fred 
                        Ackers</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:45 3 
                        Apr '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1973448_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 88px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>There are actually a number of 
                                things occuring here when you increase the 
                                sample rate. 1) FFT is being called more often. 
                                It is a relavitely computationally intensive 
                                routine increase CPU use. 2) You are reading 
                                from the hard drive which is relatively slow to 
                                begin with compared to using memory and CPU 
                                while reading from a hardware device. 3) Just as 
                                the FFT is being called more often, the Drawing 
                                routines are being called more often. They are 
                                using SetPixel and LineTo functions which are 
                                relatively slow methods of drawing. As they are 
                                called more often, that means more pixels need 
                                to be processed increase CPU usage. <BR><BR>
                                <DIV class=ForumSig>Nothing is impossible, It's 
                                merely a matter of finding an answer to the 
                                question of HOW? ... And answering that question 
                                is usually the most difficult part of the 
                                job!!!</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1973448&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=39693&amp;select=1973448&amp;floc=/KB/audio-video/waveInFFT.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;tid=1963929">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=39693&amp;msg=1973448">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=1973448&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1973448 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(24814,1973448,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Tuesday, September 30, 2008 3:10 AM &nbsp; 
                  &nbsp; Last Update:Wednesday, October 8, 2008 3:59 PM</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><B>1</B><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>2</A><A class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;fr=51#xx0xx" 
                  name=Frm_HoverNL>3</A><A class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;fr=76#xx0xx" 
                  name=Frm_HoverNL>4</A><A class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;fr=101#xx0xx" 
                  name=Frm_HoverNL>5</A> <A class=Frm_HL 
                  href="http://www.codeproject.com/KB/audio-video/waveInFFT.aspx?fid=39693&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next 
      »</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 alt=General 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_general.gif" 
      width=16 align=top> General &nbsp;&nbsp; <IMG height=16 alt=News 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_news.gif" 
      width=16 align=top> News &nbsp;&nbsp; <IMG height=16 alt=Question 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_question.gif" 
      width=16 align=top> Question &nbsp;&nbsp; <IMG height=16 alt=Answer 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_answer.gif" 
      width=16 align=top> Answer &nbsp;&nbsp; <IMG height=16 alt=Joke 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_joke.gif" 
      width=16 align=top> Joke &nbsp;&nbsp; <IMG height=16 alt=Rant 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_rant.gif" 
      width=16 align=top> Rant &nbsp;&nbsp; <IMG height=16 alt=Admin 
      src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/msg_admin.gif" 
      width=16 align=top> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=6855">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy</A> | <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 3 Apr 2007<BR>Editor: <A 
            id=ctl00_ArticleEditor 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3873871">Sean 
            Ewington</A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2004 by Fred 
            Ackers<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2008 
            <BR>Web19 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE>
      <CENTER></CENTER></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE><BR>
<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject FFT of waveIn audio signals_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
new HVMenu(new menu_NavbarConfig());
//]]></SCRIPT>
</BODY></HTML>
