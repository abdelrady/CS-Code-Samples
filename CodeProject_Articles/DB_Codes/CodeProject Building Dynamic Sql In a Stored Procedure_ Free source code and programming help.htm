<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0064)http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx -->
<HTML><HEAD><TITLE>CodeProject: Building Dynamic Sql In a Stored Procedure. Free source code and programming help</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content='This article explains about Building and Executing a Dynamic Sql in a stored procedure.; Author:   <font color="brown" size="1">John Prabhu</font>; Section: Database; Chapter: Database' 
name=Description>
<META 
content="SQL 2000, C++, SQL, Windows, Visual Studio, DBA, Dev, Intermediate,Database,Database,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("www.codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/jxs.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/bookmark.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/rateitem.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function MsgVoteForm(MemberID,MsgID,GB,gp,bp,mt) {
 if(!GB)document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"5":"1")+unescape(");\"%3E"));
 if(GB) document.write(unescape("%3Cimg height=\"24\" width=\"24\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;"); else for(var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"vote this message a " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ")\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"1":"5")+unescape(");\"%3E"));
 if(GB)document.write(unescape("%3Cimg height=\"24\" width=\"24\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" border=\"0\" alt=\"vote 5\" align=\"middle\" /%3E%3C/a%3E "));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?") == true)
  return RateMsg(userid, msgid, score);
 else return false;
}
function RateMsg(memberid, msgid, score) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4) {
   if ( req.status == 200 ) {
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match)?match[1]:"An error occured" + unescape("%3C/b%3E");
   }
   else
   {
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
   }
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK 
href="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/ForumClassicIE6.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" type=image/ico rel="shortcut icon">
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            id=ctl00_Logo 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; WIDTH: 225px; HEIGHT: 90px; BORDER-RIGHT-WIDTH: 0px" 
            alt="The Code Project" 
            src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/logo225x90.gif"></A></TD>
          <TD class=HeaderBanner align=right width="100%"><IFRAME 
            src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/ServeHTML.htm" 
            frameBorder=0 width=728 scrolling=no height=90></IFRAME></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">5,215,143 
                  members and growing! (20,420 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">abdelrady2030</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx">My 
                  Settings</A> | <A id=ctl00_MemberMenu_MyCodeProject 
                  href="http://www.codeproject.com/script/Membership/MyCodeProject.aspx"><B>My 
                  CodeProject</B></A> | <A id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 
                  src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/fave.gif" 
                  width=16 align=absMiddle border=0> My Bookmarks</A> | <A 
                  id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2fdatabase%2fBuilding_Dynamic_SQL.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD noWrap><A href="http://www.codeproject.com/">Home</A></TD>
                <TD>&nbsp; </TD>
                <TD noWrap align=right>Current Site: </TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/">Main Site</A></TD>
                <TD noWrap><A href="http://java.codeproject.com/">Java</A></TD>
                <TD noWrap><A href="http://lamp.codeproject.com/">Linux Apache 
                  MySQL PHP</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus><!--380-->
                  <DIV id=MenuPos 
                  style="WIDTH: 305px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=305>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleUneditedHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A> 
            » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/database/">Database</A> » <A 
            id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/database/index.aspx?#Database - General">General</A> 
            <SPAN class=ArticleIntermediate 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Intermediate</SPAN> <SPAN 
            id=ctl00_ArticleTopHeader_LicenceTerms></SPAN><BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>Building Dynamic Sql In a 
            Stored Procedure</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2445395"><FONT 
            color=brown size=1>John Prabhu</FONT></A></B><BR><BR><SPAN 
            class=ArticleTopDescr id=ctl00_ArticleTopHeader_ArticleDescr>This 
            article explains about Building and Executing a Dynamic Sql in a 
            stored procedure.</SPAN> </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>C++, SQL, Windows, 
            Visual Studio, SQL 2000, SQL, DBA, Dev</SPAN><BR><BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>9 Oct 2007</B><BR><SPAN 
            style="PADDING-RIGHT: 0.5ex">Updated</SPAN>: <B>9 Oct 2007</B> 
            <BR><SPAN style="PADDING-RIGHT: 3.2ex">Views</SPAN>: 
            <B>13,846</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD>
                  <DIV id=ctl00_ArticleTopHeader_UneditedDiv><B>Note: <A 
                  id=ctl00_ArticleTopHeader_UneditedLnk 
                  href="http://www.codeproject.com/script/Articles/Unedited.aspx">This 
                  is an unedited reader contribution</A></B> </DIV></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV style="PADDING-TOP: 5px; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6247%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fcp_daily_150x80.gif%26C%3dFalse%26id%3d6247%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22150%22%20height%3d%2280%22%3e%3c%2fa%3e"));</SCRIPT>
      </DIV>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <DIV style="PADDING-TOP: 0px"><IMG 
      style="FLOAT: left; MARGIN-LEFT: 8px; MARGIN-RIGHT: 9px" height=20 
      alt=Comp 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/prize_winner.gif" 
      width=10> <A href="http://www.codeproject.com/Feature/CodeGenComp/">Code 
      Generation<BR>comp. $1,000 prize!</A></DIV>
      <DIV style="MARGIN-TOP: 4px; MARGIN-BOTTOM: 3px"><IMG 
      style="FLOAT: left; MARGIN-LEFT: 6px; MARGIN-RIGHT: 6px" height=16 
      alt=Comp 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/coffee.gif" 
      width=16> <A href="http://www.codeproject.com/Zones/IBM/">Win CodeProject 
      Coffee!</A></DIV>
      <DIV style="PADDING-TOP: 0px"><IMG 
      style="FLOAT: left; MARGIN-LEFT: 8px; MARGIN-RIGHT: 9px" height=20 
      alt=Comp 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/prize_winner.gif" 
      width=10> <A id=ctl00_Announcements_CompLink 
      href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
      Competition</A><BR clear=all>
      <DIV style="PADDING-BOTTOM: 5px; PADDING-TOP: 3px"><IMG 
      style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 8px" 
      height=16 alt=Staff 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/staff_sm.gif" 
      width=12> <A href="http://www.codeproject.com/info/jobs/">We're 
      Hiring</A></DIV></DIV></DIV>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
Board</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV><BR>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2 style="DISPLAY: none">
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MI id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3 style="DISPLAY: none">
      <DIV class=MI id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4>
      <DIV class=MIS id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5 style="DISPLAY: none">
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV>
      <DIV class=MI id=Section126><A 
      href="http://www.codeproject.com/KB/codegen/">Code 
      Generation</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter12');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=12">Third 
      Party Products</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter12 style="DISPLAY: none">
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section124><A 
      href="http://www.codeproject.com/KB/solution-center/">Solution 
      Center</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/WhitePapers">WhitePapers</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/CodeGeneration">Code 
      Generation</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/QuestSQL">Quest SQL 
      Zone</A></DIV><BR>
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6484%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fDPB%2b160x600.jpg%26C%3dFalse%26id%3d6484%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22160%22%20height%3d%22600%22%3e%3c%2fa%3e"));</SCRIPT>
      <IMG height=1 alt="" 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/t.gif" 
      width=160> </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top>
            <TABLE>
              <TBODY></TBODY></TABLE>
            <DIV class=SmallText><IMG style="VERTICAL-ALIGN: middle" height=16 
            alt=print 
            src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/print.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
            href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?display=Print">Print</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Broken Article?" 
            src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/report.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_BrokenLnk 
            href="http://www.codeproject.com/script/Articles/Report.aspx?aid=20815">Report 
            Article</A> &nbsp; <IMG style="VERTICAL-ALIGN: middle" alt=Watch 
            src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/watchon.png"> 
            <A class="" id=bmw_20815,2 onclick="return watchMe(20815, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=20815&amp;obtid=2&amp;bma=AddWatch" 
            name=ajaxBookmarkWatchLink>Watch</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN><SPAN 
            id=ctl00_ArticleHeaderLinks_ArticleBmkWatch_Message></SPAN>&nbsp; 
            <IMG style="VERTICAL-ALIGN: middle" height=16 alt=Bookmark 
            src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/link.png" 
            width=16> <A class="" id=bm_20815,2 
            onclick="return bookmarkMe(20815, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=20815&amp;obtid=2&amp;bma=AddBookmark" 
            name=ajaxBookmarkLink>Bookmark</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN><SPAN 
            id=ctl00_ArticleHeaderLinks_ArticleBmk_Message></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Discuss 
            src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/discuss.gif" 
            width=15> <A 
            href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx#_comments">Discuss</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Recommend Article" 
            src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/mail.gif" 
            width=16>&nbsp;<A id=ctl00_ArticleHeaderLinks_Recommend 
            href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=20815">Send&nbsp;to&nbsp;a&nbsp;friend</A> 
            </DIV></TD>
          <TD style="WIDTH: 100px; WHITE-SPACE: nowrap; TEXT-ALIGN: right">
            <TABLE id=CurRat>
              <TBODY>
              <TR>
                <TD>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=SmallText style="WHITE-SPACE: nowrap" 
                      align=right><SPAN id=ctl00_ArticleRating_VoteLabel>12 
                        votes for this Article.</SPAN></TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=1>
                          <TBODY>
                          <TR>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD noWrap width=20 bgColor=white height=7><IMG 
                              height=7 
                              src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/red.gif" 
                              width=14 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/white.gif" 
                              width=20 align=center 
                      border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=ctl00_ArticleRating_PopularityRow>
                      <TD class=SmallText align=right colSpan=2><A 
                        id=ctl00_ArticleRating_PopularityLnk 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                        4.01</A> <SPAN 
                        id=ctl00_ArticleRating_PopularityLbl></SPAN><SPAN 
                        id=ratingVal>Rating: <B>3.71</B> out of 
                    5</SPAN></TD></TR></TBODY></TABLE></TD>
                <TD>
                  <DIV>
                  <TABLE class=HistTable 
                  title="Voting Distribution. Recent data only">
                    <TBODY>
                    <TR>
                      <TD><IMG title="1 vote, 8.3%" height=5 
                        alt="1 vote, 8.3%" 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>1</TD>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>2</TD>
                      <TD><IMG title="3 votes, 25.0%" height=15 
                        alt="3 votes, 25.0%" 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>3</TD>
                      <TD><IMG title="4 votes, 33.3%" height=20 
                        alt="4 votes, 33.3%" 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>4</TD>
                      <TD><IMG title="4 votes, 33.3%" height=20 
                        alt="4 votes, 33.3%" 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/pollcol.gif" 
                        width=10 
              border=0><BR>5</TD></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV class=SmallText id=ctl00_UneditedRow 
      style="PADDING-RIGHT: 5px; BORDER-TOP: #ff9900 1px dashed; PADDING-LEFT: 5px; PADDING-BOTTOM: 5px; MARGIN: 5px; PADDING-TOP: 5px; BORDER-BOTTOM: #ff9900 1px dashed"><B>Note:</B> 
      This is an unedited contribution. If this article is inappropriate, needs 
      attention or copies someone else's work without reference then please <A 
      id=ctl00_ReportProblem 
      href="http://www.codeproject.com/script/Articles/Report.aspx?aid=20815">Report 
      This Article</A> </DIV>
      <UL class=Callout id=ctl00_confirmError style="MARGIN-RIGHT: 20px">
        <LI class=SmallText 
        style="LIST-STYLE-IMAGE: url(/images/warning.gif)">You are signed up for 
        one or more <A id=ctl00_SubscribeLink2 
        href="http://www.codeproject.com/script/Membership/Subscribe.aspx?rp=%2fKB%2fdatabase%2fBuilding_Dynamic_SQL.aspx">newsletters</A> 
        but your email address is either unconfirmed, or has not been 
        reconfirmed in a long time. Please click <A id=ctl00_RequestConfirmLink2 
        href="http://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fKB%2fdatabase%2fBuilding_Dynamic_SQL.aspx">here</A> 
        to have an email sent that will allow us to confirm your email address 
        and start sending you newsletters again.</LI></UL><SPAN id=intelliTXT>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL/DynamicSql.zip">Download 
        DynamicSql.zip - 1.6 KB</A> </LI></UL>
      <H2>Introduction</H2>
      <P align=justify>A Dynamic Sql in a stored Procedure is a single 
      <CODE>Transact-SQL</CODE> statement or a set of statements stored in a 
      variable and executed using a SQL command. There may be several methods of 
      implementing this in Sql Server. This article will show you a good method 
      of doing this. Before getting into the detailed explanation let me tell 
      "When to Use Dynamic Sql?" We can't definitely say that a Static SQL will 
      meet all our programming needs. A Dynamic SQL is needed when we need to 
      retrieve a set of records based on different search parameters. Say for an 
      Example - An employee search screen or a general purpose report which need 
      to execute a different SELECT statement based on different WHERE clause. 
      </P><CODE>NOTE : Most importantly the Dynamic SQL Queries <SPAN 
      class=code-keyword>in</SPAN> a Variable are not Compiled, parsed, checked 
      <SPAN class=code-keyword>for</SPAN> errors until they are executed. 
</CODE>
      <H2>sp_executesql Vs EXECUTE Command</H2>
      <P align=justify>A dynamically build Transact-SQL Statements can be 
      executed using <CODE>EXECUTE</CODE> Command or <CODE>sp_executesql</CODE> 
      statement. Here In this article in my examples I'll be using sp_executesql 
      which is more efficient, faster in execution and also supports parameter 
      substitution. If we are using <CODE>EXECUTE</CODE> command to execute the 
      Sql String then all the parameters should be converted to character and 
      made as a part of the Query before execution. But the 
      <CODE>sp_executesql</CODE> statement provides a better way of implementing 
      this. It allows us to substitute the parameter values for any parameter 
      specified in the Sql String. Before getting into actual example let me 
      differentiate these two commands with a simple example. say - selecting a 
      record from the employee table using the ID in the <CODE>WHERE 
      </CODE>clause.</P>
      <P><EM>The basic syntax for using EXECUTE Command:</EM></P><PRE>EXECUTE(@SQLStatement)</PRE>
      <P><EM>The basic syntax for using sp_executesql:</EM></P><PRE>sp_executesql [@SQLStatement],[@ParameterDefinitionList],
[@ParameterValueList]</PRE><STRONG><CODE><STRONG>Example <SPAN 
      class=code-digit>1</SPAN>.<SPAN class=code-digit>0</SPAN></STRONG> 
      </CODE></STRONG><PRE><SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Using EXECUTE Command */</SPAN>
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Build and Execute a Transact-SQL String with a single parameter 
 value Using EXECUTE Command */</SPAN>

<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Variable Declaration */</SPAN>
DECLARE @EmpID AS SMALLINT
DECLARE @SQLQuery AS NVARCHAR(<SPAN class=code-digit>500</SPAN>)
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> set the parameter value */</SPAN>
SET @EmpID = <SPAN class=code-digit>1001</SPAN>
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Build Transact-SQL String with parameter value */</SPAN>
SET @SQLQuery = <SPAN class=code-string>'</SPAN><SPAN class=code-string>SELECT * FROM tblEmployees WHERE EmployeeID = '</SPAN> + 
CAST(@EmpID AS NVARCHAR(<SPAN class=code-digit>10</SPAN>))
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Execute Transact-SQL String */</SPAN>
EXECUTE(@SQLQuery)</PRE>
      <P align=justify>In the above example 1.0, there are two variables 
      declared. The first variable <CODE>@EmpID</CODE> is used as a parameter to 
      the sql Query and second Variable <CODE>@SQLQuery</CODE> is used to build 
      the Sql String. You can clearly see that the variable <CODE>@EmpID</CODE> 
      is cast to a NVarchar type and made as a part of the Sql String. If you 
      print the <CODE>@SQLQuery</CODE> string (<CODE>PRINT @SQLQuery</CODE>) you 
      will get the actual Sql query as shown below.</P><PRE>SELECT * FROM tblEmployees WHERE EmployeeID = <SPAN class=code-digit>1001</SPAN></PRE>
      <P>Finally, the above query is executed using EXECUTE 
      command.</P><STRONG><CODE><STRONG>Example <SPAN 
      class=code-digit>1</SPAN>.<SPAN 
      class=code-digit>1</SPAN></STRONG></CODE></STRONG> <PRE><SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Using sp_executesql */</SPAN>
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Build and Execute a Transact-SQL String with a single parameter 
value Using sp_executesql Command */</SPAN>

<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Variable Declaration */</SPAN>
DECLARE @EmpID AS SMALLINT
DECLARE @SQLQuery AS NVARCHAR(<SPAN class=code-digit>500</SPAN>)
DECLARE @ParameterDefinition AS NVARCHAR(<SPAN class=code-digit>100</SPAN>)
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> set the parameter value */</SPAN>
SET @EmpID = <SPAN class=code-digit>1001</SPAN>
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Build Transact-SQL String by including the parameter */</SPAN>
SET @SQLQuery = <SPAN class=code-string>'</SPAN><SPAN class=code-string>SELECT * FROM tblEmployees WHERE EmployeeID = @EmpID'</SPAN> 
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Specify Parameter Format */</SPAN>
SET @ParameterDefinition =  <SPAN class=code-string>'</SPAN><SPAN class=code-string>@EmpID SMALLINT'</SPAN>
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Execute Transact-SQL String */</SPAN>
EXECUTE sp_executesql @SQLQuery, @ParameterDefinition, @EmpID</PRE>
      <P align=justify>In the example 1.1, there are two variables declared. The 
      variable <CODE>@EmpID</CODE> is used as a parameter to the sql Query and 
      second Variable <CODE>@SQLQuery</CODE> is used to build the Sql String, 
      the third Variable <CODE>@ParameterDefinition</CODE> is used to specify 
      the parameter format before executing the SQL string. If you print the 
      <CODE>@SQLQuery</CODE> string (<CODE>PRINT @SQLQuery</CODE>) you will get 
      the query as shown below.</P><PRE>SELECT * FROM tblEmployees WHERE EmployeeID = @EmpID</PRE>
      <P align=justify>Here in this example you can clearly see the parameter 
      <CODE>@EmpID</CODE> is included in the statement. finally, 
      <CODE>sp_executesql</CODE> takes the necessary information to do the 
      parameter substitution and execute the dynamically build sql string. </P>
      <OL>
        <LI><CODE>@SQLQuery</CODE> --&gt; contains the SQL statement 
        <LI><CODE>@ParameterDefinition</CODE> --&gt; contains the Parameter 
        Definition 
        <LI><CODE>@EmpID</CODE> --&gt; contains the parameter value to be 
        substituted to the parameter in the SQL statement. </LI></OL><CODE>NOTE : 
      The parameters included <SPAN class=code-keyword>in</SPAN> the Dynamic sql 
      <SPAN class=code-SDKkeyword>string</SPAN> must have a corresponding entry 
      <SPAN class=code-keyword>in</SPAN> the Parameter Definition List and 
      Parameter Value List. </CODE>
      <H2>Dynamic Sql In a Stored Procedure </H2>
      <P align=justify>This part of the article explains with a real-world 
      example and sample procedure "How to Build and Execute a Dynamic SQL in a 
      stored procedure?"</P><STRONG><CODE><STRONG>Example <SPAN 
      class=code-digit>2</SPAN>.<SPAN class=code-digit>0</SPAN></STRONG> 
      </CODE></STRONG>
      <P align=justify>Let us take a simple example - Employee Table with common 
      fields such as EmployeeID, Name, Department, Designation, JoiningDate, 
      Salary and Description. you can use following Transact-Sql <CODE>CREATE 
      TABLE</CODE> statement to create a Employee Table within your 
database.</P><PRE><SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Transact-Sql to create the table tblEmployees */</SPAN>
CREATE TABLE tblEmployees
(
    EmployeeID       SMALLINT IDENTITY(<SPAN class=code-digit>1001</SPAN>,<SPAN class=code-digit>1</SPAN>) NOT NULL,
    EmployeeName     NVARCHAR(<SPAN class=code-digit>100</SPAN>) NOT NULL,
    Department       NVARCHAR(<SPAN class=code-digit>50</SPAN>) NOT NULL,
    Designation      NVARCHAR(<SPAN class=code-digit>50</SPAN>) NOT NULL,
    JoiningDate      DATETIME NOT NULL,
    Salary           DECIMAL(<SPAN class=code-digit>10</SPAN>,<SPAN class=code-digit>2</SPAN>) NOT NULL,
    [Description]    NVARCHAR(<SPAN class=code-digit>1000</SPAN>) NULL 
)
</PRE>
      <P align=justify>The following <CODE>INSERT</CODE> statements inserts some 
      sample records into the tblEmployee table.</P><PRE><SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Transact SQL to insert some sample records into tblEmployee table */</SPAN>
INSERT INTO tblEmployees
(EmployeeName, Department, Designation, 
 JoiningDate, Salary, [Description]) 
VALUES    
(<SPAN class=code-string>'</SPAN><SPAN class=code-string>John Smith'</SPAN>, <SPAN class=code-string>'</SPAN><SPAN class=code-string>IT Research'</SPAN>, <SPAN class=code-string>'</SPAN><SPAN class=code-string>Research Analyst'</SPAN>, 
 <SPAN class=code-string>'</SPAN><SPAN class=code-string>02/08/2005'</SPAN>, <SPAN class=code-digit>23000</SPAN>.<SPAN class=code-digit>00</SPAN>, <SPAN class=code-string>'</SPAN><SPAN class=code-string>Analyst since 2005'</SPAN>)

INSERT INTO tblEmployees
(EmployeeName, Department, Designation, 
 JoiningDate, Salary, [Description]) 
VALUES    
(<SPAN class=code-string>'</SPAN><SPAN class=code-string>John Micheal'</SPAN>, <SPAN class=code-string>'</SPAN><SPAN class=code-string>IT Operations'</SPAN>, <SPAN class=code-string>'</SPAN><SPAN class=code-string>Manager'</SPAN>, 
 <SPAN class=code-string>'</SPAN><SPAN class=code-string>07/15/2007'</SPAN>, <SPAN class=code-digit>15000</SPAN>.<SPAN class=code-digit>00</SPAN>, NULL)

INSERT INTO tblEmployees
(EmployeeName, Department, Designation, 
 JoiningDate, Salary, [Description]) 
VALUES    
(<SPAN class=code-string>'</SPAN><SPAN class=code-string>Will Smith'</SPAN>, <SPAN class=code-string>'</SPAN><SPAN class=code-string>IT Support'</SPAN>, <SPAN class=code-string>'</SPAN><SPAN class=code-string>Manager'</SPAN>, 
 <SPAN class=code-string>'</SPAN><SPAN class=code-string>05/20/2006'</SPAN>, <SPAN class=code-digit>13000</SPAN>.<SPAN class=code-digit>00</SPAN>, <SPAN class=code-string>'</SPAN><SPAN class=code-string>Joined last year as IT Support Manager'</SPAN>)
</PRE>
      <P align=justify>we programmer's may get a assignment to Develop a 
      Employee search screen or Generate a Employee listing Report which will 
      search the Database and return a result based on the Search criteria. In 
      this case, the search Interface should be flexible enough to search the 
      database for all possible criteria. User may require to search for the 
      following details.</P>
      <UL>
        <LI>Search for specific Employee Detail with the Name. 
        <LI>List of Employees in a specific Department. 
        <LI>List of Employees in a specific Designation. 
        <LI>List of Employees joined the organization last year. 
        <LI>List of Employees whose Salary &gt;= some specific Amount. 
        <LI>Any of these condition listed above or all of these. </LI></UL>
      <P align=justify>I have listed few possible conditions here. There could 
      be many other possibilities also which completely depends on the user 
      requirement. Here let us take these listed few possible criteria and write 
      a single stored procedure that builds a Dynamic SQL which will serve our 
      purpose in searching for the Details in the Employee Table. The following 
      <CODE>CREATE PROCEDURE </CODE>Statement will create a stored procedure 
      "sp_EmployeeSelect" with the necessary input parameters and variables to 
      build the Dynamic SQL.</P><PRE><SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> This stored procedure builds dynamic SQL and executes 
using sp_executesql */</SPAN>
Create Procedure sp_EmployeeSelect
    <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Input Parameters */</SPAN>
    @EmployeeName NVarchar(<SPAN class=code-digit>100</SPAN>),
    @Department NVarchar(<SPAN class=code-digit>50</SPAN>),
    @Designation NVarchar(<SPAN class=code-digit>50</SPAN>),
    @StartDate DateTime,
    @EndDate DateTime,
    @Salary    Decimal(<SPAN class=code-digit>10</SPAN>,<SPAN class=code-digit>2</SPAN>)
        
AS
    Set NoCount ON
    <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Variable Declaration */</SPAN>
    Declare @SQLQuery AS NVarchar(<SPAN class=code-digit>4000</SPAN>)
    Declare @ParamDefinition AS NVarchar(<SPAN class=code-digit>2000</SPAN>) 
    <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Build the Transact-SQL String with the input parameters */</SPAN> 
    Set @SQLQuery = <SPAN class=code-string>'</SPAN><SPAN class=code-string>Select * From tblEmployees where (1=1) '</SPAN> 
    <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> check for the condition and build the WHERE clause accordingly */</SPAN>
    If @EmployeeName Is Not Null 
         Set @SQLQuery = @SQLQuery + <SPAN class=code-string>'</SPAN><SPAN class=code-string> And (EmployeeName = @EmployeeName)'</SPAN>

    If @Department Is Not Null
         Set @SQLQuery = @SQLQuery + <SPAN class=code-string>'</SPAN><SPAN class=code-string> And (Department = @Department)'</SPAN> 
  
    If @Designation Is Not Null
         Set @SQLQuery = @SQLQuery + <SPAN class=code-string>'</SPAN><SPAN class=code-string> And (Designation = @Designation)'</SPAN>
  
    If @Salary Is Not Null
         Set @SQLQuery = @SQLQuery + <SPAN class=code-string>'</SPAN><SPAN class=code-string> And (Salary &gt;= @Salary)'</SPAN>

    If (@StartDate Is Not Null) AND (@EndDate Is Not Null)
         Set @SQLQuery = @SQLQuery + <SPAN class=code-string>'</SPAN><SPAN class=code-string> And (JoiningDate 
         BETWEEN @StartDate AND @EndDate)'</SPAN>
    <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Specify Parameter Format for all input parameters included 
     in the stmt */</SPAN>
    Set @ParamDefinition =      <SPAN class=code-string>'</SPAN><SPAN class=code-string> @EmployeeName NVarchar(100),
                @Department NVarchar(50),
                @Designation NVarchar(50),
                @StartDate DateTime,
                @EndDate DateTime,
                @Salary    Decimal(10,2)'</SPAN>
    <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Execute the Transact-SQL String with all parameter value's 
       Using sp_executesql Command */</SPAN>
    Execute sp_Executesql     @SQLQuery, 
                @ParamDefinition, 
                @EmployeeName, 
                @Department, 
                @Designation, 
                @StartDate, 
                @EndDate,
                @Salary
                
    If @@ERROR <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>&gt;</SPAN> <SPAN class=code-digit>0</SPAN> GoTo ErrorHandler
    Set NoCount OFF
    Return(<SPAN class=code-digit>0</SPAN>)
  
ErrorHandler:
    Return(@@ERROR)
GO</PRE>
      <P align=justify>This sample stored procedure takes few parameter's as 
      input and uses two variables to build and execute. <CODE>@SQLQuery</CODE> 
      which is used to build the dynamic sql-statement. 
      <CODE>@ParamDefinition</CODE> which is used to define the Parameter's 
      format. Whiling building the sql string in each step a IF-statement is 
      used to check whether that inputer parameter is Null or Not. If it is not 
      NULL then that parameter will be included in the sql statement which 
      basically add's a condition in the WHERE clause of the sql statement. You 
      can clearly see in the procedure, that the variable 
      <CODE>@ParamDefinition</CODE> contains all the paramerter list and finally 
      <CODE>sp_Executesql</CODE> takes sql-query, parameter list and the 
      Parameter values to executes a SELECT statement.</P>
      <P align=justify>Let us consider some of the criteria listed above and see 
      how this stored procedure works.</P>
      <P><EM>1. Search for specific Employee Detail with the name. </EM></P><PRE><SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> 1. Search for specific Employee Detail with the Name say 'John Smith'. */</SPAN>
EXEC sp_EmployeeSelect <SPAN class=code-string>'</SPAN><SPAN class=code-string>John Smith'</SPAN>, NULL, NULL, NULL, NULL, NULL
</PRE>
      <P>executing the above statement will list the details of the Employee 
      "John Smith"</P>
      <P><EM>2. List of Employees in a specific Department. AND 3. List of 
      Employees in a specific Designation.</EM></P><PRE><SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> 2. List of Employees in a specific Department. AND 
3. List of Employees in a specific Designation. */</SPAN>
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Say Department = 'IT Operations'  AND  Designation = 'Manager'*/</SPAN>
EXEC sp_EmployeeSelect NULL, <SPAN class=code-string>'</SPAN><SPAN class=code-string>IT Operations'</SPAN>, <SPAN class=code-string>'</SPAN><SPAN class=code-string>Manager'</SPAN>, NULL, NULL, NULL</PRE>
      <P>executing the above statement will list the Details of Manger's in the 
      IT Operations Department</P>
      <H2>Using Like Operator , IN Operator and Order By In Dynamic SQL</H2>
      <P align=justify>when we are building Dynamic SQL, there may be some 
      instances where we need to use <CODE>LIKE </CODE>operator, <CODE>IN 
      </CODE>operator and <CODE>Order BY</CODE> Clause. But the parameter's used 
      with these operator's and Order By Clause doesn't work the way as they 
      normally do for "=" and "Between" operator while using sp_executesql. 
      Generally <CODE>sp_executesql</CODE> doesn't do a parameter substitution 
      for order by clause and doing so causes a column-referencing problem. 
      Straightly Using LIKE operator and IN operator causes syntax error, which 
      cannot be rectified when we are including the parameter into the Dynamic 
      Sql statement. This problem can be resolved by including the actual 
      parameter value in the Dynamic sql statement. Below are the Examples that 
      show how to Use Like Operator, IN Operator and OrderBy clause while using 
      sp_executesql.</P>
      <H2><CODE><STRONG>Example <SPAN class=code-digit>3</SPAN>.<SPAN 
      class=code-digit>0</SPAN> - Using LIKE Operator</STRONG></CODE></H2>
      <P align=justify>Example 3.0 uses LIKE operator to select the list of 
      Employee's with the Name 'John'. Here in this example the parameter is not 
      included in the sql stmt instead the actual value of the parameter is 
      added to the sql stmt. so here there is no need of parameter Definition 
      for executing the sql string. same applies to other two examples shown 
      below.</P><PRE><SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Variable Declaration */</SPAN>
DECLARE @EmpName AS NVARCHAR(<SPAN class=code-digit>50</SPAN>)
DECLARE @SQLQuery AS NVARCHAR(<SPAN class=code-digit>500</SPAN>)

<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Build and Execute a Transact-SQL String with a single parameter 
value Using sp_executesql Command */</SPAN>
SET @EmpName = <SPAN class=code-string>'</SPAN><SPAN class=code-string>John'</SPAN> 
SET @SQLQuery = <SPAN class=code-string>'</SPAN><SPAN class=code-string>SELECT * FROM tblEmployees 
WHERE EmployeeName LIKE '</SPAN><SPAN class=code-string>'</SPAN><SPAN class=code-string>'</SPAN>+ <SPAN class=code-string>'</SPAN><SPAN class=code-string>%'</SPAN> + @EmpName + <SPAN class=code-string>'</SPAN><SPAN class=code-string>%'</SPAN> + <SPAN class=code-string>'</SPAN><SPAN class=code-string>'</SPAN><SPAN class=code-string>'</SPAN><SPAN class=code-string>'</SPAN> 
EXECUTE sp_executesql @SQLQuery
</PRE>
      <H2><CODE><STRONG>Example <SPAN class=code-digit>3</SPAN>.<SPAN 
      class=code-digit>1</SPAN> - Using IN Operator</STRONG></CODE></H2>
      <P>Example 3.1 uses IN operator to select the Employee details <EM>( ID = 
      1001, 1003 )</EM></P><PRE><SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Variable Declaration */</SPAN>
DECLARE @EmpID AS NVARCHAR(<SPAN class=code-digit>50</SPAN>)
DECLARE @SQLQuery AS NVARCHAR(<SPAN class=code-digit>500</SPAN>)

<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Build and Execute a Transact-SQL String with a single 
parameter value Using sp_executesql Command */</SPAN>
SET @EmpID = <SPAN class=code-string>'</SPAN><SPAN class=code-string>1001,1003'</SPAN> 
SET @SQLQuery = <SPAN class=code-string>'</SPAN><SPAN class=code-string>SELECT * FROM tblEmployees 
WHERE EmployeeID IN('</SPAN> + @EmpID + <SPAN class=code-string>'</SPAN><SPAN class=code-string>)'</SPAN>
EXECUTE sp_executesql @SQLQuery
</PRE>
      <H2><CODE><STRONG>Example <SPAN class=code-digit>3</SPAN>.<SPAN 
      class=code-digit>2</SPAN> - Using Order By Clause</STRONG></CODE></H2>
      <P>Example 3.2 sorts the Employee reocrds by "Department" column.</P><PRE><SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Variable Declaration */</SPAN>
DECLARE @OrderBy AS NVARCHAR(<SPAN class=code-digit>50</SPAN>)
DECLARE @SQLQuery AS NVARCHAR(<SPAN class=code-digit>500</SPAN>)

<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Build and Execute a Transact-SQL String with a single parameter 
value Using sp_executesql Command */</SPAN>
SET @OrderBy = <SPAN class=code-string>'</SPAN><SPAN class=code-string>Department'</SPAN> 
SET @SQLQuery = <SPAN class=code-string>'</SPAN><SPAN class=code-string>SELECT * FROM tblEmployees Order By '</SPAN> + @OrderBy

EXECUTE sp_executesql @SQLQuery
</PRE>
      <H2>Conclusion</H2>
      <P align=justify>In this article I have explained with few examples "How 
      to Build and Execute Dynamic Sql in stored procedures". Hope this article 
      will help to understand and write Dynamic SQL in a good way.</P><!-- Article Ends --><!-- Main Page Contents End --></DIV></SPAN>
      <FORM id=aspnetForm 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
      name=aspnetForm action=Building_Dynamic_SQL.aspx method=post>
      <DIV><INPUT id=__VIEWSTATE type=hidden 
      value=/wEPDwULLTEwMDUyNjYzMjhkZCYoBJRolPMbluvnRHp+gwjAeKKZ 
      name=__VIEWSTATE> </DIV>
      <H2>License</H2>
      <DIV id=ctl00_LicenseTerms>
      <P>This article has no explicit license attached to it but may contain 
      usage terms in the article text or the download files themselves. If in 
      doubt please contact the author via the discussion board below.</P>
      <P>A list of licenses authors might use can be found <A 
      href="http://www.codeproject.com/info/Licenses.aspx">here</A></P></DIV>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2445395"><FONT 
            color=brown size=1>John Prabhu</FONT></A></B><BR><BR>
            <CENTER><IMG id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
            src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/{09b731f7-f37a-4dba-aace-0cfccd5c2b36}.jpg"></CENTER><BR><SPAN 
            class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>John is currently working as a .NET Consultant at an 
            International Bank, IT Operations Division in Dubai. Previously, 
            John was working with Vxceed Technologies as a .NET 
            Analyst/Developer. During his period at Vxceed, He worked at Dubai 
            Intl. Airport, Civil Aviation IT Department as .NET Consultant on 
            the roles of Vxceed.<BR><BR>He holds a Postgraduate Degree in 
            Computer Science and MCP Certification in ASP.Net. His programming 
            experience includes ASP.NET, VB.NET, ADO.NET, SQL Server, Oracle 9i, 
            JavaScript, HTML, XML, Web Service, Windows Service, Crystal Reports 
            and .net Charting.<BR><BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow>
                <TD class=SmallText noWrap>Occupation: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Web 
                  Developer</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt="United Arab Emirates" 
                  src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/AE.gif" 
                  width=16> United Arab 
        Emirates</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE id=ctl00_PopularArticlesRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular Database articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/database/caaadoclass1.aspx">A 
              set of ADO classes - version 2.20</A>
              <DIV class=SmallText>Simple database access using an ADO 
              class.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/database/filehelpers.aspx">FileHelpers 
              v2.0 - Delimited (CSV) or Fixed Data Import/Export Framework</A>
              <DIV class=SmallText>An easy to use .NET library to read/write 
              strong typed data from files with fixed length or delimited 
              records (CSV). Also has support to import/export data from 
              different data storages (Excel, Acces, SqlServer, MySql)</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/database/sqldodont.aspx">SQL 
              Server DO's and DONT's</A>
              <DIV class=SmallText>SQL Server database best practices</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/database/connectionstrings.aspx">ADO 
              Connection Strings</A>
              <DIV class=SmallText>A list of ODBC DSN Connection Strings.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/database/DynamicMethod_ILGenerator.aspx">Dynamic... 
              but fast: The tale of three monkeys, a wolf and the DynamicMethod 
              and ILGenerator classes</A>
              <DIV class=SmallText>How to use the DynamicMethod and ILGenerator 
              classes to create dynamic code at runtime that out performs 
              reflection</DIV></LI></UL>
            <H2></H2></TD>
          <TD>
            <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6421%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252f300x250.png%26C%3dFalse%26id%3d6421%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22300%22%20height%3d%22250%22%3e%3c%2fa%3e"));</SCRIPT>
          </TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
var addtoMethod=1;
var AddURL = document.location.href;
var AddTitle = escape(document.title);
DrawLinks(100, 0, "SmallText Bold", "AddTo") 
</SCRIPT>
      </DIV>
      <TABLE class=ArticleUneditedHeader id=ctl00_RateArticleRow cellSpacing=0 
      cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD id=ctl00_RateArticle_VoteResultDiv noWrap align=right 
                width="100%"><SPAN id=voteRes></SPAN><IMG id=loaderImg 
                  style="DISPLAY: none" height=16 alt=loading... 
                  src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/ajax-loader.gif" 
                  width=16> </TD>
                <TD class=SmallText id=voteTbl style="WHITE-SPACE: nowrap" 
                align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px; WHITE-SPACE: nowrap"><I><B>Rate 
                        this Article for us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm noWrap 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn onclick="return rateItem(20815,2);" type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV><INPUT id=__EVENTVALIDATION type=hidden 
      value=/wEWCAKutaboCALAlMXDBwLBlMXDBwLClMXDBwLDlMXDBwLElMXDBwLP+++tCwK5upDkC6qBwY4dYnLzP7VULGotbVM/HnB9 
      name=__EVENTVALIDATION> </DIV></FORM>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6418%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fVisual_Numerics_IMSEL_Eval_468x60.jpg%26C%3dFalse%26id%3d6418%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22468%22%20height%3d%2260%22%3e%3c%2fa%3e"));</SCRIPT>
      <IFRAME 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/ServeLinks.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD>
            <FORM 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fdatabase%2fBuilding_Dynamic_SQL.aspx&amp;fid=470275 
            method=get><INPUT type=hidden value=470275 name=fid><INPUT 
            type=hidden 
            value=?floc=%2fKB%2fdatabase%2fBuilding_Dynamic_SQL.aspx&amp;fid=470275 
            name=currentQS><INPUT type=hidden 
            value=/KB/database/Building_Dynamic_SQL.aspx name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 alt=FAQ 
                  src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/forum_faq.gif" 
                  width=16 align=middle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 alt=Search 
                  src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/forum_search.gif" 
                  width=16 align=top border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=470275">Search 
                  Messages</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=submit></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></FORM></TD></TR>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 alt=new 
                  src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/forum_newmsg.gif" 
                  width=16 align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;floc=/KB/database/Building_Dynamic_SQL.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 9 of 9 (Total in Forum: 9) (<A 
                  href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><SPAN 
                  class=Frm_HL>Next</SPAN></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0><!-- Column Headers -->
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote Rt HdUnSel " id=F2284149_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2284149xx></A><IMG height=16 alt=General 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;select=2284149#xx2284149xx" 
                        name=2284149>Performance</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1844917">N 
                        a v a <FONT color=red>n</FONT> e e t h</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">2:13 23 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2284149_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi John,<BR><BR>It's good to get 
                                the details of dynamic SQL queries. But why we 
                                use them ? You told we use them on a search 
                                scenario, why don't you use multiple stored 
                                procedures than writing dynamic query ? 
                                <BR><BR>These are the drawbacks I felt with this 
                                method<BR><BR>1 - Writing dynamic queries inside 
                                the procedure is very near to SQL Injection 
                                attacks. <BR>2 - When a stored procedure is 
                                executed first time, SQL Server caches the 
                                execution plan, and served the next request from 
                                this cache. This gives much performance 
                                difference. But dynamic queries won't allow to 
                                generate a static execution plan, and this will 
                                be compiled for every request. <BR>3 - It's very 
                                tough to debug the queries<BR>4 - It hides 
                                errors in queries since it is appended in a 
                                string<BR><BR>So why we use them ? <BR><BR>
                                <DIV class=ForumSig>
                                <HR>
                                <BR><FONT size=1><BR><A 
                                title="Post aricles,code snippets and discussions" 
                                href="http://www.w3hearts.com/" 
                                rel=nofollow><STRONG>My Website</STRONG></A> | 
                                <A 
                                href="http://catb.org/~esr/faqs/smart-questions.html" 
                                rel=nofollow><STRONG>Ask smart 
                                questions</STRONG></A></FONT></DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2284149&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2284149&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;tid=2284149">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=470275&amp;msg=2284149">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2284149&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2284149 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(1844917,2284149,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2284726_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2284726xx></A><IMG height=16 alt=General 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;select=2284726#xx2284726xx" 
                        name=2284726>Re: Performance</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2445395"><FONT 
                        face=verdana color=brown size=1>John 
Prabhu</A></FONT></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:27 23 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2284726_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><BR>Hi Navaneeth,<BR><BR>Thanks 
                                for taking your time to read my article and 
                                posting your suggestion, comments on 
                                it.<BR><BR>Yes, I agree to your particular point 
                                that this can be acheived using multiple stored 
                                procedures or multiple SELECT queries in a 
                                stored Procedure. What If there are numerous 
                                search scenario. Do you agree that Writting 5,10 
                                or more stored procedure's to accomplish all the 
                                search scenario becomes difficult to maintain? 
                                When number of lines of CODE increases 
                                COMPLEXITY of maintaining it increases as well. 
                                it is easier to maintain and modify one stored 
                                procedure instead of 10 or more.<BR><BR>Yes, I 
                                agree with your statement (drawback - SQL 
                                Injection Attack). But this can be handled 
                                (which I haven't explained in the article). If 
                                the Input parameters are used in the way that i 
                                showed in the example then the Procedure is 
                                prone to SQL Injection Attack. We need to take 
                                some extra effort In order to protect the Stored 
                                Procedure from executing unauthorized CODE by 
                                using the following functions (REPLACE, ISNULL, 
                                TRIM...). Proper usage of these function while 
                                adding the Input parameter to the SQL string 
                                would protect the SP (I believe) and also the 
                                SELECTClause, FROMClause, WHEREClause should be 
                                build in seperate variables and concantenated at 
                                the end before execution.<BR><BR>If speed and 
                                performance are top priority then one should 
                                avoid using dynamic SQL.<BR><BR>And Debugging- 
                                we need to plan some extra time for testing and 
                                make sure that none of the part are built with 
                                syntax errors. <BR><BR>
                                <DIV class=ForumSig><FONT face=verdana 
                                color=brown size=2>Regards<BR><FONT face=verdana 
                                color=brown size=1><B>&nbsp;- J O N 
-</B><BR><BR>
                                <HR SIZE=1>
                                </DIV><BR></FONT></FONT></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2284726&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2284726&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;tid=2284149">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=470275&amp;msg=2284726">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2284726&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2284726 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(2445395,2284726,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2284759_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2284759xx></A><IMG height=16 alt=General 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;select=2284759#xx2284759xx" 
                        name=2284759>Re: Performance [modified]</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1844917">N 
                        a v a <FONT color=red>n</FONT> e e t h</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:46 23 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2284759_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>John Prabhu wrote:</DIV>Do you 
                                agree that Writting 5,10 or more stored 
                                procedure's to accomplish all the search 
                                scenario becomes difficult to maintain? 
                                </BLOCKQUOTE><BR><BR>It depends on the 
                                application which I am coding. If I am coding an 
                                application where high performance is expected, 
                                I would use multiple stored procedures. Or I 
                                would use a main procedure which is referred in 
                                the application and all other procedures will be 
                                called from this procedure depends on the search 
                                condition. This main procedure will be 
                                nested.<BR><BR>So SQL Server can cache all the 
                                nested procedures execution plan and reuse it on 
                                next request. This has been written as a 
                                recommended practice on SQL Performance.com. As 
                                you told, this will be bit tough to modify when 
                                we have lot of search criteria, but if 
                                performance really matters why don't we ignore 
                                this overhead ?<BR><BR>If it is a small 
                                application which doesn't care about the 
                                performance and we have enough time to formulate 
                                the query in string, I will be accepting your 
                                method 100%.<BR><BR>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>John Prabhu wrote:</DIV>And 
                                Debugging- we need to plan some extra time for 
                                testing and make sure that none of the part are 
                                built with syntax errors. </BLOCKQUOTE><BR><BR>I 
                                can't agree completely. Because we all are 
                                running out of time. So it's very tough to spend 
                                time for finding syntactical errors, which is 
                                usually done by SQL editor.<BR><BR>I was not 
                                criticizing your effort. I had very bad 
                                experiences with dynamic SQL queries. By the way 
                                it will be good looking into the query execution 
                                plan for dynamic queries contained procedure and 
                                a normal one which does the same job. You will 
                                find the difference<BR><BR><BR>-- modified at 
                                9:52 Tuesday 23rd October, 2007 <BR><BR>
                                <DIV class=ForumSig>
                                <HR>
                                <BR><FONT size=1><BR><A 
                                title="Post aricles,code snippets and discussions" 
                                href="http://www.w3hearts.com/" 
                                rel=nofollow><STRONG>My Website</STRONG></A> | 
                                <A 
                                href="http://catb.org/~esr/faqs/smart-questions.html" 
                                rel=nofollow><STRONG>Ask smart 
                                questions</STRONG></A></FONT></DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2284759&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2284759&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;tid=2284149">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=470275&amp;msg=2284759">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2284759&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2284759 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(1844917,2284759,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2284838_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx2284838xx></A><IMG height=16 alt=General 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;select=2284838#xx2284838xx" 
                        name=2284838>Re: Performance</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2445395"><FONT 
                        face=verdana color=brown size=1>John 
Prabhu</A></FONT></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:40 23 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2284838_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>N a v a n e e t h wrote:</DIV>it 
                                will be good looking into the query execution 
                                plan for dynamic queries contained procedure and 
                                a normal one which does the same 
                                job.</BLOCKQUOTE><BR><BR>Yes, I did. My 
                                intension of writting this article is not to say 
                                that Dynamic SQL is better way of doing things 
                                in SQL. One should know how to write dynamic 
                                SQL. And I completely accept the fact that 
                                static sql is much faster and safer way of doing 
                                things in sql. <BR><BR>
                                <DIV class=ForumSig><FONT face=verdana 
                                color=brown size=2>Regards<BR><FONT face=verdana 
                                color=brown size=1><B>&nbsp;- J O N 
-</B><BR><BR>
                                <HR SIZE=1>
                                </DIV><BR></FONT></FONT></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2284838&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2284838&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;tid=2284149">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=470275&amp;msg=2284838">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2284838&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2284838 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(2445395,2284838,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2264953_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2264953xx></A><IMG height=16 alt=General 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;select=2264953#xx2264953xx" 
                        name=2264953>er..</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2596282">dave.dolan</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:38 10 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2264953_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>no offense, it's a good article of 
                                how to do such a thing, but doesn't this sort of 
                                defeat the purpose of using a stored procedure? 
                                Essentially you're just inviting all sorts of 
                                strangeness by allowing this sort of thing. Not 
                                to mention that the security model of SQL only 
                                checks for execute rights to the SP not for 
                                rights on what is actually executed once you're 
                                granted execute rights to the proc... I'd say 
                                this is a little dangerous, and barring that, 
                                the execution plan is still arbitrary when you 
                                go into running one of these. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2264953&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2264953&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;tid=2264953">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=470275&amp;msg=2264953">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2264953&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2264953 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(2596282,2264953,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote Rt HdUnSel " id=F2264775_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2264775xx></A><IMG height=16 alt=General 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;select=2264775#xx2264775xx" 
                        name=2264775>Alternatives</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1625158">rippo</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:12 10 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2264775_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Have you seen this article, might 
                                help in understanding that you may not need 
                                dynamic SQL for generating a WHERE clause in 
                                your stored procedure 
                                sp_EmployeeSelect...<BR><BR><A 
                                href="http://www.sqlteam.com/article/implementing-a-dynamic-where-clause" 
                                rel=nofollow>http://www.sqlteam.com/article/implementing-a-dynamic-where-clause</A><BR><BR>Not 
                                having a dig, but it might be useful to provide 
                                this as an alternative. However somebody might 
                                shoot me down as COALESCE can be expensive! 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2264775&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2264775&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;tid=2264775">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=470275&amp;msg=2264775">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2264775&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2264775 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(1625158,2264775,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote HdUnSel " id=F2265314_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2265314xx></A><IMG height=16 alt=General 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;select=2265314#xx2265314xx" 
                        name=2265314>Re: Alternatives</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=71343">milansm</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:31 10 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2265314_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>What about this alternative <IMG 
                                title=Smile 
                                src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top><BR><BR>SELECT * FROM 
                                tblEmployees<BR>WHERE (@EmployeeName Is Null OR 
                                @EmployeeName = EmployeeName)<BR>AND 
                                (@Department Is Null OR @Department = 
                                Department)<BR>AND (@Designation Is Null OR 
                                @Designation = Designation)<BR>AND (@Salary Is 
                                Null OR @Salary = Salary)<BR>AND (@StartDate Is 
                                Null OR @EndDate Is Null<BR>OR (@StartDate Is 
                                Not Null AND @EndDate Is Not Null<BR>AND 
                                JoiningDate BETWEEN @StartDate AND 
                                @EndDate))<BR><BR>In many, many cases you don't 
                                need to use dynamic sql statements. Just think 
                                about problem you have to solve and try to write 
                                down logic you found.<BR><BR>However, your 
                                article is good for basic understanding of using 
                                sp_executesql. But sometimes you might want to 
                                return one value from dynamic sql and then use 
                                it in your sql procedure. Simple 
                                example:<BR><BR>-- we're looking for employee 
                                name, where a value of his ID = 
                                1.<BR><BR>DECLARE @IDEmployee int, @EmploeeName 
                                nvarchar(100)<BR><BR>SET @IDEmployee = 1<BR>SET 
                                @SQLQuery = 'SELECT @Name = EmployeeName FROM 
                                tblEmployees<BR>WHERE @IDRow = 
                                IDtblEmployees'<BR><BR>exec sp_executesql 
                                @SQLQuery, <BR>'@Name nvarchar(100) OUTPUT, 
                                @IDRow int',<BR>@Name = @EmploeeName OUTPUT, 
                                <BR>@IDRow = @IDEmployee<BR><BR>-- to show 
                                returned value:<BR>SELECT 
                                @EmploeeName<BR><BR><BR>Best regards,<BR>Milan 
                                Smidrkal <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2265314&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2265314&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;tid=2264775">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=470275&amp;msg=2265314">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2265314&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2265314 
                                style="WHITE-SPACE: nowrap">5.00/5 (2 votes)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(71343,2265314,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2266124_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2266124xx></A><IMG height=16 alt=General 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;select=2266124#xx2266124xx" 
                        name=2266124>Re: Alternatives</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2445395"><FONT 
                        face=verdana color=brown size=1>John 
Prabhu</A></FONT></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">22:22 
                        10 Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2266124_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Brilliant suggestion. it gets a 5. 
                                <BR><BR>
                                <DIV class=ForumSig><FONT face=verdana 
                                color=brown size=2>Regards<BR><FONT face=verdana 
                                color=brown size=1><B>J O H N <IMG title=Rose 
                                src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/rose.gif" 
                                align=top></B><BR><BR>"Even eagles need a push." 
                                <B>David McNally </B>
                                <HR SIZE=1>
                                </DIV><BR></FONT></FONT></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2266124&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2266124&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;tid=2264775">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=470275&amp;msg=2266124">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2266124&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2266124 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(2445395,2266124,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2263902_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2263902xx></A><IMG height=16 alt=General 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;select=2263902#xx2263902xx" 
                        name=2263902>Suggestion</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2004172">rilov</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">15:35 9 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2263902_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>i feel that this article is for 
                                the beginners you should specify that in your 
                                article. in enterprise world this is a common 
                                practice .<BR><BR>it would be very helpful to 
                                the beginners if you can follow a step by step 
                                approach . you can also put a comparison between 
                                the normal sql scenario and string build 
                                approach.<BR><BR>I appreciate your effort 
                                <BR><BR>
                                <DIV class=ForumSig>'I have not failed. I've 
                                just<BR>found 10,000 ways that won't 
                                work.'<BR>-Thomas Edison<BR></DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2263902&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=470275&amp;select=2263902&amp;floc=/KB/database/Building_Dynamic_SQL.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/Building_Dynamic_SQL.aspx?fid=470275&amp;tid=2263902">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=470275&amp;msg=2263902">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2263902&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2263902 
                                style="WHITE-SPACE: nowrap">1.80/5 (3 votes)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(2004172,2263902,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Monday, June 9, 2008 5:35 AM &nbsp; &nbsp; 
                  Last Update:Thursday, June 12, 2008 8:56 AM</TD>
                <TD 
              style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 alt=General 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_general.gif" 
      width=16 align=top> General &nbsp;&nbsp; <IMG height=16 alt=News 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_news.gif" 
      width=16 align=top> News &nbsp;&nbsp; <IMG height=16 alt=Question 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_question.gif" 
      width=16 align=top> Question &nbsp;&nbsp; <IMG height=16 alt=Answer 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_answer.gif" 
      width=16 align=top> Answer &nbsp;&nbsp; <IMG height=16 alt=Joke 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_joke.gif" 
      width=16 align=top> Joke &nbsp;&nbsp; <IMG height=16 alt=Rant 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_rant.gif" 
      width=16 align=top> Rant &nbsp;&nbsp; <IMG height=16 alt=Admin 
      src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/msg_admin.gif" 
      width=16 align=top> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=20815">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy </A>| <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 9 Oct 2007<BR>Editor: <A 
            id=ctl00_ArticleEditor></A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2007 by <FONT 
            color=brown size=1>John Prabhu</FONT><BR>Everything else Copyright © 
            <A href="mailto:webmaster@codeproject.com">CodeProject</A>, 
            1999-2008 <BR>Web16 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE>
      <CENTER></CENTER></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE><BR>
<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Building Dynamic Sql In a Stored Procedure_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
new HVMenu(new menu_NavbarConfig());
//]]></SCRIPT>
</BODY></HTML>
