<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0059)http://www.codeproject.com/KB/database/DataGridView2Db.aspx -->
<HTML><HEAD><TITLE>CodeProject: Auto Saving DataGridView Rows to a SQL Server Database. Free source code and programming help</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="Saving a changed row in the DataGridView automatically to the database seems to be a basic task, but is challenging to implement. Read here why the most intuitive approaches fail and how to get it working.; Author: Peter Huber SG; Section: Database; Chapter: Database" 
name=Description>
<META 
content="C#, Windows, .NET, Visual Studio, DBA, Dev, ADO.NET, WinForms, Intermediate,Database,Database,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("www.codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/jxs.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/bookmark.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/rateitem.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function MsgVoteForm(MemberID,MsgID,GB,gp,bp,mt) {
 if(!GB)document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"5":"1")+unescape(");\"%3E"));
 if(GB) document.write(unescape("%3Cimg height=\"24\" width=\"24\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;"); else for(var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"vote this message a " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ")\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"1":"5")+unescape(");\"%3E"));
 if(GB)document.write(unescape("%3Cimg height=\"24\" width=\"24\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" border=\"0\" alt=\"vote 5\" align=\"middle\" /%3E%3C/a%3E "));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?") == true)
  return RateMsg(userid, msgid, score);
 else return false;
}
function RateMsg(memberid, msgid, score) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4) {
   if ( req.status == 200 ) {
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match)?match[1]:"An error occured" + unescape("%3C/b%3E");
   }
   else
   {
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
   }
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK 
href="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/ForumClassicIE6.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" type=image/ico rel="shortcut icon">
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            id=ctl00_Logo 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; WIDTH: 225px; HEIGHT: 90px; BORDER-RIGHT-WIDTH: 0px" 
            alt="The Code Project" 
            src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/logo225x90.gif"></A></TD>
          <TD class=HeaderBanner align=right width="100%">
            <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6155%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fScaleout_SSI_728x90.gif%26C%3dFalse%26id%3d6155%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22728%22%20height%3d%2290%22%3e%3c%2fa%3e"));</SCRIPT>
          </TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">5,215,143 
                  members and growing! (19,374 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">abdelrady2030</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx">My 
                  Settings</A> | <A id=ctl00_MemberMenu_MyCodeProject 
                  href="http://www.codeproject.com/script/Membership/MyCodeProject.aspx"><B>My 
                  CodeProject</B></A> | <A id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 
                  src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/fave.gif" 
                  width=16 align=absMiddle border=0> My Bookmarks</A> | <A 
                  id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2fdatabase%2fDataGridView2Db.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD noWrap><A href="http://www.codeproject.com/">Home</A></TD>
                <TD>&nbsp; </TD>
                <TD noWrap align=right>Current Site: </TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/">Main Site</A></TD>
                <TD noWrap><A href="http://java.codeproject.com/">Java</A></TD>
                <TD noWrap><A href="http://lamp.codeproject.com/">Linux Apache 
                  MySQL PHP</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus><!--380-->
                  <DIV id=MenuPos 
                  style="WIDTH: 305px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=305>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A> 
            » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/database/">Database</A> » <A 
            id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/database/index.aspx?#Database - ADO.NET">ADO.NET</A> 
            <SPAN class=ArticleIntermediate 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Intermediate</SPAN> <SPAN 
            id=ctl00_ArticleTopHeader_LicenceTerms></SPAN><BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>Auto Saving DataGridView Rows 
            to a SQL Server Database</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2558097">Peter 
            Huber SG</A></B><BR><BR><SPAN class=ArticleTopDescr 
            id=ctl00_ArticleTopHeader_ArticleDescr>Saving a changed row in the 
            DataGridView automatically to the database seems to be a basic task, 
            but is challenging to implement. Read here why the most intuitive 
            approaches fail and how to get it working.</SPAN> </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>C#, Windows, .NET, 
            Visual Studio, ADO.NET, WinForms, DBA, Dev</SPAN><BR><BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>26 Jan 
            2006</B><BR><SPAN style="PADDING-RIGHT: 0.5ex">Updated</SPAN>: <B>26 
            Jan 2006</B> <BR><SPAN style="PADDING-RIGHT: 3.2ex">Views</SPAN>: 
            <B>118,519</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV style="PADDING-TOP: 5px; TEXT-ALIGN: center"><IFRAME 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/ServeHTML.htm" 
      frameBorder=0 width=150 scrolling=no height=80></IFRAME></DIV>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <DIV style="PADDING-TOP: 0px"><IMG 
      style="FLOAT: left; MARGIN-LEFT: 8px; MARGIN-RIGHT: 9px" height=20 
      alt=Comp 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/prize_winner.gif" 
      width=10> <A href="http://www.codeproject.com/Feature/CodeGenComp/">Code 
      Generation<BR>comp. $1,000 prize!</A></DIV>
      <DIV style="MARGIN-TOP: 4px; MARGIN-BOTTOM: 3px"><IMG 
      style="FLOAT: left; MARGIN-LEFT: 6px; MARGIN-RIGHT: 6px" height=16 
      alt=Comp 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/coffee.gif" 
      width=16> <A href="http://www.codeproject.com/Zones/IBM/">Win CodeProject 
      Coffee!</A></DIV>
      <DIV style="PADDING-TOP: 0px"><IMG 
      style="FLOAT: left; MARGIN-LEFT: 8px; MARGIN-RIGHT: 9px" height=20 
      alt=Comp 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/prize_winner.gif" 
      width=10> <A id=ctl00_Announcements_CompLink 
      href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
      Competition</A><BR clear=all>
      <DIV style="PADDING-BOTTOM: 5px; PADDING-TOP: 3px"><IMG 
      style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 8px" 
      height=16 alt=Staff 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/staff_sm.gif" 
      width=12> <A href="http://www.codeproject.com/info/jobs/">We're 
      Hiring</A></DIV></DIV></DIV>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
Board</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV><BR>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2 style="DISPLAY: none">
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MI id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3 style="DISPLAY: none">
      <DIV class=MI id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4>
      <DIV class=MIS id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5 style="DISPLAY: none">
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV>
      <DIV class=MI id=Section126><A 
      href="http://www.codeproject.com/KB/codegen/">Code 
      Generation</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter12');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=12">Third 
      Party Products</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter12 style="DISPLAY: none">
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section124><A 
      href="http://www.codeproject.com/KB/solution-center/">Solution 
      Center</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/WhitePapers">WhitePapers</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/CodeGeneration">Code 
      Generation</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/QuestSQL">Quest SQL 
      Zone</A></DIV><BR>
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6292%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fWholeTomato_ChangeSigExt_160x600.gif%26C%3dFalse%26id%3d6292%22%20alt%3d%22The%20intellisense%20upgrade%20for%20Visual%20Studio%20.NET%20-%20make%20your%20IDE%20as%20smart%20as%20you.%22%20border%3d%220%22%20width%3d%22160%22%20height%3d%22600%22%3e%3c%2fa%3e"));</SCRIPT>
      <IMG height=1 alt="" 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/t.gif" 
      width=160> </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top>
            <TABLE>
              <TBODY></TBODY></TABLE>
            <DIV class=SmallText><IMG style="VERTICAL-ALIGN: middle" height=16 
            alt=print 
            src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/print.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
            href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?display=Print">Print</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Broken Article?" 
            src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/report.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_BrokenLnk 
            href="http://www.codeproject.com/script/Articles/Report.aspx?aid=12846">Report 
            Article</A> &nbsp; <IMG style="VERTICAL-ALIGN: middle" alt=Watch 
            src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/watchon.png"> 
            <A class="" id=bmw_12846,2 onclick="return watchMe(12846, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=12846&amp;obtid=2&amp;bma=AddWatch" 
            name=ajaxBookmarkWatchLink>Watch</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN><SPAN 
            id=ctl00_ArticleHeaderLinks_ArticleBmkWatch_Message></SPAN>&nbsp; 
            <IMG style="VERTICAL-ALIGN: middle" height=16 alt=Bookmark 
            src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/link.png" 
            width=16> <A class="" id=bm_12846,2 
            onclick="return bookmarkMe(12846, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=12846&amp;obtid=2&amp;bma=AddBookmark" 
            name=ajaxBookmarkLink>Bookmark</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN><SPAN 
            id=ctl00_ArticleHeaderLinks_ArticleBmk_Message></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Discuss 
            src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/discuss.gif" 
            width=15> <A 
            href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx#_comments">Discuss</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Recommend Article" 
            src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/mail.gif" 
            width=16>&nbsp;<A id=ctl00_ArticleHeaderLinks_Recommend 
            href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=12846">Send&nbsp;to&nbsp;a&nbsp;friend</A> 
            </DIV></TD>
          <TD style="WIDTH: 100px; WHITE-SPACE: nowrap; TEXT-ALIGN: right">
            <TABLE id=CurRat>
              <TBODY>
              <TR>
                <TD>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=SmallText style="WHITE-SPACE: nowrap" 
                      align=right><SPAN id=ctl00_ArticleRating_VoteLabel>22 
                        votes for this Article.</SPAN></TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=1>
                          <TBODY>
                          <TR>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD noWrap width=20 bgColor=white height=7><IMG 
                              height=7 
                              src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/red.gif" 
                              width=3 align=center 
                      border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=ctl00_ArticleRating_PopularityRow>
                      <TD class=SmallText align=right colSpan=2><A 
                        id=ctl00_ArticleRating_PopularityLnk 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                        5.58</A> <SPAN 
                        id=ctl00_ArticleRating_PopularityLbl></SPAN><SPAN 
                        id=ratingVal>Rating: <B>4.16</B> out of 
                    5</SPAN></TD></TR></TBODY></TABLE></TD>
                <TD>
                  <DIV>
                  <TABLE class=HistTable 
                  title="Voting Distribution. Recent data only">
                    <TBODY>
                    <TR>
                      <TD><IMG title="1 vote, 4.5%" height=1 
                        alt="1 vote, 4.5%" 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>1</TD>
                      <TD><IMG title="2 votes, 9.1%" height=3 
                        alt="2 votes, 9.1%" 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>2</TD>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>3</TD>
                      <TD><IMG title="6 votes, 27.3%" height=9 
                        alt="6 votes, 27.3%" 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>4</TD>
                      <TD><IMG title="13 votes, 59.1%" height=20 
                        alt="13 votes, 59.1%" 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/pollcol.gif" 
                        width=10 
              border=0><BR>5</TD></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <UL class=Callout id=ctl00_confirmError style="MARGIN-RIGHT: 20px">
        <LI class=SmallText 
        style="LIST-STYLE-IMAGE: url(/images/warning.gif)">You are signed up for 
        one or more <A id=ctl00_SubscribeLink2 
        href="http://www.codeproject.com/script/Membership/Subscribe.aspx?rp=%2fKB%2fdatabase%2fDataGridView2Db.aspx">newsletters</A> 
        but your email address is either unconfirmed, or has not been 
        reconfirmed in a long time. Please click <A id=ctl00_RequestConfirmLink2 
        href="http://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fKB%2fdatabase%2fDataGridView2Db.aspx">here</A> 
        to have an email sent that will allow us to confirm your email address 
        and start sending you newsletters again.</LI></UL><SPAN id=intelliTXT>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/database/DataGridView2Db/DataGridView2Db_demo.zip">Download 
        demo project - 20.6 Kb</A> </LI></UL>
      <H2>Introduction</H2>
      <P>SQL Enterprise Manager did it since years: Whenever a user changes a 
      row in a table, it is automatically written back to the database table. 
      Providing our users with the same functionality is tricky to implement 
      because of the interaction of <CODE>DataSet</CODE> and 
      <CODE>BindingSource</CODE>, which is hardly documented in the .NET help. 
      This article investigates some intuitive solutions and explains why they 
      will not work. A detailed analysis of the involved events leads to the 
      final solution, which is surprisingly simple as any good solution should 
      be.</P>
      <H2>Background</H2>
      <P>Often, a user has to save his work explicitly, like saving a document 
      in Word. This approach works right out of the box with 
      <CODE>DataRowViews</CODE>, using the save button of the 
      <CODE>BindingNavigator</CODE>. But saving explicitly can be cumbersome for 
      the user if changes in a <CODE>DataRow</CODE> should be updated 
      immediately to the database. Implementing auto saving should be easy! Just 
      use an event which detects that the row content has changed, use the 
      <CODE>Update</CODE> method of the <CODE>TableAdapter</CODE> and you are 
      done. Unfortunately, ADO.NET will run into some strange internal errors 
      should you try it.</P>
      <P>Let's have a closer look at some intuitive solutions (or skip to <A 
      href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx#solution">The 
      solution</A> if you are in a hurry).</P>
      <H3>DataGridView event</H3>
      <P>The <CODE>DataGridView</CODE> would be the most obvious choice to 
      detect that a row has changed in the <CODE>DataGridView</CODE>. But the 
      <CODE>DataGridView</CODE> focuses mostly on a cell, displaying its 
      content, the user interaction and writing back the changed data to 
      <CODE>DatSet.DataTable.DataRow</CODE>. Events like 
      <CODE>DataGridView_RowValidated</CODE> fire for all possible reasons, and 
      not necessarily because the user has changed the data.</P>
      <P>There would be the <CODE>DataGridView_CellEndEdit</CODE> event 
      indicating a change. But using <CODE>TableAdapter.Update()</CODE> at this 
      point of time will mess up ADO.NET. Updating the database would happen in 
      the middle of copying from the <CODE>DataView</CODE> to the 
      <CODE>DataTable</CODE>. Both activities change the state of the 
      <CODE>DataRow</CODE>. Interrupting the copy with the update will prevent 
      the copy operation from finishing properly (I guess ADO.NET doesn't 
      support reentrancy).</P>
      <H3>BindingSource event</H3>
      <P>The data binding for the <CODE>DataGridView</CODE> is done in the 
      <CODE>BindingSource</CODE>, the right place to detect when the content of 
      a cell has changed:</P><PRE lang=cs><SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> BindingSource_CurrentItemChanged(
  <SPAN class=code-keyword>object</SPAN> sender, EventArgs e) 
{
  DataRow ThisDataRow = 
    ((DataRowView)((BindingSource)sender).Current).Row;
  <SPAN class=code-keyword>if</SPAN> (ThisDataRow.RowState==DataRowState.Modified) {
    TableAdapter.Update(ThisDataRow);
  } 
}</PRE>
      <P>If you try this code, it will work, alas for the first changed record 
      only! You will get a strange error message during the update of the second 
      row, basically the row seems to be empty. When you check with the 
      debugger, the row has meaningful data before the update and only after the 
      runtime error it seems to be empty. The update even writes the second 
      record successfully into the database.</P>
      <H3>DataTable event</H3>
      <P>If the <CODE>BidingSource</CODE> doesn't work, how about using an event 
      from the <CODE>DataSet.DataTable</CODE>? After all, any change to the 
      <CODE>DataRow</CODE> should be written to the database, regardless of who 
      does it. The code could look like this:</P><PRE lang=cs><SPAN class=code-keyword>void</SPAN> Table_RowChanged
  (<SPAN class=code-keyword>object</SPAN> sender, DataRowChangeEventArgs e)
{ 
    <SPAN class=code-keyword>if</SPAN> (e.Row.RowState == DataRowState.Modified)
    {
    TableAdapter.Update(e.Row);
  }
}</PRE>
      <P>This time, you will immediately get a run time error. ADO.NET has not 
      yet finished changing the <CODE>DataRow</CODE> when the 
      <CODE>Update</CODE> tries to change the state of the <CODE>DataRow</CODE> 
      again.</P>
      <H2><A name=Solution>The solution</A></H2>
      <P>It seems that ADO.NET doesn't want to be interrupted by a row update to 
      the database until is has completely copied the changes from the 
      <CODE>DatRowView</CODE> to the <CODE>DataTable</CODE>. None of the row 
      change related events can be used to save the row to the database. So the 
      solution must be to use an event which fires after the row is copied and 
      the event should not be related to the row changed! Well, then let's just 
      use the <CODE>PositionChanged</CODE> event of the 
      <CODE>BindingSource</CODE>. It fires for the next row the user navigates 
      to. So the challenge is to remember which was the last row, check if it 
      was modified and update the database if needed. Don't forget to do the 
      same thing when the <CODE>Form</CODE> closes, the 
      <CODE>PositionChanged</CODE> event will not fire when the 
      <CODE>Form</CODE> closes:</P><PRE lang=cs><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>partial</SPAN> <SPAN class=code-keyword>class</SPAN> MainForm: Form {
  <SPAN class=code-keyword>public</SPAN> MainForm() {
    InitializeComponent();
  }

  <SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> MainForm_Load(
    <SPAN class=code-keyword>object</SPAN> sender, EventArgs e) 
  {
    <SPAN class=code-keyword>this</SPAN>.regionTableAdapter.Fill(
      <SPAN class=code-keyword>this</SPAN>.northwindDataSet.Region);
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> resize the column once, but allow the
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> users to change it.
</SPAN>    <SPAN class=code-keyword>this</SPAN>.regionDataGridView.AutoResizeColumns(
      DataGridViewAutoSizeColumnsMode.AllCells);
  }
 
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>tracks for PositionChanged event last row
</SPAN>  <SPAN class=code-keyword>private</SPAN> DataRow LastDataRow = <SPAN class=code-keyword>null</SPAN>;

  <SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>SUMMARY</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN>  <SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> Checks if there is a row with changes and
</SPAN>  <SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> writes it to the database
</SPAN>  <SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>/</SPAN><SPAN class=code-SummaryComment>SUMMARY</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN>  <SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> UpdateRowToDatabase() {
    <SPAN class=code-keyword>if</SPAN> (LastDataRow!=null) {
      <SPAN class=code-keyword>if</SPAN> (LastDataRow.RowState==
          DataRowState.Modified) {
        regionTableAdapter.Update(LastDataRow);
      }
    }
  }
  
  <SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> regionBindingSource_PositionChanged(
    <SPAN class=code-keyword>object</SPAN> sender, EventArgs e) 
  {
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if the user moves to a new row, check if the 
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> last row was changed
</SPAN>    BindingSource thisBindingSource = 
      (BindingSource)sender;
    DataRow ThisDataRow=
      ((DataRowView)thisBindingSource.Current).Row;
    <SPAN class=code-keyword>if</SPAN> (ThisDataRow==LastDataRow) {
      <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> we need to avoid to write a datarow to the 
</SPAN>      <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> database when it is still processed. Otherwise
</SPAN>      <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> we get a problem with the event handling of 
</SPAN>      <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>the DataTable.
</SPAN>      <SPAN class=code-keyword>throw</SPAN> <SPAN class=code-keyword>new</SPAN> ApplicationException(<SPAN class=code-string>"</SPAN><SPAN class=code-string>It seems the"</SPAN> +
        <SPAN class=code-string>"</SPAN><SPAN class=code-string> PositionChanged event was fired twice for"</SPAN> + 
        <SPAN class=code-string>"</SPAN><SPAN class=code-string> the same row"</SPAN>);
    }

    UpdateRowToDatabase();
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> track the current row for next 
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> PositionChanged event
</SPAN>    LastDataRow = ThisDataRow;
  }

  <SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> MainForm_FormClosed(
    <SPAN class=code-keyword>object</SPAN> sender, FormClosedEventArgs e) 
  {
    UpdateRowToDatabase();
  }
}</PRE>
      <H2>Event analysis</H2>
      <P>As a bonus, find a trace of the events involved when the user changes 
      the content of a cell in the <CODE>DataGridView</CODE>:</P><PRE lang=text>DataGridView_CellBeginEdit       
    CellEditMode: False
DataGridView_CellValidating      
    CellEditMode: True
DataTable_ColumnChanging         
    RowState: Unchanged; HasVersion 'DCOP'
DataTable_ColumnChanged          
    RowState: Unchanged; HasVersion 'DCOP'
DataGridView_CellValidated       
    CellEditMode: True
DataGridView_CellEndEdit         
    CellEditMode: False
DataGridView_RowValidating       
    CellEditMode: False 
DataTable_RowChanging            
    RowState: Unchanged; HasVersion 'DCOP'
BindingSource_CurrentItemChanged 
    RowState: Modified ; HasVersion 'DCO ' 
BindingSource_ListChanged        
    RowState: Modified ; HasVersion 'DCO '
DataTable_RowChanged             
    RowState: Modified ; HasVersion 'DCO '
DataGridView_RowValidated        
    CellEditMode: False
DataGridView_Validating          
    CellEditMode: False   
DataGridView_Validated           
    CellEditMode: False

DataRow Versions: 
D: Default
C: Current
O: Old
P: Proposed</PRE>
      <H2>Using the code</H2>
      <P>Before you can run the sample application, open the Solution Explorer 
      to change the <CODE>NorthwindConnectionString</CODE>. The 
      <CODE>DataSource</CODE> should point to your SQL server with the Northwind 
      database.</P>
      <P>Once the application is running, change the name of a region and move 
      to another row. This will save the region name to the database. Check in 
      the database or close and restart the application to see if the change is 
      really stored. Don't forget to change the region name back to its original 
      value.</P>
      <H2>Conclusion</H2>
      <P>The same problem existed in earlier ADO.NET versions. I didn't try it, 
      but the described approach should also work for earlier versions, just use 
      the events of the <CODE>CurrencyManager</CODE>.</P>
      <H2>History</H2>
      <UL>
        <LI>27.1.2006: Original posting. </LI></UL><!-- Article Ends --><!-- Main Page Contents End --></DIV></SPAN>
      <FORM id=aspnetForm 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
      name=aspnetForm action=DataGridView2Db.aspx method=post>
      <DIV><INPUT id=__VIEWSTATE type=hidden 
      value=/wEPDwULLTEwMDUyNjYzMjhkZIpiiDyIRXzStsLA0f6Fwfm+A+5Y 
      name=__VIEWSTATE> </DIV>
      <H2>License</H2>
      <DIV id=ctl00_LicenseTerms>
      <P>This article has no explicit license attached to it but may contain 
      usage terms in the article text or the download files themselves. If in 
      doubt please contact the author via the discussion board below.</P>
      <P>A list of licenses authors might use can be found <A 
      href="http://www.codeproject.com/info/Licenses.aspx">here</A></P></DIV>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2558097">Peter 
            Huber SG</A></B><BR><BR>
            <CENTER><IMG id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
            src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/{E69571C2-A66F-4F08-813C-D4C603A7289A}.jpg"></CENTER><BR><SPAN 
            class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>SW Dev Manager from Switzerland living in Singapore<BR><BR>I 
            would be very interested to do SW development in Singapore for an 
            international .NET project.<BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow>
                <TD class=SmallText noWrap>Occupation: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Web 
                  Developer</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt=Singapore 
                  src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/SG.gif" 
                  width=16> 
      Singapore</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE id=ctl00_PopularArticlesRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular Database articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/database/caaadoclass1.aspx">A 
              set of ADO classes - version 2.20</A>
              <DIV class=SmallText>Simple database access using an ADO 
              class.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/database/filehelpers.aspx">FileHelpers 
              v2.0 - Delimited (CSV) or Fixed Data Import/Export Framework</A>
              <DIV class=SmallText>An easy to use .NET library to read/write 
              strong typed data from files with fixed length or delimited 
              records (CSV). Also has support to import/export data from 
              different data storages (Excel, Acces, SqlServer, MySql)</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/database/sqldodont.aspx">SQL 
              Server DO's and DONT's</A>
              <DIV class=SmallText>SQL Server database best practices</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/database/connectionstrings.aspx">ADO 
              Connection Strings</A>
              <DIV class=SmallText>A list of ODBC DSN Connection Strings.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/database/DynamicMethod_ILGenerator.aspx">Dynamic... 
              but fast: The tale of three monkeys, a wolf and the DynamicMethod 
              and ILGenerator classes</A>
              <DIV class=SmallText>How to use the DynamicMethod and ILGenerator 
              classes to create dynamic code at runtime that out performs 
              reflection</DIV></LI></UL>
            <H2></H2></TD>
          <TD><IFRAME 
            src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\ServeHTML(1).htm" 
            frameBorder=0 width=300 scrolling=no 
        height=250></IFRAME></TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
var addtoMethod=1;
var AddURL = document.location.href;
var AddTitle = escape(document.title);
DrawLinks(100, 0, "SmallText Bold", "AddTo") 
</SCRIPT>
      </DIV>
      <TABLE class=RatingBar id=ctl00_RateArticleRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD id=ctl00_RateArticle_VoteResultDiv noWrap align=right 
                width="100%"><SPAN id=voteRes></SPAN><IMG id=loaderImg 
                  style="DISPLAY: none" height=16 alt=loading... 
                  src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/ajax-loader.gif" 
                  width=16> </TD>
                <TD class=SmallText id=voteTbl style="WHITE-SPACE: nowrap" 
                align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px; WHITE-SPACE: nowrap"><I><B>Rate 
                        this Article for us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm noWrap 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn onclick="return rateItem(12846,2);" type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV><INPUT id=__EVENTVALIDATION type=hidden 
      value=/wEWCALmpquzDQLAlMXDBwLBlMXDBwLClMXDBwLDlMXDBwLElMXDBwLP+++tCwK5upDkC7ErvnSuegUPLl2/yPgxXxcNclXX 
      name=__EVENTVALIDATION> </DIV></FORM>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d3485%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fcp_daily_468x60.gif%26C%3dFalse%26id%3d3485%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22468%22%20height%3d%2260%22%3e%3c%2fa%3e"));</SCRIPT>
      <IFRAME 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/ServeLinks.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD>
            <FORM 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fdatabase%2fDataGridView2Db.aspx&amp;fid=261351 
            method=get><INPUT type=hidden value=261351 name=fid><INPUT 
            type=hidden 
            value=?floc=%2fKB%2fdatabase%2fDataGridView2Db.aspx&amp;fid=261351 
            name=currentQS><INPUT type=hidden 
            value=/KB/database/DataGridView2Db.aspx name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 alt=FAQ 
                  src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/forum_faq.gif" 
                  width=16 align=middle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 alt=Search 
                  src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/forum_search.gif" 
                  width=16 align=top border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=261351">Search 
                  Messages</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=submit></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></FORM></TD></TR>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 alt=new 
                  src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/forum_newmsg.gif" 
                  width=16 align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;floc=/KB/database/DataGridView2Db.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 25 of 39 (Total in Forum: 39) (<A 
                  href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next</A></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0><!-- Column Headers -->
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2457185_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2457185xx></A><IMG height=16 alt=Question 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=2457185#xx2457185xx" 
                        name=2457185>Not getting the PositionChanged 
event</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4848856">Sam 
                        Lambert</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">17:32 7 
                        Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2457185_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Admittedly, I'm a newbie with C# 
                                and .NET (despite coding for almost 30 years), 
                                but I can't seem to get the PositionChanged 
                                event to fire.<BR><BR>I've got the following 
                                defined:<BR><CODE><BR>dataGridView1.DataSource = 
                                bindingSource1;<BR>bindingSource1.PositionChanged 
                                += 
                                bindingSource1_PositionChanged;<BR></CODE><BR>My 
                                event handler never gets invoked. I've got a 
                                ListChanged event handler on the BindingSource 
                                that fires when I do a Fill(), and a RowsAdded 
                                event on the datagrid that fires off 
                                appropriately, but I cannot get this other 
                                handler to work.<BR><BR>Any 
                                suggestions?<BR><BR>-- Sam <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2457185&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2457185&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=2457185">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=2457185">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2457185&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2457185 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(4848856,2457185,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote Rt HdUnSel " id=F2389579_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2389579xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=2389579#xx2389579xx" 
                        name=2389579>vb solution</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4838823">Al 
                        Kearns</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:55 
                        14 Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2389579_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR><BR>Was looking for a 
                                solution for this problem but in VB - once 
                                converted, it worked great. Although the code 
                                provided only covered editing existing records, 
                                adding functionality for adding new rows was 
                                quite simple (in fact I used a Select... Case 
                                statement and trapped the Edit and AddNew in one 
                                case)<BR><BR>code is as 
                                follows:<BR><BR><CODE><BR>Private Sub 
                                UpdateRowToDatabase()<BR><BR>If Not 
                                IsNothing(LastDataRow) Then<BR><BR>Select Case 
                                LastDataRow.RowState<BR><BR>Case 
                                DataRowState.Modified, 
                                DataRowState.Added<BR><BR>ClientsTableAdapter.Update(LastDataRow)<BR><BR>End 
                                Select<BR><BR>End If<BR><BR>End 
                                Sub<BR><BR>Private Sub 
                                ClientsBindingSource_PositionChanged(ByVal 
                                sender As Object, _<BR>ByVal e As 
                                System.EventArgs) _<BR>Handles 
                                ClientsBindingSource.PositionChanged<BR><BR>Dim 
                                bsClients As BindingSource = CType(sender, 
                                BindingSource)<BR>Dim row As DataRowView<BR>row 
                                = bsClients.Current<BR>Dim ThisDataRow As 
                                DataRow = row.Row<BR><BR>If 
                                ThisDataRow.Equals(LastDataRow) 
                                Then<BR><BR>'don't write a datarow while it is 
                                still being processed<BR>'problems with event 
                                handling of the DataTable will occur<BR>Throw 
                                New ApplicationException("It seems the" + _<BR>" 
                                PositionChanged event was fired twice for" + 
                                _<BR>" the same row")<BR><BR>End 
                                If<BR><BR>'update row and save it for next time 
                                thru<BR>UpdateRowToDatabase()<BR>LastDataRow = 
                                ThisDataRow<BR><BR>End Sub<BR><BR>Private Sub 
                                frmMain_FormClosed(ByVal sender As Object, 
                                _<BR>ByVal e As 
                                System.Windows.Forms.FormClosedEventArgs) 
                                _<BR>Handles 
                                Me.FormClosed<BR><BR>UpdateRowToDatabase()<BR><BR>End 
                                Sub<BR></CODE><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2389579&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2389579&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=2389579">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=2389579">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2389579&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2389579 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(4838823,2389579,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2284115_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2284115xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=2284115#xx2284115xx" 
                        name=2284115>RowLeave ?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3489243">andycted</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:49 23 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2284115_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I suppose you could use RowLeave 
                                to check when the selected row has changed ? and 
                                maybe track if cells have been edited with 
                                CellBeginEdit and CellEndEdit ?<BR>I'm not sure 
                                but it seems to work for me right 
                                now...<BR><BR><BR>Andy<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2284115&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2284115&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=2284115">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=2284115">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2284115&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2284115 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(3489243,2284115,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2323508_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2323508xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=2323508#xx2323508xx" 
                        name=2323508>Re: RowLeave ?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3489243">andycted</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:28 17 
                        Nov '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2323508_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Actually saving modifications by 
                                handling RowLeave gives me some problems when 
                                working with multiple controls. I'm actually 
                                trying BindingSource.CurrentChanged (not 
                                BindingSource.CurrentItemChanged) with a certain 
                                degree of success until now.<BR>Andy <BR><BR>
                                <DIV class=ForumSig>Andrea Sabbatini<BR>Sviluppo 
                                software - Software 
                                development<BR>www.andreasabbatini.com<BR>www.doctorsoffice.it</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2323508&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2323508&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=2284115">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=2323508">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2323508&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2323508 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(3489243,2323508,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2266379_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2266379xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=2266379#xx2266379xx" 
                        name=2266379>Adding new rows to the DataGridView 
                      UI</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1733497">Subrahmanyam 
                        K</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:50 11 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2266379_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi Peter,<BR><BR>Very nice 
                                article.<BR><BR>Besides updating the existing 
                                rows, I have the requirement of adding new rows 
                                to the DataGridViews User Interface which 
                                internally gets added to the underlying 
                                datasource.<BR><BR>Here is my requirement in 
                                detail:<BR><BR>I have a requirement to add new 
                                rows to the DataGridView UI which is bound to a 
                                DataTable.<BR><BR>The new row added to the UI 
                                should get added to the underlying 
                                DataSource.<BR><BR>I have bound the DataGridView 
                                to a DataSource. <BR><BR>The DataSource consists 
                                of 10 columns out of which only 5 columns were 
                                bound to the DataGridView. <BR><BR>The other 5 
                                columns which are not bound consists of 
                                composite primary key on 2 columns and 3 other 
                                columns will not accept null 
                                values.<BR><BR><BR><BR>I have tried with 
                                "DefaultValueNeede" event of the DataGridView to 
                                define the default values for the new 
                                row.<BR><BR>As only 5 columns are bound to the 
                                DataGridView, I could supply the default values 
                                only to those columns.<BR><BR>How would I supply 
                                the default values to the rest of the columns 
                                which are not bound to the 
                                DataGridView?<BR><BR>Which event of the 
                                DataGridView should be handled in this 
                                scenario?<BR><BR>An exception is thrown when I 
                                tried to commit the new row in the DataGridView 
                                UI (by adding a "new new row") to the 
                                DataGrid.<BR><BR>The exception is that "Required 
                                values are not supplied to the new DataRow" 
                                which are the composite primary key columns (2) 
                                and "not null" columns (3).<BR><BR><BR>Thank 
                                You. <BR><BR>
                                <DIV class=ForumSig>Subrahmanyam 
                                K</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2266379&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2266379&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=2266379">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=2266379">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2266379&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2266379 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(1733497,2266379,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2350418_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2350418xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=2350418#xx2350418xx" 
                        name=2350418>Re: Adding new rows to the DataGridView 
                        UI</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4259236">Momony</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">14:57 7 
                        Dec '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2350418_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I had that similar problem of 
                                specifying default values for columns in the 
                                datatable that were not in the 
                                datagridview.<BR><BR>I did handled the 
                                DataGridView's Default values needed, and 
                                retrieved the underlying datatable row from the 
                                bindingsource's Current property.<BR><BR>The 
                                code looked like this:<BR>private void 
                                HandleGridViewDefaultValuesNeeded(object sender, 
                                DataGridViewRowEventArgs e)<BR>{ if 
                                (e.Row.IsNewRow)<BR>{ DataRowView currentRowView 
                                = BindingSource.Current as 
                                DataRowView;<BR>MyTableRow currentRow = 
                                currentRowView.Row as MyTableRow<BR>object 
                                currentID = currentRow["MyIDColumn"];<BR>if 
                                (Convert.IsDBNull(currentID))<BR>{ 
                                currentRow["MyIDColumn"] = 
                                Guid.NewGuid();<BR>}<BR>}<BR>}<BR><BR>Hope that 
                                helps,<BR>-Kent <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2350418&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2350418&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=2266379">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=2350418">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2350418&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2350418 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(4259236,2350418,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2075150_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2075150xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=2075150#xx2075150xx" 
                        name=2075150>Great article ... but what about prompting 
                        before saving?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4175531">seehsarp</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:10 10 
                        Jun '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2075150_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR><BR>your article is very 
                                good. I searched for some solution on a similar 
                                problem.<BR>I want the user to decide if the 
                                changed data should be saved, rejected or 
                                modified again. Therefore I wrote these lines in 
                                the CurrentItem_Changed Handler of my 
                                BindingSource:<BR><BR><CODE><BR>DataRow 
                                ThisDataRow = 
                                ((DataRowView)bs.Current).Row;<BR>if 
                                (ThisDataRow != LastDataRow)<BR>{<BR>if 
                                (LastDataRow != null &amp;&amp; 
                                LastDataRow.RowState == 
                                DataRowState.Modified)<BR>{<BR>switch 
                                (MessageBox.Show("Do you want to save \"" + 
                                LastDataRow["Name"] + "\"?",<BR>"Last item " + 
                                LastDataRow["IDData"] + " has unsaved 
                                changes:",<BR>MessageBoxButtons.YesNoCancel, 
                                MessageBoxIcon.Question))<BR>{<BR>case 
                                DialogResult.Yes: saveData(); /*calls 
                                Update-method*/ break;<BR>case DialogResult.No: 
                                LastDataRow.RejectChanges(); break;<BR>/// AT 
                                THIS POINT THE LAST DATA ROW IS RE-OPENED, WHICH 
                                WORKS - ALMOST.<BR>case DialogResult.Cancel: 
                                bs.Position = LastDRowPos; 
                                return;<BR><BR>}<BR>}<BR><BR>LastDataRow = 
                                ThisDataRow; /// Saves last row<BR>LastDRowPos = 
                                bs.Position; /// Saves Position of last 
                                row<BR>}<BR></CODE><BR><BR>This really works 
                                fine, but my only problem occures when the user 
                                answers "Cancel" (I know that it isn't too smart 
                                to change the bindingsource position in the very 
                                same handler ): The bindingsource seems to be 
                                changed properly. Only my datagridview still 
                                selects the old row!!! And if I want to change 
                                this manually by 
                                <CODE>datagridview.Row[LastDRowPos].Cells[0].Selected 
                                = true;</CODE> I get a 
                                InvalidOperationException.<BR><BR>Help, anyone 
                                please? <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2075150&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2075150&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=2075150">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=2075150">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2075150&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2075150 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(4175531,2075150,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2069859_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2069859xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=2069859#xx2069859xx" 
                        name=2069859>Thanks - Great article, just what I 
                        needed!</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1717535">CSutherland</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">10:09 6 
                        Jun '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2069859_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Thanks - Great article, just what 
                                I needed! <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2069859&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2069859&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=2069859">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=2069859">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2069859&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2069859 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(1717535,2069859,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote Rt HdUnSel " id=F2036249_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2036249xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=2036249#xx2036249xx" 
                        name=2036249>Cant get it to update my db.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4119092">Jon 
                        Henry</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">17:41 
                        14 May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2036249_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I cant get it to update my db. 
                                Anyone see anything wrong?<BR><BR>using 
                                System;<BR>using 
                                System.Collections.Generic;<BR>using 
                                System.ComponentModel;<BR>using 
                                System.Data;<BR>using System.Drawing;<BR>using 
                                System.Text;<BR>using 
                                System.Windows.Forms;<BR>using 
                                System.Drawing.Printing;<BR><BR>namespace 
                                Paintball<BR>{<BR>public partial class fclsinv : 
                                Form<BR>{<BR>// The class that will do the 
                                printing process.<BR>DataGridViewPrinter 
                                MyDataGridViewPrinter;<BR><BR>public 
                                fclsinv()<BR>{<BR>InitializeComponent();<BR>}<BR>private 
                                void fclsinv_Load(object sender, EventArgs 
                                e)<BR>{<BR>// TODO: This line of code loads data 
                                into the 'paintballDataSet.Inventory' table. You 
                                can move, or remove it, as 
                                needed.<BR>this.inventoryTableAdapter.Fill(this.paintballDataSet.Inventory);<BR>// 
                                resize the column once, but allow the users to 
                                change 
                                it.<BR>this.TheDataGridView.AutoResizeColumns(DataGridViewAutoSizeColumnsMode.AllCells);<BR>}<BR>private 
                                void timer1_Tick(object sender, EventArgs 
                                e)<BR>{<BR>// TODO: This line of code loads data 
                                into the 'paintballDataSet.Inventory' table. You 
                                can move, or remove it, as 
                                needed.<BR>this.inventoryTableAdapter.Fill(this.paintballDataSet.Inventory);<BR>}<BR><BR>//tracks 
                                for PositionChanged event last row<BR>private 
                                DataRow LastDataRow = null;<BR><BR>/// 
                                <SUMMARY>Checks if there is a row with changes 
                                and writes it to the database 
                                </SUMMARY><BR>private void 
                                UpdateRowToDatabase()<BR>{<BR>if (LastDataRow != 
                                null)<BR>{<BR>if (LastDataRow.RowState == 
                                DataRowState.Modified)<BR>{<BR>this.inventoryTableAdapter.Update(LastDataRow);<BR>}<BR>}<BR>}<BR>private 
                                void 
                                inventoryBindingSource_PositionChanged(object 
                                sender, EventArgs e)<BR>{<BR>// if the user 
                                moves to a new row, check if the last row was 
                                changed<BR>BindingSource thisBindingSource = 
                                (BindingSource)sender;<BR>DataRow ThisDataRow = 
                                ((DataRowView)inventoryBindingSource.Current).Row;<BR>if 
                                (ThisDataRow != LastDataRow)<BR>{<BR>// we need 
                                to avoid to write a datarow to the database when 
                                it is still processed. Otherwise<BR>// we get a 
                                problem with the event handling of the 
                                DataTable.<BR>throw new ApplicationException("It 
                                seems the" + " PositionChanged event was fired 
                                twice for" +<BR>" the same 
                                row");<BR>}<BR>UpdateRowToDatabase();<BR>// 
                                track the current row for next PositionChanged 
                                event<BR>LastDataRow = 
                                ThisDataRow;<BR>}<BR><BR>private void 
                                btnclose_Click(object sender, EventArgs 
                                e)<BR>{<BR>UpdateRowToDatabase(); <BR>} 
                                <BR><BR>Jon Henry<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2036249&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2036249&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=2036249">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=2036249">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2036249&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2036249 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(4119092,2036249,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F2206717_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2206717xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=2206717#xx2206717xx" 
                        name=2206717>Re: Cant get it to update my db.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4469550">Elphabah</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">18:24 
                        30 Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2206717_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>My code looks just like yours, and 
                                mine also doesn't work. I'll be interested in 
                                any response.<BR><BR><BR>Elph<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2206717&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=2206717&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=2036249">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=2206717">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2206717&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2206717 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(4469550,2206717,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1983514_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1983514xx></A><IMG height=16 alt=Question 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1983514#xx1983514xx" 
                        name=1983514>Validate the row?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3846234">http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3846234</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:53 11 
                        Apr '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1983514_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>When do you validate the row 
                                before saving it to the DB?<BR><BR>I tried to 
                                add "this.Validate()" before the save... but 
                                that gave me all sorts of trouble.<BR><BR>Any 
                                ideas?<BR><BR>Anders... <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1983514&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1983514&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1983514">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1983514">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1983514&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1983514 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(3846234,1983514,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1831604_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1831604xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1831604#xx1831604xx" 
                        name=1831604>Another approach</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2519047">bamboozle</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:36 6 
                        Jan '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1831604_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>- Use VirtualMode<BR>- Use the 
                                RowValidating event in conjunction with 
                                IsCurrentRowDirty to detect update attempts<BR>- 
                                Update the database yourself<BR>- If it succeeds 
                                - DataTable.AcceptChanges()<BR>- If it fails - 
                                e.Cancel = true;<BR>- handle CancelRowEdit with 
                                DataTable.RejectChanges()<BR>- Proposed values 
                                are here: 
                                this.gridOne.Rows[e.RowIndex].Cells[i].Value<BR>- 
                                Current values are here: 
                                this.dt.Rows[e.RowIndex][i, 
                                DataRowVersion.Original]<BR>- Now Microsoft's 
                                Dirty Pen bug is fixed because you can implement 
                                RowDirtyStateNeeded correctly<BR><BR>This is the 
                                grid 99% of WinForms actually 
                                need.<BR><BR>Whoever designed DataGridView 
                                should get a new job, outside of software 
                                development.<BR><BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1831604&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1831604&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1831604">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1831604">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1831604&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1831604 
                                style="WHITE-SPACE: nowrap">3.73/5 (7 votes)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(2519047,1831604,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1953956_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1953956xx></A><IMG height=16 alt=Question 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1953956#xx1953956xx" 
                        name=1953956>Re: Another approach</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3855356">Yahshuatwo</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:32 22 
                        Mar '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1953956_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Bamboozle:<BR><BR>How can your 
                                approach be done using 
                                dataadapters?<BR><BR><BR><IMG 
                                title="Poke tongue" 
                                src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/smiley_tongue.gif" 
                                align=top><BR><BR><BR>
                                <DIV 
                                class=ForumSig>yahshuatwo</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1953956&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1953956&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1831604">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1953956">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1953956&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1953956 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(3855356,1953956,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1743844_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1743844xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1743844#xx1743844xx" 
                        name=1743844>but if I have a query</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2897934">mhowin</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:20 6 
                        Nov '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1743844_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>in my project the datagridview is 
                                connected a one query.<BR>When i try to update 
                                my tableAdaptare, i receive this error:<BR>View 
                                or function 'MYQRY' is not updatable because the 
                                modification affects multiple base 
                                tables.<BR><BR>But my query is very 
                                simple!<BR>If i launch the query in sqlserver, 
                                it works correctly.<BR><BR>can someone help me? 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1743844&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1743844&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1743844">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1743844">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1743844&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1743844 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(2897934,1743844,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1954991_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1954991xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1954991#xx1954991xx" 
                        name=1954991>Re: but if I have a query</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3934509">JohnieBraaf</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">14:33 
                        22 Mar '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1954991_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>U have to Update each Data Adapter 
                                for each table seperatly!<BR>A data adapter can 
                                only contain 1 table, a dataset can contain 
                                multiple but cannot preform the update! 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1954991&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1954991&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1743844">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1954991">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1954991&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1954991 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(3934509,1954991,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1676926_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1676926xx></A><IMG height=16 alt=Question 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1676926#xx1676926xx" 
                        name=1676926>Database not getting Updated</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=904422">Jon 
                        Dwan</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:35 20 
                        Sep '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1676926_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I have a created the auto saving 
                                function, everything appears to be working 
                                correctly however when i view the contents of 
                                the database table the changes have not be 
                                replciated to the database file. I have coded a 
                                VB version and checked it against the C# example 
                                and they appear to be the same - i have included 
                                my code below.<BR><BR>Any help on this one would 
                                be greatly 
                                appreciated.<BR><BR>---------------------------------------------------------------------------------------------<BR><BR>Imports 
                                System.Data.SqlClient<BR><BR>Public Class 
                                myOptions<BR><BR>Private Sub 
                                myOptions_Load(ByVal sender As System.Object, 
                                ByVal e As System.EventArgs) Handles 
                                MyBase.Load<BR>'TODO: This line of code loads 
                                data into the 'ServicesDataSet.services' table. 
                                You can move, or remove it, as 
                                needed.<BR>Me.ServicesTableAdapter.Fill(Me.ServicesDataSet.services)<BR>End 
                                Sub<BR>Private Sub myOptions_FormClosed(ByVal 
                                sender As Object, ByVal e As 
                                System.Windows.Forms.FormClosedEventArgs) 
                                Handles 
                                Me.FormClosed<BR>Me.updateServiceDataRow()<BR>End 
                                Sub<BR><BR>Private servicesDataRow As DataRow = 
                                Nothing<BR><BR>Private Sub 
                                updateServiceDataRow()<BR>If Me.servicesDataRow 
                                IsNot Nothing Then<BR>If 
                                Me.servicesDataRow.RowState = 
                                DataRowState.Modified 
                                Then<BR>Me.servicesDataRow.Item("updated_timestamp") 
                                = 
                                Date.Now<BR>Me.servicesDataRow.Item("updated_user") 
                                = 
                                retrieveCurrentUser()<BR>Me.ServicesTableAdapter.Update(Me.servicesDataRow)<BR>Me.ServicesDataSet.Tables("services").AcceptChanges()<BR>End 
                                If<BR>End If<BR>End Sub<BR>Public Function 
                                retrieveCurrentUser() As String<BR>Dim 
                                userName<BR>Dim id As 
                                System.Security.Principal.WindowsIdentity = 
                                System.Security.Principal.WindowsIdentity.GetCurrent()<BR>userName 
                                = id.Name.ToString<BR>Return 
                                userName.Substring(userName.IndexOf("\") + 1, 
                                userName.ToString.Length - 
                                (userName.IndexOf("\") + 1))<BR>End 
                                Function<BR><BR>Private Sub 
                                ServicesBindingSource_PositionChanged(ByVal 
                                sender As Object, ByVal e As System.EventArgs) 
                                Handles 
                                ServicesBindingSource.PositionChanged<BR>Dim 
                                thisBindingSource As BindingSource = 
                                CType(sender, BindingSource)<BR>Dim thisDataRow 
                                As DataRow = CType(thisBindingSource.Current, 
                                DataRowView).Row<BR><BR>If 
                                thisDataRow.Equals(servicesDataRow) 
                                Then<BR>Throw New ApplicationException("Position 
                                Changed Event was fired twice for the same 
                                row")<BR>End 
                                If<BR><BR>Me.updateServiceDataRow()<BR>Me.servicesDataRow 
                                = thisDataRow<BR>End Sub<BR><BR>Private Sub 
                                btnNew_Click(ByVal sender As System.Object, 
                                ByVal e As System.EventArgs) Handles 
                                btnNew.Click<BR>Dim newRow As DataRow = 
                                Me.ServicesDataSet.Tables("services").NewRow<BR><BR>newRow("service_description") 
                                = ""<BR>newRow("service_status") = 
                                0<BR>newRow("created_timestamp") = 
                                Date.Now<BR>newRow("created_user") = 
                                retrieveCurrentUser()<BR><BR>Me.ServicesDataSet.Tables("services").Rows.Add(newRow)<BR><BR>End 
                                Sub<BR>Private Sub btnDelete_Click(ByVal sender 
                                As System.Object, ByVal e As System.EventArgs) 
                                Handles btnDelete.Click<BR>If 
                                Me.dgvServices.SelectedRows.Count = 0 
                                Then<BR>MessageBox.Show("Please select a record 
                                to remove.", "myScope", MessageBoxButtons.OK, 
                                MessageBoxIcon.Warning)<BR>Else<BR>Dim 
                                selectedRows As 
                                DataGridViewSelectedRowCollection = 
                                Me.dgvServices.SelectedRows<BR>Dim selectedRow 
                                As DataGridViewRow<BR><BR>For Each selectedRow 
                                In 
                                selectedRows<BR>Me.ServicesDataSet.Tables("services").Rows(selectedRow.Index).Delete()<BR>Next<BR><BR>Try<BR>Me.ServicesTableAdapter.Update(Me.ServicesDataSet.Tables("services"))<BR>Me.ServicesDataSet.Tables("services").AcceptChanges()<BR>Catch 
                                ex As Exception<BR>MessageBox.Show(ex.Message, 
                                "myScope", MessageBoxButtons.OK, 
                                MessageBoxIcon.Warning)<BR>Me.ServicesDataSet.RejectChanges()<BR>End 
                                Try<BR>End If<BR><BR>End Sub<BR>End 
                                Class<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1676926&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1676926&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1676926">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1676926">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1676926&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1676926 
                                style="WHITE-SPACE: nowrap">2.17/5 (3 votes)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(904422,1676926,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1771459_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1771459xx></A><IMG height=16 alt=Answer 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1771459#xx1771459xx" 
                        name=1771459>Re: Database not getting Updated</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3573174">C++reativeSoft</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:45 
                        22 Nov '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1771459_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Right ! You have the same 
                                manifeste with binding textboxes and 
                                datagridview. No updates, no changes and no 
                                adding data for Access and sqlserver databases. 
                                Only Visual C++ 7.0 works FINE. So you have the 
                                choice. If not you have to workaround by other 
                                methodes. like shown in this 
                                forum.<BR>C++reativeSoft<CODE></CODE> <BR><BR>
                                <DIV class=ForumSig>Only Visual C++ and C# 
                                dreams are allowed.</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1771459&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1771459&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1676926">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1771459">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1771459&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1771459 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(3573174,1771459,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1634413_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1634413xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1634413#xx1634413xx" 
                        name=1634413>I did in an other way</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1988458">inamgul</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:34 21 
                        Aug '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1634413_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hello,<BR>i incountered this 
                                problem and solved in another way.<BR><BR>I used 
                                the cell changed event in the datagrid and 
                                didn't care about whether the data in the cell 
                                is updated or not.<BR><BR>in my approach, for 
                                every move of cursor from one cell to another, i 
                                checked whether the new cell is in the current 
                                row or row is also changed.<BR>as the following 
                                code illustrates.<BR>private void 
                                dataGrid1_CurrentCellChanged(object sender, 
                                System.EventArgs e)<BR>{<BR>// If the row is 
                                changed, then save the data in the 
                                datagrid.<BR>cellChanged();<BR>}<BR><BR>and 
                                <BR><BR>void 
                                cellChanged()<BR>{<BR>if(prevCustRow!=dataGrid1.CurrentRowIndex)<BR>{<BR>prevCustRow 
                                = 
                                dataGrid1.CurrentRowIndex;<BR>saveCust();<BR>}<BR>}<BR><BR>This 
                                has solved my problem. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1634413&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1634413&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1634413">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1634413">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1634413&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1634413 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(1988458,1634413,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1600233_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1600233xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1600233#xx1600233xx" 
                        name=1600233>New record add</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1509128">hominoid</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:35 28 
                        Jul '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1600233_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>This strategy doesn't work when I 
                                want to provide adding new records to grid... 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1600233&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1600233&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1600233">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1600233">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1600233&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1600233 
                                style="WHITE-SPACE: nowrap">1.50/5 (3 votes)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(1509128,1600233,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1594918_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1594918xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1594918#xx1594918xx" 
                        name=1594918>Thanks! And ... here's a class to 
                        encapsulate it.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=612902">Jeff 
                        Roush</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:39 
                        25 Jul '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1594918_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I spent several hours yesterday 
                                struggling with how to do this. I saw the 
                                problems with handling several of the events 
                                mentioned above and in the comments before I ran 
                                across this article, but this article gave me 
                                the solution. Thanks!<BR><BR><BR>In my 
                                application, I've got a number of DataGridViews 
                                that each need to be udpated. So I made a helper 
                                class, GridDataUpdater, to encapsulate the 
                                update functions. <BR><BR>This simplifies the 
                                code a lot when you've got more than one 
                                DataGridView, so I thought I'd pass it 
                                on.<BR><BR>To use it, you have to create a new 
                                instance of GridDataUpdater for each bound 
                                DataGridView. Then you tell that instance which 
                                TableAdapter update command to use when it 
                                updates the row of data, and also assign its two 
                                event handlers to the BindingSource's 
                                PositionChanged event and the DataGridView's 
                                Leave event:<BR><BR><PRE>private GridDataUpdater tableUpdater<BR>...<BR><BR>private void initUpdateHandlers()<BR>{<BR>  tableUpdater = new GridDataUpdater();<BR>  tableUpdater.TableUpdateCommand = new GridDataUpdater.TableUpdateCommandDelegate(tableAdapter.Update);<BR>  theGridsBindingSource.PositionChanged += new EventHandler(tableUpdater.onBindingSource_PositionChanged);<BR>  theDataGridView.Leave += new EventHandler(tableUpdater.onDataGridView_Leave);<BR>}<BR></PRE><BR><BR>The 
                                GridDataUpdater class itself is:<BR><BR><PRE>    public class GridDataUpdater<BR>    {<BR>        public delegate void TableUpdateCommandDelegate(System.Data.DataRow row);<BR>        public TableUpdateCommandDelegate TableUpdateCommand;<BR><BR>        //tracks for PositionChanged event last row<BR>        private DataRow LastDataRow = null;<BR><BR>        /// <SUMMARY><BR>        /// Checks if there is a row with changes and writes it to the database<BR>        /// </SUMMARY><BR>        private void UpdateRowToDatabase()<BR>        {<BR>            if (LastDataRow != null)<BR>            {<BR>                if (LastDataRow.RowState == DataRowState.Modified)<BR>                {<BR>                    TableUpdateCommand(LastDataRow);<BR>                }<BR>            }<BR>        }<BR><BR>        private BindingSource thisBindingSource = null;<BR>        public void onBindingSource_PositionChanged( object sender, EventArgs e)<BR>        {<BR>            // if the user moves to a new row, check if the last row was changed<BR>            thisBindingSource = (BindingSource)sender;<BR>            if (thisBindingSource.Current == null)<BR>                return;<BR><BR>            DataRow ThisDataRow = ((DataRowView)thisBindingSource.Current).Row;<BR>            if (ThisDataRow == LastDataRow)<BR>                return;<BR><BR>            UpdateRowToDatabase();<BR>            // track the current row for next PositionChanged event<BR>            LastDataRow = ThisDataRow;<BR>        }<BR><BR>        public void onDataGridView_Leave(object sender, EventArgs e)<BR>        {<BR>            if (thisBindingSource == null)<BR>                return;<BR><BR>            DataGridView grid = (DataGridView)sender;<BR>            if (grid.IsCurrentRowDirty)<BR>            {<BR>                grid.EndEdit();<BR>                thisBindingSource.EndEdit();<BR>                UpdateRowToDatabase();<BR>            }<BR>            LastDataRow = null;<BR>        }<BR>    }<BR><BR></PRE><BR><BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1594918&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1594918&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1594918">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1594918">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1594918&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1594918 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(612902,1594918,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F1645657_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1645657xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1645657#xx1645657xx" 
                        name=1645657>Re: Thanks! And ... here's a class to 
                        encapsulate it.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2763189">stuallenii</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:11 
                        28 Aug '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1645657_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>thanks for the helper class, I had 
                                to make a change to the delegate 
                                signature:<BR><BR><CODE>public class 
                                GridDataUpdater<BR>{<BR>public delegate <B>int 
                                </B>TableUpdateCommandDelegate(System.Data.DataRow 
                                row);</CODE><BR><BR>I would gather that most 
                                typed dataset generic update methods return an 
                                int. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1645657&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1645657&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1594918">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1645657">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1645657&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1645657 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(2763189,1645657,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1542669_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1542669xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1542669#xx1542669xx" 
                        name=1542669>In addition to form's OnClose() 
                      event...</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=83466">DocX</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:03 
                        21 Jun '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1542669_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Good point about checking for a 
                                final update before the form containing the grid 
                                closes, but users may also need to ensure that 
                                the most recent grid change gets recorded when 
                                keeping the form open, but clicking to other 
                                controls on the form. In this case, the grid's 
                                "Leave" event can be used, since it fires when 
                                the grid loses focus (i.e. when it is no longer 
                                the active control on the form). <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1542669&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1542669&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1542669">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1542669">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1542669&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1542669 
                                style="WHITE-SPACE: nowrap">4.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(83466,1542669,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1578164_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1578164xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1578164#xx1578164xx" 
                        name=1578164>Re: In addition to form's OnClose() 
                        event...</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2687042">Jim 
                        Waverly</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:25 
                        14 Jul '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1578164_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I found this article very 
                                useful!<BR><BR>While using the Leave event, I 
                                noticed that the binding is not always updated 
                                when the gridview is left. To resolve this, I 
                                used the following code. Obviously, some of your 
                                variables will be different.<BR><BR><PRE><BR>    Private Sub dgvSources_Leave(ByVal sender As Object, ByVal e As System.EventArgs) Handles dgvSources.Leave<BR>        Dim Grid As DataGridView = sender<BR>        If Grid.IsCurrentRowDirty Then<BR>            Grid.EndEdit()<BR>            HltSourceBindingSource.EndEdit()<BR>            HltSourceTableAdapter.Update(HltSourceBindingSource.DataSource)<BR>        End If<BR>    End Sub<BR></PRE><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1578164&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1578164&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1542669">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1578164">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1578164&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1578164 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(2687042,1578164,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1484394_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1484394xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1484394#xx1484394xx" 
                        name=1484394>DataTable events can be used, I 
                      suppose</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1101679">lponiew</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">13:41 
                        11 May '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1484394_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>but in handler body that handler 
                                must be temporarily uwired (using -= operator), 
                                DataTable updated then handler wired (+=) again 
                                - it works for me. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1484394&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1484394&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1484394">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1484394">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1484394&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1484394 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVoteForm(1101679,1484394,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1543764_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1543764xx></A><IMG height=16 alt=General 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;select=1543764#xx1543764xx" 
                        name=1543764>Re: DataTable events can be used, I 
                        suppose</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=89645">fbachan</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:04 22 
                        Jun '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1543764_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Could you please put the code for 
                                this? Thnaks <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1543764&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261351&amp;select=1543764&amp;floc=/KB/database/DataGridView2Db.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;tid=1484394">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261351&amp;msg=1543764">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1543764&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1543764 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVoteForm(89645,1543764,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="C:\Documents and Settings\valley\Desktop\New Folder\CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Monday, June 9, 2008 5:35 AM &nbsp; &nbsp; 
                  Last Update:Thursday, June 12, 2008 8:22 AM</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><B>1</B> <A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/database/DataGridView2Db.aspx?fid=261351&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next 
      »</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 alt=General 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_general.gif" 
      width=16 align=top> General &nbsp;&nbsp; <IMG height=16 alt=News 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_news.gif" 
      width=16 align=top> News &nbsp;&nbsp; <IMG height=16 alt=Question 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_question.gif" 
      width=16 align=top> Question &nbsp;&nbsp; <IMG height=16 alt=Answer 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_answer.gif" 
      width=16 align=top> Answer &nbsp;&nbsp; <IMG height=16 alt=Joke 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_joke.gif" 
      width=16 align=top> Joke &nbsp;&nbsp; <IMG height=16 alt=Rant 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_rant.gif" 
      width=16 align=top> Rant &nbsp;&nbsp; <IMG height=16 alt=Admin 
      src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/msg_admin.gif" 
      width=16 align=top> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=12846">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy </A>| <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 26 Jan 2006<BR>Editor: <A 
            id=ctl00_ArticleEditor 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1823121">Rinish 
            Biju</A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2006 by Peter 
            Huber SG<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2008 
            <BR>Web10 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE>
      <CENTER></CENTER></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE><BR>
<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Auto Saving DataGridView Rows to a SQL Server Database_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
new HVMenu(new menu_NavbarConfig());
//]]></SCRIPT>
</BODY></HTML>
