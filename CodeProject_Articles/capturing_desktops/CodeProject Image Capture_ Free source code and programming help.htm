<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0056)http://www.codeproject.com/KB/graphics/imagecapture.aspx -->
<HTML><HEAD><TITLE>CodeProject: Image Capture. Free source code and programming help</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="An article about image capture.; Author: emxx; Section: General Graphics; Chapter: Multimedia" 
name=Description>
<META 
content=".NET 1.1, NT4, Win2K, VS.NET2003, C#, Dev, Intermediate,General Graphics,Multimedia,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject Image Capture_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject Image Capture_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Image Capture_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Image Capture_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

--></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
function MsgVoteForm(MemberID, MsgID) {
 document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ",1)\"%3E"));
 document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"absmiddle\" /%3E%3C/a%3E "));
 for (var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"give this message a vote of " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ")\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ",5)\"%3E"));
 document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" alt=\"vote 5\" border=\"0\" align=\"absmiddle\" /%3E%3C/a%3E "));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?") == true)
  return RateMsg(userid, msgid, score);
 else return false;
}
function RateMsg(memberid, msgid, score) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4) {
   if ( req.status == 200 ) {
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match)?match[1]:"An error occured" + unescape("%3C/b%3E");
   }
   else
   {
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
   }
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
--></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

--></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Image Capture_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK href="/favicon.ico" type=image/ico rel=icon><LINK href="/favicon.ico" 
type=image/ico rel="shortcut icon">
<SCRIPT type=text/javascript>
	function SetAsAvailable() {
	   var aid = document.getElementById("ArticleId");
	   if(aid)
		   window.location.href = "/script/Articles/UpdateArticleStatus.aspx?aid=" + articleId.value + "&rp=" + location.href;
	}
	</SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            height=90 alt=Home src="/Images/Standard/codeproject225x90.gif" 
            width=225 border=0></A></TD>
          <TD class=HeaderBanner align=right width="100%">
            <SCRIPT type=text/javascript>document.write("<a href=\"http://www.codeproject.com/Redir.aspx?adid=5008&way=ban\" target=\"_blank\" rel=\"nofollow\"><img src=\"http://www.codeproject.com/script/Ann/ServeImg.aspx?File=%2fscript%2fadmentor%2fimages%2fxoreax_808_leader_728x90.gif&C=False&id=5008\" alt=\"\" border=\"0\" width=\"728\" height=\"90\"></a>");</SCRIPT>
          </TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">4,881,172 
                  members and growing! (10,590 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">abdelrady2030</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx"><IMG 
                  height=16 src="/images/tools.gif" width=16 align=absMiddle 
                  border=0> <B>My Settings</B></A> | <A 
                  id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 src="/images/fave.gif" width=16 align=absMiddle 
                  border=0> My Bookmarks</A> | <A id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2fgraphics%2fimagecapture.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD><A href="http://www.codeproject.com/">Home</A></TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/?cat=1">All Topics</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=2">MFC/C++</A></TD>
                <TD noWrap><A 
                href="http://www.codeproject.com/?cat=3">C#</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=6">VB.NET</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=4">ASP.NET</A></TD>
                <TD noWrap><A 
                href="http://www.codeproject.com/?cat=9">SQL</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=8">Architect</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus><!--380-->
                  <DIV id=MenuPos 
                  style="WIDTH: 305px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=305>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A> 
            » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/graphics/">General Graphics</A> 
            » <A id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/graphics/index.aspx?#General Graphics - Graphics">Graphics</A> 
            <SPAN class=ArticleIntermediate 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Intermediate</SPAN> <SPAN 
            id=ctl00_ArticleTopHeader_LicenceTerms></SPAN><BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>Image 
            Capture</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=776266">emxx</A></B><BR><BR><SPAN 
            class=ArticleTopDescr id=ctl00_ArticleTopHeader_ArticleDescr>An 
            article about image capture.</SPAN> </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>C#, Windows, .NET, NT4, 
            Win2K, .NET 1.1, VS, VS.NET2003, Dev</SPAN><BR><BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>17 Feb 
            2004</B><BR><SPAN style="PADDING-RIGHT: 0.5ex">Updated</SPAN>: <B>17 
            Feb 2004</B> <BR><SPAN style="PADDING-RIGHT: 3.2ex">Views</SPAN>: 
            <B>87,475</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV style="PADDING-TOP: 5px; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write("<a href=\"http://www.codeproject.com/Redir.aspx?adid=3487&way=ban\" target=\"_blank\" rel=\"nofollow\"><img src=\"http://www.codeproject.com/script/Ann/ServeImg.aspx?File=%2fscript%2fadmentor%2fimages%2fcp_daily_150x80.gif&C=False&id=3487\" alt=\"\" border=\"0\" width=\"150\" height=\"80\"></a>");</SCRIPT>
      </DIV>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <DIV style="PADDING-TOP: 0px"><IMG 
      style="PADDING-RIGHT: 14px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 10px" 
      height=20 alt=Comp src="/script/Awards/Images/prize_winner.gif" width=10> 
      <A id=ctl00_Announcements_CompLink 
      href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
      Competition</A><BR clear=all>
      <DIV style="PADDING-BOTTOM: 5px; PADDING-TOP: 3px"><IMG 
      style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 8px" 
      height=16 alt=Staff src="/script/membership/images/staff_sm.gif" width=12> 
      <A href="http://www.codeproject.com/info/jobs/">We're Hiring!</A></DIV>
      <DIV style="PADDING-BOTTOM: 5px; PADDING-TOP: 3px"><IMG 
      style="PADDING-RIGHT: 0px; MARGIN-TOP: 3px; FLOAT: left; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px" 
      height=20 alt=Silverlight src="/images/silverlight_20.jpg" width=27> <A 
      href="http://www.codeproject.com/script/News/View.aspx?nwid=6024">Add 
      Silverlight to your articles</A></DIV></DIV></DIV>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV>
      <DIV></DIV><BR>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2 style="DISPLAY: none">
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">AJAX and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MI id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3>
      <DIV class=MI id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MIS id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4 style="DISPLAY: none">
      <DIV class=MI id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5 style="DISPLAY: none">
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/kb/showcase/">Product Showcase</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/Install">Installshield 
      2008</A></DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV><BR>
      <SCRIPT type=text/javascript>document.write("<a href=\"http://www.codeproject.com/Redir.aspx?adid=5044&way=ban\" target=\"_blank\" rel=\"nofollow\"><img src=\"http://www.codeproject.com/script/Ann/ServeImg.aspx?File=%2fscript%2fadmentor%2fimages%2fWhole_Tomato_VisastX_160x600_v1.gif&C=False&id=5044\" alt=\"The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you.\" border=\"0\" width=\"160\" height=\"600\"></a>");</SCRIPT>
      <IMG height=1 alt="" src="/script/Common/Images/t.gif" width=160> </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top>
            <TABLE>
              <TBODY></TBODY></TABLE>
            <TABLE cellSpacing=1 cellPadding=3 width=1 border=0>
              <TBODY>
              <TR class=smalltext vAlign=center>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt=print src="/script/Articles/Images/print.gif" 
                  width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
                  href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?display=Print">Print</A> 
                </TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt="Broken Article?" 
                  src="/script/Articles/Images/broken.gif" width=16> <A 
                  id=ctl00_ArticleHeaderLinks_BrokenLnk 
                  href="http://www.codeproject.com/script/Articles/Report.aspx?aid=6123">Broken 
                  Article?</A> </TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  id=ctl00_ArticleHeaderLinks_ArticleBmk_BookmarkImg 
                  title="Add to bookmarks" 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; WIDTH: 16px; BORDER-BOTTOM: 0px; HEIGHT: 16px" 
                  src="/script/Bookmarks/Images/link.png"> <A 
                  id=ctl00_ArticleHeaderLinks_ArticleBmk_BookmarkLnk 
                  href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=6123&amp;obtid=2">Add 
                  Bookmark</A> <SPAN 
                  id=ctl00_ArticleHeaderLinks_ArticleBmk_Message></SPAN></TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt=Discuss src="/script/Content/Images/discuss.gif" 
                  width=15> <A 
                  href="http://www.codeproject.com/KB/graphics/imagecapture.aspx#_comments">Discuss</A> 
                </TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt="Recommend Article" 
                  src="/script/Content/Images/mail.gif" width=16> <A 
                  id=ctl00_ArticleHeaderLinks_Recommend 
                  href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=6123">Send 
                  to a friend</A> </TD></TR></TBODY></TABLE></TD>
          <TD align=right>
            <TABLE>
              <TBODY>
              <TR>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
                  align=right><SPAN id=ctl00_ArticleRating_VoteLabel>24 votes 
                  for this Article.</SPAN> </TD>
                <TD>
                  <TABLE cellSpacing=0 cellPadding=0 border=1>
                    <TBODY>
                    <TR>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=20 
                      border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=20 
                      border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=20 
                      border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=20 
                      border=0></TD>
                      <TD noWrap width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=5 
                    border=0></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=ctl00_ArticleRating_PopularityRow>
                <TD class=SmallText align=right colSpan=2><A 
                  id=ctl00_ArticleRating_PopularityLnk 
                  title="Calculated as rating x Log10(# votes)" 
                  href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                  5.86</A><SPAN id=ctl00_ArticleRating_PopularityLbl></SPAN> 
                  Rating: <B>4.24</B> out of 5 
      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <UL class=Callout id=ctl00_confirmError style="MARGIN-RIGHT: 20px">
        <LI class=SmallText 
        style="LIST-STYLE-IMAGE: url(/images/warning.gif)">You are signed up for 
        one or more <A id=ctl00_SubscribeLink2 
        href="http://www.codeproject.com/script/Membership/Subscribe.aspx?rp=%2fKB%2fgraphics%2fimagecapture.aspx">newsletters</A> 
        but your email address is either unconfirmed, or has not been 
        reconfirmed in a long time. Please click <A id=ctl00_RequestConfirmLink2 
        href="http://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fKB%2fgraphics%2fimagecapture.aspx">here</A> 
        to have an email sent that will allow us to confirm your email address 
        and start sending you newsletters again.</LI></UL><SPAN id=intelliTXT>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/graphics/ImageCapture/ImageCapture_demo.zip">Download 
        demo project - 317 Kb</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/graphics/ImageCapture/ImageCapture_source.zip">Download 
        source - 336 Kb</A> </LI></UL>
      <P><IMG height=381 alt="Sample Image" src="ImageCapture/ImageCapture.gif" 
      width=397></P>
      <H2>Introduction</H2>
      <P>The following subjects are discussed in this article:</P>
      <OL>
        <LI>Capturing an image of the desktop or its work area. 
        <LI>Capturing an image of a control or its client area. 
        <LI>Capturing an image of what's underneath a control or its client 
        area. 
        <LI>Converting images from one format to another. 
        <LI>Converting an image to usable icon. </LI></OL>
      <H2>Background</H2>
      <P>Several C# and C++ articles are available discussing desktop capture. 
      This article generalizes from there and presents a testbed for loading, 
      capturing, and saving images in various graphical formats including 
      conversion of an image to a usable icon.</P>
      <P>Captured images are specified areas of GDI windows such as the desktop 
      or a GDI+ control. A GDI (Graphical Device Interface) window is specified 
      by a window handle. To operate on a GDI+ object (basically a .NET control) 
      using a GDI method, we need to use its GDI window handle. Fortunately, it 
      is available.</P><PRE lang=cs><SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  get a control's window handle for GDI manipulation
</SPAN>    ...
System.Windows.Forms.Control ctl = <SPAN class=code-keyword>new</SPAN> System.Windows.Forms.Control();
System.<SPAN class=code-SDKkeyword>IntPtr</SPAN> wndHandle = ctl.Handle;
    ...</PRE>
      <H2>Code Organization</H2>
      <P>The solution consists of two projects;</P>
      <OL>
        <LI>A C# library containing the capture methods (<I>Capture.cs</I>), \ 
        the interop methods (<I>Dll.cs</I>), as well as some debug and sound 
        methods, and 
        <LI>A testing form (<I>TestCapture.cs</I>) to exercise the capture 
        methods. </LI></OL>
      <H2>Module Dll.cs</H2>
      <P>This module defines entry points to methods contained in various DLLs. 
      To simplify access, a namespace called <CODE>Dll</CODE> is defined whose 
      class names are the same as the DLLs to be accessed. Each class then 
      defines the desired interop DLL entry points and equivalent C# 
methods.</P>
      <H3>Example class defining C# accessible entry points for a DLL</H3><PRE lang=cs>    ...
<SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> GDI32 dll access
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>/</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>class</SPAN> GDI32
{
  <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>const</SPAN> <SPAN class=code-keyword>int</SPAN> SRCCOPY = <SPAN class=code-digit>13369376</SPAN>;

  [DllImport(<SPAN class=code-string>"</SPAN><SPAN class=code-string>gdi32.dll"</SPAN>, EntryPoint=<SPAN class=code-string>"</SPAN><SPAN class=code-string>DeleteDC"</SPAN>)]
  <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>extern</SPAN> <SPAN class=code-SDKkeyword>IntPtr</SPAN> DeleteDC(<SPAN class=code-SDKkeyword>IntPtr</SPAN> hDc);

  [DllImport(<SPAN class=code-string>"</SPAN><SPAN class=code-string>gdi32.dll"</SPAN>, EntryPoint=<SPAN class=code-string>"</SPAN><SPAN class=code-string>DeleteObject"</SPAN>)]
  <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>extern</SPAN> <SPAN class=code-SDKkeyword>IntPtr</SPAN> DeleteObject(<SPAN class=code-SDKkeyword>IntPtr</SPAN> hDc);

  [DllImport(<SPAN class=code-string>"</SPAN><SPAN class=code-string>gdi32.dll"</SPAN>, EntryPoint=<SPAN class=code-string>"</SPAN><SPAN class=code-string>BitBlt"</SPAN>)]
  <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>extern</SPAN> <SPAN class=code-keyword>bool</SPAN> BitBlt(<SPAN class=code-SDKkeyword>IntPtr</SPAN> hdcDest,<SPAN class=code-keyword>int</SPAN> xDest,
             <SPAN class=code-keyword>int</SPAN> yDest,<SPAN class=code-keyword>int</SPAN> wDest,<SPAN class=code-keyword>int</SPAN> hDest,<SPAN class=code-SDKkeyword>IntPtr</SPAN> hdcSource,
             <SPAN class=code-keyword>int</SPAN> xSrc,<SPAN class=code-keyword>int</SPAN> ySrc,<SPAN class=code-keyword>int</SPAN> RasterOp);

  [DllImport(<SPAN class=code-string>"</SPAN><SPAN class=code-string>gdi32.dll"</SPAN>, EntryPoint=<SPAN class=code-string>"</SPAN><SPAN class=code-string>CreateCompatibleBitmap"</SPAN>)]
  <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>extern</SPAN> <SPAN class=code-SDKkeyword>IntPtr</SPAN> CreateCompatibleBitmap(<SPAN class=code-SDKkeyword>IntPtr</SPAN> hdc,
             <SPAN class=code-keyword>int</SPAN> nWidth, <SPAN class=code-keyword>int</SPAN> nHeight);

  [DllImport(<SPAN class=code-string>"</SPAN><SPAN class=code-string>gdi32.dll"</SPAN>, EntryPoint=<SPAN class=code-string>"</SPAN><SPAN class=code-string>CreateCompatibleDC"</SPAN>)]
  <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>extern</SPAN> <SPAN class=code-SDKkeyword>IntPtr</SPAN> CreateCompatibleDC(<SPAN class=code-SDKkeyword>IntPtr</SPAN> hdc);

  [DllImport(<SPAN class=code-string>"</SPAN><SPAN class=code-string>gdi32.dll"</SPAN>, EntryPoint=<SPAN class=code-string>"</SPAN><SPAN class=code-string>SelectObject"</SPAN>)]
  <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>extern</SPAN> <SPAN class=code-SDKkeyword>IntPtr</SPAN> SelectObject(<SPAN class=code-SDKkeyword>IntPtr</SPAN> hdc,<SPAN class=code-SDKkeyword>IntPtr</SPAN> bmp);
}                                           <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> end class GDI32
</SPAN>    ...</PRE>
      <P>Rather than directly accessing the interop methods from other projects, 
      access in this solution is isolated to the classes in the C# library such 
      as the <CODE>Capture</CODE> class.</P><PRE lang=cs><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>SUMMARY</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> Example of fully qualified Dll interop method access
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>/</SPAN><SPAN class=code-SummaryComment>SUMMARY</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN>    ...
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment>    release window and capture resources
</SPAN>  Dll.USER32.ReleaseDC(wndHWND,wndHDC);  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> release window context
</SPAN>  Dll.GDI32.DeleteDC(capHDC);            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> delete capture context
</SPAN>  Dll.GDI32.DeleteObject(capBMP);        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> delete capture bitmap
</SPAN>    ...</PRE>
      <H2>Module Capture.cs</H2>
      <H3>GDI Window Capture</H3>
      <P>The underlying method used by other capture methods is shown below. 
      This method captures an image within a specified rectangle within a 
      specified window. The window is specified by a GDI window handle. The 
      image is returned as a .NET bitmap.</P>
      <P>The method operates as follows. First, a window device context is 
      procured. Second, using the window device context, a compatible capture 
      device context is created, and a GDI bitmap is created and associated with 
      this capture device context. Third, the specified rectangle in the window 
      device context is copied to the capture device context thus populating the 
      GDI bitmap. Finally, the GDI bitmap is converted to a GDI+ bitmap and 
      returned to the caller.</P><PRE lang=cs><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> Captures the window or part thereof to a bitmap image.
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>/</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> Bitmap Window(<SPAN class=code-SDKkeyword>IntPtr</SPAN> wndHWND, 
             <SPAN class=code-keyword>int</SPAN> x, <SPAN class=code-keyword>int</SPAN> y, <SPAN class=code-keyword>int</SPAN> width, <SPAN class=code-keyword>int</SPAN> height)
{
  <SPAN class=code-SDKkeyword>IntPtr</SPAN>  wndHDC = USER32.GetDC(wndHWND);
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get context for window 
</SPAN>
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  create compatibile capture context and bitmap
</SPAN>  <SPAN class=code-SDKkeyword>IntPtr</SPAN>  capHDC = GDI32.CreateCompatibleDC(wndHDC);
  <SPAN class=code-SDKkeyword>IntPtr</SPAN>  capBMP = GDI32.CreateCompatibleBitmap(wndHDC, width, height);

  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  make sure bitmap non-zero
</SPAN>  <SPAN class=code-keyword>if</SPAN> (capBMP == <SPAN class=code-SDKkeyword>IntPtr</SPAN>.Zero)<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if no compatible bitmap
</SPAN>  {
    USER32.ReleaseDC(wndHWND,wndHDC); <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   release window context
</SPAN>    GDI32.DeleteDC(capHDC); <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   delete capture context
</SPAN>    <SPAN class=code-keyword>return</SPAN> <SPAN class=code-keyword>null</SPAN>; <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   return null bitmap
</SPAN>  }

  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  select compatible bitmap in compatible context
</SPAN>  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  copy window context to compatible context
</SPAN>  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  select previous bitmap back into compatible context
</SPAN>  <SPAN class=code-SDKkeyword>IntPtr</SPAN>  prvHDC = (<SPAN class=code-SDKkeyword>IntPtr</SPAN>)GDI32.SelectObject(capHDC,capBMP); 
  GDI32.BitBlt(capHDC,<SPAN class=code-digit>0</SPAN>,<SPAN class=code-digit>0</SPAN>,width,height,wndHDC,x,y,GDI32.SRCCOPY); 
  GDI32.SelectObject(capHDC,prvHDC);

  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  create GDI+ bitmap for window
</SPAN>  Bitmap  bmp = System.Drawing.Image.FromHbitmap(capBMP); 

  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  release window and capture resources
</SPAN>  USER32.ReleaseDC(wndHWND,wndHDC); <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> release window context
</SPAN>  GDI32.DeleteDC(capHDC); <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> delete capture context
</SPAN>  GDI32.DeleteObject(capBMP); <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> delete capture bitmap
</SPAN>
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  return bitmap image to user
</SPAN>  <SPAN class=code-keyword>return</SPAN> bmp;  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> return bitmap
</SPAN>}              <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> end method Window</SPAN></PRE>
      <H3>Desktop Capture</H3>
      <P>The desktop capture methods (<CODE>Desktop</CODE> and 
      <CODE>DesktopWA</CODE>) are shown below.</P>
      <P>Method <CODE>Desktop</CODE> captures the entire desktop. It picks up 
      the width and height of the desktop, a window handle for the desktop and 
      then uses capture method <CODE>Window</CODE> to return a bitmap of the 
      desktop. The width and height are procured using interop routines. This 
      information can also be attained using the method 
      <CODE>System.Windows.Forms.Screen.PrimaryScreen.Bounds</CODE>.</P>
      <P>Method <CODE>DesktopWA</CODE> captures the working area of the desktop. 
      It picks up the bounds of the desktop working area based on a specified 
      control in that working area and then uses capture method 
      <CODE>Window</CODE> to return a bitmap of the desktop.</P><PRE lang=cs><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> Captures the desktop to a bitmap image
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>/</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> Bitmap Desktop()
{
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> desktop width
</SPAN>  <SPAN class=code-keyword>int</SPAN>    width = USER32.GetSystemMetrics(USER32.SM_CXSCREEN);
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> desktop height
</SPAN>  <SPAN class=code-keyword>int</SPAN>    height = USER32.GetSystemMetrics(USER32.SM_CYSCREEN);
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> desktop window handle
</SPAN>  <SPAN class=code-SDKkeyword>IntPtr</SPAN> desktopHWND = USER32.GetDesktopWindow();
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> return desktop bitmap
</SPAN>  <SPAN class=code-keyword>return</SPAN> Window(desktopHWND,<SPAN class=code-digit>0</SPAN>,<SPAN class=code-digit>0</SPAN>,width,height);
} <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> end method Desktop
</SPAN>
<SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> Captures the desktop work area to a bitmap image
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>/</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> Bitmap DesktopWA(Control ctl)
{
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> desktop work area
</SPAN>  Rectangle wa = Screen.GetWorkingArea(ctl);
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> desktop window handle          
</SPAN>  <SPAN class=code-SDKkeyword>IntPtr</SPAN>    desktopHWND = USER32.GetDesktopWindow();
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> return work area bitmap
</SPAN>  <SPAN class=code-keyword>return</SPAN>    Window(desktopHWND,wa.X,wa.Y,wa.Width,wa.Height);
} <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> end method DesktopWA</SPAN></PRE>
      <H3>Control Capture</H3>
      <P>The control capture method is <CODE>Control</CODE>. The first method 
      <CODE>Control</CODE> captures the entire control. The second method 
      <CODE>Control</CODE> captures a specified portion of the control or what's 
      underneath the control.</P>
      <P>When capturing what's beneath a control, the desired area is converted 
      to screen coordinates and a window handle to the screen (desktop) is 
      utilized for the capture. The window handle for the control cannot be used 
      since the desired area is on the screen under the control. To perform this 
      capture and procure the desired bitmap, the control must be hidden prior 
      to capture.</P>
      <P>When capturing an area on the control, the desired area is converted to 
      control coordinates and a window handle for the control is utilized for 
      the capture.</P><PRE lang=cs><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> Captures the control to a bitmap image. The entire control is
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> captured including both the client and non-client areas.
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>/</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> Bitmap  Control(System.Windows.Forms.Control ctl)
{
  <SPAN class=code-keyword>return</SPAN> Control(ctl,<SPAN class=code-keyword>false</SPAN>,<SPAN class=code-keyword>false</SPAN>); <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> capture entire control
</SPAN>} <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> end method Control
</SPAN>
<SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> Captures the specified area of the control or whats underneath
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> the control. If the argument flag client is true, only the client
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> area of the control is captured, otherwise the entire control is 
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> captured. If the argument flag under is true, the capture area under
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> the control is captured, otherwise the specified area on the control
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> is captured.
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>/</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> Bitmap  Control(System.Windows.Forms.Control ctl
                             ,<SPAN class=code-keyword>bool</SPAN> client,<SPAN class=code-keyword>bool</SPAN> under)
{
  Bitmap    bmp;      <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> capture bitmap
</SPAN>  Rectangle ctlR;     <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> capture area in control coordinates
</SPAN>  Rectangle scrR;     <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> capture area in screen coordinates
</SPAN>  
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get capture rectangle in control
</SPAN>  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> coordinates and in screen coordinates
</SPAN>  <SPAN class=code-keyword>if</SPAN> (client)        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if capturing client area
</SPAN>  {
     <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   get rectangle in control coordinates
</SPAN>     ctlR = ctl.ClientRectangle;
     <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   get rectangle in screen coordinates
</SPAN>     scrR = ctl.RectangleToScreen(ctlR);
  }
  <SPAN class=code-keyword>else</SPAN>   <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if capturing entire control
</SPAN>  {
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   get rectangle in parent coordinates
</SPAN>    scrR = ctl.Bounds;
    <SPAN class=code-keyword>if</SPAN> (ctl.Parent != <SPAN class=code-keyword>null</SPAN>)  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   if parent exists
</SPAN>      <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>     map to screen coordinates
</SPAN>      scrR = ctl.Parent.RectangleToScreen(scrR);
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get rectangle in control coordinates
</SPAN>    ctlR = ctl.RectangleToClient(scrR);
  }
  
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> capture an area under the control
</SPAN>  <SPAN class=code-keyword>if</SPAN> (under)  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if capture area is under control
</SPAN>  {
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   save control visibility
</SPAN>    <SPAN class=code-keyword>bool</SPAN> prvV = ctl.Visible;
    <SPAN class=code-keyword>if</SPAN> (prvV)   <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   if control visible
</SPAN>    {
      <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>     make control invisible
</SPAN>      ctl.Visible = <SPAN class=code-keyword>false</SPAN>;
      <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>     allow time for control to vanish
</SPAN>      Thread.Sleep(m_HDelay);
    ) <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>     prior to image capture
</SPAN>
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  Capture bitmap using desktop window handle and screen coordinates
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  for the capture area. Note, the control window handle can NOT be used
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  for capturing an area under the control.
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   get window handle for desktop
</SPAN>    <SPAN class=code-SDKkeyword>IntPtr</SPAN>  desktopHWND = USER32.GetDesktopWindow();
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   get bitmap for capture area under control
</SPAN>    bmp = Window(desktopHWND,scrR);
    <SPAN class=code-keyword>if</SPAN> (ctl.Visible != prvV) <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   if control visibility was changed
</SPAN>      ctl.Visible = prvV;    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>     restore previous visibility
</SPAN>  }

  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  capture an area on the control
</SPAN>  <SPAN class=code-keyword>else</SPAN>  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if capture area not under control
</SPAN>  {
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  Capture bitmap using control window handle and control coordinates
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  for capture area.
</SPAN>    bmp = Window(ctl.Handle,ctlR);
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   get bitmap using control window handle
</SPAN>  }
  <SPAN class=code-keyword>return</SPAN> bmp;  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> return requested bitmap
</SPAN>}              <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> end method Control</SPAN></PRE>
      <H2>ImageCapture.cs</H2>
      <P>The image capture form allows images to be loaded, saved, captured, and 
      converted. It handles one image at a time and does not as yet include 
      image editing functions. It will, optionally, retain the aspect ratio of 
      an image. Load and save support a number of image formats allowing image 
      format conversion. And, images can be converted and saved as usable icons. 
      The form was used for testing, and has very elemental error checking and 
      recovery capabilities.</P>
      <H3>Image Capture</H3>
      <P>Action menu items control image capture. Desktop or desktop area image 
      capture is accomplished by clicking the appropriate action menu item, 
      "Capture Desktop" or "Capture Desktop Work Area" respectively.</P>
      <P>Partial desktop image captures are done using the viewport. The 
      viewport is the client area of the form. To use the viewport, it must 
      first be opened. This is done by clicking action menu item "Open 
      Viewport". Opening the viewport causes the form's transparency key to be 
      set to the background color of the form. This makes the area underneath 
      the client area of the form visible to the user. The user moves the form 
      over and sizes the form to encompass the desired selection. Capture of the 
      image is accomplished by clicking action menu item "Capture View". This 
      causes the view to be captured and the viewport to be closed.</P>
      <P>Prior to loading or capturing another image, the current image must be 
      saved or released. The action menu item "Release View" will dispose off 
      the current image.</P>
      <H3>Image Load</H3>
      <P>An image may be loaded from a file. For images other than icons, the 
      method <CODE>Image.FromFile</CODE> is utilized to input the image. This 
      method automatically detects the format of the image upon input, without 
      requiring the user to specify that format. The image is then converted to 
      a bitmap.</P>
      <P>Icons are special cased. Icons are input using the <CODE>Icon</CODE> 
      constructor, and then converted to a bitmap.</P><PRE lang=cs><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> Menu selection to load an image from a file.
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>/</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> miLoad_Click(<SPAN class=code-keyword>object</SPAN> sender, System.EventArgs e)
{
  <SPAN class=code-keyword>if</SPAN> (UnsavedBM())                         <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if unsaved image exists
</SPAN>    <SPAN class=code-keyword>return</SPAN>;                                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   return
</SPAN>  CloseViewport();                         <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> close viewport
</SPAN>
  DialogResult dr = ofd.ShowDialog(<SPAN class=code-keyword>this</SPAN>);  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> show the dialog
</SPAN>  <SPAN class=code-keyword>if</SPAN> (dr != DialogResult.OK)               <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if not ok
</SPAN>    <SPAN class=code-keyword>return</SPAN>;                                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   forget it
</SPAN>
  <SPAN class=code-keyword>string</SPAN> fn = ofd.FileName;                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> pick up file path
</SPAN>  <SPAN class=code-keyword>int</SPAN>    idx = fn.LastIndexOf(<SPAN class=code-string>"</SPAN><SPAN class=code-string>\\");       // get last backslash
  sfd.InitialDirectory = (idx &lt;= 0)? "</SPAN><SPAN class=code-string>"</SPAN><SPAN class=code-string> : fn.Substring(0,idx);
  sfd.FileName = fn;                       // make default for save
  Dispose(capBM);              // dispose of previous bitmap (if any)
    
  idx = fn.LastIndexOf("</SPAN>.<SPAN class=code-string>"</SPAN><SPAN class=code-string>) + 1;           // find start of extension
  string ext = (idx &gt; 0) &amp;&amp; (idx &lt; fn.Length)? fn.Substring(idx) : "</SPAN><SPAN class=code-string>"</SPAN><SPAN class=code-string>;
  if (ext.ToLower().Equals("</SPAN>ico<SPAN class=code-string>"</SPAN><SPAN class=code-string>))         // if file is an icon
  {
    this.Icon = new Icon(fn);              //   read new form icon from file
    capBM = this.Icon.ToBitmap();          //   convert to bitmap
  }
  else                                     // if file not an icon
    capBM = new Bitmap(Image.FromFile(fn));//   read bitmap from file

  PicInCtl(curCtl,false);   // place new image in current control
  capBMSaved = true;        // image has been saved, it came from a file
  Play("</SPAN>LoadView.wav<SPAN class=code-string>"</SPAN><SPAN class=code-string>);     // play load view sound
}                           // end action miLoad_Click</SPAN></PRE>
      <H3>Image Display</H3>
      <P>A loaded or captured image is manipulated internally as a 
      <CODE>Bitmap</CODE>. It should be noted that a <CODE>Bitmap</CODE> is 
      based on an <CODE>Image</CODE> and can thus be thought of as an image when 
      necessary. Essentially, the current image is displayed as the background 
      of the client area of the form. When the form is resized, the image is 
      resized to fit within its client area. If the image aspect ratio is being 
      preserved, the normal case, then an aspect sized version of the image will 
      be fit within the client area of the form. No image significance is lost 
      since the original bitmap is preserved.</P>
      <H3>Image Save</H3>
      <P>An image may be saved to a file. For images other than icons, the 
      <CODE>Bitmap</CODE> instance method <CODE>Save</CODE> is utilized to 
      output the image. This method supports a large number of image formats. 
      However, the image format must be explicitly specified when invoking 
      <CODE>Bitmap</CODE> instance method <CODE>Save</CODE>. A filter is used in 
      the save file dialog to allow the user to select the image format.</P><PRE lang=cs><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> Menu selection to save the image to a file.
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>/</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> miSave_Click(<SPAN class=code-keyword>object</SPAN> sender, System.EventArgs e)
{
  <SPAN class=code-keyword>if</SPAN> (capBM == <SPAN class=code-keyword>null</SPAN>)                       <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if no bitmap
</SPAN>    <SPAN class=code-keyword>return</SPAN>;                                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   return
</SPAN>  DialogResult dr = sfd.ShowDialog(<SPAN class=code-keyword>this</SPAN>);  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> show the dialog
</SPAN>  <SPAN class=code-keyword>if</SPAN> (dr != DialogResult.OK)               <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if not ok
</SPAN>    <SPAN class=code-keyword>return</SPAN>;                                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   forget it
</SPAN>
  <SPAN class=code-keyword>string</SPAN> fn = sfd.FileName;                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> pick up file path
</SPAN>  <SPAN class=code-keyword>if</SPAN> (fn.Equals(<SPAN class=code-string>"</SPAN><SPAN class=code-string>"</SPAN>))                       <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if no filename
</SPAN>  {
    Play(<SPAN class=code-string>"</SPAN><SPAN class=code-string>Error.wav"</SPAN>);                     <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   play nothing saved sound
</SPAN>    MessageBox.Show(<SPAN class=code-string>"</SPAN><SPAN class=code-string>No filename specified, nothing saved"</SPAN>);
    <SPAN class=code-keyword>return</SPAN>;
  }

  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> set default image type to selected filter format
</SPAN>  ImageType it = ImageType.SetImageType(sfd.FilterIndex-1);  
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> filter index is one based
</SPAN>  
  <SPAN class=code-keyword>if</SPAN> (it.format == ImageFormat.Icon)     <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if saving an icon
</SPAN>  {
    Icon = BitmapToIcon(capBM,aspect);   <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   convert bitmap to icon
</SPAN>    Stream s = sfd.OpenFile();           <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   open file
</SPAN>    Icon.Save(s);                        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   save the icon
</SPAN>    s.Close();                           <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   close file
</SPAN>  }
  <SPAN class=code-keyword>else</SPAN>                                   <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if saving other format
</SPAN>    capBM.Save(fn,it.format);            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   use generic image save
</SPAN>  capBMSaved = <SPAN class=code-keyword>true</SPAN>;                     <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> image has been saved
</SPAN>  Play(<SPAN class=code-string>"</SPAN><SPAN class=code-string>SaveView.wav"</SPAN>);                  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> play image saved sound
</SPAN>}                                        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> end action miSave_Click</SPAN></PRE>
      <H3>Image to Icon</H3>
      <P>An image may be saved as an icon. A usable icon is based on a small 
      bitmap. The maximum size of this bitmap is determined by display 
      resolution and color support. For the purposes of this demo, a display 
      supporting at least 256 colors or more was assumed. For this display 
      assumption, the maximum bitmap size is 96 by 96. Converting the image 
      bitmap to a bitmap for the icon is not a problem. However, preserving the 
      image aspect ratio is a problem.</P>
      <P>The choice made in this demo for icon aspect preservation was to drop 
      significance in the longest direction. In other words, a bitmap was formed 
      that was 96 pixels in the shortest direction and more than this in the 
      longest direction. The icon bitmap was then extracted from this bitmap 
      using a centering rectangle thus dropping some significance along both 
      outer edges for the longest direction. To preserve aspect without losing 
      significance, the image should be edited and/or cropped into a square. 
      This can be done in an external image editor since these features don't 
      currently exist in <I>ImageCapture</I>.</P><PRE lang=cs><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> Convert bitmap to icon preserving aspect if requested
</SPAN><SPAN class=code-SummaryComment>///</SPAN><SPAN class=code-comment> <SPAN class=code-SummaryComment>&lt;</SPAN><SPAN class=code-SummaryComment>/</SPAN><SPAN class=code-SummaryComment>summary</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>
</SPAN><SPAN class=code-keyword>private</SPAN> Icon BitmapToIcon(Bitmap obm,<SPAN class=code-keyword>bool</SPAN> preserve)
{
  Bitmap bm;
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  if not preserving aspect
</SPAN>  <SPAN class=code-keyword>if</SPAN> (!preserve)                         <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if not preserving aspect
</SPAN>    bm = <SPAN class=code-keyword>new</SPAN> Bitmap(obm,ICON_W,ICON_H);  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   rescale from original bitmap
</SPAN>
  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  if preserving aspect drop excess
</SPAN>  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  significance in least significant direction
</SPAN>  <SPAN class=code-keyword>else</SPAN>                           <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if preserving aspect
</SPAN>  {
    Rectangle rc = <SPAN class=code-keyword>new</SPAN> Rectangle(<SPAN class=code-digit>0</SPAN>,<SPAN class=code-digit>0</SPAN>,ICON_W,ICON_H);
    <SPAN class=code-keyword>if</SPAN> (obm.Width &gt;= obm.Height)  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   if width least significant
</SPAN>    {                            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  rescale width based on max icon height
</SPAN>      bm = <SPAN class=code-keyword>new</SPAN> Bitmap(obm,(ICON_H*obm.Width)/obm.Height,ICON_H);
      rc.X = (bm.Width - ICON_W) / <SPAN class=code-digit>2</SPAN>; <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> chop off excess width significance
</SPAN>      <SPAN class=code-keyword>if</SPAN> (rc.X &lt; <SPAN class=code-digit>0</SPAN>) rc.X = <SPAN class=code-digit>0</SPAN>;
    }
    <SPAN class=code-keyword>else</SPAN>                   <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   if height least significant
</SPAN>    {                      <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   rescale height based on max icon width
</SPAN>      bm = <SPAN class=code-keyword>new</SPAN> Bitmap(obm,ICON_W,(ICON_W*obm.Height)/obm.Width);
      rc.Y = (bm.Height - ICON_H) / <SPAN class=code-digit>2</SPAN>; <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> chop off excess height significance
</SPAN>      <SPAN class=code-keyword>if</SPAN> (rc.Y &lt; <SPAN class=code-digit>0</SPAN>) rc.Y = <SPAN class=code-digit>0</SPAN>;
    }
    bm = bm.Clone(rc,bm.PixelFormat); <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>   bitmap for icon rectangle
</SPAN>  }

  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>  create icon from bitmap
</SPAN>  Icon icon = Icon.FromHandle(bm.GetHicon()); <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> create icon from bitmap
</SPAN>  bm.Dispose();                               <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> dispose of bitmap
</SPAN>  <SPAN class=code-keyword>return</SPAN> icon;                                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> return icon
</SPAN>}                                             <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> end method BitmapToIcon</SPAN></PRE>
      <H2>Points of Interest</H2>
      <OL>
        <LI>Aspect Preservation - Abandoned Approach. Keying off form size 
        changes to then modify the client area of the form for aspect 
        preservation created an out of order resonating series of form size 
        changes that led to unfortunate behavior. Even though these issues were 
        eventually overcome, the approach was abandoned as too cumbersome. 
        <LI>GDI Window Handles - Since a GDI window handle can be used to conger 
        up the associated GDI+ control, using the 
        <CODE>Control.FromHandle</CODE> method, it seemed possible there might 
        be a GDI+ control available for the desktop that could be accessed using 
        this method. Of course, the results after testing this hypothesis were 
        disappointing. Although the test crashes were variously reported by the 
        debugger, no GDI+ control for the desktop was ever forthcoming using 
        this technique. 
        <LI>Image Beneath Control - Various methods were tested to gather the 
        image beneath a control. Timing issues arose during some of the early 
        tests. A variable delay was introduced to overcome this problem. The 
        code still has a 5ms delay to allow the control being hidden to drop out 
        of the desktop bitmap. This delay may no longer be required. More 
        testing needs to be done in this regard. </LI></OL>
      <H2>History</H2>
      <P>01/31/2004 - Initial release.</P><!-- Article Ends --><!-- Main Page Contents End --></DIV></SPAN>
      <H2>License</H2>
      <P>This article has no explicit license attached to it but may contain 
      usage terms in the article text or the download files themselves. If in 
      doubt please contact the author via the discussion board below.</P>
      <P>A list of licenses authors might use can be found <A 
      href="http://www.codeproject.com/info/Licenses.aspx">here</A></P>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=776266">emxx</A></B><BR><BR>
            <CENTER></CENTER><BR><SPAN class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>Don is a consultant specializing in advanced tools and software 
            for embedded applications.<BR><BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow>
                <TD class=SmallText noWrap>Occupation: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Web 
                  Developer</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt="United States" src="/script/Geo/Images/US.gif" 
                  width=16> United 
        States</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE id=ctl00_PopularArticlesRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular General Graphics articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/graphics/zedgraph.aspx">A 
              flexible charting library for .NET</A>
              <DIV class=SmallText>Looking for a way to draw 2D line graphs with 
              C#? Here's yet another charting class library with a high degree 
              of configurability, that is also easy to use.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/graphics/cximage.aspx">CxImage</A>
              <DIV class=SmallText>CxImage is a C++ class to load, save, 
              display, transform BMP, JPEG, GIF, PNG, TIFF, MNG, ICO, PCX, TGA, 
              WMF, WBMP, JBG, J2K images.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/graphics/julijanpiechart.aspx">3D 
              Pie Chart</A>
              <DIV class=SmallText>A class library for drawing 3D pie 
              charts.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/graphics/specialfx.aspx">Really 
              cool visual FX</A>
              <DIV class=SmallText>A set of classes for doing stunning visual 
              effects, including water, plasma and fire.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/graphics/ImageStone.aspx">ImageStone</A>
              <DIV class=SmallText>An article on a library for image 
              manipulation.</DIV></LI></UL>
            <H2></H2></TD>
          <TD><IFRAME 
            src="CodeProject Image Capture_ Free source code and programming help_files/ServeHTML.htm" 
            frameBorder=0 width=300 scrolling=no 
        height=250></IFRAME></TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
			var addtoMethod=1;
			var AddURL = document.location.href;
			var AddTitle = escape(document.title);
			DrawLinks(100, 0, "SmallText Bold", "AddTo") 
			</SCRIPT>
      </DIV>
      <TABLE class=RatingBar id=ctl00_RateArticleRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/graphics/imagecapture.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <FORM id=aspnetForm 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            name=aspnetForm action=imagecapture.aspx method=post>
            <DIV><INPUT id=__VIEWSTATE type=hidden 
            value=/wEPDwULLTEwMDUyNjYzMjhkZAErJkGgsTGj5SXNWB5XzUmGWDmz 
            name=__VIEWSTATE> </DIV>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD class=SmallText style="WHITE-SPACE: nowrap" align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px"><I><B>Rate this Article for 
                        us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
            <DIV><INPUT id=__EVENTVALIDATION type=hidden 
            value=/wEWCALuzISfDQLAlMXDBwLBlMXDBwLClMXDBwLDlMXDBwLElMXDBwLP+++tCwK5upDkC8K9b4e6kbgCoup6KFQFZkD+SAT9 
            name=__EVENTVALIDATION> </DIV></FORM></TD></TR></TBODY></TABLE>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center"><IFRAME 
      src="C:\Documents and Settings\admin\Desktop\qwe\CodeProject Image Capture_ Free source code and programming help_files\ServeHTML(1).htm" 
      frameBorder=0 width=468 scrolling=no height=60></IFRAME><IFRAME 
      src="CodeProject Image Capture_ Free source code and programming help_files/ServeLinks.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <FORM 
        action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fgraphics%2fimagecapture.aspx&amp;fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick 
        method=get>
        <TBODY>
        <TR>
          <TD><INPUT type=hidden value=33609 name=fid><INPUT type=hidden 
            value=?floc=%2fKB%2fgraphics%2fimagecapture.aspx&amp;fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick 
            name=currentQS><INPUT type=hidden 
            value=/KB/graphics/imagecapture.aspx name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 
                  src="/script/Forums/Images/forum_faq.gif" width=16 
                  align=absMiddle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 
                  src="/script/Forums/Images/forum_search.gif" width=16 
                  align=absMiddle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=33609">Search 
                  comments</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=submit></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 
                  src="/script/Forums/Images/forum_newmsg.gif" width=16 
                  align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;floc=/KB/graphics/imagecapture.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 18 of 18 (Total in Forum: 18) (<A 
                  href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><SPAN 
                  class=Frm_HL>Next</SPAN></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD><!-- Column Headers -->
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0>
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 src="/script/Forums/Images/t.gif" width=1 
                  border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=2332559_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2332559xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_question.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2332559#xx2332559xx" 
                        name=2332559>I need the help please in the 
                      following</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3369100">aishar</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">10:11 
                        23 Nov '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=2332559_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I use a code to draw using a 
                                window controls in a window form but when save 
                                the drawing the result is an empty yellow page 
                                how can I save please the code 
                                is:<BR><BR>[STAThread]<BR>static void Main() 
                                <BR>{<BR>Application.Run(new 
                                Form2());<BR>}<BR><BR><BR>// Keep track of when 
                                fake drag or resize mode is enabled.<BR>private 
                                bool isDragging = false;<BR>private bool 
                                isResizing = false;<BR><BR>// Store the location 
                                where the user clicked on the 
                                control.<BR>private int clickOffsetX, 
                                clickOffsetY;<BR><BR>private void 
                                lbl_MouseDown(object 
                                sender,System.Windows.Forms.MouseEventArgs 
                                e)<BR>{<BR>// Retrieve a reference to the active 
                                label.<BR>Control currentCtrl;<BR>currentCtrl = 
                                (Control)sender;<BR><BR>if (e.Button == 
                                MouseButtons.Right)<BR>{<BR>// Show the context 
                                menu.<BR>currentCtrl.ContextMenu.Show(currentCtrl, 
                                new Point(e.X, e.Y));<BR>}<BR>else if (e.Button 
                                == MouseButtons.Left)<BR>{<BR>clickOffsetX = 
                                e.X;<BR>clickOffsetY = e.Y;<BR><BR>if ((e.X + 5) 
                                &gt; currentCtrl.Width || (e.Y + 5) &gt; 
                                currentCtrl.Height)<BR>{<BR>// The mouse pointer 
                                is in the bottom right corner,<BR>// so resizing 
                                mode is appropriate.<BR>isResizing = 
                                true;<BR>}<BR>else<BR>{<BR>// The mouse is 
                                somewhere else, so dragging mode is<BR>// 
                                appropriate.<BR>isDragging = 
                                true;<BR>}<BR>}<BR>}<BR><BR>private void 
                                lbl_MouseMove(object sender, 
                                System.Windows.Forms.MouseEventArgs 
                                e)<BR>{<BR>// Retrieve a reference to the active 
                                shape.<BR>Control currentCtrl;<BR>currentCtrl = 
                                (Control)sender;<BR><BR>if 
                                (isDragging)<BR>{<BR>// Move the 
                                control.<BR>currentCtrl.Left = e.X + 
                                currentCtrl.Left - 
                                clickOffsetX;<BR>currentCtrl.Top = e.Y + 
                                currentCtrl.Top - clickOffsetY;<BR>}<BR>else if 
                                (isResizing)<BR>{<BR>// Resize the control, 
                                according to the resize mode.<BR>if 
                                (currentCtrl.Cursor == 
                                Cursors.SizeNWSE)<BR>{<BR>currentCtrl.Width = 
                                e.X;<BR>currentCtrl.Height = e.Y;<BR>}<BR>else 
                                if (currentCtrl.Cursor == 
                                Cursors.SizeNS)<BR>{<BR>currentCtrl.Height = 
                                e.Y;<BR>}<BR>else if (currentCtrl.Cursor == 
                                Cursors.SizeWE)<BR>{<BR>currentCtrl.Width = 
                                e.X;<BR>}<BR>}<BR>else<BR>{<BR>// Change the 
                                cursor if the mouse pointer is on one of the 
                                edges<BR>// of the control.<BR>if (((e.X + 5) 
                                &gt; currentCtrl.Width) &amp;&amp; <BR>((e.Y + 
                                5) &gt; 
                                currentCtrl.Height))<BR>{<BR>currentCtrl.Cursor 
                                = Cursors.SizeNWSE;<BR>}<BR>else if ((e.X + 5) 
                                &gt; 
                                currentCtrl.Width)<BR>{<BR>currentCtrl.Cursor = 
                                Cursors.SizeWE;<BR>}<BR>else if ((e.Y + 5) &gt; 
                                currentCtrl.Height)<BR>{<BR>currentCtrl.Cursor = 
                                Cursors.SizeNS;<BR>}<BR>else<BR>{<BR>currentCtrl.Cursor 
                                = Cursors.Arrow;<BR>}<BR>}<BR><BR>}<BR>private 
                                void lbl_MouseUp(object sender, 
                                System.Windows.Forms.MouseEventArgs 
                                e)<BR>{<BR>isDragging = false;<BR>isResizing = 
                                false;<BR>}<BR><BR>private void 
                                mnuColorChange_Click(object sender, 
                                System.EventArgs e)<BR>{<BR>// Show color 
                                dialog.<BR>ColorDialog dlgColor = new 
                                ColorDialog();<BR>dlgColor.ShowDialog();<BR><BR>// 
                                Change label 
                                background.<BR>mnuLabel.SourceControl.BackColor 
                                = dlgColor.Color;<BR><BR>}<BR><BR>private void 
                                DrawingShapes_MouseDown(object sender, 
                                System.Windows.Forms.MouseEventArgs 
                                e)<BR>{<BR>if (e.Button == 
                                MouseButtons.Right)<BR>{<BR>this.ContextMenu.Show(this, 
                                new Point(e.X, 
                                e.Y));<BR>}<BR><BR>}<BR><BR>private void 
                                mnuNewShape_Click(object sender, 
                                System.EventArgs e)<BR>{<BR>// Create and 
                                configure the shape with some defaults.<BR>Shape 
                                newShape = new Shape();<BR>newShape.Size = new 
                                Size(40, 40);<BR>newShape.ForeColor = 
                                Color.Coral;<BR><BR>// Configure the appropriate 
                                shape depending on the menu option 
                                selected.<BR>if (sender == 
                                mnuRectangle)<BR>{<BR>newShape.Type = 
                                Shape.ShapeType.Rectangle;<BR>}<BR>else if 
                                (sender == mnuEllipse)<BR>{<BR>newShape.Type = 
                                Shape.ShapeType.Ellipse;<BR>}<BR>else if (sender 
                                == mnuTriangle)<BR>{<BR>newShape.Type = 
                                Shape.ShapeType.Triangle;<BR>}<BR><BR>// To 
                                determine where to place the shape, you need to 
                                convert the <BR>// current screen-based mouse 
                                coordinates into relative form 
                                coordinates.<BR>newShape.Location = 
                                this.PointToClient(Control.MousePosition);<BR><BR>// 
                                Attach a context menu to the 
                                shape.<BR>newShape.ContextMenu = 
                                mnuLabel;<BR><BR>// Connect the shape to all its 
                                event handlers.<BR>newShape.MouseDown += new 
                                MouseEventHandler(lbl_MouseDown);<BR>newShape.MouseMove 
                                += new 
                                MouseEventHandler(lbl_MouseMove);<BR>newShape.MouseUp 
                                += new MouseEventHandler(lbl_MouseUp);<BR><BR>// 
                                Add the shape to the 
                                form.<BR>this.Controls.Add(newShape);<BR>}<BR><BR>private 
                                void mnuRemoveShape_Click(object sender, 
                                System.EventArgs e)<BR>{<BR>Shape ctrlShape = 
                                (Shape)mnuLabel.SourceControl;<BR>this.Controls.Remove(ctrlShape);<BR>}<BR><BR>private 
                                void DrawingShapes_Load(object sender, EventArgs 
                                e)<BR>{<BR>DrawArea = new 
                                Bitmap(this.ClientRectangle.Width, 
                                this.ClientRectangle.Height, 
                                System.Drawing.Imaging.PixelFormat.Format24bppRgb);<BR>InitializeDrawArea();<BR>Graphics 
                                xGraph; xGraph = Graphics.FromImage(DrawArea); 
                                // clear the drawing area to background color 
                                <BR>xGraph.Clear(Color.LightYellow);<BR><BR>}<BR>private 
                                void InitializeDrawArea()<BR>{ <BR>}<BR>private 
                                void saveToolStripMenuItem_Click(object sender, 
                                EventArgs e)<BR>{<BR>ImageFormat format = 
                                ImageFormat.Jpeg; <BR>SaveFileDialog sfd = new 
                                SaveFileDialog(); <BR>sfd.Filter = "JPEG 
                                Files(*.jpg)|*.jpg"; <BR>if (sfd.ShowDialog() == 
                                DialogResult.OK) <BR>{ // now save the image in 
                                the DrawArea <BR>DrawArea.Save( sfd.FileName, 
                                format ); }<BR>}<BR>}<BR>public class Shape : 
                                System.Windows.Forms.UserControl<BR>{<BR>// The 
                                types of shapes supported by this 
                                control.<BR>public enum 
                                ShapeType<BR>{<BR>Rectangle,<BR>Ellipse,<BR>Triangle<BR>}<BR><BR>private 
                                ShapeType shape = 
                                ShapeType.Rectangle;<BR>private GraphicsPath 
                                path = null;<BR><BR>public ShapeType 
                                Type<BR>{<BR>get<BR>{<BR>return 
                                shape;<BR>}<BR>set<BR>{<BR>shape = 
                                value;<BR>RefreshPath();<BR>this.Invalidate();<BR>}<BR>}<BR><BR>// 
                                Create the corresponding GraphicsPath for the 
                                shape, and apply<BR>// it to the control by 
                                setting the Region property.<BR>private void 
                                RefreshPath()<BR>{<BR>path = new 
                                GraphicsPath();<BR>switch (shape)<BR>{<BR>case 
                                ShapeType.Rectangle:<BR>path.AddRectangle(this.ClientRectangle);<BR>break;<BR>case 
                                ShapeType.Ellipse:<BR>path.AddEllipse(this.ClientRectangle);<BR>break;<BR>case 
                                ShapeType.Triangle:<BR>Point pt1 = new 
                                Point(this.Width / 2, 0);<BR>Point pt2 = new 
                                Point(0, this.Height);<BR>Point pt3 = new 
                                Point(this.Width, 
                                this.Height);<BR>path.AddPolygon(new Point[] 
                                {pt1, pt2, pt3});<BR>break;<BR>}<BR>this.Region 
                                = new Region(path);<BR>}<BR><BR>protected 
                                override void OnResize(System.EventArgs 
                                e)<BR>{<BR>base.OnResize(e);<BR>RefreshPath();<BR>this.Invalidate();<BR>}<BR><BR>protected 
                                override void 
                                OnPaint(System.Windows.Forms.PaintEventArgs 
                                e)<BR>{<BR>base.OnPaint(e);<BR>if (path != 
                                null)<BR>{<BR>e.Graphics.SmoothingMode = 
                                SmoothingMode.AntiAlias;<BR>e.Graphics.FillPath(new 
                                SolidBrush(this.BackColor), 
                                path);<BR>e.Graphics.DrawPath(new 
                                Pen(this.ForeColor, 4), 
                                path);<BR>}<BR>}<BR><BR>} <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=2332559&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=2332559&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2332559">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=2332559">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2332559&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2332559 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(3369100,2332559);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=2055282_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2055282xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2055282#xx2055282xx" 
                        name=2055282>poor icon</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=856406"><FONT 
                        color=#008800><B>Muammar©</B></FONT></A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:36 27 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=2055282_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi, can you tell me why do i get a 
                                very poor quality icon when i save it??, it 
                                looks fine before that (as im displaying it in a 
                                picture box before saving it as a 
                                stream)<BR><BR>Thanx<IMG 
                                src="/script/Forums/Images/smiley_smile.gif" 
                                align=absMiddle> <BR><BR>
                                <DIV class=ForumSig>
                                <HR>
                                <FONT face="Comic Sans MS" color=#3300aa 
                                size=2>Smile: A curve that can set a lot of 
                                things straight!</FONT><FONT face=Arial 
                                size=4><BR>(\ 
                                /)<BR>(O.o)<BR>(&gt;&lt;)</FONT></DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=2055282&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=2055282&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2055282">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=2055282">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2055282&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2055282 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(856406,2055282);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=2078991_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2078991xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2078991#xx2078991xx" 
                        name=2078991>Re: poor icon</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=776266">emxx</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">16:52 
                        12 Jun '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=2078991_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>When a bitmap or image is saved as 
                                an icon a conversion takes place. An icon has 
                                relatively very few pixels of information as 
                                compared to the original image. For best results 
                                when converting to an icon, you want an original 
                                image that has high contrast between light and 
                                dark areas. To do this you may want to edit the 
                                orignal image, or convert to an icon and then 
                                edit the icon.<BR><BR><BR>
                                <DIV class=ForumSig>Don is a consultant 
                                specializing in advanced tools and software for 
                                embedded applications.<BR></DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=2078991&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=2078991&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2055282">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=2078991">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2078991&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2078991 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(776266,2078991);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=1696054_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1696054xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1696054#xx1696054xx" 
                        name=1696054>hidden windows</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3204197">kajok</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:13 3 
                        Oct '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1696054_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Do you know of any way to capture 
                                a control without bringing it to the front of 
                                the screen and letting it remain partially or 
                                completely unseen.<BR>Bringing a window to the 
                                front takes too long for my application. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1696054&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1696054&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1696054">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1696054">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1696054&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1696054 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(3204197,1696054);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote HdUnSel " id=1697725_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1697725xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1697725#xx1697725xx" 
                        name=1697725>Re: hidden windows</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=776266">emxx</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:21 4 
                        Oct '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1697725_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>In .NET V2 controls include the 
                                following method: 
                                System.Windows.Forms.Control.DrawToBitmap(System.Drawing.Bitmap, 
                                System.Drawing.Rectangle).<BR><BR>This method 
                                allows a control, or a portion thereof, to be 
                                drawn to a bitmap. I haven't as yet specifically 
                                investigated this method, so I don't know if it 
                                brings the control to the front or even if the 
                                control needs to be visible to successfully 
                                capture the control's image. The brief 
                                documentation seems to imply that it would 
                                work.<BR><BR>In any event I would experiment 
                                with this method as part of your investigation 
                                into resolving your issue.<BR><BR><BR><BR>
                                <DIV class=ForumSig>Don consults with Embedded 
                                Excellence specializing in advanced tools and sw 
                                for embedded applications.</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1697725&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1697725&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1696054">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1697725">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1697725&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1697725 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(776266,1697725);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1730519_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx1730519xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1730519#xx1730519xx" 
                        name=1730519>Re: hidden windows</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3200844">domini_harling</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:10 
                        27 Oct '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1730519_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>emxx wrote:</DIV>In .NET V2 
                                controls include the following method: 
                                System.Windows.Forms.Control.DrawToBitmap(System.Drawing.Bitmap, 
                                System.Drawing.Rectangle).</BLOCKQUOTE><BR><BR>I 
                                experimented with this method and it works as 
                                advertised. It captures a control to a bitmap, 
                                even if it is hidden. So there is no more need 
                                for a platform invoke.<BR><BR>Thanks for 
                                pointing this method 
                                out.<BR><BR><BR><BR>Dom<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1730519&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1730519&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1696054">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1730519">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1730519&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1730519 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(3200844,1730519);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=1823719_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx1823719xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1823719#xx1823719xx" 
                        name=1823719>Re: hidden windows</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3009993">Melatonin</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:05 1 
                        Jan '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1823719_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>This works for controls, but what 
                                if you want to capture an ActiveX control (which 
                                does not extend the DrawToBitmap() method? I was 
                                also wondering if there is any way to capture a 
                                control even if it happens to be much larger (up 
                                to 20 or 30 times larger than the screen). I 
                                have an ActiveX control with graphical data, and 
                                I set its size to be huge (20 or 30 times larger 
                                than the screen and the form). I then want to 
                                capture it after it has been resized, but I 
                                don't want to show the ActiveX control while I 
                                am doing it. This would result in a huge bitmap 
                                (several hundred megabytes) which is what I 
                                want. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1823719&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1823719&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1696054">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1823719">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1823719&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1823719 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(3009993,1823719);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1878293_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx1878293xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1878293#xx1878293xx" 
                        name=1878293>Re: hidden windows</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3746513">Pavel 
                        Rubanov</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:47 5 
                        Feb '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1878293_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I`m play around capture with NET2 
                                vs pinvoke, and find that the most suitable for 
                                capture gdi windows is used you pinvoke`s with 
                                one 
                                replacement:<BR>replace<BR>GDI32.BitBlt(capHDC,0,0,width,height,wndHDC,x,y,GDI32.SRCCOPY); 
                                <BR>to<BR>BOOL PrintWindow(<BR>HWND hwnd, // 
                                Window to copy<BR>HDC hdcBlt, // HDC to print 
                                into<BR>UINT nFlags // Optional 
                                flags<BR>);<BR><BR>It`s able to me make shots 
                                from every visible not minimised window, even if 
                                partial window visible on the screen (because 
                                PrintWindow() kick window to draw itself to 
                                pointed 
                                dc).<BR>System.Windows.Forms.Control.DrawToBitmap() 
                                of NET2 act alike, but with sending WM_PRINT 
                                itself (for some reason I can`t achieve any 
                                result with WM_PRINT or WM_PRINTCLIENT insted of 
                                PrintWindow()).<BR><BR>Thanks, Pavel 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1878293&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1878293&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1696054">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1878293">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1878293&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1878293 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(3746513,1878293);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=2043193_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2043193xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2043193#xx2043193xx" 
                        name=2043193>Re: hidden windows</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=531923">lalitkale</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:28 18 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=2043193_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>What to say about this!<BR><BR>Its 
                                awesome dude!<BR><BR>This one line suggested by 
                                you have saved lots of hairs from my head<IMG 
                                src="/script/Forums/Images/smiley_tongue.gif" 
                                align=absMiddle><BR><BR>Seriously A million 
                                thanks <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=2043193&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=2043193&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1696054">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=2043193">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2043193&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2043193 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(531923,2043193);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=1292816_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1292816xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1292816#xx1292816xx" 
                        name=1292816>Capturing Image of Minimized Window</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2207884">IslamianFalcon</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:32 30 
                        Nov '05 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1292816_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Dear,<BR>is it possible to capture 
                                the image of window who is minimized. i got the 
                                handle of window+device context using pinvoke in 
                                C#. i use the following 
                                functions.<BR>FindWindow();<BR>GetWindowDC();<BR>CreateCompatibleDC();<BR>CreateCompatibleBitmap();<BR>in 
                                C#. but can't succeed to get the image of that 
                                window who is minimized, anyone can help 
                                me........<BR>Regards,<BR>Shahbaz. 
<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1292816&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1292816&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1292816">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1292816">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1292816&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1292816 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2207884,1292816);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=2084487_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2084487xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2084487#xx2084487xx" 
                        name=2084487>Re: Capturing Image of Minimized 
                      Window</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=634640">dmihailescu</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">10:14 
                        15 Jun '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=2084487_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>You've got to make the window 
                                visible.<BR>Use ShowWindow(SW_Restore) before 
                                GetWindowDC();<BR>You might find something 
                                usefull at <A 
                                href="http://www.codeproject.com/useritems/snapshot.asp">here</A>[<A 
                                title="New Window" 
                                href="http://www.codeproject.com/useritems/snapshot.asp" 
                                target=_blank>^</A>] <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=2084487&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=2084487&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1292816">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=2084487">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2084487&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2084487 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(634640,2084487);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=1257832_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1257832xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_question.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1257832#xx1257832xx" 
                        name=1257832>Capture of video image</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor>Sensei76</TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:40 19 
                        Oct '05 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1257832_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello, great job!<BR><BR>But while 
                                experimenting with the demo project I found the 
                                following problem:<BR>I need make a screenshot 
                                of a form (or better: just the parent control 
                                which displays the video) while playing a MPEG2 
                                video file. In most cases I get a black square 
                                at the region of the video. The same goes for 
                                MPEG1 or MPEG4 formats.<BR><BR>Surprisingly it 
                                works fine with the same MPEG2 video file after 
                                it has been converted to a constant bitrate. In 
                                this case, the screenshot shows the correct 
                                image of the current video frame.<BR><BR>Even 
                                more surprising, AFTER I made a successful shot 
                                of this video, I can make shots of the other 
                                formats, too!<BR><BR>Can anybody explain 
                                this?<BR><BR>-- modified at 5:38 Thursday 20th 
                                October, 2005<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1257832&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1257832&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1257832">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1257832">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1257832&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt style="TEXT-ALIGN: right"><A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1257832&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=m">Edit</A>·<A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1257832&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=d">Delete</A><BR><SPAN 
                                id=MVF1257832 style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(-1,1257832);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1330482_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1330482xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_answer.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1330482#xx1330482xx" 
                        name=1330482>Re: Capture of video image</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2600084">photonics</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:58 10 
                        Jan '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1330482_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Dear sir.<BR>you must turn off the 
                                hardware acceleration. <BR><BR>Go to the Start 
                                Menu and select Settings-&gt;Control Panel. 
                                <BR>From the list view, select Display 
                                Properties and select the last page titled 
                                Settings. <BR>Find the Advanced button and then 
                                choose "Troubleshooting". <BR>There you will 
                                find a slider control for hardware acceleration. 
                                Move that slider to None, then click OK button. 
                                <BR><BR><BR><BR>MMp<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1330482&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1330482&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1257832">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1330482">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1330482&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1330482 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2600084,1330482);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=1200213_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1200213xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1200213#xx1200213xx" 
                        name=1200213>l256 color icons</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1047255">Qruk</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:06 19 
                        Aug '05 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1200213_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi<BR>I have this problem. I use 
                                icon as internal Embeded Resource. I want to 
                                convert icon created from this resource to 
                                bitmap (i use ToBitmap method). Everything is 
                                allright when i use 16 color icons. When i use 
                                256 color icons, i loose information about 
                                transparent color. <BR>Can anybody tell why ? 
                                <BR><BR>Qruk<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1200213&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1200213&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1200213">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1200213">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1200213&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1200213 
                                style="WHITE-SPACE: nowrap">2.00/5 (2 votes)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1047255,1200213);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote Rt HdUnSel " id=1193382_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1193382xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1193382#xx1193382xx" 
                        name=1193382>managed code</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=741754">shinobumono</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:31 12 
                        Aug '05 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1193382_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Is there nothing in the framework 
                                so that we can do that all with managed code? 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1193382&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1193382&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1193382">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1193382">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1193382&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1193382 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(741754,1193382);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=1173096_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1173096xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1173096#xx1173096xx" 
                        name=1173096>Saving GDI control as image.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2094617">jay.gosavi</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:39 25 
                        Jul '05 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1173096_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>The code u have given is 
                                excelent.. But thing is if i want to save gdi 
                                form as an image on button click provided my 
                                form is in minimse state.. it should give me 
                                whole form as image.. <BR>Can somebody help me 
                                out.. <BR><BR>Jay<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1173096&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1173096&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1173096">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1173096">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1173096&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1173096 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2094617,1173096);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote Rt HdUnSel " id=1125084_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1125084xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1125084#xx1125084xx" 
                        name=1125084>Control Capture</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor>faze79</TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:01 3 
                        Jun '05 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1125084_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi, Great work! I try using your 
                                code for getting an image from a control. 
                                Unfortunately when an other window (not parent) 
                                is displayed over my control, on the resulting 
                                bitmap it is present. How can i grab an image 
                                from my control and his soon without any other 
                                window?<BR>Bye FAZE <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1125084&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1125084&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1125084">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=1125084">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1125084&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt style="TEXT-ALIGN: right"><A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1125084&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=m">Edit</A>·<A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=1125084&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=d">Delete</A><BR><SPAN 
                                id=MVF1125084 style="WHITE-SPACE: nowrap">5.00/5 
                                (2 votes)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(-1,1125084);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=801862_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx801862xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=801862#xx801862xx" 
                        name=801862>Convert bitmap from 24bit color to 256 
                        color</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1039125">MDM_RVS</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">17:28 
                        24 Apr '04 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=801862_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>how i can convert the value of 
                                each pixel of the bitmap i have from 24 bit to 
                                256 color <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=801862&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=33609&amp;select=801862&amp;floc=/KB/graphics/imagecapture.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/graphics/imagecapture.aspx?fid=33609&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=801862">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=33609&amp;msg=801862">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=801862&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF801862 
                                style="WHITE-SPACE: nowrap">2.60/5 (5 votes)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1039125,801862);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 src="/script/Forums/Images/t.gif" width=1 
                  border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Sunday, March 2, 2008 2:07 AM &nbsp; &nbsp; 
                  Last Update:Sunday, March 2, 2008 2:07 AM</TD>
                <TD 
              style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 
      src="/script/Forums/Images/msg_general.gif" width=16 align=absMiddle> 
      General &nbsp;&nbsp; <IMG height=16 
      src="/script/Forums/Images/msg_news.gif" width=16 align=absMiddle> News 
      &nbsp;&nbsp; <IMG height=16 src="/script/Forums/Images/msg_question.gif" 
      width=16 align=absMiddle> Question &nbsp;&nbsp; <IMG height=16 
      src="/script/Forums/Images/msg_answer.gif" width=16 align=absMiddle> 
      Answer &nbsp;&nbsp; <IMG height=16 
      src="/script/Forums/Images/msg_joke.gif" width=16 align=absMiddle> Joke 
      &nbsp;&nbsp; <IMG height=16 src="/script/Forums/Images/msg_admin.gif" 
      width=16 align=absMiddle> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=6123">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy </A>| <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 17 Feb 2004<BR>Editor: <A 
            id=ctl00_ArticleEditor 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=28970">Smitha 
            Vijayan</A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2004 by 
            emxx<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 
            1999-2008<BR>Web15 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE>
<SCRIPT language=Javascript 
src="CodeProject Image Capture_ Free source code and programming help_files/front.asp" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
--></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Image Capture_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Image Capture_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Image Capture_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
new HVMenu(new menu_NavbarConfig());
--></SCRIPT>
</BODY></HTML>
