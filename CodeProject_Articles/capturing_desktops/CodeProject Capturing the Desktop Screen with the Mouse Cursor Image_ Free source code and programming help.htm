<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0061)http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx -->
<HTML><HEAD><TITLE>CodeProject: Capturing the Desktop Screen with the Mouse Cursor Image. Free source code and programming help</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="This artcile shows how to capture a desktop screenshot with the mouse cursor included.; Author: Rashid.Mahmood; Section: C#; Chapter: Languages" 
name=Description>
<META 
content=".NET 2.0, Win2K, WinXP, VS2005, C#, GDI+, Dev, Intermediate,C#,Languages,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

--></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
function MsgVoteForm(MemberID, MsgID) {
 document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ",1)\"%3E"));
 document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"absmiddle\" /%3E%3C/a%3E "));
 for (var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"give this message a vote of " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ")\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ",5)\"%3E"));
 document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" alt=\"vote 5\" border=\"0\" align=\"absmiddle\" /%3E%3C/a%3E "));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?") == true)
  return RateMsg(userid, msgid, score);
 else return false;
}
function RateMsg(memberid, msgid, score) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4) {
   if ( req.status == 200 ) {
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match)?match[1]:"An error occured" + unescape("%3C/b%3E");
   }
   else
   {
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
   }
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
--></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

--></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK href="/favicon.ico" type=image/ico rel=icon><LINK href="/favicon.ico" 
type=image/ico rel="shortcut icon">
<SCRIPT type=text/javascript>
	function SetAsAvailable() {
	   var aid = document.getElementById("ArticleId");
	   if(aid)
		   window.location.href = "/script/Articles/UpdateArticleStatus.aspx?aid=" + articleId.value + "&rp=" + location.href;
	}
	</SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            height=90 alt=Home src="/Images/Standard/codeproject225x90.gif" 
            width=225 border=0></A></TD>
          <TD class=HeaderBanner align=right width="100%">
            <SCRIPT type=text/javascript>document.write("<a href=\"http://www.codeproject.com/Redir.aspx?adid=5038&way=ban\" target=\"_blank\" rel=\"nofollow\"><img src=\"http://www.codeproject.com/script/Ann/ServeImg.aspx?File=%2fscript%2fadmentor%2fimages%2fWholeTomato_RefRename_728x90.gif&C=False&id=5038\" alt=\"The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you.\" border=\"0\" width=\"728\" height=\"90\"></a>");</SCRIPT>
          </TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">4,881,172 
                  members and growing! (10,383 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">abdelrady2030</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx"><IMG 
                  height=16 src="/images/tools.gif" width=16 align=absMiddle 
                  border=0> <B>My Settings</B></A> | <A 
                  id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 src="/images/fave.gif" width=16 align=absMiddle 
                  border=0> My Bookmarks</A> | <A id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2fcs%2fDesktopCaptureWithMouse.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD><A href="http://www.codeproject.com/">Home</A></TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/?cat=1">All Topics</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=2">MFC/C++</A></TD>
                <TD noWrap><A 
                href="http://www.codeproject.com/?cat=3">C#</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=6">VB.NET</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=4">ASP.NET</A></TD>
                <TD noWrap><A 
                href="http://www.codeproject.com/?cat=9">SQL</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=8">Architect</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus><!--380-->
                  <DIV id=MenuPos 
                  style="WIDTH: 305px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=305>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A> 
            » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/cs/">C#</A> » <A 
            id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/cs/index.aspx?#C - How To">How 
            To</A> <SPAN class=ArticleIntermediate 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Intermediate</SPAN> <SPAN 
            id=ctl00_ArticleTopHeader_LicenceTerms></SPAN><BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>Capturing the Desktop Screen 
            with the Mouse Cursor Image</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2363661">Rashid.Mahmood</A></B><BR><BR><SPAN 
            class=ArticleTopDescr id=ctl00_ArticleTopHeader_ArticleDescr>This 
            artcile shows how to capture a desktop screenshot with the mouse 
            cursor included.</SPAN> </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>C#, Windows, .NET, 
            Win2K, WinXP, .NET 2.0, VS, GDI+, VS2005, Dev</SPAN><BR><BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>27 Jan 
            2006</B><BR><SPAN style="PADDING-RIGHT: 0.5ex">Updated</SPAN>: <B>27 
            Jan 2006</B> <BR><SPAN style="PADDING-RIGHT: 3.2ex">Views</SPAN>: 
            <B>40,654</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV style="PADDING-TOP: 5px; TEXT-ALIGN: center"><IFRAME 
      src="CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files/ServeHTML.htm" 
      frameBorder=0 width=150 scrolling=no height=80></IFRAME></DIV>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <DIV style="PADDING-TOP: 0px"><IMG 
      style="PADDING-RIGHT: 14px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 10px" 
      height=20 alt=Comp src="/script/Awards/Images/prize_winner.gif" width=10> 
      <A id=ctl00_Announcements_CompLink 
      href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
      Competition</A><BR clear=all>
      <DIV style="PADDING-BOTTOM: 5px; PADDING-TOP: 3px"><IMG 
      style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 8px" 
      height=16 alt=Staff src="/script/membership/images/staff_sm.gif" width=12> 
      <A href="http://www.codeproject.com/info/jobs/">We're Hiring!</A></DIV>
      <DIV style="PADDING-BOTTOM: 5px; PADDING-TOP: 3px"><IMG 
      style="PADDING-RIGHT: 0px; MARGIN-TOP: 3px; FLOAT: left; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px" 
      height=20 alt=Silverlight src="/images/silverlight_20.jpg" width=27> <A 
      href="http://www.codeproject.com/script/News/View.aspx?nwid=6024">Add 
      Silverlight to your articles</A></DIV></DIV></DIV>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV>
      <DIV></DIV><BR>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2 style="DISPLAY: none">
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">AJAX and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MI id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3 style="DISPLAY: none">
      <DIV class=MI id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4 style="DISPLAY: none">
      <DIV class=MI id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5>
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MIS id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/kb/showcase/">Product Showcase</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/Install">Installshield 
      2008</A></DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV><BR>
      <SCRIPT type=text/javascript>document.write("<a href=\"http://www.codeproject.com/Redir.aspx?adid=5044&way=ban\" target=\"_blank\" rel=\"nofollow\"><img src=\"http://www.codeproject.com/script/Ann/ServeImg.aspx?File=%2fscript%2fadmentor%2fimages%2fWhole_Tomato_VisastX_160x600_v1.gif&C=False&id=5044\" alt=\"The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you.\" border=\"0\" width=\"160\" height=\"600\"></a>");</SCRIPT>
      <IMG height=1 alt="" src="/script/Common/Images/t.gif" width=160> </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top>
            <TABLE>
              <TBODY></TBODY></TABLE>
            <TABLE cellSpacing=1 cellPadding=3 width=1 border=0>
              <TBODY>
              <TR class=smalltext vAlign=center>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt=print src="/script/Articles/Images/print.gif" 
                  width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
                  href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?display=Print">Print</A> 
                </TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt="Broken Article?" 
                  src="/script/Articles/Images/broken.gif" width=16> <A 
                  id=ctl00_ArticleHeaderLinks_BrokenLnk 
                  href="http://www.codeproject.com/script/Articles/Report.aspx?aid=12850">Broken 
                  Article?</A> </TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  id=ctl00_ArticleHeaderLinks_ArticleBmk_BookmarkImg 
                  title="Add to bookmarks" 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; WIDTH: 16px; BORDER-BOTTOM: 0px; HEIGHT: 16px" 
                  src="/script/Bookmarks/Images/link.png"> <A 
                  id=ctl00_ArticleHeaderLinks_ArticleBmk_BookmarkLnk 
                  href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=12850&amp;obtid=2">Add 
                  Bookmark</A> <SPAN 
                  id=ctl00_ArticleHeaderLinks_ArticleBmk_Message></SPAN></TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt=Discuss src="/script/Content/Images/discuss.gif" 
                  width=15> <A 
                  href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx#_comments">Discuss</A> 
                </TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt="Recommend Article" 
                  src="/script/Content/Images/mail.gif" width=16> <A 
                  id=ctl00_ArticleHeaderLinks_Recommend 
                  href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=12850">Send 
                  to a friend</A> </TD></TR></TBODY></TABLE></TD>
          <TD align=right>
            <TABLE>
              <TBODY>
              <TR>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
                  align=right><SPAN id=ctl00_ArticleRating_VoteLabel>14 votes 
                  for this Article.</SPAN> </TD>
                <TD>
                  <TABLE cellSpacing=0 cellPadding=0 border=1>
                    <TBODY>
                    <TR>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=20 
                      border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=20 
                      border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=20 
                      border=0></TD>
                      <TD noWrap width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=14 
                      border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/white.gif" width=20 
                      border=0></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=ctl00_ArticleRating_PopularityRow>
                <TD class=SmallText align=right colSpan=2><A 
                  id=ctl00_ArticleRating_PopularityLnk 
                  title="Calculated as rating x Log10(# votes)" 
                  href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                  4.27</A><SPAN id=ctl00_ArticleRating_PopularityLbl></SPAN> 
                  Rating: <B>3.72</B> out of 5 
      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <UL class=Callout id=ctl00_confirmError style="MARGIN-RIGHT: 20px">
        <LI class=SmallText 
        style="LIST-STYLE-IMAGE: url(/images/warning.gif)">You are signed up for 
        one or more <A id=ctl00_SubscribeLink2 
        href="http://www.codeproject.com/script/Membership/Subscribe.aspx?rp=%2fKB%2fcs%2fDesktopCaptureWithMouse.aspx">newsletters</A> 
        but your email address is either unconfirmed, or has not been 
        reconfirmed in a long time. Please click <A id=ctl00_RequestConfirmLink2 
        href="http://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fKB%2fcs%2fDesktopCaptureWithMouse.aspx">here</A> 
        to have an email sent that will allow us to confirm your email address 
        and start sending you newsletters again.</LI></UL><SPAN id=intelliTXT>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse/ScreenshotCaptureWithMouse_Src.zip">Download 
        source files - 14.7 Kb</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse/ScreenshotCaptureWithMouse_Demo.zip">Download 
        demo project - 5.55 Kb</A> </LI></UL>
      <P><IMG height=468 alt="Sample Image - DesktopCaptureWithMouse.jpg" 
      src="DesktopCaptureWithMouse/DesktopCaptureWithMouse.jpg" width=565></P>
      <H2>Introduction</H2>
      <P>This article shows how you can capture screen images including the 
      mouse cursor.</P>
      <H2>Background</H2>
      <P>Screen capturing is a very useful way of resource sharing as used in 
      applications like Remote Desktop, Virtual Network Computing (VNC), where a 
      user can access, view, and interact with a remote desktop as his own 
      desktop. Also, it is used in non ethical applications like hacking 
      applications, where a hacker can hack a computer using some malicious 
      server application, and the server then frequently takes screenshots of 
      the prey machine and sends them to the clients. You will see a lot of 
      source code resources over the internet discussing how to take screenshots 
      of the desktop or an area of the desktop but none of them discuss how to 
      capture the mouse cursor bitmap with the screenshot. Sometimes it becomes 
      necessary to capture the mouse to see the whole activity of the hacked 
      machine. First, we will discuss here what the actual problem is.</P>
      <H2>Problem</H2>
      <P>Most of us think that the mouse cursor image is a part of the desktop 
      display but actually it works on an upper layer over the desktop. Windows 
      always tracks mouse with a “Hot Spot”, the actual position seen by the 
      Windows.</P>
      <P>Currently, there are two common ways to capture and manipulate the 
      desktop image:</P>
      <OL>
        <LI>Copy the desktop bitmap data from Video Memory to the System Memory. 
        Do processing and then again blit it back to the Video Memory. This can 
        be easily done using the <CODE>BitBlt()</CODE> or the 
        <CODE>StretchBlt()</CODE> APIs provided by Win32. 
        <LI>Another way is to directly manipulate the desktop bitmap in the 
        Video Memory if enough memory is available as provided by DirectDraw. 
        </LI></OL>
      <P>Both of these don’t provide us the facility to capture the mouse cursor 
      image with the desktop image.</P>
      <H2>Solution</H2>
      <P>The solution to the problem of capturing the mouse cursor image with 
      the desktop image is quite simple.</P>
      <OL>
        <LI>First, get the bitmap of the screen using <CODE>BitBlt()</CODE>. I 
        have provided a simple function named <CODE>CaptureDesktop()</CODE> in 
        the <I>CaptureScreen.cs</I> file that captures the screen bitmap as 
        almost all the codes available over the internet do. 
        <LI>Then capture the mouse cursor bitmap as: 
        <H4>Get Cursor Icon:</H4>
        <P>First, get the cursor information using the Win32 
        <CODE>GetCursorInfo()</CODE>. The function fills the 
        <CODE>CURSORINFO</CODE> structure provided as a parameter. Don't forget 
        to initialize the <CODE>cbSize</CODE> member of the structure before 
        passing it as an argument. Then we check whether the cursor is visible 
        or not, by checking for the equality of the <CODE>flags</CODE> member of 
        the filled structure with the <CODE>CURSOR_SHOWING</CODE> constant. If 
        they are equal then we get the handle to the cursor icon using the 
        <CODE>CopyIcon</CODE><CODE>()</CODE> function that takes the 
        <CODE>hCursor</CODE> member of the above filled structure.</P>
        <H4>Get Cursor Position:</H4>
        <P>Now, we have to get the Icon information so that we can get the 
        hotspot position. This information is easily retrieved using the 
        <CODE>GetIconInfo()</CODE> function. Here is the C# implementation of 
        the mouse capturing function:</P><PRE lang=cs><SPAN class=code-keyword>static</SPAN> Bitmap CaptureCursor(<SPAN class=code-keyword>ref</SPAN> <SPAN class=code-keyword>int</SPAN> x, <SPAN class=code-keyword>ref</SPAN> <SPAN class=code-keyword>int</SPAN> y)
{
   Bitmap bmp;
   <SPAN class=code-SDKkeyword>IntPtr</SPAN> hicon;
   Win32Stuff.CURSORINFO ci = <SPAN class=code-keyword>new</SPAN> Win32Stuff.CURSORINFO(); 
   Win32Stuff.ICONINFO icInfo;
   ci.cbSize = Marshal.SizeOf(ci);
   <SPAN class=code-keyword>if</SPAN>(Win32Stuff.GetCursorInfo(<SPAN class=code-keyword>out</SPAN> ci))
   {
       <SPAN class=code-keyword>if</SPAN> (ci.flags == Win32Stuff.CURSOR_SHOWING)
       { 
           hicon = Win32Stuff.CopyIcon(ci.hCursor);
           <SPAN class=code-keyword>if</SPAN>(Win32Stuff.GetIconInfo(hicon, <SPAN class=code-keyword>out</SPAN> icInfo))
           {
               x = ci.ptScreenPos.x - ((<SPAN class=code-keyword>int</SPAN>)icInfo.xHotspot);
               y = ci.ptScreenPos.y - ((<SPAN class=code-keyword>int</SPAN>)icInfo.yHotspot);
               Icon ic = Icon.FromHandle(hicon);
               bmp = ic.ToBitmap(); 

               <SPAN class=code-keyword>return</SPAN> bmp;
           }
       }
   }
   <SPAN class=code-keyword>return</SPAN> <SPAN class=code-keyword>null</SPAN>;
}</PRE>
        <LI>We now have both the bitmaps, i.e., the desktop bitmap and the mouse 
        cursor bitmap with its position on the screen. Now, it's time to place 
        the mouse cursor bitmap on the desktop bitmap. I have provided the 
        following function that places the mouse cursor image over the desktop 
        bitmap at the proper position: <PRE lang=cs><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> Bitmap CaptureDesktopWithCursor()
{     
   <SPAN class=code-keyword>int</SPAN> cursorX = <SPAN class=code-digit>0</SPAN>;
   <SPAN class=code-keyword>int</SPAN> cursorY = <SPAN class=code-digit>0</SPAN>;
   Bitmap desktopBMP;
   Bitmap cursorBMP;
   Bitmap finalBMP;
   Graphics g;
   Rectangle r;
   desktopBMP = CaptureDesktop();
   cursorBMP = CaptureCursor(<SPAN class=code-keyword>ref</SPAN> cursorX, <SPAN class=code-keyword>ref</SPAN> cursorY);
   <SPAN class=code-keyword>if</SPAN>(desktopBMP != <SPAN class=code-keyword>null</SPAN>)
   {
       <SPAN class=code-keyword>if</SPAN> (cursorBMP != <SPAN class=code-keyword>null</SPAN>)
       {
           r = <SPAN class=code-keyword>new</SPAN> Rectangle(cursorX, cursorY, 
                   cursorBMP.Width, cursorBMP.Height);
           g = Graphics.FromImage(desktopBMP);
           g.DrawImage(cursorBMP, r);
           g.Flush();
           <SPAN class=code-keyword>return</SPAN> desktopBMP;
       }
       <SPAN class=code-keyword>else</SPAN>
           <SPAN class=code-keyword>return</SPAN> desktopBMP;
   }
   <SPAN class=code-keyword>return</SPAN> <SPAN class=code-keyword>null</SPAN>;
}</PRE>
        <LI>The bitmap with the cursor is now ready to be rendered over a viewer 
        surface (a <CODE>PictureBox</CODE> used here). Since the viewer's 
        visible area is smaller than the desktop bitmap area, scaling has been 
        used in the function that displays the cooked desktop image. <PRE lang=cs><SPAN class=code-comment>//</SPAN><SPAN class=code-comment> ssWithMouseViewer is the PictureBox control
</SPAN><SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> Display(Bitmap desktop)
{
    Graphics g;
    Rectangle r;
    <SPAN class=code-keyword>if</SPAN>(desktop != <SPAN class=code-keyword>null</SPAN>)
    {
        r = <SPAN class=code-keyword>new</SPAN> Rectangle(<SPAN class=code-digit>0</SPAN>,<SPAN class=code-digit>0</SPAN>,ssWithMouseViewer.Width, 
                            ssWithMouseViewer.Height);
        g = ssWithMouseViewer.CreateGraphics();
        g.DrawImage(desktop,r);
        g.Flush();
    }
}</PRE></LI></OL>
      <H2>Note</H2>
      <P>The binary image provided is compiled with Visual Studio .NET 2005 so 
      you have to install .NET Framework 2.0.</P>
      <H2>Known problems</H2>
      <P>I have tested the application on my machine with no known problems, so 
      I expect the same behavior on your machine.</P><!-- Article Ends --><!-- Main Page Contents End --></DIV></SPAN>
      <H2>License</H2>
      <P>This article has no explicit license attached to it but may contain 
      usage terms in the article text or the download files themselves. If in 
      doubt please contact the author via the discussion board below.</P>
      <P>A list of licenses authors might use can be found <A 
      href="http://www.codeproject.com/info/Licenses.aspx">here</A></P>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2363661">Rashid.Mahmood</A></B><BR><BR>
            <CENTER><IMG id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
            src="/script/Membership/ProfileImages/{28EF4068-091A-48A1-AAAE-8C3D9608B19D}.jpg"></CENTER><BR><SPAN 
            class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>He is always interested to write technical articles that address 
            the problems of the programmers community.<BR><BR>He loves to 
            develope softares using C++, VC++ and C#. He also likes programming 
            in Java due to its high portability. His area of interest is 
            Graphics side esp. Games.<BR><BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow>
                <TD class=SmallText noWrap>Occupation: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Web 
                  Developer</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt=Pakistan src="/script/Geo/Images/PK.gif" 
                  width=16> 
      Pakistan</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE id=ctl00_PopularArticlesRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular C# articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/cs/AsyncMethodInvocation.aspx">Asynchronous 
              Method Invocation</A>
              <DIV class=SmallText>How to use .NET to call methods in a 
              non-blocking mode.</DIV>
              <LI><A href="http://www.codeproject.com/KB/cs/csppleds.aspx">I/O 
              Ports Uncensored - 1 - Controlling LEDs (Light Emiting Diodes) 
              with Parallel Port</A>
              <DIV class=SmallText>Controlling LEDs (Light Emiting Diodes) with 
              Parallel Port</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/cs/IconLib.aspx">IconLib - 
              Icons Unfolded (MultiIcon and Windows Vista supported)</A>
              <DIV class=SmallText>Library to manipulate icons and icons 
              libraries with support to create, load, save, import and export 
              icons in ico, icl, dll, exe, cpl and src format. (Windows Vista 
              icons supported).</DIV>
              <LI><A href="http://www.codeproject.com/KB/cs/cspplcds.aspx">I/O 
              Ports Uncensored Part 2 - Controlling LCDs (Liquid Crystal 
              Displays) and VFDs (Vacuum Fluorescent Displays) with Parallel 
              Port</A>
              <DIV class=SmallText>Controlling LCDs (Liquid Crystal Displays) 
              and VFDs (Vacuum Fluorescent Displays) with Parallel Port</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/cs/AutoDiagrammer.aspx">100% 
              Reflective Class Diagram Creation Tool</A>
              <DIV class=SmallText>100% Reflective Class Diagram Creation 
              Tool</DIV></LI></UL>
            <H2></H2></TD>
          <TD><IFRAME 
            src="C:\Documents and Settings\admin\Desktop\qwe\CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files\ServeHTML(1).htm" 
            frameBorder=0 width=300 scrolling=no 
        height=250></IFRAME></TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
			var addtoMethod=1;
			var AddURL = document.location.href;
			var AddTitle = escape(document.title);
			DrawLinks(100, 0, "SmallText Bold", "AddTo") 
			</SCRIPT>
      </DIV>
      <TABLE class=RatingBar id=ctl00_RateArticleRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <FORM id=aspnetForm 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            name=aspnetForm action=DesktopCaptureWithMouse.aspx method=post>
            <DIV><INPUT id=__VIEWSTATE type=hidden 
            value=/wEPDwULLTEwMDUyNjYzMjhkZJr5y2p0SrFqA2ilSzY5zXn3HK5I 
            name=__VIEWSTATE> </DIV>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD class=SmallText style="WHITE-SPACE: nowrap" align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px"><I><B>Rate this Article for 
                        us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
            <DIV><INPUT id=__EVENTVALIDATION type=hidden 
            value=/wEWCAKV0pLtAwLAlMXDBwLBlMXDBwLClMXDBwLDlMXDBwLElMXDBwLP+++tCwK5upDkCxmzeN7SPq/6MAcOhMBYZYvtnJkU 
            name=__EVENTVALIDATION> </DIV></FORM></TD></TR></TBODY></TABLE>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write("<a href=\"http://www.codeproject.com/Redir.aspx?adid=5040&way=ban\" target=\"_blank\" rel=\"nofollow\"><img src=\"http://www.codeproject.com/script/Ann/ServeImg.aspx?File=%2fscript%2fadmentor%2fimages%2fWholeTomato_AutoSuggest_468x60_Original_newfont.gif&C=False&id=5040\" alt=\"The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you.\" border=\"0\" width=\"468\" height=\"60\"></a>");</SCRIPT>
      <IFRAME 
      src="CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files/ServeLinks.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <FORM 
        action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fcs%2fDesktopCaptureWithMouse.aspx&amp;fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick 
        method=get>
        <TBODY>
        <TR>
          <TD><INPUT type=hidden value=261533 name=fid><INPUT type=hidden 
            value=?floc=%2fKB%2fcs%2fDesktopCaptureWithMouse.aspx&amp;fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick 
            name=currentQS><INPUT type=hidden 
            value=/KB/cs/DesktopCaptureWithMouse.aspx name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 
                  src="/script/Forums/Images/forum_faq.gif" width=16 
                  align=absMiddle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 
                  src="/script/Forums/Images/forum_search.gif" width=16 
                  align=absMiddle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=261533">Search 
                  comments</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=submit></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 
                  src="/script/Forums/Images/forum_newmsg.gif" width=16 
                  align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 25 of 25 (Total in Forum: 25) (<A 
                  href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><SPAN 
                  class=Frm_HL>Next</SPAN></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD><!-- Column Headers -->
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0>
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 src="/script/Forums/Images/t.gif" width=1 
                  border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=2370753_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2370753xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_question.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2370753#xx2370753xx" 
                        name=2370753>Remote Desktop Monitoring in C#.Net</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3714512">Member 
                        3714512</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:15 27 
                        Dec '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=2370753_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR>I want to develop a utility 
                                in C# .Net that can be used for Remote Desktop 
                                Monitoring. I want to know whether any class or 
                                APIs are supporeted by .Net which will help me 
                                in this regard.<BR>In Java we have a Robot class 
                                which will provide us many APIs for the same.Is 
                                there any equivalent class in .Net?Please share 
                                your knowledge regarding this.Thanking you in 
                                advance. <BR><BR>pp<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=2370753&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=2370753&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2370753">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=2370753">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2370753&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2370753 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(3714512,2370753);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=1842600_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1842600xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_question.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1842600#xx1842600xx" 
                        name=1842600>VC++ :(</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=572709">Sobaan</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:43 
                        12 Jan '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1842600_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello,<BR>I need to capture the 
                                mouse cursor image in VC++ 6.0 .<BR>Can you 
                                guide me coz its pretty 
                                urgent!<BR><BR>Regards,<BR>Sobaan <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1842600&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1842600&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1842600">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1842600">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1842600&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1842600 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(572709,1842600);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote Rt HdUnSel " id=1840265_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1840265xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_question.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1840265#xx1840265xx" 
                        name=1840265>Text Cursor</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1190988">Fornazin</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:29 
                        11 Jan '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1840265_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR><BR>I tried to capture the 
                                cursor when it is over a text and the code did 
                                not capture it.<BR><BR>I think the issue is on 
                                the method ToBitmap(). Does anybody you know can 
                                I print the text cursor on the 
                                screen?<BR><BR>Thanks,<BR><BR><BR><BR>Marcelo 
                                Fornazin<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1840265&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1840265&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1840265">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1840265">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1840265&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1840265 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1190988,1840265);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1859852_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1859852xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_answer.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1859852#xx1859852xx" 
                        name=1859852>Re: Text Cursor</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1190988">Fornazin</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">10:07 
                        24 Jan '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1859852_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>One more information. I'm talking 
                                about the I-beam cursor. I can't draw the I-beam 
                                cursor using ToBitmap() method. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1859852&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1859852&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1840265">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1859852">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1859852&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1859852 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1190988,1859852);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=1833666_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1833666xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_question.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1833666#xx1833666xx" 
                        name=1833666>IT is not rendering me desktop image with 
                        mouse</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2227676">gabrousman</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:17 8 
                        Jan '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1833666_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello,<BR>It is not rendering me 
                                desktop image with mouse. I have checked the 
                                image of bitmap, that is coming fine, but when i 
                                open the desktop image with mouse image, it is 
                                not working and showing me nothing. Kindly help 
                                me how i can also use it to capture the complete 
                                movement of the mouse over the captured screen 
                                image.<BR>Thanks<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1833666&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1833666&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1833666">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1833666">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1833666&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1833666 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2227676,1833666);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=1822290_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1822290xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_question.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1822290#xx1822290xx" 
                        name=1822290>How can i control the remote Desktop 
                        Through Mouse and Key Board</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2036888">Me 
                        the Lover</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:26 
                        29 Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1822290_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello,<BR>I want to know that is 
                                there any possibility to control the remote 
                                desktop using my own mouse and keyboard the same 
                                like WINdows XP RDP utility?<BR>Kindly send me 
                                the links where i can found the code sample or 
                                can you provide the code sample on the Code 
                                project.com to share your knowledge with 
                                others.<BR>I really need it urgently so that i 
                                may complete my final project.<BR><BR>Waiting 
                                for your reply.<BR>Regards,<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1822290&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1822290&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1822290">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1822290">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1822290&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1822290 
                                style="WHITE-SPACE: nowrap">2.67/5 (3 votes)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2036888,1822290);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=1408725_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1408725xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1408725#xx1408725xx" 
                        name=1408725>Have you solved the IBeam cursor 
                        problem?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=532078">Globulus</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:44 15 
                        Mar '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1408725_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><BR>When the cursor is an IBeam 
                                (like when over a text editor), the captured 
                                image is white, rather than black. This is 
                                because the cursor image is actually white, but 
                                the cursor mask is entirely white as well. When 
                                the cursor is applied to the screen, the mask is 
                                AND'ed with the screen contents, then the cursor 
                                bitmap is XOR'ed with this result. This is fine 
                                for applying it to the screen, but if one wants 
                                a picture of what the icon usually looks like on 
                                a white background, you would have to do 
                                something like this:<BR><BR>Step 1: destimage = 
                                image xor mask<BR>Step 2: destmask = (not mask) 
                                or image<BR>Step 3. dest = destmask and 
                                destimage<BR><BR>This would be the correct(?) 
                                result of a function returning an alpha-blended 
                                image of the cursor.<BR><BR>But if you just want 
                                to use it in a screen capture program, you 
                                should check for the presence of the mask/image 
                                information and use it the same way Windows does 
                                when rendering the screen. This would provide an 
                                exact match. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1408725&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1408725&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1408725">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1408725">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1408725&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1408725 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(532078,1408725);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1929120_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1929120xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1929120#xx1929120xx" 
                        name=1929120>Re: Have you solved the IBeam cursor 
                        problem?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=684213">ssheldon</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:31 7 
                        Mar '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1929120_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Theres a simpler way to solve 
                                this. Instead of exracting the bitmap and using 
                                graphics.DrawImage, one can call 
                                graphics.DrawIcon passing the icon obtained 
                                through Icon.FromHandle. This handles the mask. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1929120&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1929120&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1408725">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1929120">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1929120&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1929120 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(684213,1929120);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=1407295_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1407295xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1407295#xx1407295xx" 
                        name=1407295>Leak in CaptureCursor found and 
                      fixed!</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=532078">Globulus</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:51 14 
                        Mar '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1407295_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Found the leaks. Wrapped it up in 
                                a self-contained class for just the single 
                                purpose of capturing an image of the cursor. 
                                Sorry about the VB.Net. I come from a VB6 
                                background and haven't switched to C# 
                                yet.<BR><BR>There were two problems:<BR><BR>1) 
                                Not releasing the bitmap(s) created by the call 
                                to GetIconInfo (normally just one).<BR>2) Not 
                                destroying the icon created using 
                                CopyIcon.<BR><BR>Since Windows 2000/XP only 
                                gives you approx. 10.000 GDI handles per 
                                process, this is the reason why the original 
                                version failed after around 5.000 iterations 
                                (two leaks per call).<BR><BR>Hope this sample 
                                helps anyone searching for this kind of 
                                information. Seems to work ok now. Using 
                                GetGuiResources really helped pinpoint the 
                                problem.<BR><BR>---snip---<BR><BR>Option 
                                Explicit On<BR>Option Strict 
                                On<BR><BR>'Research<BR>'--------<BR>'<BR>'"Capturing 
                                the Desktop Screen with the Mouse Cursor 
                                Image"<BR>'The original screen capture sample 
                                from which CaptureCursor was 
                                adapted.<BR>'http://www.codeproject.com/csharp/DesktopCaptureWithMouse.asp<BR>'<BR>'"Example 
                                of overlaying a cursor on a bitmap multiple 
                                times" (Delphi code)<BR>'Details some 
                                peculiarities of 
                                GetIconInfo.<BR>'http://homepages.borland.com/efg2lab/Library/Graphics/CursorOverlay.htm<BR><BR>Imports 
                                System.Runtime.InteropServices<BR><BR>Public 
                                Class RTGlobalCursor<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; Private Const CURSOR_SHOWING As 
                                Integer = 1<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &lt;StructLayout(LayoutKind.Sequential)&gt; 
                                _<BR>&nbsp;&nbsp; &nbsp;&nbsp; Private Structure 
                                CURSORINFO<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; ' 
                                Fields<BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; Public cbSize As 
                                Integer<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Public flags As 
                                Integer<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Public hCursor As 
                                IntPtr<BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; Public ptScreenPos As 
                                Point<BR>&nbsp;&nbsp; &nbsp;&nbsp; End 
                                Structure<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &lt;StructLayout(LayoutKind.Sequential)&gt; 
                                _<BR>&nbsp;&nbsp; &nbsp;&nbsp; Private Structure 
                                ICONINFO<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; ' 
                                Fields<BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; Public fIcon As 
                                Boolean<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Public xHotspot As 
                                Integer<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Public yHotspot As 
                                Integer<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Public hbmMask As 
                                IntPtr&nbsp;&nbsp; &nbsp;&nbsp; 'Handle of the 
                                icon’s bitmask bitmap.<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Public 
                                hbmColor As IntPtr&nbsp;&nbsp; 'Handle of the 
                                icon’s color bitmap. Optional for monochrome 
                                icons.<BR>&nbsp;&nbsp; &nbsp;&nbsp; End 
                                Structure<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &lt;StructLayout(LayoutKind.Sequential)&gt; 
                                _<BR>&nbsp;&nbsp; &nbsp;&nbsp; Private Structure 
                                POINT<BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; ' Fields<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Public x 
                                As Integer<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Public y As 
                                Integer<BR>&nbsp;&nbsp; &nbsp;&nbsp; End 
                                Structure<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &lt;DllImport("user32.dll")&gt; 
                                _<BR>&nbsp;&nbsp; &nbsp;&nbsp; Private Shared 
                                Function CopyIcon(ByVal hIcon As IntPtr) As 
                                IntPtr<BR>&nbsp;&nbsp; &nbsp;&nbsp; End 
                                Function<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &lt;DllImport("gdi32.dll")&gt; _<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; Private Shared Function 
                                DeleteObject(ByVal hDc As IntPtr) As 
                                IntPtr<BR>&nbsp;&nbsp; &nbsp;&nbsp; End 
                                Function<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &lt;DllImport("user32.dll")&gt; 
                                _<BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Private 
                                Shared Function DestroyIcon(ByVal hIcon As 
                                IntPtr) As Boolean<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                End Function<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &lt;DllImport("user32.dll")&gt; 
                                _<BR>&nbsp;&nbsp; &nbsp;&nbsp; Private Shared 
                                Function GetCursorInfo(&lt;Out()&gt; ByRef pci 
                                As CURSORINFO) As Boolean<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; End Function<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &lt;DllImport("user32.dll")&gt; 
                                _<BR>&nbsp;&nbsp; &nbsp;&nbsp; Private Shared 
                                Function GetIconInfo(ByVal hIcon As IntPtr, 
                                &lt;Out()&gt; ByRef piconinfo As ICONINFO) As 
                                Boolean<BR>&nbsp;&nbsp; &nbsp;&nbsp; End 
                                Function<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &lt;DllImport("user32.dll")&gt; 
                                _<BR>&nbsp;&nbsp; &nbsp;&nbsp; Private Shared 
                                Function GetGuiResources(ByVal hProcess As 
                                IntPtr, ByVal uiFlags As Integer) As 
                                Integer<BR>&nbsp;&nbsp; &nbsp;&nbsp; End 
                                Function<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                Private Shared Function GetGDIHandleCount() As 
                                Integer<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Return 
                                GetGuiResources(Process.GetCurrentProcess.Handle, 
                                0)<BR>&nbsp;&nbsp; &nbsp;&nbsp; End 
                                Function<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                Private Shared Function GetUserHandleCount() As 
                                Integer<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Return 
                                GetGuiResources(Process.GetCurrentProcess.Handle, 
                                1)<BR>&nbsp;&nbsp; &nbsp;&nbsp; End 
                                Function<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                Private Shared Sub HandleMessage(ByVal message 
                                As String)<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Debug.WriteLine("HC: " 
                                &amp; message &amp; ": GDI: " &amp; 
                                GetGDIHandleCount().ToString &amp; ": User: " 
                                &amp; 
                                GetUserHandleCount().ToString)<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; End Sub<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; Public Shared Function 
                                CaptureCursor(ByRef x As Integer, ByRef y As 
                                Integer) As Bitmap<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; 'Return value 
                                initially nothing<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Dim bmp As Bitmap = 
                                Nothing<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Dim curInfo As New 
                                CURSORINFO<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; curInfo.cbSize = 
                                Marshal.SizeOf(curInfo)<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                'HandleMessage("Start")<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; If 
                                GetCursorInfo(curInfo) Then<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; If curInfo.flags = 
                                CURSOR_SHOWING Then<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Dim hicon 
                                As IntPtr = 
                                CopyIcon(curInfo.hCursor)<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; If hicon &lt;&gt; IntPtr.Zero 
                                Then<BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; Dim icoInfo As 
                                ICONINFO<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; If GetIconInfo(hicon, 
                                icoInfo) Then<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; 'Delete the mask, if 
                                present.<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; If icoInfo.hbmMask &lt;&gt; 
                                IntPtr.Zero Then<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                DeleteObject(icoInfo.hbmMask)<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; End 
                                If<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 'Delete 
                                the color bitmap, if present.<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; If icoInfo.hbmColor 
                                &lt;&gt; IntPtr.Zero Then<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; 
                                DeleteObject(icoInfo.hbmColor)<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; End 
                                If<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; x = 
                                curInfo.ptScreenPos.x - 
                                icoInfo.xHotspot<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; y = curInfo.ptScreenPos.y - 
                                icoInfo.yHotspot<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; End 
                                If<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; Dim ic As Icon = 
                                Icon.FromHandle(hicon)<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; bmp = 
                                ic.ToBitmap<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; 'Must destroy the icon 
                                object we got from CopyIcon<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                DestroyIcon(hicon)<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; End If<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; End If<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; End 
                                If<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; 
                                'HandleMessage("End")<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Return 
                                bmp<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; End 
                                Function<BR><BR>End Class<BR><BR><BR>-- modified 
                                at 10:52 Tuesday 14th March, 2006<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1407295&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1407295&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1407295">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1407295">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1407295&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1407295 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(532078,1407295);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=2219477_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2219477xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2219477#xx2219477xx" 
                        name=2219477>Re: Leak in CaptureCursor found and 
                        fixed!</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3834789">ham-z</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:01 9 
                        Sep '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=2219477_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>you such a genius... 
                                <BR><BR>really thanks <BR><BR>enjoy code. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=2219477&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=2219477&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1407295">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=2219477">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2219477&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2219477 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(3834789,2219477);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=1406758_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1406758xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1406758#xx1406758xx" 
                        name=1406758>Excellent</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1811573">mrsnipey</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">2:39 14 
                        Mar '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1406758_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Worked great for me. 
<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1406758&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1406758&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1406758">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1406758">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1406758&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1406758 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1811573,1406758);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=1404435_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1404435xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1404435#xx1404435xx" 
                        name=1404435>Leak in CaptureCursor?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=532078">Globulus</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">10:07 
                        12 Mar '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1404435_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I was looking for some code to 
                                grab the current, global cursor and came across 
                                your sample code. Great! Exactly what I was 
                                looking for.<BR><BR>Except: To ensure that there 
                                was no memory or handle leaks in the code, I ran 
                                a call to CaptureCursor 1000s of times in a 
                                loop. I did not do anything with the bitmap 
                                returned. After nearly 5,000 calls an exception 
                                is generated by the .ToBitmap call. The 
                                stacktrace looks like 
                                this:<BR><BR>---snip---<BR>&nbsp;&nbsp; at 
                                System.Drawing.Graphics.GetHdc()<BR>&nbsp;&nbsp; 
                                at 
                                System.Drawing.Internal.WindowsGraphics.FromGraphics(Graphics 
                                g, ApplyGraphicsProperties 
                                properties)<BR>&nbsp;&nbsp; at 
                                System.Drawing.Icon.Draw(Graphics graphics, 
                                Rectangle targetRect)<BR>&nbsp;&nbsp; at 
                                System.Drawing.Icon.ToBitmap()<BR>&nbsp;&nbsp; 
                                at ... CaptureCursor(Int32&amp; x, Int32&amp; 
                                y)<BR>---snip---<BR><BR>This happens 
                                consistently after 4,975-4,981 calls (tested on 
                                two WinXP machines).<BR>I did not change 
                                anything in your code, except making the capture 
                                stuff public, so I could access it using a 
                                reference in a vb.net project.<BR><BR>Here is my 
                                test loop:<BR>---snip---<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; Private Sub 
                                CaptureCursorLoop()<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Dim totalmemory As 
                                String = ""<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; For i As Integer = 1 
                                To 10000<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; Dim x As Integer<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Dim y As 
                                Integer<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; Dim bm As Bitmap = 
                                ScreenshotCaptureWithMouse.ScreenCapture.CaptureScreen.CaptureCursor(x, 
                                y)<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; If i Mod 
                                200 = 0 Then<BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                totalmemory = 
                                GC.GetTotalMemory(False).ToString<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; End 
                                If<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; Me.Text = 
                                i.ToString &amp; ": Memory: " &amp; 
                                totalmemory<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; Next<BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; End Sub<BR>---snip---<BR><BR>I know 
                                this is irrelevant to your sample application, 
                                but for other application types (e.g. a screen 
                                magnifier displaying a copy of the current 
                                global cursor, updated several times a second 
                                using a timer), well ... then it is another 
                                matter.<BR><BR>Any ideas?<BR><BR><BR>-- modified 
                                at 13:10 Sunday 12th March, 2006<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1404435&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1404435&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1404435">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1404435">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1404435&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1404435 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(532078,1404435);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1404867_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1404867xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1404867#xx1404867xx" 
                        name=1404867>Re: Leak in CaptureCursor?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2363661">Rashid.Mahmood</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">23:22 
                        12 Mar '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1404867_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Try to use short delay between 
                                each capture.<BR><BR>Thanx <BR><BR>"Imagination 
                                is much more important than 
                                implementation"<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1404867&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1404867&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1404435">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1404867">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1404867&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1404867 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2363661,1404867);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1404920_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx1404920xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1404920#xx1404920xx" 
                        name=1404920>Re: Leak in CaptureCursor?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=532078">Globulus</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:42 13 
                        Mar '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1404920_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Makes no difference. Only delays 
                                the inevitable.<BR><BR>I inserted some 
                                DoEvents/garbage collection into the loop. See 
                                below. Crashes after the same number of 
                                iterations. Added a few dozen DoEvents made no 
                                difference either. Calling a smaller loop 
                                multiple times (using a button, clicked 
                                manually, giving the system a chance to clean 
                                up) gave the same result as well: Crashes after 
                                around 4,975 total iterations.<BR><BR>I had a 
                                similar problem a few days ago (creating a 
                                cursor dynamically from a bitmap). Crashed 
                                consistently after around 1,200 iterations, so I 
                                had to find and fix the leak. Now I can call it 
                                millions of times without any problems. I hope 
                                to be able to do the same thing with your code. 
                                It goes a long way to solving my problem, but 
                                either a piece is missing or there is an InterOp 
                                problem that needs to be worked 
                                around.<BR><BR>---snip---<BR>Private Sub 
                                CaptureCursorLoop()<BR>Dim totalmemory As String 
                                = ""<BR>For i As Integer = 1 To 10000<BR>Dim x 
                                As Integer<BR>Dim y As Integer<BR>Dim bm As 
                                Bitmap = 
                                ScreenshotCaptureWithMouse.ScreenCapture.CaptureScreen.CaptureCursor(x, 
                                y)<BR><BR>bm.Dispose()<BR>bm = 
                                Nothing<BR>GC.Collect()<BR>Application.DoEvents()<BR><BR>If 
                                i Mod 200 = 0 Then<BR>totalmemory = 
                                GC.GetTotalMemory(False).ToString<BR>End 
                                If<BR><BR>Me.Text = i.ToString &amp; ": Memory: 
                                " &amp; totalmemory<BR><BR>Next<BR>End 
                                Sub<BR>---snip--- <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1404920&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1404920&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1404435">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1404920">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1404920&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1404920 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(532078,1404920);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=1395026_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1395026xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1395026#xx1395026xx" 
                        name=1395026>Win32 and GDI</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=supporter height=16 
                        src="/script/Membership/Images/supporter_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=39011">Scott 
                        Elder</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:03 5 
                        Mar '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1395026_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>This is a great example. I would 
                                like to do something very similar, but I don't 
                                want to use OS specific calls. Is there a way 
                                thins could be done without all the DllImports? 
                                Just raw 
                                C#?<BR><BR>Thanks,<BR><BR><BR><BR>-Scott<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1395026&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1395026&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1395026">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1395026">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1395026&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1395026 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(39011,1395026);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1395093_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1395093xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1395093#xx1395093xx" 
                        name=1395093>Re: Win32 and GDI</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2363661">Rashid.Mahmood</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">21:54 5 
                        Mar '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1395093_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Yes you can use DirectX to do the 
                                same thing.<BR><BR>Thanx <BR><BR>"Imagination is 
                                much more important than 
                                implementation"<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1395093&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1395093&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1395026">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1395093">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1395093&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1395093 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2363661,1395093);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1395100_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx1395100xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1395100#xx1395100xx" 
                        name=1395100>Re: Win32 and GDI</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=supporter height=16 
                        src="/script/Membership/Images/supporter_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=39011">Scott 
                        Elder</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">22:06 5 
                        Mar '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1395100_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Thanks for the quick reply. I was 
                                under the impression DirectX would only work on 
                                the windowns platform? I am trying to come up 
                                with a way that my viewer could work on any 
                                platform the .NET framework had been ported 
                                to.<BR><BR>Thanks,<BR><BR><BR><BR>-Scott<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1395100&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1395100&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1395026">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1395100">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1395100&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1395100 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(39011,1395100);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote HdUnSel " id=1442638_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1442638xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_answer.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1442638#xx1442638xx" 
                        name=1442638>Re: Win32 and GDI</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1165854">Razi 
                        Al-Sayed</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:09 9 
                        Apr '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1442638_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I used the following code to 
                                capture desktop image with cursor. I am using 
                                .NET Framework 2.0.<BR><BR><B>Note:</B> HotSpot 
                                property is new in the .NET Framework version 
                                2.0.<BR><BR><PRE>using System.Drawing;<BR>/* ... */<BR>Bitmap desktopBMP = new Bitmap(<BR>   System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width,<BR>   System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height);<BR><BR>Graphics g = Graphics.FromImage(desktopBMP);<BR><BR>g.CopyFromScreen(0, 0, 0, 0, <BR>   new Size(<BR>   System.Windows.Forms.Screen.PrimaryScreen.Bounds.Width,<BR>   System.Windows.Forms.Screen.PrimaryScreen.Bounds.Height));<BR>            <BR>Rectangle rect = new Rectangle(<BR>   Cursor.Position.X - Cursor.Current.HotSpot.X,<BR>   Cursor.Position.Y - Cursor.Current.HotSpot.Y,<BR>   Cursor.Current.Size.Width,<BR>   Cursor.Current.Size.Height);<BR>            <BR>Cursor.Current.Draw(g,rect);<BR>return desktopBMP;</PRE><BR><BR>Razi<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1442638&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1442638&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1395026">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1442638">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1442638&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1442638 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1165854,1442638);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=1353748_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1353748xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1353748#xx1353748xx" 
                        name=1353748>Selected areas</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=177431">Michael 
                        J. Collins</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:10 31 
                        Jan '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1353748_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Thanks for this, it's quite 
                                helpful. I have mostly done web programming but 
                                I'm trying to get in to windows programming. One 
                                thing I've always wanted to know is how to make 
                                a screen capture utility where you select a 
                                portion using a mouse and dragging to create an 
                                "ants marching" box around an area and only 
                                capturing that area. I can't find a .Net way to 
                                do it. Is there one?<BR><BR><BR><BR>Michael J. 
                                Collins<BR>Web Application 
                                Programmer<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1353748&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1353748&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1353748">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1353748">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1353748&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1353748 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(177431,1353748);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=1353131_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1353131xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_question.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1353131#xx1353131xx" 
                        name=1353131>another question :)</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1378459">ketan14</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:05 31 
                        Jan '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1353131_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR>I really liked this 
                                article.I had been looking at this issue for 
                                quite some time and the only work around I could 
                                make out was to get the cursor posotion and then 
                                put it at a spot on the captured bitmap but it 
                                was difficult to get to correct spot.<BR><BR>I 
                                have a question,supposing a user left clicks and 
                                a menu is displayed and at that time we capture 
                                the screen.Is their a way to see this menu with 
                                the cursor postion and all.I have not been able 
                                to solve this issue<BR><BR>Kindly 
                                advise<BR>Thanks<BR>Ketan <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1353131&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1353131&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1353131">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1353131">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1353131&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1353131 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1378459,1353131);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1354659_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1354659xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_answer.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1354659#xx1354659xx" 
                        name=1354659>Re: another question :)</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2363661">Rashid.Mahmood</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">22:32 
                        31 Jan '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1354659_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Do u want to capture the whole 
                                desktop?<BR>if so then i think it will work out. 
                                U just needs keyboard hooks<BR>so that u can 
                                capture against any combination of keys whether 
                                ur<BR>application is visible or not. And the 
                                captured desktop will surely<BR>have menu and 
                                then place mouse cursor at appropriate 
                                position.<BR><BR>Thanx.<IMG 
                                src="/script/Forums/Images/smiley_smile.gif" 
                                align=absMiddle> <BR><BR>"Imagination is much 
                                more important than 
implementation"<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1354659&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1354659&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1353131">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1354659">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1354659&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1354659 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2363661,1354659);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1405105_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx1405105xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1405105#xx1405105xx" 
                        name=1405105>Re: another question :)</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1378459">ketan14</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:10 13 
                        Mar '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1405105_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hey I was just using your APIs 
                                here and it seems if the cursor changes to 
                                anything other than the arrow[standard cursor 
                                shape] or the hourglass,it does not show them.I 
                                guess it has something to do with the 
                                CURSOR_SHOWING flag.<BR>Can you suggest what can 
                                be done?<BR><BR>Thanks.If I can find the 
                                solution I will update this thread coz I believe 
                                it would fulfill the purpose of ur 
                                article.<BR><BR>Regards,<BR>Ketan <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1405105&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1405105&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1353131">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1405105">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1405105&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1405105 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1378459,1405105);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=1511882_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx1511882xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1511882#xx1511882xx" 
                        name=1511882>Re: another question :)</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2571093">Daniel 
                        Repich</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">14:04 
                        31 May '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1511882_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>How do programs like gotomypc 
                                capture the transparent dragging of icons 
                                whereas most screen savers cannot? I have also 
                                seen a program called Hypersnap6 do this. 
                                Standard BitBlt does not seem to capture those 
                                overlays.<BR><BR><BR><BR>Daniel 
                                Repich<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1511882&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1511882&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1353131">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1511882">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1511882&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1511882 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2571093,1511882);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=1350770_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1350770xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1350770#xx1350770xx" 
                        name=1350770>"Desktop" ???</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=965246">fwsouthern</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">13:44 
                        28 Jan '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1350770_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>You seem to have omitted the 
                                "Desktop" capture and opted for just the primary 
                                screen -- have you considered:<BR><BR>a. option 
                                to selectively capture the entire Desktop, the 
                                primary screen (your current program) and each 
                                secondary screen?<BR><BR>b. capturing all 
                                content of the object (Desktop, primary or a 
                                secondary screen) including media play 
                                contents?<BR><BR>c. NOT having your view screen 
                                always on top &amp; using global hooks to invoke 
                                screen capture and view/hide your view screen? 
                                It is quite irritating to always have your view 
                                screen as part of the Desktop capture. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1350770&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1350770&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1350770">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1350770">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1350770&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1350770 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(965246,1350770);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 
                  src="/script/Forums/Images/t.gif" width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote HdUnSel " id=1351592_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1351592xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_answer.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=1351592#xx1351592xx" 
                        name=1351592>Re: "Desktop" ???</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2363661">Rashid.Mahmood</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">22:14 
                        29 Jan '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=1351592_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Thanx for ur comments.<BR>Actually 
                                my aim was to show you how you can capture the 
                                desktop including mouse cursor.<BR><BR>I will 
                                surely update the demo to accomodate the changes 
                                you mentioned.<BR><BR>If any other comments, 
                                please just post them.<BR><BR>Again Thanx <IMG 
                                src="/script/Forums/Images/smiley_smile.gif" 
                                align=absMiddle> <BR><BR>"Imagination is much 
                                more important than 
implementation"<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1351592&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=261533&amp;select=1351592&amp;floc=/KB/cs/DesktopCaptureWithMouse.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/cs/DesktopCaptureWithMouse.aspx?fid=261533&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=1350770">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=261533&amp;msg=1351592">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1351592&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1351592 
                                style="WHITE-SPACE: nowrap">4.50/5 (2 votes)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2363661,1351592);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 src="/script/Forums/Images/t.gif" width=1 
                  border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Sunday, March 2, 2008 2:02 AM &nbsp; &nbsp; 
                  Last Update:Sunday, March 2, 2008 2:07 AM</TD>
                <TD 
              style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><B>1</B></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 
      src="/script/Forums/Images/msg_general.gif" width=16 align=absMiddle> 
      General &nbsp;&nbsp; <IMG height=16 
      src="/script/Forums/Images/msg_news.gif" width=16 align=absMiddle> News 
      &nbsp;&nbsp; <IMG height=16 src="/script/Forums/Images/msg_question.gif" 
      width=16 align=absMiddle> Question &nbsp;&nbsp; <IMG height=16 
      src="/script/Forums/Images/msg_answer.gif" width=16 align=absMiddle> 
      Answer &nbsp;&nbsp; <IMG height=16 
      src="/script/Forums/Images/msg_joke.gif" width=16 align=absMiddle> Joke 
      &nbsp;&nbsp; <IMG height=16 src="/script/Forums/Images/msg_admin.gif" 
      width=16 align=absMiddle> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=12850">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy </A>| <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 27 Jan 2006<BR>Editor: <A 
            id=ctl00_ArticleEditor 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=28970">Smitha 
            Vijayan</A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2006 by 
            Rashid.Mahmood<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 
            1999-2008<BR>Web15 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE>
<SCRIPT language=Javascript 
src="CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files/front.asp" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
--></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Capturing the Desktop Screen with the Mouse Cursor Image_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
new HVMenu(new menu_NavbarConfig());
--></SCRIPT>
</BODY></HTML>
