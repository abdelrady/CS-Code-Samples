<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0065)http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx -->
<HTML><HEAD><TITLE>CodeProject: Using Window Messages to Implement Global System Hooks in C#. Free source code and programming help</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="Explains how to implement any type of global system hook in C# by using an unmanaged C++ DLL and Windows messages.; Author: ChrisP1118; Section: Hardware &amp; System; Chapter: General Reading" 
name=Description>
<META 
content="VC7.1, .NET 1.1, Win2K, WinXP, Win2003, Vista, VS.NET2003, C# 1.0, Dev, Beginner,Hardware &amp; System,General Reading,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("www.codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if(top!=self)top.location.href=location.href; if(typeof(DemoUrl)!="undefined")document.write(unescape('%3Cme')+'ta http'+'-equiv="re' +'fresh" con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/apiresults.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/JobsSummaryRetriever.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/jquery-1.2.6.min.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/jxs.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/rateitem.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/bookmark.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function MarkAns(MemberID,MsgID,QID) {
 document.write(unescape("%3Cdiv class=\"CallOut\"%3E"));
 document.write("Was this a good answer to your question? ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+", "+MsgID.toString()+",6,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"correct\" border=\"0\" align=\"absmiddle\" /%3E Yes%3C/a%3E"));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+","+MsgID.toString()+",7,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"correct\" style=\"margin-left:10px\" border=\"0\" align=\"absmiddle\" /%3E No%3C/a%3E"));
 document.write(unescape("%3C/div%3E"));
}
function MsgVFrm(MemberID,MsgID,GB,gp,bp,mt){
 if(!GB)document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"5":"1")+unescape(",0);\"%3E"));
 if(GB) document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;"); else for(var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"vote this message a " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ",0)\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"1":"5")+unescape(",0);\"%3E"));
 if(GB)document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" border=\"0\" alt=\"vote 5\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;&nbsp; "); else document.write(unescape("%3Cbr /%3E")); document.writeln(unescape("[%3Ca href='#xx") + MsgID.toString() +"xx' title='Report as Abuse' onclick='return ReportMsg(" + MemberID.toString());
 document.writeln(", " + MsgID.toString() + unescape(",-2)'%3EReport Message%3C/a%3E]"));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?"))
  return RateMsg(userid, msgid, score, 0);
 else return false;
}
function RateMsg(memberid, msgid, score, questionId) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4){
   if (req.status == 200){
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match&&match[1])?match[1]:"An error occured" + unescape("%3C/b%3E");
   } else
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString()+"&qid="+questionId.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK 
href="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/ForumClassicIE6.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" type=image/ico rel="shortcut icon">
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            id=ctl00_Logo 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; WIDTH: 225px; HEIGHT: 90px; BORDER-RIGHT-WIDTH: 0px" 
            alt="The Code Project" 
            src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/logo225x90.gif"></A></TD>
          <TD class=HeaderBanner align=right width="100%"><IFRAME 
            src="res://D:\WINDOWS.0\system32\shdoclc.dll/dnserror.htm" 
            frameBorder=0 width=728 scrolling=no height=90></IFRAME></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">5,644,149 
                  members and growing! (16,407 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">Abdelrady_FCIS</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx">My 
                  Settings</A> | <A id=ctl00_MemberMenu_MyCodeProject 
                  href="http://www.codeproject.com/script/Membership/MyCodeProject.aspx"><B>My 
                  CodeProject</B></A> | <A id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/fave.gif" 
                  width=16 align=absMiddle border=0> My Bookmarks</A> | <A 
                  id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2fsystem%2fWilsonSystemGlobalHooks.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD noWrap><A href="http://www.codeproject.com/">Home</A></TD>
                <TD>&nbsp; </TD>
                <TD style="FONT-WEIGHT: normal" noWrap align=right>Current 
                  Site:</TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/">C++ / .NET</A></TD>
                <TD noWrap><A href="http://java.codeproject.com/">Java</A></TD>
                <TD noWrap><A href="http://sql.codeproject.com/">SQL</A></TD>
                <TD noWrap><A href="http://lamp.codeproject.com/">Linux / 
                  Unix</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus>
                  <DIV id=MenuPos 
                  style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=380>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
                        Board</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
            Reading</A> » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/system/">Hardware &amp; 
            System</A> » <A id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/system/index.aspx?#Hardware &amp; System - General">General</A> 
            <SPAN class=ArticleBeginner 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Beginner</SPAN> <SPAN class=SmallText 
            id=ctl00_ArticleTopHeader_LicenceTerms 
            style="MARGIN-LEFT: 40px">License: <A 
            href="http://www.opensource.org/licenses/gpl-license.php">The GNU 
            General Public License (GPL)</A></SPAN> <BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>Using Window Messages to 
            Implement Global System Hooks in C#</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=83302">ChrisP1118</A></B><BR><BR><SPAN 
            class=ArticleTopDescr 
            id=ctl00_ArticleTopHeader_ArticleDescr>Explains how to implement any 
            type of global system hook in C# by using an unmanaged C++ DLL and 
            Windows messages.</SPAN> </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>VC7.1, C++, C#, C# 
            1.0Windows, .NET, .NET 1.1, Win2K, WinXP, Win2003, VistaVS.NET2003, 
            Visual Studio, Dev</SPAN><BR><BR><SPAN 
            style="WIDTH: 14ex">Posted</SPAN>: <B>3 May 2007</B><BR><SPAN 
            style="WIDTH: 14ex">Updated</SPAN>: <B>3 May 2007</B> <BR><SPAN 
            style="WIDTH: 14ex">Views</SPAN>: <B>47,553</B><BR><SPAN 
            style="WIDTH: 14ex">Bookmarked</SPAN>: <B>103 times</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar" 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px">
      <TABLE cellPadding=2>
        <TBODY>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/Info_24.png" 
            width=24></TD>
          <TD><A 
            href="http://www.codeproject.com/script/Awards/Competition.aspx?cid=286">Mobile 
            Developer Contest</A></TD></TR>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/MonthlyComp.png" 
            width=24 align=middle></TD>
          <TD><A id=ctl00_Announcements_CompLink 
            href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
            Competition</A></TD></TR></TBODY></TABLE></DIV><IMG id=ctl00_JobSummary_Li 
      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
      src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/animated_loading_blue.gif" 
      name=Li> 
      <DIV id=ctl00_JobSummary_Th style="DISPLAY: none" name="Th"></DIV>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2 style="DISPLAY: none">
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3 style="DISPLAY: none">
      <DIV class=MI id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4 style="DISPLAY: none">
      <DIV class=MI id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5 style="DISPLAY: none">
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV>
      <DIV class=MI id=Section128><A 
      href="http://www.codeproject.com/KB/testing/">Testing and QA</A></DIV>
      <DIV class=MI id=Section126><A 
      href="http://www.codeproject.com/KB/codegen/">Code 
      Generation</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7>
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV>
      <DIV class=MIS id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter12');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=12">Third 
      Party Products</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter12 style="DISPLAY: none">
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section124><A 
      href="http://www.codeproject.com/KB/solution-center/">Solution 
      Center</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
Board</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/kb/Showcase/">Product Showcase</A></DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/WhitePapers">WhitePapers / 
      Webcasts</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/Acresso">InstallShield 
      2009</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/APress">Apress 
      Bookstore</A></DIV><BR>
      <DIV style="MARGIN-BOTTOM: 10px; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d8018%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252fjobs.codeproject_need_a_dev_150x80.gif%26C%3dFalse%26adid%3d8018%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22150%22%20height%3d%2280%22%3e%3c%2fa%3e"));</SCRIPT>
      </DIV>
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d7957%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252fklik_160x600.jpg%26C%3dFalse%26adid%3d7957%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22160%22%20height%3d%22600%22%3e%3c%2fa%3e"));</SCRIPT>
    </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION> <OPTION value=s>Jobs</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top width="100%">
            <TABLE>
              <TBODY></TBODY></TABLE>
            <DIV class=SmallText><IMG style="VERTICAL-ALIGN: middle" height=16 
            alt=print 
            src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/print.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
            href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?display=Print">Print</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Broken Article?" 
            src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/report.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_BrokenLnk 
            href="http://www.codeproject.com/script/Articles/Report.aspx?aid=18638">Report 
            Article</A> &nbsp; <IMG style="VERTICAL-ALIGN: middle" alt=Watch 
            src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/watchon.png"> 
            <A class="" id=ctl00_ArticleHeaderLinks_ArticleBmkWatch_WatchMe 
            onclick="return watchMe(18638, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=18638&amp;obtid=2&amp;bma=AddWatch" 
            name=bmw_18638_2>Watch</A> <SPAN class=TinyText 
            id=ctl00_ArticleHeaderLinks_ArticleBmkWatch_StatusMsg 
            style="VISIBILITY: hidden" name="bmw_18638_2"></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Bookmark 
            src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/link.png" 
            width=16> <A class="" 
            id=ctl00_ArticleHeaderLinks_ArticleBmk_BookmarkMe 
            onclick="return bookmarkMe(18638, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=18638&amp;obtid=2&amp;bma=AddBookmark" 
            name=bm_18638_2>Bookmark</A> <SPAN class=TinyText 
            id=ctl00_ArticleHeaderLinks_ArticleBmk_StatusMsg 
            style="VISIBILITY: hidden" name="bm_18638_2"></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Discuss 
            src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/discuss.gif" 
            width=15> <A 
            href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx#_comments">Discuss</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Recommend Article" 
            src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/mail.gif" 
            width=16>&nbsp;<A id=ctl00_ArticleHeaderLinks_Recommend 
            href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=18638">Send&nbsp;to&nbsp;a&nbsp;friend</A> 
            </DIV></TD>
          <TD style="WIDTH: 100px; WHITE-SPACE: nowrap; TEXT-ALIGN: right">
            <TABLE id=CurRat>
              <TBODY>
              <TR>
                <TD>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=SmallText id=ctl00_ArticleRating_VL 
                      style="WHITE-SPACE: nowrap" align=right><SPAN 
                        id=ctl00_ArticleRating_VoteLabel>32 votes for this 
                        Article.</SPAN></TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=1>
                          <TBODY>
                          <TR>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD noWrap width=20 bgColor=white height=7><IMG 
                              height=7 
                              src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/red.gif" 
                              width=17 align=center 
                        border=0></TD></TR></TBODY></TABLE><SPAN class=SmallText 
                        id=ctl00_ArticleRating_Votes></SPAN></TD></TR>
                    <TR id=ctl00_ArticleRating_PopularityRow>
                      <TD class=SmallText align=right colSpan=2><A 
                        id=ctl00_ArticleRating_PopularityLnk 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                        7.32</A> <SPAN 
                        id=ctl00_ArticleRating_PopularityLbl></SPAN><SPAN 
                        id=ratingVal>Rating: <B>4.86</B> out of 
                    5</SPAN></TD></TR></TBODY></TABLE></TD>
                <TD>
                  <DIV>
                  <TABLE class=HistTable 
                  title="Voting Distribution. Recent data only">
                    <TBODY>
                    <TR>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>1</TD>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>2</TD>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>3</TD>
                      <TD><IMG title="4 votes, 12.5%" height=2 
                        alt="4 votes, 12.5%" 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>4</TD>
                      <TD><IMG title="28 votes, 87.5%" height=20 
                        alt="28 votes, 87.5%" 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/pollcol.gif" 
                        width=10 
              border=0><BR>5</TD></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks/WilsonGlobalSystemHooks_src.zip">Download 
        source and two demo projects - 113 Kb </A></LI></UL>
      <P><IMG height=336 alt="Screenshot - WilsonGlobalSystemHooks1.jpg" src="" 
      width=600></P>
      <P><IMG height=420 alt="Screenshot - WilsonGlobalSystemHooks1.jpg" src="" 
      width=600></P>
      <H2>Introduction</H2>
      <P>Global system hooks allow an application to intercept Windows messages 
      intended for other applications. This has always been difficult 
      (impossible, according to MSDN) to implement in C#. This article attempts 
      to implement global system hooks by creating a DLL wrapper in C++ that 
      posts messages to the hooking application's message queue. Put simply, 
      this lets you implement any type of global Windows hook from managed code. 
      </P>
      <H2>Why Global System Hooks and C# Don't Play Well Together</H2>
      <P>Global system hooks have always been a problem for .NET developers. To 
      understand why, we first need to discuss how hooks work at a system level 
      and how Windows processes these event notifications. </P>
      <P>Normally, an application implements hooks by creating a callback 
      function and informing Windows of this function. When Windows processes a 
      hookable event, such as mouse movement or the creation of a window, it 
      calls this callback function, which the hooking application handles 
      accordingly. With local hooks (when an application hooks other events 
      taking place in the same process), this callback function can be located 
      anywhere, and local hooks can be written pretty easily in C# -- a quick 
      look around CodeProject reveals several examples. Unfortunately, Windows 
      is not so permissive with global system hooks, which allow one process to 
      intercept events from another process. Windows insists that the callback 
      functions for global system hooks be located in DLLs. Neither C# nor 
      VB.NET are able to produce standard Windows DLLs, which means they're also 
      unable to process global system hooks -- the MSDN library even explicitly 
      says global system hooks cannot be handled within managed code 
      applications. How discouraging! </P>
      <P>Luckily, C# programmers are a clever and crafty bunch. Michael Kennedy, 
      in his CodeProject article <A 
      href="http://www.codeproject.com/csharp/globalsystemhook.asp">"Global 
      System Hooks in .NET"</A>, came up with a workaround. Using C++, he 
      created a DLL that essentially worked as a wrapper to managed code. The 
      C++ DLL registered a callback function with Windows. When a hook 
      notification arrived in that callback, it called a managed code function. 
      Using this technique, he was able to trap several hook notifications, such 
      as low-level keyboard and mouse events. The problem he discovered, though, 
      was that Windows changes the execution context when sending out certain 
      hook notifications. When Windows hooked a low-level mouse or keyboard 
      event, it called any hooking application from within the context of the 
      hooking application. But for most other events, the callback function was 
      called from the context of the hooked application. This essentially meant 
      that his wrapper functions couldn't be used with most Windows hooks. </P>
      <H2>The Workaround</H2>
      <P>I've created my own workaround to this problem, although as you'll see 
      below, it comes with some definite caveats. In a nutshell, what I've done 
      is (like Kennedy) to create a C++ DLL which contains the actual callback 
      function. However, the DLL doesn't just serve as a wrapper to a managed 
      code delegate. Instead, when it receives a hook notification, it posts a 
      custom Windows message to the managed application's Windows message queue. 
      This message can then be intercepted in the C# program's 
      <CODE>WndProc</CODE> event. So, just as a window regularly receives 
      messages like <CODE>WM_MOUSEMOVE</CODE>, your managed application will now 
      also receive messages like <CODE>WILSON_HOOK_SHELL_WINDOWCREATED</CODE>. 
      </P>
      <H2>The Projects</H2>
      <P>The code consists of three projects. First, there's the GlobalCbtHook, 
      a C++ project which creates the DLL used for the callback functions. 
      Second, there's GlobalHooksTest, a simple application designed to 
      demonstrate this code, which implements <CODE>WH_SHELL</CODE> and 
      <CODE>WH_CBT</CODE> hooks. The third (and coolest) of the three projects 
      is TransparencyMenu. This is also a demonstration project, showing an 
      actual practical application of global system hooks. </P>
      <H2>GlobalCbtHook -- the DLL Project</H2>
      <P>This project is deceptively simple. There are, however, a few quirks to 
      my programming, which have created the potential for some bugs in your 
      application, as described below. One other note: with some minor 
      exceptions, all the similarly-named functions in the DLL do the same 
      thing, just for different types of hooks. That is, 
      <CODE>InitializeCbtHook</CODE> and <CODE>InitializeShellHook</CODE> work 
      in the same way -- so in my explanations below, I use <CODE>ABC</CODE> as 
      a sort of generic hook. </P>
      <H3>Warning One: SetProp and GetProp</H3>
      <P>Because Windows injects the callback function into all running 
      processes, there will always be multiple instances of this code loaded. 
      Yet they all need to share at least one piece of information, namely, the 
      handle to the window that needs to receive the hook event notifications. 
      After several frustrating hours reading up on shared memory, I decided I 
      wanted an easier solution. That's when the MSDN documentation threw me a 
      lifesaver in the form of <CODE>GetProp</CODE> and <CODE>SetProp</CODE>. 
      </P>
      <P><CODE>GetProp</CODE> and <CODE>SetProp</CODE> are API functions that 
      allow you to associate any type of handle with any window. That is, if you 
      have a window handle (<CODE>hWnd</CODE>), you can associate any other 
      handle with it, and in such a way that any application can access that 
      data. Luckily, there's one window handle that's essentially constant in 
      any Windows session, the desktop handle. So, in order to store the handle 
      to the window receiving hook events, I use the desktop window's 
      properties. This is kind of a hack, but works pretty reliably and 
      effectively. The <CODE>InitializeAbcHook</CODE> functions checks to see if 
      there is already a handle named <CODE>WILSON_HOOK_HWND_ABC</CODE> already 
      associated with the desktop window. Assuming there's not, this handle is 
      set to the handle of the window that will receive the hook events. </P>
      <P>This code is in <CODE>InitializeCbtHook</CODE>, showing 
      <CODE>GetProp</CODE>: </P><PRE><SPAN class=code-keyword>if</SPAN> (GetProp(GetDesktopWindow(), <SPAN class=code-string>"</SPAN><SPAN class=code-string>WILSON_HOOK_HWND_CBT"</SPAN>) != NULL)
{
  SendNotifyMessage((HWND)GetProp(GetDesktopWindow(), 
      <SPAN class=code-string>"</SPAN><SPAN class=code-string>WILSON_HOOK_HWND_CBT"</SPAN>), 
      RegisterWindowMessage(<SPAN class=code-string>"</SPAN><SPAN class=code-string>WILSON_HOOK_CBT_REPLACED"</SPAN>), <SPAN class=code-digit>0</SPAN>, <SPAN class=code-digit>0</SPAN>);
}

SetProp(GetDesktopWindow(), <SPAN class=code-string>"</SPAN><SPAN class=code-string>WILSON_HOOK_HWND_CBT"</SPAN>, destination);</PRE>
      <P>And <CODE>SetProp</CODE> is used in <CODE>CbtHookCallback</CODE> to 
      retreive the window handle: </P><PRE>HWND dstWnd = (HWND)GetProp(GetDesktopWindow(),
               <SPAN class=code-string>"</SPAN><SPAN class=code-string>WILSON_HOOK_HWND_CBT"</SPAN>);</PRE>
      <P>There is one major problem to this approach: it means that only one 
      application can be hooking these events at a time. When a second 
      application (that uses the same DLL) starts hooking events, a message 
      (<CODE>WILSON_HOOK_CBT_REPLACED</CODE>) is sent to the first application, 
      informing it that it's now out of luck and no longer hooking anything. So, 
      if you use this code in your own software, it'd be a good idea to 
      recompile it, changing the <EM>WILSON_HOOK</EM> strings to something 
      different, so that your application will not conflict with any other 
      software using this approach. </P>
      <H3>Warning Two: Return Values</H3>
      <P>The other major problem with my particular approach to hooking is that 
      it doesn't allow you to return a value when a hook callback is called. 
      Normally, a hook callback function is allowed to return a value, which can 
      affect whatever event is happening that generated the hook. For instance, 
      when the CBT <CODE>CREATEWND</CODE> hook is raised, setting a non-zero 
      return value prevents the window from being created. This functionality 
      could be used to prevent certain classes or types of windows from being 
      created. However, in its current form, my solution doesn't allow you to 
      set a return value. There is, theoretically, a fairly easy workaround for 
      this. I use the <CODE>SendNotifyMessage</CODE> in the C++ DLL to send the 
      message to the hooking application, which means the DLL just posts a 
      message and then doesn't wait around to see if the hooking application 
      actually processes it. However, you could instead use the 
      <CODE>SendMessage</CODE> command, which forces the DLL to wait for the 
      hooking application to process the hook and return the value set in 
      <CODE>Message.Result</CODE> in the managed code. The downside to this 
      approach, and the reason I didn't implement it this way, is that it can 
      very easily lead to system crashes. If your managed code encounters an 
      unhandled exception, execution won't return to the calling 
      <CODE>SendMessage</CODE> function, which in turn hangs the application 
      being hooked. A dozen hard reboots in the span of about 20 minutes 
      convinced me of the wisdom of <CODE>SendNotifyMessage</CODE>. </P>
      <H3>The RegisterWindowMessage Function</H3>
      <P>My code uses the <CODE>RegisterWindowMessage</CODE> function. This is 
      an API function which generates a unique message ID that can be used among 
      multiple applications. When one application registers a message with a 
      certain name, any other application that registers a message of the same 
      name will get the same message ID in response. All the messages posted by 
      the DLL use message IDs generated by this function. Thus, managed code 
      must also call this function to know what message IDs to watch for in 
      <CODE>WndProc</CODE>. </P>
      <H3>Inside the DLL</H3>
      <P>The C++ DLL contains code to handle eight different types of hooks. If 
      you are so inclined, you should be able to follow the model and easily 
      create additional code to handle the other hook types. For each type of 
      hook, there are three functions in the DLL. These three functions are 
      more-or-less the same between all the different hook types. </P>
      <P><CODE>InitializeAbcHook</CODE> is an exported function that's called 
      from managed code. The first parameter is the ID of the thread to hook. 
      Setting this to zero will hook all processes -- giving you a global hook. 
      You could also use this to only hook events from one thread, which in many 
      scenarios would be far more efficient than hooking events in all threads. 
      The second parameter is the handle of the window that hook events will be 
      broadcast to. This should be the handle of a form or a control. The 
      <CODE>InitializeAbcHook</CODE> function checks to see if a message handle 
      has already been stored (a.k.a., another application is already hooking 
      using our DLL), then stores this handle, and finally installs the hook 
      using this line: </P><PRE>hookAbc = SetWindowsHookEx(WH_ABC, (HOOKPROC)AbcHookCallback, 
                                g_appInstance, threadID);</PRE>
      <P><CODE>UninitializeAbcHook</CODE> just removes the hook. Make sure your 
      managed code application calls this before quitting -- if you don't, the 
      DLL will keep hooking, even though your application (that's supposed to 
      receive the hooks) has ended. This can lead to some major problems, as 
      well as needlessly degrades performance. </P>
      <P><CODE>AbcHookCallback</CODE> is the actual callback function, and 
      varies a bit depending on the hook type. For the simplest hooks, like 
      mouse and keyboard hooks, this function just sends the necessary message 
      to the queue of the hooking application, and then continues the hook chain 
      by calling <CODE>CallNextHookEx</CODE>. For hooks like CBT or Shell, there 
      are multiple types of events that could be occuring -- such as 
      <CODE>ACTIVATE</CODE> or <CODE>CREATEWND</CODE>. The callback function 
      determines which type of sub-hook is being called, and then raises the 
      appropriate event. For <CODE>CallWndProc</CODE> and <CODE>GetMsg</CODE>, 
      there is too much data to send to the hooking application using only one 
      message. For these two hooks, after all, there are four pieces of data we 
      want to know in our managed application: the handle of the hooked window, 
      the message that was hooked, and the <CODE>lParam</CODE> and 
      <CODE>wParam</CODE> values -- however, when sending our own messages to 
      the hooking application, we can only send data in <CODE>lParam</CODE> and 
      <CODE>wParam</CODE>. So these two callback functions send two messages, 
      one with the handle and intercepted message, the other with the 
      intercepted <CODE>lParam</CODE> and <CODE>wParam</CODE>. They also have a 
      check to prevent infinite recursion -- <CODE>GetMsg</CODE> sends a message 
      to the hooking application, which is in turn intercepted by the same 
      callback function that posted the message. </P>
      <H2>The Managed Code: GlobalHooks.cs</H2>
      <P>I've created a class called <CODE>GlobalHooks</CODE> which functions as 
      an intermediary between a managed application and the DLL, making it easy 
      to implement global hooks in your own projects. The class contains an 
      abstract internal class called <CODE>Hook</CODE>, as well as eight 
      subclasses of <CODE>Hook</CODE>, one for each type of hook supported. </P>
      <P>To use global system hooks in your own code, the first thing to do is 
      create an instance of the <CODE>GlobalHooks</CODE> class: </P><PRE>    <SPAN class=code-keyword>private</SPAN> GlobalHooks _GlobalHooks;
</PRE>
      <P>When you instantiate this class, you must pass it a window handle: </P><PRE>    _GlobalHooks = <SPAN class=code-keyword>new</SPAN> GlobalHooks(<SPAN class=code-keyword>this</SPAN>.Handle);
</PRE>
      <P>You also need to override the <CODE>WndProc</CODE> function to allow 
      the <CODE>GlobalHooks</CODE> function to process all incoming messages. 
      This <CODE>ProcessWindowMessage</CODE> function checks for messages coming 
      from the DLL, indicating a hook notification has been raised. </P><PRE>    <SPAN class=code-keyword>protected</SPAN> override <SPAN class=code-keyword>void</SPAN> WndProc(<SPAN class=code-keyword>ref</SPAN> Message m)
    {
        <SPAN class=code-keyword>if</SPAN> (_GlobalHooks != null)
            _GlobalHooks.ProcessWindowMessage(<SPAN class=code-keyword>ref</SPAN> m);

        base.WndProc (<SPAN class=code-keyword>ref</SPAN> m);
    }
</PRE>
      <P>Next, you need to create some event handlers for whatever you want to 
      hook. For instance, to receive notification every time a top-level window 
      is created, create an event handler for the 
      <CODE>GlobalHooks.Shell.WindowCreated</CODE>, as follows: </P><PRE>    _GlobalHooks.Shell.WindowCreated += 
               <SPAN class=code-keyword>new</SPAN> GlobalHooks.WindowEventHandler(Shell_WindowCreated);</PRE>
      <P>To begin hooking events, you must call the <CODE>Start</CODE> function 
      in the appropriate class. </P><PRE>    _GlobalHooks.Shell.Start();
</PRE>
      <P>Just as important are the corresponding <CODE>Stop</CODE> functions, 
      which must be called when you want to stop hooking events. Make sure you 
      stop hooking events before your application terminates. </P><PRE>    _GlobalHooks.Shell.Stop();
</PRE>
      <P>That's all it takes! </P>
      <H2>Final Thoughts</H2>
      <P>Despite the potential pitfalls, the technique described here has worked 
      quite well for me when I've needed to hook global events. However, if 
      you're creating an application that only needs to hook low-level mouse or 
      keyboard events, Michael Kennedy's code might be better suited for you. 
      Also, the <CODE>CallWndProc</CODE> and <CODE>GetMsg</CODE> hooks are both 
      pretty inefficient, as they essentially duplicate every message generated 
      by Windows (creating a copy to send to the hooking application). If your 
      application only needs to hook one or two messages, you can easily rewrite 
      the DLL to only post notification messages to the hooking application when 
      the hooked program receives those one or two messages you're looking for. 
      </P><!-- Article Ends --><!-- Main Page Contents End --></DIV>
      <FORM id=aspnetForm 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
      name=aspnetForm action=WilsonSystemGlobalHooks.aspx method=post>
      <DIV><INPUT id=__VIEWSTATE type=hidden 
      value=/wEPDwULLTEwMDUyNjYzMjhkZOEVUctdXYMD3r7lh2weB4t11F/Z 
      name=__VIEWSTATE> </DIV>
      <H2>License</H2>
      <DIV id=ctl00_LicenseTerms>
      <P>This article, along with any associated source code and files, is 
      licensed under <A 
      href="http://www.opensource.org/licenses/gpl-license.php">The GNU General 
      Public License (GPL)</A></P></DIV>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=83302">ChrisP1118</A></B><BR><BR>
            <CENTER></CENTER><BR><SPAN class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>I currently live in a small town in Burkina Faso, where I spend 
            some of my free time (during the hours when there's electricity) 
            playing around with C#. For a bit more about my less nerdy 
            activities, check out <A 
            href="http://chrisburkina.blogspot.com/">http://chrisburkina.blogspot.com/</A> 
            or <A 
            href="http://www.youtube.com/watch?v=Rw1Pb7hlIWw">http://www.youtube.com/watch?v=Rw1Pb7hlIWw</A> 
            -- neither of them, however, has anything to do with C#.<BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt="Burkina Faso" src="" width=16> Burkina 
                  Faso</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular Hardware &amp; System articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/system/xyntservice.aspx">Start 
              Your Windows Programs From An NT Service</A>
              <DIV class=SmallText>Make your MFC, VB and other Windows programs 
              behave like NT services.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/system/serial.aspx">Serial 
              library for C++</A>
              <DIV class=SmallText>A high-performance, complete and compact 
              serial library for C++</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/system/driverdev.aspx">Driver 
              Development Part 1: Introduction to Drivers</A>
              <DIV class=SmallText>This article will go into the basics of 
              creating a simple driver.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/system/hooksys.aspx">API 
              hooking revealed</A>
              <DIV class=SmallText>The article demonstrates how to build a user 
              mode Win32 API spying system</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/system/NoDeleteDelay.aspx">Eliminating 
              Explorer's delay when deleting an in-use file</A>
              <DIV class=SmallText>How to track down and patch an annoyance in 
              Windows Explorer's code.</DIV></LI></UL></TD>
          <TD><IFRAME 
            src="res://D:\WINDOWS.0\system32\shdoclc.dll/dnserror.htm" 
            frameBorder=0 width=300 scrolling=no 
        height=250></IFRAME></TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
var socialLinks = new social();
socialLinks.addtoMethod=1;
socialLinks.DrawLinks("socialLinks", document.location.href, escape(document.title), 100, 0, "SmallText Bold", "AddTo");
</SCRIPT>
      </DIV>
      <TABLE class=RatingBar id=ctl00_RateArticleRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD id=ctl00_RateArticle_VoteResultDiv noWrap align=right 
                width="100%"><SPAN id=voteRes></SPAN><IMG id=loaderImg 
                  style="DISPLAY: none" height=16 alt=loading... 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/ajax-loader.gif" 
                  width=16> </TD>
                <TD class=SmallText id=voteTbl style="WHITE-SPACE: nowrap" 
                align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px; WHITE-SPACE: nowrap"><I><B>Rate 
                        this Article for us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm noWrap 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn onclick="return rateItem(18638,2);" type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV><INPUT id=__EVENTVALIDATION type=hidden 
      value=/wEWCAKT5duJCQLAlMXDBwLBlMXDBwLClMXDBwLDlMXDBwLElMXDBwLP+++tCwK5upDkC1mdUqTWK0Srhex3TAHLOrUQkAZR 
      name=__EVENTVALIDATION> </DIV></FORM>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6678%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fAdm%252fimages%252finnovaysys_docX_468x60.gif%26C%3dFalse%26adid%3d6678%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22468%22%20height%3d%2260%22%3e%3c%2fa%3e"));</SCRIPT>
      <IFRAME src="res://D:\WINDOWS.0\system32\shdoclc.dll/dnserror.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD>
            <FORM 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fsystem%2fWilsonSystemGlobalHooks.aspx&amp;fid=414057 
            method=get><INPUT type=hidden value=414057 name=fid><INPUT 
            type=hidden 
            value=?floc=%2fKB%2fsystem%2fWilsonSystemGlobalHooks.aspx&amp;fid=414057 
            name=currentQS><INPUT type=hidden 
            value=/KB/system/WilsonSystemGlobalHooks.aspx name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 alt=FAQ 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/forum_faq.gif" 
                  width=16 align=middle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 alt=Search 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/forum_search.gif" 
                  width=16 align=top border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=414057">Search 
                  Messages</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=SetOpt></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></FORM></TD></TR>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 alt=new 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/forum_newmsg.gif" 
                  width=16 align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 25 of 31 (Total in Forum: 31) (<A 
                  href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next</A></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0><!-- Column Headers -->
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2724877_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2724877xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2724877#xx2724877xx" 
                        name=2724877>Using your class to cancel a particular 
                        window?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1753232">mpgjunky</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">16:00 
                        15 Sep '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2724877_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR><BR>Firstly, well done on 
                                this quite complex subject.<BR><BR>Secondly, I 
                                was wondering if you could point me in the right 
                                direction in using your class to intercept and 
                                dismiss a particular window?<BR><BR>Specifically 
                                I have a WebBrowser class on my form navigating 
                                to a secure page with a self signed certificate 
                                which generates a security dialog.<BR><BR>I wish 
                                to either dismiss or accept [answer yes in the 
                                dialog] so the message does not get shown to the 
                                user.<BR><BR>After much googling around, I think 
                                the only method this can be achieved is using 
                                hooks, unless I am wrong.<BR><BR>Many 
                                thanks,<BR>Michael.<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2724877&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2724877&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2724877">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2724877">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2724877&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2724877 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1753232,2724877,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2598069_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2598069xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2598069#xx2598069xx" 
                        name=2598069>How to hook outlook windows message</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=929491">Alex_Bob</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:29 15 
                        Jun '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2598069_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>First of all, i want to thank you 
                                for this useful document. But i still have 
                                difficulty to hook outlook Windows message with 
                                SetWindowsHookEx, i mean which type of hoo i 
                                have to use for the first parameter of 
                                SetWindowsHookEx function.<BR><BR>After my 
                                investigation if found RegisterWindowMessage 
                                funtion. In my case, it's possible to use it 
                                with SetWindowsHookEx together??? to be able to 
                                only focus on outlook.<BR><BR>Thanks 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2598069&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2598069&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2598069">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2598069">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2598069&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2598069 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(929491,2598069,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2551775_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2551775xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2551775#xx2551775xx" 
                        name=2551775>The main window slow down with MouseDLL 
                        hook?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=606401">minhvc</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:33 14 
                        May '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2551775_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>When you start MouseDLL hook and 
                                click to minimize, maximize button the window 
                                resized is me more slow than when we call stop 
                                the MouseDll hook? How speed up? <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2551775&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2551775&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2551775">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2551775">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2551775&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2551775 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(606401,2551775,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2531022_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2531022xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2531022#xx2531022xx" 
                        name=2531022>The Transperancy menu does not affect IE 
                        and it does not affect new windows, only existing 
                        ones</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=5035476">asnat</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:53 30 
                        Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2531022_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>am i missing something? 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2531022&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2531022&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2531022">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2531022">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2531022&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2531022 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(5035476,2531022,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2516912_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2516912xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2516912#xx2516912xx" 
                        name=2516912>How would you get a handle of an 
                        application's sub item(s) rather than the main 
                      form</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2858138">Member 
                        2858138</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">13:12 
                        21 Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2516912_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I see that it displays the caption 
                                of the Window that i click on, but if i click on 
                                a textbox or a button in that window i still get 
                                only the caption of the main window. Any tips on 
                                how to get the handle of the specific item? 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2516912&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2516912&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2516912">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2516912">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2516912&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2516912 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(2858138,2516912,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2441606_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2441606xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2441606#xx2441606xx" 
                        name=2441606>Get notified when a new process has 
                        started</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2328789">Dsypher</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:37 26 
                        Feb '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2441606_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR><BR>What do I have to do to 
                                get notified when a new process, the one's we 
                                see in the task manager has started? Can I get 
                                the full filename of that process?<BR><BR>Thanks 
                                <BR><BR>
                                <DIV class=ForumSig>There is no patch for 
                                ignorance</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2441606&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2441606&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2441606">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2441606">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2441606&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2441606 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(2328789,2441606,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2438742_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2438742xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2438742#xx2438742xx" 
                        name=2438742>GetMsg stops firing after a while</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4259439">cypher5432</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">17:45 
                        23 Feb '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2438742_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I'm trying to catch when any 
                                window has been minimized. The only way that 
                                seems to remotely work is to use GetMsg, catch 
                                WM_SIZE, and read the low-order word of wParam 
                                (which tells if the window's current 
                                state).<BR><BR>This works fine and it catches 
                                WM_SIZE messages for a bit. But, by the time my 
                                application's main window has opened, GetMsg has 
                                stopped firing. I've set a breakpoint on my 
                                GetMsg callback and it simply doesn't get called 
                                any longer, even when I can see a window is 
                                sending WM_SIZE messages in Spy++.<BR><BR>Can 
                                you tell me why GetMsg stops firing after a 
                                while? Or perhaps suggest another method for 
                                catching when a window has been 
                                minimized?<BR><BR>Thank you! <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2438742&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2438742&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2438742">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2438742">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2438742&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2438742 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4259439,2438742,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2221076_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2221076xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2221076#xx2221076xx" 
                        name=2221076>Possible use in a Console 
                      application?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4333044">MVWODOC</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">16:29 
                        10 Sep '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2221076_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>This is an extraordinary article, 
                                and piece of coding. Thanks for placing it in 
                                Code Project. <BR>I'd love to use it as the 
                                basis for a feature in a Console application 
                                where it would watch which windows are being 
                                created by the user. But this newbie can't 
                                figure out how to get around your use of WndProc 
                                here to catch Windows messages. Is there a way 
                                to do this? I could create a dummy form whose 
                                sole purpose is to catch and handle messages, 
                                but I'm hoping for a cleaner way. Any thoughts? 
                                <BR><BR>= Marchand =<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2221076&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2221076&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2221076">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2221076">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2221076&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2221076 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(4333044,2221076,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2199156_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2199156xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2199156#xx2199156xx" 
                        name=2199156>Hint or Tooltip</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1227503">oakcool</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:23 25 
                        Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2199156_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello there, I want to know if 
                                when a user takes the mouse over something 
                                inside the application and a ToolTip shows up, 
                                if a can grab the text on it.<BR>If it is 
                                possible what do you advise me to approach this 
                                problem.<BR>The Idea is to automate a layout 
                                test tool, so I will be moving the mouse arround 
                                and doing tasks acordinly to what I find. 
                                <BR><BR>Thanks,<BR><BR>Mateus<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2199156&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2199156&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2199156">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2199156">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2199156&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2199156 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1227503,2199156,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2198451_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2198451xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2198451#xx2198451xx" 
                        name=2198451>WH_GETMESSAGES</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3474036">ablmonroe</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:59 
                        24 Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2198451_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>is there a list of the messages 
                                that this actually captures?<BR><BR><BR>i added 
                                some code to check for 
                                WM_WINDOWPOSCHANGED<BR><BR>but it never seems to 
                                get captured.<BR><BR><BR>Thanks <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2198451&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2198451&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2198451">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2198451">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2198451&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2198451 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3474036,2198451,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2221729_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2221729xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2221729#xx2221729xx" 
                        name=2221729>Re: WH_GETMESSAGES</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=83302">ChrisP1118</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:35 11 
                        Sep '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2221729_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Try using the Spy++ tool that 
                                comes with Visual Studio. It lets you monitor 
                                exactly which messages are sent to a window. 
                                Also, try using WH_GETMSG or a few of the other 
                                hooks that intercept all messages and see if you 
                                have better luck with them. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2221729&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2221729&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2198451">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2221729">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2221729&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2221729 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(83302,2221729,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2623941_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2623941xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2623941#xx2623941xx" 
                        name=2623941>Re: WH_GETMESSAGES</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2852742">Singulink</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">16:02 3 
                        Jul '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2623941_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I will second this - there are a 
                                bunch of messages that don't get passed through 
                                with the GetMsg hook. One of them is the 
                                WM_WINDOWPOSCHANGED message, another is WM_MOVE, 
                                and I'm sure there are more (but those are the 
                                ones I found). <BR><BR>My less then ideal 
                                workaround is to capture WM_MOUSEMOVE and just 
                                perform what I need done on window resize/move 
                                each time, as well as on the CBT MoveSize 
                                event.<BR><BR>Any idea why those messages don't 
                                get passed through?<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2623941&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2623941&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2198451">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2623941">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2623941&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2623941 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(2852742,2623941,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2100393_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2100393xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2100393#xx2100393xx" 
                        name=2100393>Hooks in WinCE</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3068947">Rahul 
                        P. Shukla</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:54 26 
                        Jun '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2100393_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR>Can we create same hooks in 
                                WinCE. I have to trap the keyboard messages 
                                intended for other application.<BR>please reply 
                                if its possible anyway in WinCE.<BR><BR>thanks 
                                <BR><BR>
                                <DIV class=ForumSig>Thanks,<BR>Rahul <IMG 
                                alt=Smile 
                                src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top></DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2100393&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2100393&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2100393">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2100393">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2100393&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2100393 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3068947,2100393,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2061665_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2061665xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2061665#xx2061665xx" 
                        name=2061665>problem with IE7 in protect mode</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2556547">LuxNw</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:58 31 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2061665_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR>i try your app on Vista 
                                with IE7 in protect mode, and it doesn't work 
                                fine...<BR>your app doesn't detect IE7 
                                message.<BR>If i turn off protect mode all work 
                                fine.<BR>Have you any idea how to solve the 
                                problem?<BR><BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2061665&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2061665&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2061665">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2061665">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2061665&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2061665 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(2556547,2061665,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2045533_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2045533xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2045533#xx2045533xx" 
                        name=2045533>getting text of currently selected 
                      menu</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2992753">neo786</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">15:05 
                        20 May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2045533_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi, Is it possible to find out the 
                                text of the currently selected menu item e.g. 
                                file/edit save/print... <BR>using the GetMsg 
                                hook? Is there a message fired everytime a user 
                                hhighlights a menu item.<BR>Thanks, D 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2045533&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2045533&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2045533">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2045533">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2045533&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2045533 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(2992753,2045533,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2044403_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2044403xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2044403#xx2044403xx" 
                        name=2044403>Hello , I need to use your hook model in 
                        more than one application at a time</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3208448">Ky 
                        Nam</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:39 
                        18 May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2044403_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello , can you help me with this 
                                piece of code ?<BR><BR>I need to use your hook 
                                model in more than one application at a time , 
                                so i write this :<BR><BR>#include 
                                &lt;stdlib.h&gt;<BR><BR>#include 
                                &lt;list&gt;<BR><BR>void 
                                ClearRegisteredWindows(LPCTSTR 
                                HookMessage)<BR><BR>{<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; 
                                RemoveProp(GetDesktopWindow(), 
                                HookMessage);<BR><BR>}<BR><BR>void 
                                RegisterWindow(HWND Window , LPCTSTR 
                                HookMessage)<BR><BR>{<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; std::list&lt;HWND&gt;* 
                                l;<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                l = (std::list&lt;HWND&gt;*) 
                                GetProp(GetDesktopWindow(), 
                                HookMessage);<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; if (l==NULL)<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; {<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; l = new 
                                std::list&lt;HWND&gt;;<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; BOOL kq = 
                                SetProp(GetDesktopWindow(), HookMessage, 
                                l);<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; }<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; 
                                l-&gt;push_back(Window);<BR><BR>}<BR><BR>void 
                                SendHookNotifyMessage(LPCTSTR HookMessage, UINT 
                                msg, WPARAM wparam, LPARAM 
                                lparam)<BR><BR>{<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; std::list&lt;HWND&gt;* 
                                l;<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                l = (std::list&lt;HWND&gt;* ) 
                                GetProp(GetDesktopWindow(), 
                                HookMessage);<BR><BR><BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; //i think the error 
                                occurs here<BR><BR><BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; for 
                                (std::list&lt;HWND&gt;::iterator i = 
                                l-&gt;begin() ; i != l-&gt;end() ; 
                                i++)<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; SendNotifyMessage(*i, msg, wparam, 
                                lparam);<BR><BR>}<BR><BR><BR><BR>Some other 
                                codes :<BR><BR>#include 
                                &lt;malloc.h&gt;<BR><BR><BR><BR>LPCTSTR 
                                HookMessagePrefix=TEXT("WILSON_HOOK_");<BR><BR>int 
                                HookMessagePrefixSize=lstrlen(HookMessagePrefix);<BR><BR>LPTSTR 
                                NewText ;<BR><BR>LPCTSTR AddPrefix(LPCTSTR 
                                Text)<BR><BR>{<BR><BR>#ifdef UNICODE&nbsp;&nbsp; 
                                <BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                NewText = (LPTSTR) realloc(NewText, 
                                (HookMessagePrefixSize + lstrlen(Text) ) * 2 + 
                                1);<BR><BR>#else <BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; NewText = (LPTSTR) 
                                realloc(NewText, HookMessagePrefixSize + 
                                lstrlen(Text) +1);<BR><BR>#endif 
                                <BR><BR><BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; 
                                lstrcpy(NewText,HookMessagePrefix);<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; return 
                                lstrcat(NewText,Text);<BR><BR>}<BR><BR><BR><BR>And 
                                use it :<BR><BR>bool InitializeShellHook(int 
                                threadID, HWND 
                                destination)<BR><BR>{<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; if (g_appInstance == 
                                NULL)<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; {<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; return false;<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; 
                                }<BR><BR><BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; RegisterWindow(destination, 
                                AddPrefix(TEXT("HWND_SHELL")));<BR><BR><BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; hookShell = 
                                SetWindowsHookEx(WH_SHELL, 
                                (HOOKPROC)ShellHookCallback, g_appInstance, 
                                threadID);<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; return hookShell != 
                                NULL;<BR><BR>}<BR><BR><BR><BR>static LRESULT 
                                CALLBACK ShellHookCallback(int code, WPARAM 
                                wparam, LPARAM 
                                lparam)<BR><BR>{<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; if (code &gt;= 
                                0)<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                {<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; UINT msg 
                                = 0;<BR><BR><BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; if (code == 
                                HSHELL_ACTIVATESHELLWINDOW)<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; msg = 
                                RegisterWindowMessage(AddPrefix(TEXT("HSHELL_ACTIVATESHELLWINDOW")));<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; else if (code == 
                                HSHELL_GETMINRECT)<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; msg = 
                                RegisterWindowMessage(AddPrefix(TEXT("HSHELL_GETMINRECT")));<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; else if (code == 
                                HSHELL_LANGUAGE)<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; msg = 
                                RegisterWindowMessage(AddPrefix(TEXT("HSHELL_LANGUAGE")));<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; else if (code == 
                                HSHELL_REDRAW)<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; msg = 
                                RegisterWindowMessage(AddPrefix(TEXT("HSHELL_REDRAW")));<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; else if (code == 
                                HSHELL_TASKMAN)<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; msg = 
                                RegisterWindowMessage(AddPrefix(TEXT("HSHELL_TASKMAN")));<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; else if (code == 
                                HSHELL_WINDOWACTIVATED)<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; msg = 
                                RegisterWindowMessage(AddPrefix(TEXT("HSHELL_WINDOWACTIVATED")));<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; else if (code == 
                                HSHELL_WINDOWCREATED)<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; msg = 
                                RegisterWindowMessage(AddPrefix(TEXT("HSHELL_WINDOWCREATED")));<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; else if (code == 
                                HSHELL_WINDOWDESTROYED)<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; msg = 
                                RegisterWindowMessage(AddPrefix(TEXT("HSHELL_WINDOWDESTROYED")));<BR><BR><BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; if (msg != 
                                0)<BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; 
                                SendHookNotifyMessage(AddPrefix(TEXT("HWND_SHELL")), 
                                msg, wparam, lparam);<BR><BR>&nbsp;&nbsp; 
                                &nbsp;&nbsp; &nbsp;&nbsp; 
                                }<BR><BR><BR><BR>&nbsp;&nbsp; &nbsp;&nbsp; 
                                &nbsp;&nbsp; return CallNextHookEx(hookShell, 
                                code, wparam, lparam);<BR><BR>}<BR><BR><BR><BR>I 
                                can not send message to windows in list . The 
                                list i get from desktop window’s property have 
                                no entry , even i often can not get the size of 
                                list .<BR><BR>Excuse me , i very rarely write 
                                C++ code&nbsp;&nbsp; .<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2044403&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2044403&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2044403">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2044403">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2044403&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2044403 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3208448,2044403,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote HdUnSel " id=F2044577_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2044577xx></A><IMG height=16 alt=Answer 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2044577#xx2044577xx" 
                        name=2044577>Re: Hello , I need to use your hook model 
                        in more than one application at a time</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=83302">ChrisP1118</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:03 19 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2044577_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>The problem is that the DLL isn't 
                                loaded just once for the whole system, it's 
                                loaded once for each process. And within each 
                                process, when you attempt to allocate memory 
                                (such as when you create the list), it's 
                                allocated only within the memory space of that 
                                process. So in your code, what actually happens 
                                is that each process creates its own std::list. 
                                The only way around this is to use shared 
                                memory, and create the list of window handles in 
                                shared memory.<BR><BR>Another potential problem 
                                with your code: GetProp and SetProp can only be 
                                used to store handles. What you're storing are 
                                pointers -- I don't know enough about how they 
                                work to know if this is also causing problems, 
                                but it could be. But even if it is properly 
                                storing the pointers, there's still the problem 
                                that the address referenced by the pointer is in 
                                the memory space of another process (and 
                                therefore inaccessible). <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2044577&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2044577&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2044403">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2044577">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2044577&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2044577 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(83302,2044577,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2040295_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2040295xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2040295#xx2040295xx" 
                        name=2040295>RAW INPUT</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4100201">Ramon.Talavera</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:42 
                        16 May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2040295_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello,<BR>What kind of hooks are 
                                RAW_INPUT messages? <BR><BR>It is getting hard 
                                for me to intercept raw input messages in other 
                                windows. I need to distinguish between 2 
                                keyboards.<BR><BR>Thanks. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2040295&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2040295&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2040295">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2040295">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2040295&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2040295 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4100201,2040295,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2039934_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2039934xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2039934#xx2039934xx" 
                        name=2039934>Remote Hooks</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3899084">Bourtree</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:37 16 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2039934_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Great stuff Chris.<BR><BR>I read 
                                your article with great interest as I believe 
                                the approach you have adopted ‘may’ provide me 
                                with a solution to a design problem I have been 
                                toiling with for weeks.<BR><BR>I want to create 
                                remote hooks for a process and according to all 
                                the documentation I have read, this can only be 
                                achieved using an external DLL which presented a 
                                similar challenge to yours, that is, how to get 
                                those events back into the managed code. 
                                <BR><BR>The only big caveat I am faced with is 
                                that my process is a console application rather 
                                than a windows form and subsequently I cannot 
                                use the window handle and subsequent messaging 
                                (WndProc event). Basically, all I have is the 
                                Process Id and thread Id of the console 
                                application for reference.<BR><BR>Do you have 
                                any ideas as to how I can achieve a similar 
                                solution given the 
                                constraints?<BR><BR>Thanks<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2039934&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2039934&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2039934">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2039934">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2039934&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2039934 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3899084,2039934,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2043723_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2043723xx></A><IMG height=16 alt=Answer 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2043723#xx2043723xx" 
                        name=2043723>Re: Remote Hooks</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=83302">ChrisP1118</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:21 18 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2043723_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I don't know if it's possible to 
                                process hooks like this from a console 
                                application. I've never really worked much with 
                                console applications -- could you create a 
                                Windows Form to process the messages, but just 
                                not display the form?<BR><BR>If you're fairly 
                                comfortable with Windows API programming, it's 
                                possible to create a "message only" window. 
                                Essentially, it lets you process Windows 
                                messages but without physically creating a 
                                window. You'd only need to use a few API calls, 
                                like CreateWindowEx, to get it working -- 
                                there's more documentation on message only 
                                windows on MSDN. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2043723&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2043723&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2039934">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2043723">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2043723&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2043723 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(83302,2043723,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2034241_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2034241xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2034241#xx2034241xx" 
                        name=2034241>Raw Input, Global Hooks</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4100201">Ramon.Talavera</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:26 
                        13 May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2034241_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello,<BR><BR>I have read your 
                                article about global hooks, it is very well 
                                written, thank you very much indeed. I am trying 
                                to listen to Raw Input messages but it is being 
                                very difficult for me to support those kinds of 
                                messages (seconday HIDS) with your Global Hooks 
                                library. <BR><BR>My problem: All raw input 
                                examples do track local secondary keyboard an 
                                mouse events, but no example does track them 
                                globally. No global hooks dll seems to support 
                                raw input.<BR><BR>I am sending code to you that 
                                allows to listen to local raw input messages, 
                                could you help me adding support for this kind 
                                of messages to your dll? it would really be a 
                                valuable add on to it. It seems to me that it 
                                should be easy for you to code it. if I am not 
                                wrong, what it should do is remap raw input 
                                messages to C#, as it does with mouse events, 
                                but it is really getting hard for me to get it 
                                :/. <BR><BR>I will really appreciate your help. 
                                The local rawmouse code my be downloaded from 
                                http://www.jstookey.com/arcade/rawmouse/ 
                                .<BR><BR>Thanks in advance.<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2034241&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2034241&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2034241">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2034241">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2034241&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2034241 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4100201,2034241,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2025503_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2025503xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2025503#xx2025503xx" 
                        name=2025503>Great, but I have a problem</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3685609">xmagic123</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:40 8 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2025503_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>this hook does exactly what I 
                                want, a shell hook, but my application is 
                                written in vb.net, I am trying to study the code 
                                so I can call the dll functions in vb.net. I am 
                                not fluent in C#, is there anyone can help me 
                                with a example of how to call the dll in vb.net? 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2025503&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2025503&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2025503">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2025503">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2025503&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2025503 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3685609,2025503,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2023385_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2023385xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2023385#xx2023385xx" 
                        name=2023385>licence? and (solved previous query)</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2992753">neo786</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:46 7 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2023385_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>What licence ar are you releasing 
                                this under? and thanks. It's a cool library. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2023385&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2023385&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2023385">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2023385">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2023385&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2023385 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(2992753,2023385,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2024303_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2024303xx></A><IMG height=16 alt=General 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2024303#xx2024303xx" 
                        name=2024303>Re: licence? and (solved previous 
                      query)</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=83302">ChrisP1118</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:50 7 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2024303_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>You're completely free to use this 
                                library in your own applications. I'd appreciate 
                                it if you gave me credit, but it's not 
                                necessary. Also, please rename the "WILSON_HOOK" 
                                constants when using this in your own app. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2024303&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2024303&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2023385">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2024303">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2024303&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2024303 
                                style="WHITE-SPACE: nowrap">3.50/5 (2 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(83302,2024303,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2022852_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2022852xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;select=2022852#xx2022852xx" 
                        name=2022852>more hooks</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2992753">neo786</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">13:34 6 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2022852_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Will you be adding more hooks to 
                                your dll? <BR>and I'd like to access the text 
                                displayed by certain controls like 
                                buttons/textboxes in external programs. What 
                                hook would I need to use to be able to do 
                                that?<BR>Thanks, <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2022852&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=414057&amp;select=2022852&amp;floc=/KB/system/WilsonSystemGlobalHooks.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;tid=2022852">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=414057&amp;msg=2022852">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?obid=2022852&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2022852 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(2992753,2022852,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Friday, October 31, 2008 2:13 PM &nbsp; &nbsp; 
                  Last Update:Friday, November 14, 2008 8:33 AM</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><B>1</B> <A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/system/WilsonSystemGlobalHooks.aspx?fid=414057&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next 
      »</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 alt=General 
      src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_general.gif" 
      width=16 align=top> General &nbsp;&nbsp; <IMG height=16 alt=News 
      src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_news.gif" 
      width=16 align=top> News &nbsp;&nbsp; <IMG height=16 alt=Question 
      src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_question.gif" 
      width=16 align=top> Question &nbsp;&nbsp; <IMG height=16 alt=Answer 
      src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_answer.gif" 
      width=16 align=top> Answer &nbsp;&nbsp; <IMG height=16 alt=Joke 
      src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_joke.gif" 
      width=16 align=top> Joke &nbsp;&nbsp; <IMG height=16 alt=Rant 
      src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_rant.gif" 
      width=16 align=top> Rant &nbsp;&nbsp; <IMG height=16 alt=Admin 
      src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/msg_admin.gif" 
      width=16 align=top> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=18638">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy</A> | <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 3 May 2007<BR>Editor: <A 
            id=ctl00_ArticleEditor 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=28970">Smitha 
            Vijayan</A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2007 by 
            ChrisP1118<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2008 
            <BR>Web18 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE>
      <CENTER></CENTER></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE><BR>
<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using Window Messages to Implement Global System Hooks in C#_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
new HVMenu(new menu_NavbarConfig());
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
$(document).ready(function() {RetrieveJobsSummary('Th', 'Li',18638,2,64,"7,159,162,64,175,179,11,23,24,26,27,38,184,118,152");});
//]]></SCRIPT>
</BODY></HTML>
