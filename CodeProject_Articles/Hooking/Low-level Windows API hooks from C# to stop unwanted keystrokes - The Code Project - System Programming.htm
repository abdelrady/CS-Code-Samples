<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0053)http://www.codeproject.com/cs/system/CSLLKeyboard.asp -->
<HTML><HEAD><TITLE>Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<META content=en-US name=MS.LOCALE>
<META 
content="Babies and other animals love nothing better than to have a whack at the keyboard, with all sorts of unpredictable results. This application demonstrates how to trap keystrokes before they can do any damage." 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="Emma Burrows" name=Author>
<META content="16 Jun 2006 14:00:00 GMT" name=Search.PublishDate>
<META content="16 Jun 2006 14:00:00 GMT" name=Search.RevisedDate>
<META 
content="Free source code, , Visual C++, MFC, Windows, windows API low-level keyboard hook" 
name=keywords>
<META 
content="Article content copyright Emma Burrows, 2006, everthing else Copyright © CodeProject, 1999-2006, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/oncopy.js"></SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white><!-- COPYRIGHT 2006 I/PRO Corporation ALL RIGHTS RESERVED. - Page view auditing -->
<SCRIPT language=JavaScript type=text/javascript>
var LSPT="";
LSPT += "?durl=" + escape(document.URL);
LSPT += "&hostname=" + location.hostname;
LSPT += "&url=" + location.pathname;
LSPT += "&query=" + escape(location.search) + escape(location.hash);
LSPT += "&referrer=" + escape(document.referrer);
LSPT += "&browser=" + escape(navigator.appName);
LSPT += "&version=" + escape(navigator.appVersion);
LSPT += "&os=" + escape(navigator.platform);
LSPT += "&xdomain=codeproject.com";
LSPT += "&custid=codeproject";
</SCRIPT>

<SCRIPT type=text/javascript>
document.write('<img src=http://'+'content.ipro.com/images/pixel.gif'+LSPT+' height="1" width="1" style="position:absolute; top:0px; left:0px">');
</SCRIPT>
<NOSCRIPT><IMG style="LEFT: 0px; POSITION: absolute; TOP: 0px" height=1 src="" 
width=1> </NOSCRIPT><!-- END I/PRO PAGE TAG -->
<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
document.write("<!-- " + location.href + "-->");
</SCRIPT>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2371&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FGraphicsServer%5F728x90%2Egif&C=False&id=2371&cb=6290958\" alt=\"\" border=0 width=728 height=90></a>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">3,560,250 members and 
            growing! &nbsp; 7,410 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2959938">abdelrady2030 
            </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/cs/system/CSLLKeyboard.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2959938">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/cs/system/CSLLKeyboard.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=5">.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=1">All Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=380>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/store/">StoreFront</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=3">C#</A>, <A 
            href="http://www.codeproject.com/?cat=5">.NET</A> &gt;&gt; <A 
            href="http://www.codeproject.com/cs/system/">System Programming</A> 
            &gt;&gt; <A 
            href="http://www.codeproject.com/cs/system/#Hardware">Hardware</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">Low-level Windows 
            API hooks from C# to stop unwanted keystrokes</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=761050">Emma 
            Burrows</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">Babies and other animals love nothing 
            better than to have a whack at the keyboard, with all sorts of 
            unpredictable results. This application demonstrates how to trap 
            keystrokes before they can do any damage.</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C#<BR>Windows (NT4, Win2K, 
            WinXP, Win2003), .NET<BR>Win32, VS, WinForms<BR>Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>17 Jun 
            2006</B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: 
            <B>14,224</B> </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <TABLE class=MemberNavBar 
            style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; MARGIN-BOTTOM: 10px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
            cellSpacing=0>
              <TBODY>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/books2_sml.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.amazon.com/gp/redirect.html?link_code=ur2&amp;tag=thecodeprojec-20&amp;camp=1789&amp;creative=9325&amp;location=/gp/browse%3Fnode=5">Programming 
                  books</A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/support_icon.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.codeproject.com/store/"><B>Ultimate 
                  Combo<BR>MFC tools $449</B></A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/mail.gif" 
                  width=16></TD>
                <TD class=SmallText><A 
                  href="http://www.codeproject.com/script/recommend/form.asp?guid=CSLLKeyboard%2Fcsharp6%2F17%2F2006">Send 
                  to a friend</A></TD></TR></TBODY></TABLE>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2263&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FWholeTomato%5FRefRename%5FBlack%5F160x600%2Egif&C=False&id=2263&cb=6290961\" alt=\"The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you.\" border=0 width=160 height=600></a>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=CSLLKeyboard%2Fcsharp6%2F17%2F2006">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fcs%2Fsystem%2FCSLLKeyboard%2Easp&amp;guid=CSLLKeyboard%2Fcsharp6%2F17%2F2006">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp#__comments">Discuss</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>31 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/red.gif" 
                              width=16 border=0><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/white.gif" 
                              width=4 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        7.14</A>. Rating: <B>4.78</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <UL class=download>
              <LI><A 
              href="http://www.codeproject.com/cs/system/CSLLKeyboard/CSLLKeyboard_src.zip">Download 
              source files - 2.33 Kb</A> 
              <LI><A 
              href="http://www.codeproject.com/cs/system/CSLLKeyboard/CSLLKeyboard_demo.zip">Download 
              demo project (VS 2005) -&nbsp;16 Kb</A> 
              <LI><A 
              href="http://www.codeproject.com/cs/system/CSLLKeyboard/CSLLKeyboard_2003_demo.zip">Download 
              demo project (VS 2003) -&nbsp;12 Kb</A> </LI></UL>
            <P><IMG height=316 alt="Sample Image - CSLLKeyboard.jpg" 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/CSLLKeyboard.jpg" 
            width=438></P>
            <H2>Introduction</H2>
            <P>Cats and babies have a lot in common. They both like eating the 
            house plants, and share the same hatred of closed doors. They also 
            love using keyboards, with the result that the important email you 
            were sending to your boss is dispatched in mid-sentence, your 
            accounts in Excel are embellished with four rows of gobbledygook, 
            and your failure to notice that Windows Explorer was open results in 
            several files moving to the Recycle Bin.</P>
            <P>The solution is an application which you can switch to as soon as 
            the keyboard is under threat, and which will ensure that any 
            keyboard activity is harmless. This article illustrates how the 
            keyboard can be neutralised in a C# application using a low-level 
            Windows API hook.</P>
            <H2>Background</H2>
            <P>There are a number of articles and code samples regarding hooks 
            in Windows, and some of them are listed at the end of this article. 
            Neutralising the keyboard when children are around must be a common 
            need -- someone here wrote <A 
            href="http://www.codeproject.com/samples/ForTheKids.asp">almost 
            exactly the same thing in C++</A><A 
            href="http://www.codeproject.com/samples/ForTheKids.asp" 
            target=_blank>[^]</A>! However, when I was looking for source code 
            to create my application, I found very few .NET examples, and none 
            that involved a self-contained class in C#.</P>
            <P>The .NET framework gives managed access to the keyboard events 
            you’ll need for most ordinary uses through <CODE>KeyPress</CODE>, 
            <CODE>KeyUp</CODE> and <CODE>KeyDown</CODE>. Unfortunately, these 
            events can’t be used to stop Windows from processing key 
            combinations like Alt+Tab or the Windows Start key, which allow 
            users to navigate away from an application. The conveniently placed 
            Windows key in particular was irresistible to my baby son!</P>
            <P>The solution is to catch the keyboard events at the operating 
            system level rather than through the framework. To do this, the 
            application needs to use Windows API functions to add itself to the 
            “hook chain” of applications listening for keyboard messages from 
            the operating system. When it receives this type of message, the 
            application can selectively pass the message on, as it normally 
            should, or suppress it so that no further applications -- including 
            Windows -- can act on it. This article explains how.</P>
            <P>Please note, however, that this code only applies to NT-based 
            versions of Windows (NT, 2000 and XP), and that it isn't possible to 
            use this method to disable Ctrl+Alt+Delete (suggestions on how to do 
            that can be found in <A 
            href="http://msdn.microsoft.com/msdnmag/issues/02/09/CQA/default.aspx">this 
            MSDN Magazine Q&amp;A</A><A 
            href="http://msdn.microsoft.com/msdnmag/issues/02/09/CQA/default.aspx" 
            target=_blank>[^]</A>).</P>
            <H2>Using the code</H2>
            <P>For ease of use, I have attached two separate zip files to this 
            article. One contains only the <CODE>KeyboardHook</CODE> class which 
            is the main focus of this article. The other is a complete Microsoft 
            Visual C# 2005 Express Edition project for an application called 
            “Baby Keyboard Bash” which displays the keys’ names or coloured 
            shapes in response to keystrokes.</P>
            <H3>Instantiating the class</H3>
            <P>The keyboard hook is set up and handled by the 
            <CODE>KeyboardHook</CODE> class in <EM>keyboard.cs</EM>. This class 
            implements <CODE>IDisposable,</CODE> so the simplest way to 
            instantiate it is to use the <CODE>using</CODE> keyword in the 
            application’s <CODE>Main</CODE><CODE>(</CODE><CODE>)</CODE> method, 
            to enclose the <CODE>Application.Run() </CODE>call. This will ensure 
            that the hook is set up as soon as the application starts and, more 
            importantly, is disabled as the application shuts down.</P>
            <P>The class raises an event to warn the application that a key has 
            been pressed, so it is important for the main form to have access to 
            the instance of <CODE>KeyboardHook</CODE> created in the 
            <CODE>Main()</CODE> method; the simplest solution is to store this 
            instance in a public member variable. In a Visual Studio 2003 
            project, this will usually go in the <CODE>Form1</CODE> class (or 
            whatever the application’s main class is called), and in Visual 
            Studio 2005, in the <CODE>Program</CODE> class in 
            <EM>Program.cs</EM>.</P>
            <P><CODE>KeyboardHook</CODE> has three constructors to enable or 
            disable certain settings:</P>
            <UL>
              <LI><CODE>KeyboardHook()</CODE>: traps all keystrokes, passing 
              nothing to Windows or other applications. 
              <LI><CODE lang=cs>KeyboardHook(<I><SPAN 
              class=cs-keyword>string</SPAN> param</I>)</CODE>: Converts the 
              string to one of the values in the <CODE>Parameters</CODE> enum 
              and then calls the following constructor: 
              <LI><CODE lang=cs>KeyboardHook(<I>KeyboardHook.Parameters <SPAN 
              class=cs-keyword>enum</SPAN></I>)</CODE>: Depending on the value 
              selected from the <CODE>Parameters</CODE> enum, the following 
              settings can be enabled: 
              <UL class=enum>
                <LI><CODE>Parameters.AllowAltTab</CODE>: allows the user to 
                switch to other applications using Alt+Tab. 
                <LI><CODE>Parameters.AllowWindowsKey</CODE>: allows the user to 
                access the taskbar and Start menu using Ctrl+Esc or one of the 
                Windows keys. 
                <LI><CODE>Parameters.AllowAltTabAndWindows</CODE>: enables 
                Alt+Tab, Ctrl+Esc and the Windows keys. 
                <LI><CODE>Parameters.PassAllKeysToNextApp</CODE>: if the 
                parameter is true, all keystrokes will be passed to any other 
                listening applications, including Windows. </LI></UL></LI></UL>
            <P>Enabling Alt+Tab and/or the Windows keys allows the person who is 
            actually using the computer to switch to another application and 
            interact with it using the mouse while keystrokes continue to be 
            trapped by the keyboard hook. The <CODE>PassAllKeysToNextApp</CODE> 
            setting effectively disables the keystroke trapping; the class will 
            still set up a low-level keyboard hook and raise its 
            <CODE>KeyIntercepted</CODE> event, but it will also pass the 
            keyboard events to other listening applications.</P>
            <P>The simplest way to instantiate the class to trap all keystrokes 
            is therefore:</P><PRE lang=cs><SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>static</SPAN> KeyboardHook kh;

[STAThread]
<SPAN class=cs-keyword>static</SPAN> <SPAN class=cs-keyword>void</SPAN> Main()
{
  <SPAN class=cs-comment>//Other code</SPAN>
  <SPAN class=cs-keyword>using</SPAN> (kh = <SPAN class=cs-keyword>new</SPAN> KeyboardHook())
  {
    Application.Run(<SPAN class=cs-keyword>new</SPAN> Form1());
  }
</PRE>
            <H3>Handling the KeyIntercepted event</H3>
            <P>When a key is pressed, the <CODE>KeyboardHook</CODE> class raises 
            a <CODE>KeyIntercepted</CODE> event containing some 
            <CODE>KeyboardHookEventArgs</CODE>. This needs to be handled by a 
            method of the type <CODE>KeyboardHookEventHandler</CODE>, which can 
            be set up as follows:</P><PRE lang=cs>kh.KeyIntercepted += <SPAN class=cs-keyword>new</SPAN> KeyboardHook.KeyboardHookEventHandler(kh_KeyIntercepted);
</PRE>
            <P>The <CODE>KeyboardHookEventArgs</CODE> returns the following 
            information on the key that was pressed:</P>
            <UL>
              <LI><CODE>KeyName</CODE>: the key’s name, obtained by casting the 
              trapped key code to <CODE>System.Windows.Forms.Keys</CODE>. 
              <LI><CODE>KeyCode</CODE>: the original key code returned by the 
              keyboard hook 
              <LI><CODE>PassThrough</CODE>: whether this instance of 
              <CODE>KeyboardHook</CODE> is configured to allow this keystroke 
              through to other applications. Checking this is useful if you want 
              to allow a user to switch to another application using Alt+Tab or 
              Ctrl+Esc/Windows keys. </LI></UL>
            <P>A method with the appropriate signature can then be used to 
            perform whatever tasks the keystroke calls for. Here is an example 
            from the enclosed sample application:</P><PRE lang=cs><SPAN class=cs-keyword>void</SPAN> kh_KeyIntercepted(KeyboardHookEventArgs e)
{
  <SPAN class=cs-comment>//Check if this key event is being passed to</SPAN>
  <SPAN class=cs-comment>//other applications and disable TopMost in </SPAN>
  <SPAN class=cs-comment>//case they need to come to the front</SPAN>
  <SPAN class=cs-keyword>if</SPAN> (e.PassThrough)
  {
    <SPAN class=cs-keyword>this</SPAN>.TopMost = <SPAN class=cs-keyword>false</SPAN>;
  }
  ds.Draw(e.KeyName);
}
</PRE>
            <P>The rest of this article explains how the low-level keyboard hook 
            is implemented in <CODE>KeyboardHook</CODE>.</P>
            <H2>Implementing a low-level Windows API keyboard hook</H2>
            <P>The Windows API contains three methods in <EM>user32.dll</EM> 
            that are useful for this purpose:</P>
            <UL>
              <LI><CODE>SetWindowsHookEx</CODE>, which sets up the keyboard hook 

              <LI><CODE>UnhookWindowsHookEx</CODE>, which removes the keyboard 
              hook 
              <LI><CODE>CallNextHookEx</CODE>, which passes the keystroke 
              information to the next application listening for keyboard events 
              </LI></UL>
            <P>The key to creating an application which can hijack the keyboard 
            is to implement the first two methods, and forgo the third. The 
            result is that any keys pressed go no further than the 
            application.</P>
            <P>In order to achieve this, the first step is to include the 
            <CODE>System.Runtime.InteropServices</CODE> namespace and import the 
            API methods, starting with <CODE>SetWindowsHookEx</CODE>:</P><PRE lang=cs><SPAN class=cs-keyword>using</SPAN> System.Runtime.InteropServices
...
<SPAN class=cs-comment>//Inside class:</SPAN>

[DllImport(<SPAN class=cpp-string>"user32.dll"</SPAN>, CharSet = CharSet.Auto, SetLastError = <SPAN class=cs-keyword>true</SPAN>)]
<SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>static</SPAN> <SPAN class=cs-keyword>extern</SPAN> IntPtr SetWindowsHookEx(<SPAN class=cs-keyword>int</SPAN> idHook,
  LowLevelKeyboardProc lpfn, IntPtr hMod, <SPAN class=cs-keyword>uint</SPAN> dwThreadId);

</PRE>
            <P>The code to import <CODE>UnhookWindowsHookEx</CODE> and 
            <CODE>CallNextHookEx</CODE> is listed in the sections concerning 
            those methods further in this article.</P>
            <P>The next step is to call <CODE>SetWindowsHookEx</CODE> to set up 
            the hook, passing the following four parameters:</P>
            <UL>
              <LI><B>idHook</B>: This number determines the type of hook to be 
              set up. For example, <CODE>SetWindowsHookEx</CODE> can also be 
              used to hook into mouse events; <A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/setwindowshookex.asp">a 
              complete list can be found on MSDN</A><A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/setwindowshookex.asp">[^]</A>. 
              In this case, we’re only interested in number 13, which is the 
              keyboard hook’s id. To make the code more legible, this has been 
              assigned to the constant <CODE>WH_KEYBOARD_LL</CODE>. 
              <LI><B>lpfn</B>: A long pointer to the function that will handle 
              the keyboard events. In C#, the “pointer” is achieved by passing 
              an instance of a delegate type, referring to the appropriate 
              method. This is the method that will be called every time the hook 
              is used.<BR>An important point to note here is that the delegate 
              instance needs to be stored in a member variable in the class. 
              This is to prevent it being garbage collected as soon as the first 
              method call ends. 
              <LI><B>hMod</B>: An instance handle for the application which is 
              setting up the hook. Most of the samples I found simply set this 
              to <CODE>IntPtr.Zero</CODE>, on the grounds that it is unlikely 
              that there will be more than one instance of the application. 
              However, this code uses <CODE>GetModuleHandle</CODE> from 
              <I>kernel32.dll</I> to identify the exact instance to make the 
              class potentially more flexible. 
              <LI><B>dwThreadId</B>: The ID of the current thread. Setting this 
              to 0 makes the hook global, which is the appropriate setting for a 
              low-level keyboard hook. </LI></UL>
            <P><CODE>SetWindowsHookEx</CODE> returns a hook&nbsp;ID which will 
            be used to unhook the application when it shuts down, so this needs 
            to be stored in a member variable for future use. The relevant code 
            from the <CODE>KeyboardHook</CODE> class is as follows:</P><PRE lang=cs><SPAN class=cs-keyword>private</SPAN> HookHandlerDelegate proc;
<SPAN class=cs-keyword>private</SPAN> IntPtr hookID = IntPtr.Zero;
<SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>const</SPAN> <SPAN class=cs-keyword>int</SPAN> WH_KEYBOARD_LL = <SPAN class=cs-literal>13</SPAN>;


<SPAN class=cs-keyword>public</SPAN> KeyboardHook()
{
  proc = <SPAN class=cs-keyword>new</SPAN> HookHandlerDelegate(HookCallback);
  <SPAN class=cs-keyword>using</SPAN> (Process curProcess = Process.GetCurrentProcess())
  <SPAN class=cs-keyword>using</SPAN> (ProcessModule curModule = curProcess.MainModule)
  {
     hookID = SetWindowsHookEx(WH_KEYBOARD_LL, proc,
                    GetModuleHandle(curModule.ModuleName), <SPAN class=cs-literal>0</SPAN>);
  }
}
</PRE>
            <H3>Processing keyboard events</H3>
            <P>As mentioned above, <CODE>SetWindowsHookEx</CODE> requires a 
            pointer to the callback function that will be used to process the 
            keyboard events. It expects a function with the following 
            signature:</P><PRE lang=cs>LRESULT CALLBACK LowLevelKeyboardProc
(   <SPAN class=cs-keyword>int</SPAN> nCode,
    WPARAM wParam,
    LPARAM lParam
);
</PRE>
            <P>The C# method for setting up a “pointer to a function” is to use 
            a delegate, so the first step in giving 
            <CODE>SetWindowsHookEx</CODE> what it needs is to declare a delegate 
            with the right signature:</P><PRE lang=cs>    <SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>delegate</SPAN> IntPtr HookHandlerDelegate(
        <SPAN class=cs-keyword>int</SPAN> nCode, IntPtr wParam, <SPAN class=cs-keyword>ref</SPAN> KBDLLHOOKSTRUCT lParam);
</PRE>
            <P>And then write a callback method with the same signature; this 
            method will contain all the code that actually processes the 
            keyboard event. In the case of <CODE>KeyboardHook</CODE>, it checks 
            whether the keystroke should be passed to other applications and 
            then raises the <CODE>KeyIntercepted</CODE> event. Here is a 
            simplified version without the keystroke handling code:</P><PRE lang=cs><SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>const</SPAN> <SPAN class=cs-keyword>int</SPAN> WM_KEYDOWN = <SPAN class=cs-literal>0x0100</SPAN>;
<SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>const</SPAN> <SPAN class=cs-keyword>int</SPAN> WM_SYSKEYDOWN = <SPAN class=cs-literal>0x0104</SPAN>;

<SPAN class=cs-keyword>private</SPAN> IntPtr HookCallback(<SPAN class=cs-keyword>int</SPAN> nCode, IntPtr wParam, <SPAN class=cs-keyword>ref</SPAN> KBDLLHOOKSTRUCT lParam)
{
  <SPAN class=cs-comment>//Filter wParam for KeyDown events only - otherwise this code</SPAN>
  <SPAN class=cs-comment>//will execute twice for each keystroke (ie: on KeyDown and KeyUp)</SPAN>
  <SPAN class=cs-comment>//WM_SYSKEYDOWN is necessary to trap Alt-key combinations</SPAN>
  <SPAN class=cs-keyword>if</SPAN> (nCode &gt;= <SPAN class=cs-literal>0</SPAN> &amp;&amp; 
      (wParam == (IntPtr)WM_KEYDOWN || wParam == (IntPtr)WM_SYSKEYDOWN))
  {
    <SPAN class=cs-comment>//Raise the event</SPAN>
    OnKeyIntercepted(<SPAN class=cs-keyword>new</SPAN> KeyboardHookEventArgs(lParam.vkCode, AllowKey));
    <SPAN class=cs-comment>//Return a dummy value to trap the keystroke</SPAN>
    <SPAN class=cs-keyword>return</SPAN> (System.IntPtr)<SPAN class=cs-literal>1</SPAN>;
  }
  <SPAN class=cs-comment>//The event wasn’t handled, pass it to next application</SPAN>
  <SPAN class=cs-keyword>return</SPAN> CallNextHookEx(hookID, nCode, wParam, <SPAN class=cs-keyword>ref</SPAN> lParam);
}
</PRE>
            <P>A reference to <CODE>HookCallback</CODE> is then assigned to an 
            instance of <CODE>HookHandlerDelegate</CODE> and passed in the call 
            to <CODE>SetWindowsHookEx</CODE>, as illustrated in the previous 
            section.</P>
            <P>Whenever a keyboard event occurs, the following parameters will 
            be passed to <CODE>HookCallBack</CODE>:</P>
            <UL>
              <LI><B>nCode</B>: <A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/lowlevelkeyboardproc.asp">According 
              to the MSDN documentation</A><A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/lowlevelkeyboardproc.asp">[^]</A>, 
              the callback function should return the result of 
              <CODE>CallNextHookEx</CODE> if this value is less than zero. 
              Normal keyboard events will return an <CODE>nCode</CODE> of 0 or 
              more. </LI></UL>
            <UL>
              <LI><B>wParam</B>: This value indicates what type of event 
              occurred: key up or key down, and whether the key pressed was a 
              system key (left or right-hand Alt keys). </LI></UL>
            <UL>
              <LI><B>lParam</B>: A structure to store precise information on the 
              keystroke, such as the code of the key which was pressed. The 
              structure declared in <CODE>KeyboardHook</CODE> is as follows: 
              </LI></UL><PRE lang=cs><SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>struct</SPAN> KBDLLHOOKSTRUCT
{ 
  <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>int</SPAN> vkCode;
  <SPAN class=cs-keyword>int</SPAN> scanCode;
  <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>int</SPAN> flags;
  <SPAN class=cs-keyword>int</SPAN> time;
  <SPAN class=cs-keyword>int</SPAN> dwExtraInfo;
}
</PRE>
            <P>The two public parameters are the only ones used by the callback 
            method in<CODE> KeyboardHook</CODE>. <CODE>vkCoke</CODE> returns the 
            virtual key code, which can be cast to 
            <CODE>System.Windows.Forms.Keys</CODE> to obtain the key’s name, 
            while <CODE>flags</CODE> indicates if this is an extended key (the 
            Windows Start key, for instance) or if the Alt key was pressed at 
            the same time. The complete code for the <CODE>HookCallback</CODE> 
            method illustrates which <CODE>flags</CODE> values to check for in 
            each case.</P>
            <P>If the information provided by <CODE>flags</CODE> and the other 
            components of the <CODE>KBDLLHOOKSTRUCT</CODE> are not needed, the 
            signature of the callback method and delegate can be changed as 
            follows:</P><PRE lang=cs><SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>delegate</SPAN> IntPtr HookHandlerDelegate(
        <SPAN class=cs-keyword>int</SPAN> nCode, IntPtr wParam, IntPtr lParam);</PRE>
            <P>In this case, <CODE>lParam</CODE> will return only the 
            <CODE>vkCode</CODE>.</P>
            <H3>Passing keystrokes to the next application</H3>
            <P>A well-behaved keyboard hook callback method should end by 
            calling the <CODE>CallNextHookEx</CODE> function and returning its 
            result. This ensures that other applications get a chance to handle 
            the keystrokes destined for them.</P>
            <P>However, the key functionality of the <CODE>KeyboardHook</CODE> 
            class is preventing keystrokes from being propagated to any further 
            applications. So whenever it processes a keystroke, 
            <CODE>HookCallback</CODE> returns a dummy value instead:</P><PRE lang=cs><SPAN class=cs-keyword>return</SPAN> (System.IntPtr)<SPAN class=cs-literal>1</SPAN>;</PRE>
            <P>On the other hand, it does call <CODE>CallNextHookEx</CODE> if it 
            didn’t handle the event, or if the parameter passed with 
            <CODE>KeyboardHook</CODE>’s overloaded constructor allows certain 
            key combinations through.</P>
            <P><CODE>CallNextHookEx</CODE> is enabled by importing the function 
            from <EM>user32.dll</EM> as shown in the following code:</P><PRE lang=cs>[DllImport(<SPAN class=cpp-string>"user32.dll"</SPAN>, CharSet = CharSet.Auto, SetLastError = <SPAN class=cs-keyword>true</SPAN>)]
<SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>static</SPAN> <SPAN class=cs-keyword>extern</SPAN> IntPtr CallNextHookEx(IntPtr hhk, <SPAN class=cs-keyword>int</SPAN> nCode,
  IntPtr wParam, <SPAN class=cs-keyword>ref</SPAN> KeyInfoStruct lParam);</PRE>
            <P>The imported method is then called by this line in the 
            <CODE>HookCallback</CODE> method, which ensures that all the 
            parameters received through the hook are passed on to the next 
            application:</P><PRE>CallNextHookEx(hookID, nCode, wParam, ref lParam);
</PRE>
            <P>As mentioned before, if the flags in <CODE>lParam</CODE> are not 
            relevant, the signature for the imported <CODE>CallNextHookEx</CODE> 
            can be changed to define <CODE>lParam</CODE> as 
            <CODE>System.IntPtr</CODE>.</P>
            <H3>Removing the hook</H3>
            <P>The last step in processing the hook is to remove it when the 
            instance of the <CODE>KeyboardHook</CODE> class is destroyed, using 
            the <CODE>UnhookWindowsHookEx</CODE> function imported from 
            <EM>user32.dll</EM> as follows. </P><PRE lang=cs>[DllImport(<SPAN class=cpp-string>"user32.dll"</SPAN>, CharSet = CharSet.Auto, SetLastError = <SPAN class=cs-keyword>true</SPAN>)]
[<SPAN class=cs-keyword>return</SPAN>: MarshalAs(UnmanagedType.Bool)]
<SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>static</SPAN> <SPAN class=cs-keyword>extern</SPAN> <SPAN class=cs-keyword>bool</SPAN> UnhookWindowsHookEx(IntPtr hhk);
</PRE>
            <P>Since <CODE>KeyboardHook</CODE> implements 
            <CODE>IDisposable</CODE>, this can be done in the 
            <CODE>Dispose</CODE> method.</P><PRE lang=cs><SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>void</SPAN> Dispose()
{
  UnhookWindowsHookEx(hookID);
}</PRE>
            <P><CODE>hookID</CODE> is the id returned by the call to 
            <CODE>SetWindowsHookEx</CODE> in the constructor. This removes the 
            application from the hook chain.</P>
            <H2>Sources</H2>
            <P>Here are some good sources on Windows hooks in C# and in 
            general:</P>
            <UL>
              <LI>A good C# console application sample can be found in <A 
              href="http://blogs.msdn.com/toub/archive/2006/05/03/589423.aspx">Stephen 
              Toub's MSDN blog</A><A 
              href="http://blogs.msdn.com/toub/archive/2006/05/03/589423.aspx" 
              target=_blank>[^]</A> 
              <LI>For information on Windows API hooks in general, see <A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/setwindowshookex.asp">MSDN’s 
              article on SetWindowsHookEx</A><A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/setwindowshookex.asp" 
              target=_blank>[^]</A> and its related links 
              <LI><A 
              href="http://www.codeproject.com/csharp/GlobalSystemHook.asp">A 
              Code Project article</A><A 
              href="http://www.codeproject.com/csharp/GlobalSystemHook.asp" 
              target=_blank>[^]</A> on a class for global hook in C#, which 
              illustrates how to set up the other available hooks, including for 
              mouse activity. </LI></UL>
            <P>It seems that articles in any language seem to attract at least 
            one response on the lines of “how do I do the same thing in (some 
            other language)?”, so here are some samples I found:</P>
            <UL>
              <LI><A 
              href="http://www.codeguru.com/vb/gen/vb_system/keyboard/print.php/c4829/">A 
              keyboard hook sample in VB6</A><A 
              href="http://www.codeguru.com/vb/gen/vb_system/keyboard/print.php/c4829/" 
              target=_blank>[^]</A> 
              <LI><A 
              href="http://www.developer.com/net/vb/article.php/2193301">A 
              sample and article on the same thing in VB.NET</A><A 
              href="http://www.developer.com/net/vb/article.php/2193301" 
              target=_blank>[^]</A> 
              <LI><A 
              href="http://www.codeproject.com/samples/ForTheKids.asp">And again 
              in C++</A><A 
              href="http://www.codeproject.com/samples/ForTheKids.asp" 
              target=_blank>[^]</A> as part of a project with exactly the same 
              aim as this one! </LI></UL>
            <P>And nothing to do with Windows API hooks or C#, but I would like 
            to recommend Mike Ellison’s excellent <A 
            href="http://www.codeproject.com/soap/WordCPArticleTemplate.asp">Word 
            2003 template</A> if you’re ever planning to write an article for 
            Code Project!</P><!-- Article Ends --></DIV></SPAN>
            <SCRIPT 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>About Emma Burrows</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><IMG 
                  src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/{164BFCF5-0F2C-4B49-82B6-C6B877EAE057}.jpg"><BR></TD>
                <TD class=smallText>Emma's first steps in programming took 
                  place at primary school over twenty years ago, thanks to a 
                  TI-99/4A and the LOGO language. Following a Master's degree in 
                  English Studies (obtained, strangely enough, with a paper on 
                  the birth of the microcomputer), Emma started her career in 
                  IT. <BR><BR>Over the last ten years, she has worked as a 
                  localiser, technical writer, web designer, systems 
                  administrator, team leader and support engineer for companies 
                  ranging from Microsoft to the more modest British software 
                  company Equisys. <BR><BR>Emma is currently looking for a job 
                  after taking a break to have a baby. And in the meantime, she 
                  is practicing her C# and web development skills and, of 
                  course, writing articles for Code Project.
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=761050">here</A> 
                  to view Emma Burrows's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular System Programming articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/cs/system/wmi.asp">Windows 
                    Management Instrumentation (WMI) Implementation</A>
                    <DIV class=smallText>Implementing Windows Management 
                    Instrumentation (WMI) in your application.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/system/wmiproviderguide.asp">A 
                    simple guide to WMI providers</A>
                    <DIV class=smallText>How to write WMI providers in C#</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/system/registry1.asp">All 
                    (you wanted to know) about the Registry with C#, Part 1 of 
                    2</A>
                    <DIV class=smallText>How to get/set/create/delete registry 
                    keys of the system, user; setting up registry permissions 
                    etc. using C#.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/system/registrymonitor.asp">RegistryMonitor 
                    - a .NET wrapper class for RegNotifyChangeKeyValue</A>
                    <DIV class=smallText>The Windows API provides a function 
                    RegNotifyChangeKeyValue, which is not covered by the 
                    Microsoft.Win32.RegistryKey class. This solution imports 
                    that function and encapsulates it in a convenient 
                    manner.</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2257&cb=6290967\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</SCRIPT>
                </TD></TR></TBODY></TABLE>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden value=CSLLKeyboard/csharp6/17/2006 
            name=vote_name> <INPUT type=hidden value=/cs/system/CSLLKeyboard.asp 
            name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD 
                style="PADDING-RIGHT: 2px; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; BACKGROUND-COLOR: #eee" 
                width=120 height=60>
                  <DIV align=center></DIV></TD>
                <TD width=100>&nbsp;</TD>
                <TD width=468 height=60><SPAN id=AdBanner5>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2276&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FSoftwareVerify%5F468x60%2Egif&C=False&id=2276&cb=6290958\" alt=\"\" border=0 width=468 height=60></a>");</SCRIPT>
                  </SPAN></TD></TR></TBODY></TABLE></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	document.write("<br />Report as <a href='#xx" + MsgID.toString() + "xx' title='Mark as Spam' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-1)'>Spam</a> or ");
	document.write("<a href='#xx" + MsgID.toString() + "xx' title='Mark as Abuse' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-2)'>Abuse</a>");
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=317058"><IMG 
                              height=15 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION value=3>Expanded 
                                (Supporters only)</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 25 of 31 (Total: 
                              31) (<A 
                              href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <A class=HoverLink 
                              href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;fr=26" 
                              name=HoverNL>Next</A> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1743882_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1743882xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1743882#xx1743882xx" 
                                name=1743882><B>Everything works but the Alt 
                                keys</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1602307"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>ehrlich</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>11:42 6 
                                Nov 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1743882_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi Emma 
                                and others:<BR><BR>I wrote a VB6 program for 
                                children that uses the WH_KEYBOARD_LL 
                                hook.<BR>Every key is trapped perfectly, except 
                                for the two Alt keys.<BR>They are trapped but 
                                from then on the system is corrupted such that 
                                keyboard and<BR>mouse are doing things 
                                incorrectly.<BR>This only happens with the alt 
                                keys.<BR>Suggestions are welcome.<BR>Ron in 
                                Rochester. <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1743882">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1743882">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1743882&amp;forumid=317058&amp;select=1743882#xx1743882xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1743882#xx1743882xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1602307,1743882);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1730488_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1730488xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1730488#xx1730488xx" 
                                name=1730488><B>GetKeyState 
                                [modified]</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2361603"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>BarryDorman</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>14:46 27 
                                Oct 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1730488_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Firstly, this is a great 
                                article and program. It's well written and easy 
                                to understand, thanks for the time and effort 
                                you've put into it! I wanted to comment on the 
                                GetKey<STRIKE>board</STRIKE>State and HIWORD and 
                                LOWORD functions that you added in a previous 
                                reply. A short is a 2 byte variable and a word 
                                is also 2 bytes. Therefore there is no high word 
                                or low word in a short, there is a high byte and 
                                a low byte. But I don't even think this matters 
                                for this case. There are only 2 bits (not bytes) 
                                of information passed back from the 
                                GetKey<STRIKE>board</STRIKE>State function. One 
                                bit tells if the key is up or down and the other 
                                tells if the key is toggled (for caps lock, num 
                                lock, etc). Finally, ANDing (the &amp; operator) 
                                0xffff with a short doesn't do anything. That's 
                                16 1's, you just get exactly what you started 
                                with. In order to extract the high-order bit you 
                                just need to AND with 0x8000 and check if the 
                                number is zero or not. If it's zero, then the 
                                high-order bit is zero and the key is up. If you 
                                want to check the low order bit, you should AND 
                                with 0x0001 and check for zero. The function 
                                should take in a short (or maybe a byte, not an 
                                int) and return a short or byte (not an int). In 
                                fact, I would just scrap those and have two 
                                functions: bool IsKeyUp(short) , bool 
                                IsKeyToggled(short)<BR><BR><BR>-- modified at 
                                12:05 Monday 30th October, 2006<BR>I crossed 
                                through the errors, I intended to type 
                                GetKeyState <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle> <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1730488">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1730488">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1730488&amp;forumid=317058&amp;select=1730488#xx1730488xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1730488#xx1730488xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2361603,1730488);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1732667_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1732667xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1732667#xx1732667xx" 
                                name=1732667>Re: GetKeyboardState</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>5:29 30 Oct 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1732667_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thank 
                                you for the feedback, Barry. I'm actually using 
                                GetKeyState rather than GetKeyboardState, but I 
                                see what you mean about the high-order bit and 
                                ANDing correctly. As I was responding to 
                                someone's query, I'm afraid didn't look much 
                                further than finding some sample code that went 
                                in the right general direction and then checking 
                                that it seemed to produce the desired effects 
                                within the code. So thank you very much for 
                                clearing that up! <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1732667">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1732667">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1730488&amp;forumid=317058&amp;select=1732667#xx1732667xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1732667#xx1732667xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1732667);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1733093_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1733093xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1733093#xx1733093xx" 
                                name=1733093>Re: GetKeyboardState</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2361603"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>BarryDorman&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>10:18 30 Oct 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1733093_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Sorry, 
                                I was using GetKeyState also, I just typed the 
                                wrong function. I'll go back and modify my first 
                                post so that no one gets confused by that. Maybe 
                                it will be of use to someone in the future so 
                                here's some example code 
                                too:<BR><BR><CODE><BR>if (lParam.vkCode == 
                                0x41)<BR>{<BR>if ((GetKeyState(0x14) &amp; 
                                0x0001) == 0)<BR>{<BR>if ((GetKeyState(0x10) 
                                &amp; 0x8000) == 0) outputString = "a";<BR>else 
                                outputString = "A";<BR>}<BR>else<BR>{<BR>if 
                                ((GetKeyState(0x10) &amp; 0x8000) == 0) 
                                outputString = "A";<BR>else outputString = 
                                "a";<BR>}<BR>}<BR></CODE><BR><BR>The first 
                                statement checks to see if the 'A' key is 
                                pressed by checking that the virtual key code is 
                                0x41. The next piece checks to see if the Caps 
                                Lock is on by ANDing virtual key 0x14 with a 
                                binary 0000 0000 0000 0001 to get the low bit. 
                                The last check is for the shift key. I AND 
                                virtual key 0x10 with binary 1000 0000 0000 0000 
                                to see if the shift key is currently up or down. 
                                Based on these options the program decides if 
                                the output was "A" or "a". 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1733093">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1733093">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1730488&amp;forumid=317058&amp;select=1733093#xx1733093xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1733093#xx1733093xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2361603,1733093);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1687759_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1687759xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1687759#xx1687759xx" 
                                name=1687759><B>What about Ctrl+Tab......Its 
                                Urgent</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2734346"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>eswar345</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>12:45 27 
                                Sep 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1687759_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I am a 
                                newbea in .net world.<BR>I need to disable only 
                                Ctrl+Tab to disable navigating between MDI 
                                children in my application.<BR>What I have to 
                                do?<BR>Help me 
                                plz<BR><BR><BR><BR><BR>Eswar....<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1687759">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1687759">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1687759&amp;forumid=317058&amp;select=1687759#xx1687759xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1687759#xx1687759xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2734346,1687759);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1673411_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1673411xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1673411#xx1673411xx" 
                                name=1673411><B>Windows Service..</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3193403"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>kushang.moorthy</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>9:56 18 
                                Sep 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1673411_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I have 
                                made some modifications to your code to block 
                                only the PrintScreen key and it works fine, but 
                                cause of my inadequate knowledge on the subject 
                                I am unable to integrate it into a windows 
                                service.<BR>Any kinda help on this would be 
                                highly appreciated <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1673411">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1673411">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1673411&amp;forumid=317058&amp;select=1673411#xx1673411xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1673411#xx1673411xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3193403,1673411);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1643138_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1643138xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1643138#xx1643138xx" 
                                name=1643138><B>Copyright Notice</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2659399"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Jake 
                                Tober</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>17:14 25 
                                Aug 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1643138_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hello, 
                                I've stumbled upon your demo code and its almost 
                                exactly what I need for a piece of a project I'm 
                                working on. I noticed however that you've 
                                included a copyright notice in your code but I 
                                didn't see a link to any particular license in 
                                the code nor on this page nor what I could see 
                                of your profile. <BR><BR>Is it ok to use this 
                                code in a comercial project? After modding the 
                                class to better suit our needs I'd still be 
                                using ~50% of the original source code. 
                                <BR><BR><BR>~Jake 
                                Tober<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1643138">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1643138">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1643138&amp;forumid=317058&amp;select=1643138#xx1643138xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1643138#xx1643138xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2659399,1643138);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1643185_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1643185xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1643185#xx1643185xx" 
                                name=1643185>Re: Copyright Notice</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>18:14 25 Aug 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1643185_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>Jake Tober wrote:</DIV>Is it ok 
                                to use this code in a comercial project? After 
                                modding the class to better suit our needs I'd 
                                still be using ~50% of the original source 
                                code.</BLOCKQUOTE><BR><BR>Yes, the code is there 
                                to be used! To be honest, the copyright notice 
                                was just so my name had a chance of remaining on 
                                the code if it got circulated without my 
                                knowledge. (I'm alarmed by the number of sites 
                                that have reposted this article without my 
                                permission, but at least they're doing so with 
                                my name on it <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle>)<BR><BR>If your code is likely 
                                to be made public, you could just put "based on 
                                code by Emma Burrows" with a link back to the 
                                article - but it doesn't matter if it's a 
                                commercial project that will only be seen by 
                                internal developers. I'm just pleased that it's 
                                proving useful to people other than myself! <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_redface.gif" 
                                align=absMiddle> <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1643185">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1643185">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1643138&amp;forumid=317058&amp;select=1643185#xx1643185xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1643185#xx1643185xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1643185);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1645570_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1645570xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1645570#xx1645570xx" 
                                name=1645570>Re: Copyright Notice 
                                [modified]</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2659399"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Jake Tober&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>14:16 28 Aug 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1645570_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thanks 
                                <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle><BR>I'll make sure to keep your 
                                name in there <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1645570">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1645570">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1643138&amp;forumid=317058&amp;select=1645570#xx1645570xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1645570#xx1645570xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2659399,1645570);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1629517_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1629517xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1629517#xx1629517xx" 
                                name=1629517><B>HELP ME PLEASE !!!</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2536908"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Sakhan 
                                Hau</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>8:09 17 
                                Aug 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1629517_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I want 
                                to program a touch-screen keyboard that support 
                                Unicode characters (Ex: strike 'a' and then 
                                strike '1' in Vietnamese it convert to á). I am 
                                usung Unikey3.63. I have used the methods 
                                SendKeys.Send("a") and then SendKeys.Key("1") 
                                but it haven't worked.<BR><BR>Please teach me 
                                how to simulate a<IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_confused.gif" 
                                align=absMiddle> keystroke from low-level 
                                (Windows API) like OnScreen Keyboard of 
                                Microsoft.<BR><BR>Thanks very much for helping 
                                me.<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1629517">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1629517">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1629517&amp;forumid=317058&amp;select=1629517#xx1629517xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1629517#xx1629517xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2536908,1629517);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1618340_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1618340xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1618340#xx1618340xx" 
                                name=1618340><B>What if you have two 
                                keyboards... [modified]</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=145753"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>smesser</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>17:42 9 
                                Aug 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1618340_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>If a 
                                computer had two keyboards, and you wanted to 
                                know which keyboard was sending a specific 
                                event, how would you detect that?<BR><BR>For 
                                example someone presses D on keyboard A, is 
                                there a way to know this 
                                information?<BR><BR>thanks<BR><BR><BR><BR><BR>-- 
                                modified at 17:45 Wednesday 9th August, 2006 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1618340">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1618340">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1618340&amp;forumid=317058&amp;select=1618340#xx1618340xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1618340#xx1618340xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(145753,1618340);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1623102_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1623102xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1623102#xx1623102xx" 
                                name=1623102>Re: What if you have two 
                                keyboards...</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>7:54 13 Aug 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1623102_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>smesser wrote:</DIV>If a computer 
                                had two keyboards, and you wanted to know which 
                                keyboard was sending a specific event, how would 
                                you detect that?</BLOCKQUOTE><BR><BR>I must 
                                admit this isn't an area I've looked into 
                                before. I have done some research, and it looks 
                                as if you'll have to take a completely different 
                                approach. Even though it allows you to connect 
                                several devices, it seems that Windows will just 
                                bundle all the input from keyboards into one set 
                                of keyboard information. So my code will tell 
                                you that a key was pressed, but there's no way 
                                to tell which keyboard was used.<BR><BR>You'll 
                                probably have to enumerate through all the 
                                devices on the system, and then listen to input 
                                from the keyboards. In the basic Windows API, 
                                but only on Windows XP, you should be able to 
                                use <A 
                                href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/rawinput/usingrawinput.asp">RawInput</A>[<A 
                                title="New Window" 
                                href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/rawinput/usingrawinput.asp" 
                                target=_blank>^</A>] to do this. I couldn't find 
                                any C# examples wrapping this method, but in 
                                theory, once you're listening to the raw input 
                                messages, there should be a WM_INPUT message 
                                identifying which device triggered the message. 
                                Apparently, there's no way to differentiate 
                                between keyboards in other versions of 
                                Windows.<BR><BR>I know it's a bit vague, but as 
                                I only have one keyboard myself, I can't really 
                                test it. I hope that's a start anyway! 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1623102">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1623102">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1618340&amp;forumid=317058&amp;select=1623102#xx1623102xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1623102#xx1623102xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1623102);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1623443_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1623443xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1623443#xx1623443xx" 
                                name=1623443>Re: What if you have two 
                                keyboards...</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=145753"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>smesser&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>18:33 13 Aug 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1623443_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thanks 
                                for your reply.<BR><BR>Yes, I did end up using 
                                raw input, I have most of the issues worked 
                                out.<BR><BR>The only problem now is knowing 
                                which keyboard is which, meaning there isn't a 
                                primary<BR>keyboard and a secondary one, just 
                                two that both send key strokes. I just have to 
                                <BR>figure out an easy way to allow different 
                                modules of my code to determine which of the 
                                two<BR>keyboards to listen to.<BR><BR>If anyone 
                                is interested I am willing to post my code once 
                                I am finished, but I don't want to<BR>write an 
                                article.<BR><BR>Steve 
<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1623443">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1623443">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1618340&amp;forumid=317058&amp;select=1623443#xx1623443xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1623443#xx1623443xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(145753,1623443);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1574388_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1574388xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1574388#xx1574388xx" 
                                name=1574388><B>Ctrl+Alt+Del?</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=560657"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>nemesis0815</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>15:56 12 
                                Jul 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1574388_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>it seems 
                                everything works well except the Ctrl+Alt+Del 
                                combination, which still spawns the task 
                                manager, regardless of the 
                                settings?<BR><BR>Another thing, is it possible 
                                to add the KeyData object so that combinations 
                                of keys can be recognized as well?<BR><BR>Great 
                                work btw<IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle> <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1574388">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1574388">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1574388&amp;forumid=317058&amp;select=1574388#xx1574388xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1574388#xx1574388xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(560657,1574388);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1580200_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1580200xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1580200#xx1580200xx" 
                                name=1580200>Re: Ctrl+Alt+Del?</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1942893"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Khanhwed&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>5:30 17 Jul 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1580200_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Certainly, how can you do 
                                it. You think, if your program is a virus, other 
                                program will be destroy.<IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle> <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1580200">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1580200">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1574388&amp;forumid=317058&amp;select=1580200#xx1580200xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1580200#xx1580200xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1942893,1580200);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1591197_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1591197xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1591197#xx1591197xx" 
                                name=1591197>Re: Ctrl+Alt+Del?</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>8:52 23 Jul 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1591197_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I'm 
                                glad you like the code! <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_redface.gif" 
                                align=absMiddle><BR><BR>As I mentioned in the 
                                article, you'll have to look elsewhere to 
                                disable Ctrl+Alt+Del (<A 
                                href="http://msdn.microsoft.com/msdnmag/issues/02/09/CQA/default.aspx">http://msdn.microsoft.com/msdnmag/issues/02/09/CQA/default.aspx</A>[<A 
                                title="New Window" 
                                href="http://msdn.microsoft.com/msdnmag/issues/02/09/CQA/default.aspx" 
                                target=_blank>^</A>] is a good place to start). 
                                As Khanhwed points out, it's not necessarily a 
                                good idea, but it's possible.<BR><BR>Key 
                                combinations can be detected by amending the 
                                code slightly - see my response in the "Great 
                                work but one question" thread below. I may 
                                integrate these changes to the code for a 
                                version 2 when I get the time to check that it 
                                doesn't break anything else.<BR><BR>Thanks for 
                                the feedback!<BR><BR>-- modified at 8:55 Sunday 
                                23rd July, 2006<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1591197">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1591197">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1574388&amp;forumid=317058&amp;select=1591197#xx1591197xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1591197#xx1591197xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1591197);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1567701_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1567701xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1567701#xx1567701xx" 
                                name=1567701><B>Great work but one 
                                question</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1762230"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>yzrider088</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>5:17 9 Jul 
                                '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1567701_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>This is 
                                by far the best class for keyboard handling I 
                                have seen for C#. I have one question. 
                                Everything it logs, works great except for 
                                SHIFT+ D0-D9, meaning the keycode names you 
                                defined for numbers 0-9 on the regular keyboard, 
                                not using numpad. When I press 1, the keyname is 
                                D1, which is fine. However, when I hold down 
                                SHIFT+1, the keyname is still D1, and there is 
                                no way to no when the SHIFT key is release, so I 
                                cannot tell if it is a 1 or a !, 2 or a @, etc. 
                                I looked through the code and I see no 
                                implementation for keyup, as it only checks for 
                                keydown. This is probably why it does not work. 
                                I just thought it would be interesting in 
                                version 1.2 if you would implement the ability 
                                to tell if it is 1 or !. I don't care so much as 
                                if the shift key is really pressed, but if you 
                                do SHIFT+1 and it tells you D1, when you really 
                                meant to get !, then it is misleading. Just a 
                                thought, very nice work though. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1567701">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1567701">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1567701&amp;forumid=317058&amp;select=1567701#xx1567701xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1567701#xx1567701xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1762230,1567701);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1569101_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1569101xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aa0000" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aa0000" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1569101#xx1569101xx" 
                                name=1569101>Re: Great work but one 
                                question</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aa0000">Emma 
                                Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aa0000">8:48 10 Jul 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1569101_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>yzrider088 wrote:</DIV>This is by 
                                far the best class for keyboard handling I have 
                                seen for C#. </BLOCKQUOTE><BR><BR>Thank you very 
                                much - I'm flattered! <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_redface.gif" 
                                align=absMiddle><BR><BR>
                                <BLOCKQUOTE class=FQ>but if you do SHIFT+1 and 
                                it tells you D1, when you really meant to get !, 
                                then it is misleading</BLOCKQUOTE><BR><BR>The 
                                problem is that the class is so low-level that 
                                it only reports which physical button was 
                                pressed on the keyboard (in this case, the 
                                button called "D1"), not the character that this 
                                represents once the keyboard mapping and extra 
                                keys have been processed. However, you're right, 
                                processing KeyUp instead of KeyDown, and then 
                                checking whether the Shift key is pressed does 
                                allow you to do this.<BR><BR>So to modify the 
                                code, you start off by importing the <A 
                                href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/getkeystate.asp" 
                                rel=nofollow>GetKeyState</A>[<A 
                                title="New Window" 
                                href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/getkeystate.asp" 
                                target=_blank rel=nofollow>^</A>] method from 
                                user32.dll and create a couple of methods to get 
                                its high and low bits:<BR><BR><PRE>      [DllImport("user32.dll", CharSet = CharSet.Auto, <BR>        ExactSpelling = true, CallingConvention = CallingConvention.Winapi)]<BR>        public static extern short GetKeyState(int keyCode);<BR> <BR>        public static int HIWORD(int n)  {<BR>            return ((n &gt;&gt; 16) &amp; 0xffff);<BR>        }<BR><BR>        public static int LOWORD(int n) {<BR>            return (n &amp; 0xffff);<BR>        }</PRE><BR>Then 
                                you define the constants for WM_KEYUP and 
                                WM_SYSKEYUP instead of *KEYDOWN:<BR><PRE>    private const int WM_KEYUP = 0x0101;<BR>    private const int WM_SYSKEYUP = 0x0105;</PRE><BR>And 
                                of course, change the if statement in 
                                <CODE>HookCallback</CODE>:<BR><PRE>    if (nCode &gt;= 0 &amp;&amp; (wParam == (IntPtr)WM_KEYUP || wParam == (IntPtr)WM_SYSKEYUP))<BR>{<BR>  //Same code here<BR>}</PRE><BR>Finally, 
                                you check the status of the Shift key in 
                                <CODE>HookCallback </CODE>and do stuff with 
                                it:<BR><PRE>     short val = NativeMethods.GetKeyState((int)Keys.ShiftKey);<BR>     if (NativeMethods.HIWORD(val) != 0)<BR>     {<BR>         MessageBox.Show("Shift");<BR>     }</PRE><BR><BR>I 
                                feel a version 1.2 coming on... 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1569101">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1569101">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1567701&amp;forumid=317058&amp;select=1569101#xx1569101xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1569101#xx1569101xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1569101);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1569180_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1569180xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1569180#xx1569180xx" 
                                name=1569180>Re: Great work but one 
                                question</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1762230"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>yzrider088&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>9:29 10 Jul 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1569180_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Wow 
                                very prompt e-mail and the code works well, 
                                already knew it would though. Great job and 
                                thanks for the quick reply, much appreciated! 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1569180">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1569180">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1567701&amp;forumid=317058&amp;select=1569180#xx1569180xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1569180#xx1569180xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1762230,1569180);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1541320_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1541320xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1541320#xx1541320xx" 
                                name=1541320><B>Escape Close MDI 
                                Child</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1612630"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>mribbons</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>22:35 20 
                                Jun 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1541320_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Any 
                                hints on using the hook to close MDI childs on 
                                escape press?<BR><BR>I got this working by 
                                handling the keypress event for every single 
                                control on an mdi child but obviously this isn't 
                                a good way to go.<BR><BR>I implemented it using 
                                your hook library, but one of my screens has a 
                                dialog to notify a data validation, when Escape 
                                is pressed the dialog pops up, but closes after 
                                about one second.<BR><BR>Any 
                                suggestions?<BR><BR>Regards, 5/5 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1541320">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1541320">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1541320&amp;forumid=317058&amp;select=1541320#xx1541320xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1541320#xx1541320xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1612630,1541320);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1542600_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1542600xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1542600#xx1542600xx" 
                                name=1542600>Re: Escape Close MDI Child</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>14:06 21 Jun 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1542600_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>mribbons wrote:</DIV>Any hints on 
                                using the hook to close MDI childs on escape 
                                press?</BLOCKQUOTE><BR><BR>I must admit I 
                                haven't done much work with MDI applications, 
                                but based on what you said about handling the 
                                keypress event for each control, I'm guessing 
                                that the problem is actually that whatever 
                                control has the focus is catching the Escape 
                                keystroke and doing its own thing with it. If 
                                Escape is the only key you're trying to process, 
                                the following suggestion might help:<BR><BR>1. 
                                Set the MDI parent or child form's KeyPreview 
                                property to true (I didn't test this with an MDI 
                                app, so you might have to experiment)<BR>2. Add 
                                a KeyUp handler to the form that has KeyPreview 
                                turned on<BR>3. In that method, check whether 
                                the key that was pressed was Escape, and tell 
                                the child window to close<BR><BR>Let me know if 
                                that works! Otherwise, I'll try to conduct a 
                                more thorough 
                                test.<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1542600">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1542600">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1541320&amp;forumid=317058&amp;select=1542600#xx1542600xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1542600#xx1542600xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1542600);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1539098_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1539098xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1539098#xx1539098xx" 
                                name=1539098><B>Great work 
                                [modified]</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=417375"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>farnyu</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>15:15 19 
                                Jun 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1539098_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I 
                                thought it's not possible to create Global 
                                Keyboard hook. You prove that wrong. Good job. I 
                                give you a 5!<BR><BR>-- modified at 15:16 Monday 
                                19th June, 2006<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1539098">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1539098">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1539098&amp;forumid=317058&amp;select=1539098#xx1539098xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1539098#xx1539098xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(417375,1539098);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1539108_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1539108xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1539108#xx1539108xx" 
                                name=1539108>Re: Great work</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>15:22 19 Jun 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1539108_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thank 
                                you, that's very kind! <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_redface.gif" 
                                align=absMiddle> I'm pleased to know that the 
                                article is useful. <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1539108">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1539108">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1539098&amp;forumid=317058&amp;select=1539108#xx1539108xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1539108#xx1539108xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1539108);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1539193_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1539193xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1539193#xx1539193xx" 
                                name=1539193>Re: Great work</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=417375"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>farnyu&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>16:24 19 Jun 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1539193_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Have 
                                you have thought of making a sample app hooking 
                                to "Mouse Wheel"? <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle> <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1539193">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1539193">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1539098&amp;forumid=317058&amp;select=1539193#xx1539193xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1539193#xx1539193xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(417375,1539193);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1539850_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1539850xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=54><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1539850#xx1539850xx" 
                                name=1539850>Re: Great work</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>5:07 20 Jun 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1539850_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=54><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>farnyu wrote:</DIV>Have you have 
                                thought of making a sample app hooking to "Mouse 
                                Wheel"?</BLOCKQUOTE><BR><BR>Funny you should say 
                                that. After weeks of me working on the keyboard 
                                hook application, my son has just discovered the 
                                mouse... <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_doh.gif" 
                                align=absMiddle><BR><BR>However, I don't think 
                                I'll need a low-level hook for that (some kind 
                                of cage might work better <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_wink.gif" 
                                align=absMiddle>), but the following article 
                                might have what you want:<BR><BR><A 
                                href="http://www.codeproject.com/csharp/NetWin32Hooks.asp" 
                                rel=nofollow>http://www.codeproject.com/csharp/NetWin32Hooks.asp</A>[<A 
                                title="New Window" 
                                href="http://www.codeproject.com/csharp/NetWin32Hooks.asp" 
                                target=_blank rel=nofollow>^</A>] 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1539850">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1539850">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1539098&amp;forumid=317058&amp;select=1539850#xx1539850xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1539850#xx1539850xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1539850);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=#fbedbb>
                      <TD>
                        <TABLE cellPadding=2 width="100%">
                          <TBODY>
                          <TR>
                            <TD class=messagetitle>Last Visit: 17:01 Wednesday 
                              22nd November, 2006</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <A class=HoverLink 
                              href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;fr=26" 
                              name=HoverNL>Next</A> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 17 Jun 2006 </TD>
                <TD class=SmallText align=right>Article content copyright Emma 
                  Burrows, 2006<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2006</A>. <BR>Web12 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <SCRIPT 
      src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/front.asp" 
      type=text/javascript></SCRIPT>
      <BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A> • 
            <A href="http://www.aspalliance.com/">ASP Alliance</A> • <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A> • <A 
            href="http://www.developersdex.com/">Developersdex</A> • <A 
            href="http://www.devguru.com/">DevGuru</A> • <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A> • <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A> • 
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A> • 
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
