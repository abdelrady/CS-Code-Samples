<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0048)http://www.codeproject.com/csharp/globalhook.asp -->
<HTML><HEAD><TITLE>Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<META content=en-US name=MS.LOCALE>
<META 
content="This class allows you to tap keyboard and mouse and/or to detect their activity even when an application runs in the background or does not have any user interface at all." 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="George Mamaladze" name=Author>
<META content="03 Jun 2004 14:00:00 GMT" name=Search.PublishDate>
<META content="11 Jul 2006 14:00:00 GMT" name=Search.RevisedDate>
<META 
content="Free source code, , Visual C++, MFC, Windows, mouse, keyboard, tap, hook" 
name=keywords>
<META 
content="Article content copyright George Mamaladze, 2004, everthing else Copyright © CodeProject, 1999-2006, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/oncopy.js"></SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white><!-- COPYRIGHT 2006 I/PRO Corporation ALL RIGHTS RESERVED. - Page view auditing -->
<SCRIPT language=JavaScript type=text/javascript>
var LSPT="";
LSPT += "?durl=" + escape(document.URL);
LSPT += "&hostname=" + location.hostname;
LSPT += "&url=" + location.pathname;
LSPT += "&query=" + escape(location.search) + escape(location.hash);
LSPT += "&referrer=" + escape(document.referrer);
LSPT += "&browser=" + escape(navigator.appName);
LSPT += "&version=" + escape(navigator.appVersion);
LSPT += "&os=" + escape(navigator.platform);
LSPT += "&xdomain=codeproject.com";
LSPT += "&custid=codeproject";
</SCRIPT>

<SCRIPT type=text/javascript>
document.write('<img src=http://'+'content.ipro.com/images/pixel.gif'+LSPT+' height="1" width="1" style="position:absolute; top:0px; left:0px">');
</SCRIPT>
<NOSCRIPT><IMG style="LEFT: 0px; POSITION: absolute; TOP: 0px" height=1 src="" 
width=1> </NOSCRIPT><!-- END I/PRO PAGE TAG -->
<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
document.write("<!-- " + location.href + "-->");
</SCRIPT>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2507&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FAMD%5Fdownloadbanner%5F728x90%2Ejpg&C=False&id=2507&cb=6298731\" alt=\"\" border=0 width=728 height=90></a>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">3,560,250 members and 
            growing! &nbsp; 7,402 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2959938">abdelrady2030 
            </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/csharp/globalhook.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2959938">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/csharp/globalhook.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=5">.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=1">All Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=380>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/store/">StoreFront</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=3">C#</A>, <A 
            href="http://www.codeproject.com/?cat=5">.NET</A> &gt;&gt; <A 
            href="http://www.codeproject.com/csharp/">C# Programming</A> 
            &gt;&gt; <A href="http://www.codeproject.com/csharp/#How+To">How 
            To</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">Processing Global 
            Mouse and Keyboard Hooks in C#</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=116240">George 
            Mamaladze</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">This class allows you to tap keyboard 
            and mouse and/or to detect their activity even when an application 
            runs in the background or does not have any user interface at 
            all.</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C#<BR>Windows (Win2K, 
            WinXP, Win2003), .NET (.NET 1.0, .NET 1.1)<BR>Win32, VS 
            (VS.NET2003)<BR>Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>4 Jun 2004 
            </B><BR><SPAN style="PADDING-RIGHT: 0.3ex">Updated</SPAN>: <B>12 Jul 
            2006</B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: 
            <B>118,116</B> </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <TABLE class=MemberNavBar 
            style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; MARGIN-BOTTOM: 10px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
            cellSpacing=0>
              <TBODY>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/books2_sml.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.amazon.com/gp/redirect.html?link_code=ur2&amp;tag=thecodeprojec-20&amp;camp=1789&amp;creative=9325&amp;location=/gp/browse%3Fnode=5">Programming 
                  books</A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/support_icon.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.codeproject.com/store/"><B>Ultimate 
                  Combo<BR>MFC tools $449</B></A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/mail.gif" 
                  width=16></TD>
                <TD class=SmallText><A 
                  href="http://www.codeproject.com/script/recommend/form.asp?guid=globalhook%2Fcsharp6%2F4%2F2004">Send 
                  to a friend</A></TD></TR></TBODY></TABLE>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2261&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FWholeTomato%5FRefRename%5F160x600%2Egif&C=False&id=2261&cb=6298739\" alt=\"The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you.\" border=0 width=160 height=600></a>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/csharp/globalhook.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=globalhook%2Fcsharp6%2F4%2F2004">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fcsharp%2Fglobalhook%2Easp&amp;guid=globalhook%2Fcsharp6%2F4%2F2004">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/csharp/globalhook.asp#__comments">Discuss</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>148 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/red.gif" 
                              width=16 border=0><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/white.gif" 
                              width=4 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        10.42</A>. Rating: <B>4.8</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <UL class=download>
              <LI><A 
              href="http://www.codeproject.com/csharp/globalhook/globalhook_src.zip">Download 
              source files - 12.4 Kb</A> 
              <LI><A 
              href="http://www.codeproject.com/csharp/globalhook/globalhook_demo.zip">Download 
              demo application - 5.58 Kb</A> </LI></UL>
            <H2>Introduction</H2>
            <P>This class allows you to tap keyboard and mouse and/or to detect 
            their activity even when an application runs in the background or 
            does not have any user interface at all. This class raises common 
            .NET events with <CODE>KeyEventArgs</CODE> and 
            <CODE>MouseEventArgs</CODE>, so you can easily retrieve any 
            information you need.</P>
            <H2>Background</H2>
            <P>There are a number of applications that run in the background and 
            detect user inactivity to change their mode. For example, MSN 
            Messenger (or any other messenger). I was going to write such an 
            application, so I searched MSDN and found "exactly" what I needed: 
            <A 
            href="http://support.microsoft.com/default.aspx?scid=kb;en-us;318804" 
            target=_blank>318804 - HOW TO: Set a Windows Hook in Visual C# 
            .NET</A>. This article describes how to tap the mouse movement, but 
            it works only when an application is active. At the end of this 
            article, I found this explanation: <B>"Global hook is not supported 
            in .NET Framework. You cannot implement global hooks in Microsoft 
            .NET Framework..."</B>. Anyway, I continued my research and found 
            out that there are exceptions. There are <CODE>WH_KEYBOARD_LL</CODE> 
            and <CODE>WH_MOUSE_LL</CODE> hooks that can be installed globally. 
            So, I have basically replaced <CODE>WH_MOUSE</CODE> with 
            <CODE>WH_MOUSE_LL</CODE> in the MSDN example, and it works.</P>
            <P>The second step was to extract the information received into a 
            .NET <CODE>EventArgs</CODE> and raise the appropriate events.</P>
            <P>I found a similar article in CodeProject, under <A 
            href="http://www.codeproject.com/csharp/GlobalSystemHook.asp">Global 
            System Hooks in .NET by Michael Kennedy</A>, but what I dislike is, 
            there is an unmanaged DLL in C++ that is a main part of this 
            solution. This unmanaged DLL is in C++, and a number of classes make 
            it complicated to integrate it in my own tiny application.</P>
            <H2>Using the code</H2>
            <P>To use this class in your application, you need just to create an 
            instance of it and hang on events you would like to process. Hooks 
            are automatically installed when the object is created, but you can 
            stop and start listening using appropriate public methods.</P><PRE lang=cs>UserActivityHook actHook;
<SPAN class=cs-keyword>void</SPAN> MainFormLoad(<SPAN class=cs-keyword>object</SPAN> sender, System.EventArgs e)
{
    actHook= <SPAN class=cs-keyword>new</SPAN> UserActivityHook(); <SPAN class=cs-comment>// crate an instance</SPAN>
    <SPAN class=cs-comment>// hang on events</SPAN>
    actHook.OnMouseActivity+=<SPAN class=cs-keyword>new</SPAN> MouseEventHandler(MouseMoved);
    actHook.KeyDown+=<SPAN class=cs-keyword>new</SPAN> KeyEventHandler(MyKeyDown);
    actHook.KeyPress+=<SPAN class=cs-keyword>new</SPAN> KeyPressEventHandler(MyKeyPress);
    actHook.KeyUp+=<SPAN class=cs-keyword>new</SPAN> KeyEventHandler(MyKeyUp);
}</PRE>
            <P>Now, an example of how to process an event:</P><PRE lang=cs><SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>void</SPAN> MouseMoved(<SPAN class=cs-keyword>object</SPAN> sender, MouseEventArgs e)
{
    labelMousePosition.Text=String.Format(<SPAN class=cpp-string>"x={0}  y={1}"</SPAN>, e.X, e.Y);
    <SPAN class=cs-keyword>if</SPAN> (e.Clicks&gt;<SPAN class=cs-literal>0</SPAN>) LogWrite(<SPAN class=cpp-string>"MouseButton     - "</SPAN> + e.Button.ToString());
}</PRE>
            <H2>Changes and updates in the new version</H2>
            <P>I'd like to thank you all for all the useful comments in the 
            discussion forum. There were a lot of bugs and proposals posted 
            after this article was published on 4 Jun 2004. Over and over again 
            came the same topics, and I had to refer to previous posts in the 
            discussion, that is why I have decided to revise the code and 
            publish a FAQ. Here is the list of the most important changes:</P>
            <UL>
              <LI>The project was converted into Visual Studio 2005 
              <LI>The problem with upper case characters is solved 
              <LI>Mouse wheel information is now included in event arguments 
              <LI>Better exception handling 
              <LI>Cancellation of keyboard events using the <CODE>Handled</CODE> 
              property of event arguments 
              <LI>XML documentation of functions </LI></UL>
            <H2>FAQ</H2>
            <H4>Question:</H4>
            <P>The project cannot be run in Visual Studio .NET 2005 in debug 
            mode because of an exception error caused by calling the 
            <CODE>SetWindowsHookEx</CODE>. Why? Is it a problem of .NET 2.0?</P>
            <H4>Answer:</H4>
            <P>The compiled release version works well so that can not be a .NET 
            2.0 problem. To workaround, you just need to uncheck the check box 
            in the project properties that says: "Enable Visual Studio hosting 
            process". In the menu: Project -&gt; Project Properties... -&gt; 
            Debug -&gt; Enable the Visual Studio hosting process.</P>
            <H4>Question:</H4>
            <P>I need to suppress some keystrokes after I have processed 
            them.</P>
            <H4>Answer:</H4>
            <P>Just set the <CODE>e.Handled</CODE> property to <CODE 
            lang=cs><SPAN class=cs-keyword>true</SPAN></CODE> in the key events 
            you have processed. It prevent the keystrokes being processed by 
            other applications.</P>
            <H4>Question:</H4>
            <P>Is it possible to convert your global hooks to application hooks 
            which capture keystrokes and mouse movements only within the 
            application?</P>
            <H4>Answer:</H4>
            <P>Yes. Just use:</P><PRE lang=cs><SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>const</SPAN> <SPAN class=cs-keyword>int</SPAN> WH_MOUSE = <SPAN class=cs-literal>7</SPAN>;
<SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>const</SPAN> <SPAN class=cs-keyword>int</SPAN> WH_KEYBOARD = <SPAN class=cs-literal>2</SPAN>;</PRE>
            <P>everywhere, instead of:</P><PRE lang=cs><SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>const</SPAN> <SPAN class=cs-keyword>int</SPAN> WH_MOUSE_LL = <SPAN class=cs-literal>14</SPAN>;
<SPAN class=cs-keyword>private</SPAN> <SPAN class=cs-keyword>const</SPAN> <SPAN class=cs-keyword>int</SPAN> WH_KEYBOARD_LL = <SPAN class=cs-literal>13</SPAN>;</PRE>
            <H4>Question:</H4>
            <P>Does it work on Win98 (Windows ME, Windows 95)?</P>
            <H4>Answer:</H4>
            <P>Yes and No. The global hooks <CODE>WH_MOUSE_LL</CODE> and 
            <CODE>WH_KEYBOARD_LL</CODE> can be monitored only under Windows 
            NT/2000/XP. In other cases, you can only use application hooks 
            (<CODE>WH_MOUSE and WH_KEYBOARD</CODE>) which capture keystrokes and 
            mouse movement only within the application.</P>
            <H4>Question:</H4>
            <P>I have a long delay when closing applications using hooks by 
            clicking the <B>x</B> button in the titlebar. If I close the 
            application via another event (button click) for example, that works 
            fine.</P>
            <H4>Answer:</H4>
            <P>It's a know bug of Microsoft. It has to do with the Windows 
            themes. If you disable the Windows themes, the problem goes away. 
            Another choice is to have the hook code run in a secondary 
            thread.</P>
            <H4>Question:</H4>
            <P>How do I catch key combinations like Ctrl+Shift+A?</P>
            <H4>Answer:</H4>
            <P>You'll have to track which keys have gone down but not up. Only 
            the most recently pressed key keeps sending <CODE>KeyDown</CODE> 
            messages, but the others will still send a <CODE>KeyUp</CODE> when 
            released. So if you make three flags <CODE>IsCtrlDown</CODE>, 
            <CODE>IsShiftDown</CODE>, and <CODE>IsADown</CODE>, and set them to 
            <CODE lang=cs><SPAN class=cs-keyword>true</SPAN></CODE> at 
            <CODE>KeyDown</CODE> and <CODE lang=cs><SPAN 
            class=cs-keyword>false</SPAN></CODE> at <CODE>KeyUp</CODE>, the 
            expression <CODE lang=cs>(IsCtrlDown &amp;&amp; IsShiftDown 
            &amp;&amp; IsADown)</CODE> will give you the required result.</P>
            <H4>Question:</H4>
            <P>Does it works with .NET Framework 1.1 and Visual Studio 2003?</P>
            <H4>Answer:</H4>
            <P>Yes. The file <I>UserActivityHook.cs</I> can be used without any 
            changes, in a VS2003 .NET 1.1 
            project.</P><!-- Article Ends --></DIV></SPAN>
            <SCRIPT 
            src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>About George Mamaladze</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><IMG 
                  src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/{3A94D724-BAD4-4E0A-BB3E-73C0A3F5CB80}.jpg"><BR></TD>
                <TD class=smallText>I am 30 years old. I live and work in 
                  Germany. I was born and raised in Georgia former USSR. Now I 
                  am working as a programmer in a German software company.
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=116240">here</A> 
                  to view George Mamaladze's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular C# Programming articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/csharp/zedgraph.asp">A 
                    flexible charting library for .NET</A>
                    <DIV class=smallText>Looking for a way to draw 2D line 
                    graphs with C#? Here's yet another charting class library 
                    with a high degree of configurability, that is also easy to 
                    use.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/csharp/csppleds.asp">I/O 
                    Ports Uncensored - 1 - Controlling LEDs (Light Emiting 
                    Diodes) with Parallel Port</A>
                    <DIV class=smallText>Controlling LEDs (Light Emiting Diodes) 
                    with Parallel Port</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/csharp/cspplcds.asp">I/O 
                    Ports Uncensored Part 2 - Controlling LCDs (Liquid Crystal 
                    Displays) and VFDs (Vacuum Fluorescent Displays) with 
                    Parallel Port</A>
                    <DIV class=smallText>Controlling LCDs (Liquid Crystal 
                    Displays) and VFDs (Vacuum Fluorescent Displays) with 
                    Parallel Port</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/csharp/julijanpiechart.asp">3D 
                    Pie Chart</A>
                    <DIV class=smallText>A class library for drawing 3D pie 
                    charts.</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2257&cb=6298744\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</SCRIPT>
                </TD></TR></TBODY></TABLE>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden value=globalhook/csharp6/4/2004 
            name=vote_name> <INPUT type=hidden value=/csharp/globalhook.asp 
            name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/csharp/globalhook.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD 
                style="PADDING-RIGHT: 2px; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; BACKGROUND-COLOR: #eee" 
                width=120 height=60>
                  <DIV align=center>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2225&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FDundas%5F120x60%2Egif&C=False&id=2225&cb=6298747\" alt=\"\" border=0 width=120 height=60></a>");</SCRIPT>
                  </DIV></TD>
                <TD width=100>&nbsp;</TD>
                <TD width=468 height=60><SPAN id=AdBanner5>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2493&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FDundas%5FCorgent25%2D468x60%2Egif&C=False&id=2493&cb=6298736\" alt=\"\" border=0 width=468 height=60></a>");</SCRIPT>
                  </SPAN></TD></TR></TBODY></TABLE></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	document.write("<br />Report as <a href='#xx" + MsgID.toString() + "xx' title='Mark as Spam' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-1)'>Spam</a> or ");
	document.write("<a href='#xx" + MsgID.toString() + "xx' title='Mark as Abuse' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-2)'>Abuse</a>");
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=57596"><IMG 
                              height=15 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION value=3>Expanded 
                                (Supporters only)</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 25 of 385 (Total: 
                              385) (<A 
                              href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <A class=HoverLink 
                              href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;fr=26" 
                              name=HoverNL>Next</A> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1770313_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1770313xx></A><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1770313#xx1770313xx" 
                                name=1770313><B>Problem when we have now 
                                Window</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=729292"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>cdemez</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>9hrs 
                                47mins 
                              ago</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1770313_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hello,<BR><BR>I have try 
                                this library in several way:<BR>- in a window 
                                forms : works perfectly<BR>- in a command line 
                                app : it slow down my OS, by example when I open 
                                notepad all characters appear slowly. And 
                                nothing is "handled" by the hook class !! 
                                nothing !<BR>- in a service app : it slow down 
                                my OS, by example when I open notepad all 
                                characters appear slowly. And nothing is 
                                "handled" by the hook class !! nothing 
                                !<BR><BR>It sounds that when we have no window, 
                                there is a problem. (I have also try to hook in 
                                another thread, without success).<BR><BR>I can 
                                send you the project in a zip file for you to 
                                test if you want. If you have an 
                                idea.<BR><BR>Thanks <BR><BR>
                                <DIV 
                                class=ForumSig>Krys</DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1770313">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1770313">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1770313&amp;forumid=57596&amp;select=1770313#xx1770313xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1770313#xx1770313xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(729292,1770313);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1770556_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1770556xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1770556#xx1770556xx" 
                                name=1770556>Re: Problem when we have now 
                                Window</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=116240"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>George 
                                Mamaladze&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>7hrs 52mins 
                                ago&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1770556_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR>I think creating an 
                                invisible form must help.<BR>Do something like 
                                this before initialising hooks.<BR><BR><PRE>            <BR>Form frm = new Form();<BR>frm.Show();<BR>frm.Visible = false;<BR></PRE><BR><BR>Anyway 
                                send me your code as well and I'll try it 
                                out.<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1770556">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1770556">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1770313&amp;forumid=57596&amp;select=1770556#xx1770556xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1770556#xx1770556xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(116240,1770556);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1768939_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1768939xx></A><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1768939#xx1768939xx" 
                                name=1768939><B>Some problem that I experience 
                                in .NET 2.0</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2440170"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>slishnevsky1</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>14:44 21 
                                Nov 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1768939_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thank 
                                you for great article.<BR><BR>I have a program 
                                that converts on-the-fly english keys into 
                                russian letters and prints them into opened 
                                application using SendKeys.Send() 
                                method.<BR><BR>Everything works fine with all 
                                the letters except russian 
                                "&#1040;".<BR>SendKeys.Send("&#1040;") doesn't work (no 
                                output) in ONLY one case - when Left Shift key 
                                is pressed (down).<BR>I can't figure out why 
                                this is happening, looks like a bag in .NET 2.0 
                                (In 1.1 same code worked fine).<BR><BR>So, my 
                                question: SendKeys.Send("&#1040;") command is executed 
                                from KeyboardHook_KeyPress() event 
                                handler.<BR>Is it possible for application to 
                                ignore Left Shift key (when it's pressed) when 
                                running SendKeys.Send() command? Shoul I try 
                                adding some code in KeyboardHook_KeyDown() event 
                                handler maybe?<BR><BR>Thanks. Slava. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1768939">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1768939">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1768939&amp;forumid=57596&amp;select=1768939#xx1768939xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1768939#xx1768939xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2440170,1768939);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1769328_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1769328xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1769328#xx1769328xx" 
                                name=1769328>Re: Some problem that I experience 
                                in .NET 2.0</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=116240"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>George 
                                Mamaladze&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>23hrs 37mins 
                                ago&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1769328_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR>1. Check in debug 
                                mode which key code comes when you type Left 
                                Shift + A and which one when Righ Shift + 
                                A.<BR><BR>2. Are you shure your conversion from 
                                englich to russian key codes works identically 
                                in 2.0 and 1.1 ? Check conversion of apropriate 
                                key codes.<BR><BR>3. Try to send hardcoded 'A' 
                                every time when any key is pressed. Ensure that 
                                it works (I mean sending) also when Righ Shift 
                                is down.<BR><BR>I will try it out tomorow as 
                                well.<BR><BR>ochen' stranno. do zavtra. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1769328">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1769328">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1768939&amp;forumid=57596&amp;select=1769328#xx1769328xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1769328#xx1769328xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(116240,1769328);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1770593_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1770593xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1770593#xx1770593xx" 
                                name=1770593>Re: Some problem that I experience 
                                in .NET 2.0 [modified]</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2440170"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>slishnevsky1&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>7hrs 40mins 
                                ago&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1770593_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>1. 
                                LShift+A = RShift+A = 65'A' (english A), it 
                                return capital english 'A' into my conversion 
                                function.<BR>2. Conversion function is very 
                                simple - I have array where for each english 
                                letter, I have russian letter: 
                                <BR>engKey=e.KeyChar; // this is how I get 
                                65'A', <BR>when... I find rusKey=1040'&#1040;', 
                                <BR>when... I use SendKeys.Send(rusKey), and 
                                it's not working if I hold LShift key at the 
                                same time. <BR><BR>Code that worked in 1.1 
                                showing this problem on 2.0.<BR><BR>3. Already. 
                                This is what I left in my KeyPress 
                                handler:<BR><BR>private void 
                                KeyboardHook_KeyPress(object sender, 
                                KeyPressEventArgs 
                                e)<BR>{<BR>SendKeys.Send('&#1040;'.ToString()); // 
                                this is 1040'&#1040;'<BR>e.Handled = 
                                true;<BR>}<BR><BR>Works well in ALL combinations 
                                no matter what key I press, except LShift <IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/smiley_smile.gif" 
                                align=absMiddle><BR><BR>Based on that I 
                                concluded that the execution of 
                                SendKeys.Send("&#1040;") fails only when at that 
                                moment my finger is on LShift key (LShift is 
                                down) <IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/smiley_smile.gif" 
                                align=absMiddle> It works fine with CapsLock 
                                down, and with RShift down, but not with 
                                LShift.<BR><BR>I thought if this is indeed a 
                                bug, when I might try to block these special 
                                keys somehow, maybe in KeyDown event handler, 
                                but I don't know exactly this can be 
                                done...<BR><BR>&#1047;&#1072;&#1088;&#1072;&#1085;&#1077;&#1077; &#1089;&#1087;&#1072;&#1089;&#1080;&#1073;&#1086; &#1077;&#1089;&#1083;&#1080; &#1077;&#1089;&#1090;&#1100; &#1082;&#1072;&#1082;&#1080;&#1077; 
                                &#1080;&#1076;&#1077;&#1080; &#1085;&#1072; &#1101;&#1090;&#1086;&#1090; &#1089;&#1095;&#1105;&#1090;, &#1085;&#1080;&#1095;&#1077;&#1075;&#1086; &#1095;&#1090;&#1086; &#1084;&#1099; &#1085;&#1072; &#1073;&#1091;&#1088;&#1078;&#1091;&#1081;&#1089;&#1082;&#1086;&#1084; 
                                <IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/smiley_smile.gif" 
                                align=absMiddle>?<BR><BR>&#1057;&#1083;&#1072;&#1074;&#1072;.<BR><BR><BR><BR><BR><BR><BR><BR><BR><BR><BR>-- 
                                modified at 10:02 Wednesday 22nd November, 2006 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1770593">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1770593">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1768939&amp;forumid=57596&amp;select=1770593#xx1770593xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1770593#xx1770593xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2440170,1770593);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1770763_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1770763xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=54><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1770763#xx1770763xx" 
                                name=1770763>Re: Some problem that I experience 
                                in .NET 2.0</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=116240"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>George 
                                Mamaladze&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>6hrs 30mins 
                                ago&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1770763_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=54><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I have 
                                just created an empty windows application. 
                                Placed a timer conrol with following 
code<BR><BR><PRE>        <BR>   private void timer1_Tick(object sender, EventArgs e)<BR>        {<BR>            SendKeys.Send("&#1040;");<BR>        }<BR></PRE><BR><BR>If 
                                I open notepad it prints with evry tick a 
                                russian "A" it stops printing when I hold 
                                Left-Shift. <BR>This issue has nothing to do 
                                with Hooks an staff. Is it just an unknown 
                                Framework bug?<BR>Misterious !!!!! 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1770763">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1770763">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1768939&amp;forumid=57596&amp;select=1770763#xx1770763xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1770763#xx1770763xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(116240,1770763);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1770849_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1770849xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=72><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1770849#xx1770849xx" 
                                name=1770849>Re: Some problem that I experience 
                                in .NET 2.0</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2440170"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>slishnevsky1&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>5hrs 53mins 
                                ago&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1770849_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=72><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>That's 
                                right. I though I was going crazy... It's indeed 
                                doesn't have anything to do with 
                                hooks.<BR>That's just a sick behavior of 
                                SendKeys object. I even thought that "&#1040;", if 
                                it's hardcoded as a letter inside the code might 
                                cause this problem, but no, I even used 
                                something like this: 
                                SendKeys.Send(((char)1040).ToString()), but... 
                                same result. Very very strange!<BR><BR>So, I 
                                looked closer @MSDN1 (MSDN1 based on .NET 1.1): 
                                <BR><A 
                                href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemwindowsformssendkeysclasssendtopic.asp" 
                                rel=nofollow>http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemwindowsformssendkeysclasssendtopic.asp</A><BR>And 
                                when I looked closer @MSDN2 (MSDN2 based on .NET 
                                2.0): <BR><A 
                                href="http://msdn2.microsoft.com/en-us/library/system.windows.forms.sendkeys.send(VS.80).aspx" 
                                rel=nofollow>http://msdn2.microsoft.com/en-us/library/system.windows.forms.sendkeys.send(VS.80).aspx</A><BR><BR>And 
                                the only difference between these two is a 
                                warning on MSDN2:<BR><CODE><B>If your 
                                application is intended for international use 
                                with a variety of keyboards, the use of Send 
                                could yield unpredictable results and should be 
                                avoided.</B></CODE><BR><BR>It's like "We wrote 
                                this function for you, but you should not use 
                                it". Very nice <IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/smiley_confused.gif" 
                                align=absMiddle> <BR><BR>I am thinking now, is 
                                there any way to replace SendKeys.Send() with 
                                something else, maybe some Win32 function that 
                                does the same thing. But I haven't dug into this 
                                yet.<BR>George, if you know of a Win32 function 
                                that does the same thing as SendKeys.Send(), 
                                could you please point me into right 
                                direction?<BR><BR>&#1057;&#1087;&#1072;&#1089;&#1080;&#1073;&#1086;, 
                                &#1057;&#1083;&#1072;&#1074;&#1072;.<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1770849">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1770849">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1768939&amp;forumid=57596&amp;select=1770849#xx1770849xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1770849#xx1770849xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2440170,1770849);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1771127_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1771127xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=90><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1771127#xx1771127xx" 
                                name=1771127>Re: Some problem that I experience 
                                in .NET 2.0</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=116240"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>George 
                                Mamaladze&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>4hrs 17mins 
                                ago&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1771127_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=90><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>See 
                                this <A 
                                href="http://msdn2.microsoft.com/en-us/library/ms646310.aspx">http://msdn2.microsoft.com/en-us/library/ms646310.aspx</A>[<A 
                                title="New Window" 
                                href="http://msdn2.microsoft.com/en-us/library/ms646310.aspx" 
                                target=_blank>^</A>] <BR>Please let me know if 
                                it worked. <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1771127">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1771127">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1768939&amp;forumid=57596&amp;select=1771127#xx1771127xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1771127#xx1771127xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(116240,1771127);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1766975_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1766975xx></A><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1766975#xx1766975xx" 
                                name=1766975><B>Injecting 
                                Characters?</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3562397"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>AdamPiper</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>16:09 20 
                                Nov 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1766975_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I'm 
                                writing a C# program that needs a global 
                                keyboard hook for 2 reasons;<BR>
                                <OL>
                                <LI>To receive keydown/keyup events and 
                                selectively suppress further processing - which 
                                is obviously catered for by your class!<BR>
                                <LI>To inject new characters if the keydowns 
                                I've logged fulfil a specific 
                                criterion</LI></OL><BR><BR>As far as I know your 
                                class doesn't provide my second need, do you 
                                have any hints as to how I could do 
                                this?<BR><BR>Having read through all the replies 
                                to your article I'm now investigating 
                                SendKeys.SendWait, but I'm not sure this is 
                                really what I want. I notice that what I do want 
                                has been frequently refered to as "key mapping" 
                                or keypress emulation - which is basically what 
                                I need to do. Nobody's really answered those 
                                questions in much depth though. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1766975">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1766975">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1766975&amp;forumid=57596&amp;select=1766975#xx1766975xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1766975#xx1766975xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3562397,1766975);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1769376_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1769376xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1769376#xx1769376xx" 
                                name=1769376>Re: Injecting Characters?</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=116240"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>George 
                                Mamaladze&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>23hrs 2mins 
                                ago&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1769376_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR>try following code 
                                in KeyPress event handler in your programm. 
                                <BR><BR><PRE>public void MyKeyPress(object sender, KeyPressEventArgs e)<BR>{<BR>     e.Handled = true;<BR>     SendKeys.Send("a"); <BR>}</PRE><BR><BR>It 
                                will affect that you will receive only aaaa-s by 
                                any key press in any application. Is it what you 
                                are looking for? Please inform me if it worked. 
                                I'll be also very happy to receive a positive 
                                vote. <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1769376">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1769376">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1766975&amp;forumid=57596&amp;select=1769376#xx1769376xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1769376#xx1769376xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(116240,1769376);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1766087_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1766087xx></A><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1766087#xx1766087xx" 
                                name=1766087><B>Capturing the function 
                                key</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=821609"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>CWIZO</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>8:59 20 
                                Nov 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1766087_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>is there any way 
                                to capture the function key on the laptops? 
                                <BR><BR>
                                <DIV 
                                class=ForumSig>--------------------------------------------------------<BR><A 
                                href="http://www.hancic.info/">My portfolio 
                                &amp; development blog</A><BR>Q:What does the 
                                derived class in C# tell to it's 
                                parent?<BR>A:All your base are belong to 
                                us!</DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1766087">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1766087">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1766087&amp;forumid=57596&amp;select=1766087#xx1766087xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1766087#xx1766087xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(821609,1766087);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1765692_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1765692xx></A><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1765692#xx1765692xx" 
                                name=1765692><B>Problems with integrate 
                                UserActivityHook.cs</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=991689"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>AndreGr</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>4:20 20 
                                Nov 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1765692_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hallo 
                                all,<BR>first this app is greate, and I need 
                                this function in another app.<BR><BR>So I've 
                                copy the class to another app (Create Windows 
                                App-&gt;Add existing Element and adding 
                                UserActivityHook.cs and MainForm.cs).<BR><BR>So 
                                the application should be have the same 
                                functions like the original project.<BR><BR>But 
                                that's not correct. I getting all the time an 
                                error 538.<BR>(<BR>//If SetWindowsHookEx 
                                fails.<BR>if (hMouseHook == 0)<BR>{<BR>//Returns 
                                the error code returned by the last unmanaged 
                                function called using platform invoke that has 
                                the DllImportAttribute.SetLastError flag set. 
                                <BR>int errorCode = 
                                Marshal.GetLastWin32Error();<BR>//do 
                                cleanup<BR>Stop(true, false, 
                                false);<BR>//Initializes and throws a new 
                                instance of the Win32Exception class with the 
                                specified error. <BR>throw new 
                                Win32Exception(errorCode);<BR>}<BR>)<BR>When I 
                                debugging the original project and my copy I've 
                                see following diffrents:<BR>In this 
                                line:<BR>hMouseHook = 
                                SetWindowsHookEx(WH_MOUSE_LL,MouseHookProcedure,Marshal.GetHINSTANCE(Assembly.GetExecutingAssembly().GetModules()[0]),0);<BR>the 
                                orginal code getting some values, but in my copy 
                                it's only 0.<BR><BR>So what's wrong?<BR>Can 
                                somebody tell me what must change when I copy 
                                the class (and the 
                                form).<BR><BR>Thanks,<BR>Andre<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1765692">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1765692">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1765692&amp;forumid=57596&amp;select=1765692#xx1765692xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1765692#xx1765692xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(991689,1765692);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1765711_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1765711xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1765711#xx1765711xx" 
                                name=1765711>Re: Problems with integrate 
                                UserActivityHook.cs</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=116240"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>George 
                                Mamaladze&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>4:36 20 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1765711_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR>Just read the first 
                                question and answer in FAQ list at the end of 
                                article. It will enable you to run the project 
                                also in debug mode under Visual Studio 
                                2005.<BR><BR>Pleas post an answer if it helped. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1765711">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1765711">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1765692&amp;forumid=57596&amp;select=1765711#xx1765711xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1765711#xx1765711xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(116240,1765711);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1765735_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1765735xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1765735#xx1765735xx" 
                                name=1765735>Re: Problems with integrate 
                                UserActivityHook.cs</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=991689"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>AndreGr&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>5:03 20 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1765735_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Ok.<BR>My problem is 
                                fixxed.<BR><BR>Thanks. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1765735">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1765735">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1765692&amp;forumid=57596&amp;select=1765735#xx1765735xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1765735#xx1765735xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(991689,1765735);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1763101_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1763101xx></A><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1763101#xx1763101xx" 
                                name=1763101><B>diaresis and circumflex 
                                accent(!)</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3509399"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>miljbee</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>11:24 17 
                                Nov 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1763101_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hello,<BR><BR>I am a newbie 
                                with C# and dotNet. I am currently writting a 
                                small app with vs c# express, to play a bit and 
                                learn ...<BR><BR>I wanted my app to detect user 
                                activity, so it can enter in a sort of sleep 
                                mode when user is not "actively working" on the 
                                computer.<BR><BR>I found your code and it works 
                                well. I just throw events when something happens 
                                on the keyboard or mouse to record the last 
                                activity date/time.<BR><BR>I have just dicovered 
                                that when my app is running i can not type some 
                                special characters.<BR><BR>Normally, if I press 
                                ^ then e, it should display ê. Same thing with ¨ 
                                and i (ï) ...<BR>When your code is running ^ and 
                                e displays ^^e. Same thing with ¨<BR><BR>in fact 
                                accent and chars are no more combined. the 
                                double character is displayed immediatly when 
                                pressing the corresponding key. I mean pressing 
                                ^ produce immediately ^^ instead of waiting the 
                                following input.<BR><BR>The problem occurs on 
                                W2K SP4 with .Net 1.1 &amp; 2. Regionnal 
                                settings and keyboard are french.<BR><BR>I hope 
                                you understand the problem (it's not easy to 
                                figure if you don't use those key combinations 
                                in your language ...)<BR><BR>By the way, since 
                                you seem to be good in C# and dot Net, do you 
                                think about another solution to know if the user 
                                is active ?<BR><BR>Many thanks for your 
                                interrest on this post. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1763101">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1763101">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1763101&amp;forumid=57596&amp;select=1763101#xx1763101xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1763101#xx1763101xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3509399,1763101);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1763451_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1763451xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1763451#xx1763451xx" 
                                name=1763451>Re: diaresis and circumflex 
                                accent(!)</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=116240"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>George 
                                Mamaladze&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>15:31 17 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1763451_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR>I have understood 
                                the problem and I have an idea what the problem 
                                can be. Next week I will experiment and give you 
                                an exact answer.<BR><BR>I do not know any other 
                                way to detect user activity (or inactivity). 
                                There is a way to became messages from 
                                screensaver when it goes on or off, but I think 
                                it is useless fo you because it depends on 
                                screensaver settings set of each user. 
                                <BR><BR>Vous êtes français ? 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1763451">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1763451">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1763101&amp;forumid=57596&amp;select=1763451#xx1763451xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1763451#xx1763451xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(116240,1763451);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1765550_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1765550xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1765550#xx1765550xx" 
                                name=1765550>Re: diaresis and circumflex 
                                accent(!)</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3509399"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>miljbee&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>2:49 20 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1765550_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thank 
                                you very much for your attention 
                                George.<BR><BR>Oui, je suis français <IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/smiley_smile.gif" 
                                align=absMiddle> <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1765550">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1765550">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1763101&amp;forumid=57596&amp;select=1765550#xx1765550xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1765550#xx1765550xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3509399,1765550);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1765686_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1765686xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1765686#xx1765686xx" 
                                name=1765686>Re: diaresis and circumflex 
                                accent(!)</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=116240"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>George 
                                Mamaladze&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>4:19 20 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1765686_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR>to workaround this 
                                problem you need just to comment some code in 
                                the function <CODE>KeyboardHookProc</CODE> in 
                                the class <CODE>UserActivityHook.cs</CODE>. You 
                                need to avoid calling <CODE>ToAscii</CODE> 
                                function, because it reads buffered dead-key 
                                char. That is why a dead-key character (accent 
                                or diacritic) stored in the keyboard layout 
                                cannot be composed with the specified virtual 
                                key in dithered programm. <BR><BR><PRE>    ...<BR>  GetKeyboardState(keyState);<BR>  byte[] inBuffer = new byte[2];<BR>  /*<BR>  if (ToAscii(MyKeyboardHookStruct.vkCode,<BR>              MyKeyboardHookStruct.scanCode,<BR>              keyState,<BR>              inBuffer,<BR>              MyKeyboardHookStruct.flags) == 1)<BR>   */<BR>   {<BR>       char key = (char)inBuffer[0];<BR>       if ((isDownCapslock ^ isDownShift) &amp;&amp; Char.IsLetter(key)) key = Char.ToUpper(key);<BR>       KeyPressEventArgs e = new KeyPressEventArgs(key);<BR>    ...</PRE><BR><BR>Tell 
                                me if it helped.<BR><BR>Bonne chance ! 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1765686">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1765686">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1763101&amp;forumid=57596&amp;select=1765686#xx1765686xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1765686#xx1765686xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(116240,1765686);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1766065_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1766065xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1766065#xx1766065xx" 
                                name=1766065>Re: diaresis and circumflex 
                                accent(!)</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3509399"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>miljbee&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>8:46 20 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1766065_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Ok, it 
                                works !<BR><BR>Thank you for your very quick 
                                answer.<BR><BR>I have a few remarks :<BR>- i 
                                have been able to get rid off the problem by 
                                managing only the Keydown event (i mean not 
                                managing the keypresse event). It does the trick 
                                since i am not interrested in knowing the 
                                content of the input. I just need to know if 
                                something happens on the kb or mouse.<BR><BR>- 
                                since some of us just need to know if something 
                                happens and doesn't need more information, 
                                perhaps your code could be cleaned to remove the 
                                event informations. This may limit cpu time. 
                                Sorry if i am totally wrong, please remember i 
                                am a newbie !<BR><BR>- when running the 
                                performance tab of the task manager, i can not 
                                see the cpu load increase when using your code 
                                on a W2K computer. But on WinXP, i noticed that 
                                a real difference. When moving the mouse and 
                                pressing keys on the KB, the cpu load raises 
                                from 2% - 4% to 13% - 15%. It is not a so awfull 
                                problem, but i would be glad if this code could 
                                be more CPU friendly. Any idea ?<BR><BR>Here is 
                                how i use your code :<BR>i am catching the mouse 
                                event and the keydown event. when the events are 
                                fired, the only thing i do is set the propertie 
                                lastActivity to datetime.now<BR><BR>at the same 
                                time, a timer is raising an event every 3 
                                seconds to perform a few computation on 
                                lastActivity and set the userIsInactive 
                                flag.<BR><BR>here is the code 
                                :<BR><CODE><BR>using System;<BR>using 
                                System.Collections.Generic;<BR>using 
                                System.Text;<BR>using 
                                gma.System.Windows;<BR>using 
                                System.Timers;<BR><BR>namespace 
                                nsInactivity<BR>{<BR>class 
                                Inactivity<BR>{<BR>private bool 
                                inactive;<BR>private bool 
                                nearlyActive;<BR>private DateTime 
                                lastActivityDate;<BR>private UserActivityHook 
                                uah;<BR>private System.Timers.Timer 
                                ticks;<BR><BR>public 
                                Inactivity()<BR>{<BR>this.inactive = 
                                false;<BR>this.nearlyActive = 
                                false;<BR>this.ticks = new 
                                System.Timers.Timer();<BR>this.ticks.Elapsed += 
                                new 
                                ElapsedEventHandler(Every3Seconds);<BR>this.ticks.Interval 
                                = 3000;<BR>this.ticks.Enabled = 
                                true;<BR>this.uah = new 
                                UserActivityHook();<BR>this.uah.Start();<BR>this.uah.KeyDown 
                                += new 
                                System.Windows.Forms.KeyEventHandler(uah_KeyDown);<BR>//this.uah.KeyPress 
                                += new 
                                System.Windows.Forms.KeyPressEventHandler(uah_KeyPress);<BR>//this.uah.KeyUp 
                                += new 
                                System.Windows.Forms.KeyEventHandler(uah_KeyUp);<BR>this.uah.OnMouseActivity 
                                += new 
                                System.Windows.Forms.MouseEventHandler(uah_OnMouseActivity);<BR>}<BR><BR>void 
                                Every3Seconds(object sender, ElapsedEventArgs 
                                e)<BR>{<BR>TimeSpan ts;<BR>ts = DateTime.Now - 
                                this.lastActivityDate;<BR><BR>if 
                                (this.inactive)<BR>{<BR>if (ts.Seconds &lt; 
                                3)<BR>{<BR>if 
                                (this.nearlyActive)<BR>{<BR>this.inactive = 
                                false;<BR>this.nearlyActive = 
                                false;<BR>}<BR>else { this.nearlyActive = true; 
                                }<BR>}<BR>else { this.nearlyActive = false; 
                                }<BR>}<BR>else<BR>{<BR>if (ts.Seconds &lt; 3) { 
                                this.inactive = false; }<BR>else { this.inactive 
                                = true; }<BR>}<BR><BR>}<BR><BR>public DateTime 
                                LastActivityDate<BR>{<BR>get { return 
                                this.lastActivityDate; }<BR>set { 
                                this.lastActivityDate = value; }<BR>}<BR>public 
                                bool Inactive<BR>{ get { return this.inactive; } 
                                }<BR>public bool Active<BR>{ get { return 
                                !this.inactive; } }<BR><BR>private void 
                                OnAnyActivity()<BR>{<BR>this.lastActivityDate = 
                                DateTime.Now;<BR>}<BR><BR>void 
                                uah_OnMouseActivity(object sender, 
                                System.Windows.Forms.MouseEventArgs 
                                e)<BR>{<BR>this.OnAnyActivity();<BR>}<BR>void 
                                uah_KeyUp(object sender, 
                                System.Windows.Forms.KeyEventArgs 
                                e)<BR>{<BR>this.OnAnyActivity();<BR>}<BR>void 
                                uah_KeyPress(object sender, 
                                System.Windows.Forms.KeyPressEventArgs 
                                e)<BR>{<BR>this.OnAnyActivity();<BR>}<BR>void 
                                uah_KeyDown(object sender, 
                                System.Windows.Forms.KeyEventArgs 
                                e)<BR>{<BR>this.OnAnyActivity();<BR>}<BR>}<BR>}<BR><BR></CODE><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1766065">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1766065">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1763101&amp;forumid=57596&amp;select=1766065#xx1766065xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1766065#xx1766065xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3509399,1766065);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1766189_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1766189xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=54><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1766189#xx1766189xx" 
                                name=1766189>Re: diaresis and circumflex 
                                accent(!)</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=116240"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>George 
                                Mamaladze&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>9:59 20 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1766189_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=54><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR>You are right in all 
                                remarks.<BR><BR>1. The char code of special 
                                charachters is wrong if you do not use ToAscii. 
                                The problem is when you use ToAscii function 
                                then it eliminates buffer and the target 
                                application does not receive the dithered 
                                charachter. We must do something on that 
                                place.<BR><BR>2. If you will just to detect 
                                activity and reduce CPU usage make following. In 
                                the class <CODE>UserActivityHook</CODE> add a 
                                declaration for following event.<BR><BR><PRE>public event EventHandler OnActivity;</PRE><BR><BR>Then 
                                add as a firs tine of functions 
                                <CODE>MouseHookProc</CODE> and 
                                <CODE>KeyboadrHookProc </CODE>following line 
                                like this:<BR><BR><PRE>        private int MouseHookProc(int nCode, int wParam, IntPtr lParam)<BR>        {<BR>            if (OnActivity != null) OnActivity(this, new EventArgs());<BR>             ...</PRE><BR>After 
                                that you need just to hang on this events. All 
                                other events will not be processed if you do not 
                                attach to them. This will give you 
                                performance.<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1766189">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1766189">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1763101&amp;forumid=57596&amp;select=1766189#xx1766189xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1766189#xx1766189xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(116240,1766189);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1757366_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1757366xx></A><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1757366#xx1757366xx" 
                                name=1757366><B>It suddenly stopped to 
                                work</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2317960"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>fmonroy</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>16:09 14 
                                Nov 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1757366_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hello 
                                PPL, this morning I installed the updates from 
                                MS and one APP that uses keyboard hooks stopped 
                                to work.<BR><BR>The SetWindowsHookEx method 
                                returns zero, then throwing the exception it 
                                generates: "Win32Exception was unhandled" "The 
                                operation completed successfully".<BR><BR>Anyone 
                                has the same problem?<BR><BR>Thanks in advance 
                                <BR><BR>Fidencio 
                                Monroy<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1757366">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1757366">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1757366&amp;forumid=57596&amp;select=1757366#xx1757366xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1757366#xx1757366xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2317960,1757366);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1757455_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1757455xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1757455#xx1757455xx" 
                                name=1757455>Re: It suddenly stopped to 
                                work</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=116240"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>George 
                                Mamaladze&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>17:11 14 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1757455_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR>In order to handle 
                                this problem I need some more info:<BR>1. Which 
                                operating system do you use ?<BR>2. Go to 
                                Control Panel/Softtware. Switch on the check box 
                                "Show Updates" located on top in the middle. 
                                Look under Windows XXX Updates which ones where 
                                installed on this Morning. Please post KB 
                                numbers of this updates. <BR><BR>Thanks. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1757455">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1757455">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1757366&amp;forumid=57596&amp;select=1757455#xx1757455xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1757455#xx1757455xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(116240,1757455);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1757597_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1757597xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1757597#xx1757597xx" 
                                name=1757597>Re: It suddenly stopped to 
                                work</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2317960"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>fmonroy&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>19:21 14 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1757597_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                George, thanks for your quick response, I'm 
                                using Win XP SP2 English, the latest updates 
                                are:<BR>KB923980<BR>KB920213<BR>KB922760<BR>KB924270<BR>KB920342<BR><BR>Thank 
                                you <BR><BR>Fidencio 
                                Monroy<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1757597">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1757597">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1757366&amp;forumid=57596&amp;select=1757597#xx1757597xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1757597#xx1757597xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2317960,1757597);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1757621_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1757621xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=54><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1757621#xx1757621xx" 
                                name=1757621>Re: It suddenly stopped to 
                                work</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2317960"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>fmonroy&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>19:47 14 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1757621_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=54><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>George, 
                                I found the problem, I was running the project 
                                in debug mode without the symbols; my bad, I'm 
                                sorry.<BR><BR>I noticed running the exe directly 
                                from the explorer, I got surprised because it 
                                was working.<BR><BR>Thanks a lot dude. 
                                <BR><BR>Fidencio 
                                Monroy.<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1757621">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1757621">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1757366&amp;forumid=57596&amp;select=1757621#xx1757621xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1757621#xx1757621xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2317960,1757621);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1758098_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1758098xx></A><IMG 
                                height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=72><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_game.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;select=1758098#xx1758098xx" 
                                name=1758098>Re: It suddenly stopped to 
                                work</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=116240"><IMG 
                                title="Click for User Profile" height=15 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>George 
                                Mamaladze&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>3:29 15 Nov 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1758098_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/ind.gif" 
                                width=72><IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi!<BR>It's ok. Just read 
                                the first question and answer in FAQ list at the 
                                end of article. It will enable you to run the 
                                project also in debug mode under Visual Studio 
                                2005.<IMG 
                                src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/smiley_wink.gif" 
                                align=absMiddle> <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1758098">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/csharp/globalhook.asp&amp;df=100&amp;forumid=57596&amp;select=1758098">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;tid=1757366&amp;forumid=57596&amp;select=1758098#xx1758098xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/csharp/globalhook.asp?msg=1758098#xx1758098xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(116240,1758098);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/t.gif" 
                              width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=#fbedbb>
                      <TD>
                        <TABLE cellPadding=2 width="100%">
                          <TBODY>
                          <TR>
                            <TD class=messagetitle>Last Visit: 17:01 Wednesday 
                              22nd November, 2006</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <A class=HoverLink 
                              href="http://www.codeproject.com/csharp/globalhook.asp?df=100&amp;forumid=57596&amp;fr=26" 
                              name=HoverNL>Next</A> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 12 Jul 2006 </TD>
                <TD class=SmallText align=right>Article content copyright 
                  George Mamaladze, 2004<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2006</A>. <BR>Web12 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <SCRIPT 
      src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/front.asp" 
      type=text/javascript></SCRIPT>
      <BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="Processing Global Mouse and Keyboard Hooks in C# - The Code Project - C# Programming_files/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  
            <A href="http://www.aspalliance.com/">ASP Alliance</A>  <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
            href="http://www.developersdex.com/">Developersdex</A>  <A 
            href="http://www.devguru.com/">DevGuru</A>  <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A>  
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
