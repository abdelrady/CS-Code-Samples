<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0052)http://www.codeproject.com/KB/vb/WindowsHookLib.aspx -->
<HTML><HEAD><TITLE>CodeProject: Global Windows Hooks. Free source code and programming help</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="A single utility to hook the mouse and the keyboard system wide; Author: VBDT; Section: VB.NET; Chapter: Languages" 
name=Description>
<META 
content=".NET 2.0, VS2005, VB 8.0, Windows, Dev, Advanced,VB.NET,Languages,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject Global Windows Hooks_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject Global Windows Hooks_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Global Windows Hooks_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Global Windows Hooks_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function MsgVoteForm(MemberID, MsgID) {
 document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ",1)\"%3E"));
 document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 for (var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"give this message a vote of " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ")\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ",5)\"%3E"));
 document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" alt=\"vote 5\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?") == true)
  return RateMsg(userid, msgid, score);
 else return false;
}
function RateMsg(memberid, msgid, score) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4) {
   if ( req.status == 200 ) {
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match)?match[1]:"An error occured" + unescape("%3C/b%3E");
   }
   else
   {
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
   }
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Global Windows Hooks_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK 
href="CodeProject Global Windows Hooks_ Free source code and programming help_files/ForumClassicIE6.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" type=image/ico rel="shortcut icon">
<SCRIPT type=text/javascript>
	function SetAsAvailable() {
	   var aid = document.getElementById("ArticleId");
	   if(aid)
		   window.location.href = "/script/Articles/UpdateArticleStatus.aspx?aid=" + articleId.value + "&rp=" + location.href;
	}


	</SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            height=90 alt=Home 
            src="CodeProject Global Windows Hooks_ Free source code and programming help_files/codeproject225x90.gif" 
            width=225 border=0></A></TD>
          <TD class=HeaderBanner align=right width="100%">
            <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d5544%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fObjective-markets_oms_stclive_728x90.gif%26C%3dFalse%26id%3d5544%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22728%22%20height%3d%2290%22%3e%3c%2fa%3e"));</SCRIPT>
          </TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">4,950,978 
                  members and growing! (8,587 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">abdelrady2030</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx"><IMG 
                  height=16 
                  src="CodeProject Global Windows Hooks_ Free source code and programming help_files/tools.gif" 
                  width=16 align=absMiddle border=0> <B>My Settings</B></A> | <A 
                  id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 
                  src="CodeProject Global Windows Hooks_ Free source code and programming help_files/fave.gif" 
                  width=16 align=absMiddle border=0> My Bookmarks</A> | <A 
                  id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2fvb%2fWindowsHookLib.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD><A href="http://www.codeproject.com/">Home</A></TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/?cat=1">All Topics</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=2">MFC/C++</A></TD>
                <TD noWrap><A 
                href="http://www.codeproject.com/?cat=3">C#</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=6">VB.NET</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=4">ASP.NET</A></TD>
                <TD noWrap><A 
                href="http://www.codeproject.com/?cat=9">SQL</A></TD>
                <TD noWrap><A 
                  href="http://www.codeproject.com/?cat=8">Architect</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus><!--380-->
                  <DIV id=MenuPos 
                  style="WIDTH: 305px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=305>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleUneditedHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A> 
            » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/vb/">VB.NET</A> » <A 
            id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/vb/index.aspx?#VB.NET - General">General</A> 
            <SPAN class=ArticleAdvanced 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Advanced</SPAN> <SPAN class=SmallText 
            id=ctl00_ArticleTopHeader_LicenceTerms 
            style="MARGIN-LEFT: 40px">License: <A 
            href="http://www.codeproject.com/info/cpol10.aspx">The Code Project 
            Open License (CPOL)</A></SPAN> <BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>Global Windows 
            Hooks</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=1538493">VBDT</A></B><BR><BR><SPAN 
            class=ArticleTopDescr id=ctl00_ArticleTopHeader_ArticleDescr>A 
            single utility to hook the mouse and the keyboard system wide</SPAN> 
          </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>VB, VB 8.0, Windows, 
            .NET, .NET 2.0, VS, VS2005, Dev</SPAN><BR><BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>3 Aug 2007</B><BR><SPAN 
            style="PADDING-RIGHT: 0.5ex">Updated</SPAN>: <B>13 Mar 2008</B> 
            <BR><SPAN style="PADDING-RIGHT: 3.2ex">Views</SPAN>: 
            <B>25,480</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD>
                  <DIV id=ctl00_ArticleTopHeader_UneditedDiv><B>Note: <A 
                  id=ctl00_ArticleTopHeader_UneditedLnk 
                  href="http://www.codeproject.com/script/Articles/Unedited.aspx">This 
                  is an unedited reader contribution</A></B> </DIV></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV style="PADDING-TOP: 5px; TEXT-ALIGN: center"><IFRAME 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/ServeHTML.htm" 
      frameBorder=0 width=150 scrolling=no height=80></IFRAME></DIV>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <DIV style="PADDING-TOP: 0px"><IMG 
      style="PADDING-RIGHT: 14px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 10px" 
      height=20 alt=Comp 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/prize_winner.gif" 
      width=10> <A id=ctl00_Announcements_CompLink 
      href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
      Competition</A><BR clear=all>
      <DIV style="PADDING-BOTTOM: 5px; PADDING-TOP: 3px"><IMG 
      style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 7px; MARGIN-RIGHT: 8px" 
      height=16 alt=Staff 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/staff_sm.gif" 
      width=12> <A href="http://www.codeproject.com/info/jobs/">We're 
      Hiring!</A></DIV>
      <DIV style="PADDING-BOTTOM: 5px; PADDING-TOP: 3px"><IMG 
      style="PADDING-RIGHT: 0px; MARGIN-TOP: 3px; FLOAT: left; MARGIN-LEFT: 0px; MARGIN-RIGHT: 0px" 
      height=20 alt=Silverlight 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/silverlight_20.jpg" 
      width=27> <A 
      href="http://www.codeproject.com/script/News/View.aspx?nwid=6024">Add 
      Silverlight to your articles</A></DIV></DIV></DIV>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV><BR>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2 style="DISPLAY: none">
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MI id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3 style="DISPLAY: none">
      <DIV class=MI id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4 style="DISPLAY: none">
      <DIV class=MI id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5>
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MIS id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/kb/showcase/">Product Showcase</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/Install">Installshield 
      2008</A></DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV><BR>
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d5264%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fInfragistics_dotNET_newLook_160-600.jpg%26C%3dFalse%26id%3d5264%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22160%22%20height%3d%22600%22%3e%3c%2fa%3e"));</SCRIPT>
      <IMG height=1 alt="" 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/t.gif" 
      width=160> </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add CodeProject to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top>
            <TABLE>
              <TBODY></TBODY></TABLE>
            <TABLE cellSpacing=1 cellPadding=3 width=1 border=0>
              <TBODY>
              <TR class=smalltext vAlign=center>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt=print 
                  src="CodeProject Global Windows Hooks_ Free source code and programming help_files/print.gif" 
                  width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
                  href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?display=Print">Print</A> 
                </TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt="Broken Article?" 
                  src="CodeProject Global Windows Hooks_ Free source code and programming help_files/broken.gif" 
                  width=16> <A id=ctl00_ArticleHeaderLinks_BrokenLnk 
                  href="http://www.codeproject.com/script/Articles/Report.aspx?aid=19858">Broken 
                  Article?</A> </TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  id=ctl00_ArticleHeaderLinks_ArticleBmk_BookmarkImg 
                  title="Add to bookmarks" 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; WIDTH: 16px; BORDER-BOTTOM: 0px; HEIGHT: 16px" 
                  src="CodeProject Global Windows Hooks_ Free source code and programming help_files/link.png"> 
                  <A id=ctl00_ArticleHeaderLinks_ArticleBmk_BookmarkLnk 
                  href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=19858&amp;obtid=2">Add 
                  Bookmark</A> <SPAN 
                  id=ctl00_ArticleHeaderLinks_ArticleBmk_Message></SPAN></TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt=Discuss 
                  src="CodeProject Global Windows Hooks_ Free source code and programming help_files/discuss.gif" 
                  width=15> <A 
                  href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx#_comments">Discuss</A> 
                </TD>
                <TD style="WHITE-SPACE: nowrap"><IMG 
                  style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; VERTICAL-ALIGN: middle; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
                  height=16 alt="Recommend Article" 
                  src="CodeProject Global Windows Hooks_ Free source code and programming help_files/mail.gif" 
                  width=16> <A id=ctl00_ArticleHeaderLinks_Recommend 
                  href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=19858">Send 
                  to a friend</A> </TD></TR></TBODY></TABLE></TD>
          <TD align=right>
            <TABLE>
              <TBODY>
              <TR>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
                  align=right><SPAN id=ctl00_ArticleRating_VoteLabel>19 votes 
                  for this Article.</SPAN> </TD>
                <TD>
                  <TABLE cellSpacing=0 cellPadding=0 border=1>
                    <TBODY>
                    <TR>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/red.gif" 
                        width=20 border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/red.gif" 
                        width=20 border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/red.gif" 
                        width=20 border=0></TD>
                      <TD width=20 bgColor=white height=5><IMG height=5 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/red.gif" 
                        width=20 border=0></TD>
                      <TD noWrap width=20 bgColor=white height=5><IMG height=5 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/red.gif" 
                        width=2 border=0></TD></TR></TBODY></TABLE></TD></TR>
              <TR id=ctl00_ArticleRating_PopularityRow>
                <TD class=SmallText align=right colSpan=2><A 
                  id=ctl00_ArticleRating_PopularityLnk 
                  title="Calculated as rating x Log10(# votes)" 
                  href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                  5.24</A><SPAN id=ctl00_ArticleRating_PopularityLbl></SPAN> 
                  Rating: <B>4.10</B> out of 5 
      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV class=SmallText id=ctl00_UneditedRow 
      style="PADDING-RIGHT: 5px; BORDER-TOP: #ff9900 1px dashed; PADDING-LEFT: 5px; PADDING-BOTTOM: 5px; MARGIN: 5px; PADDING-TOP: 5px; BORDER-BOTTOM: #ff9900 1px dashed"><B>Note:</B> 
      This is an unedited contribution. If this article is inappropriate, needs 
      attention or copies someone else's work without reference then please <A 
      id=ctl00_ReportProblem 
      href="http://www.codeproject.com/script/Articles/Report.aspx?aid=19858">Report 
      This Article</A> </DIV>
      <UL class=Callout id=ctl00_confirmError style="MARGIN-RIGHT: 20px">
        <LI class=SmallText 
        style="LIST-STYLE-IMAGE: url(/images/warning.gif)">You are signed up for 
        one or more <A id=ctl00_SubscribeLink2 
        href="http://www.codeproject.com/script/Membership/Subscribe.aspx?rp=%2fKB%2fvb%2fWindowsHookLib.aspx">newsletters</A> 
        but your email address is either unconfirmed, or has not been 
        reconfirmed in a long time. Please click <A id=ctl00_RequestConfirmLink2 
        href="http://www.codeproject.com/script/Membership/SendConfirmRequest.aspx?rp=%2fKB%2fvb%2fWindowsHookLib.aspx">here</A> 
        to have an email sent that will allow us to confirm your email address 
        and start sending you newsletters again.</LI></UL><SPAN id=intelliTXT>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/vb/WindowsHookLib/WindowsHookLib.zip">Download 
        WindowsHookLib.zip - 11.4 KB</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/vb/WindowsHookLib/WindowsHookLib_Source_Files.zip">Download 
        WindowsHookLib_Source_Files.zip - 9.9 KB</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/vb/WindowsHookLib/Windows_Hook_Demo_Project.zip">Download 
        Windows_Hook_Demo_Project.zip - 95.9 KB</A> </LI></UL>
      <H2>Introduction</H2>
      <P dir=ltr>There are many similar articles of this type but I didn't find 
      any article discussing about how to hook the mouse and the keyboard in 
      Visual Basic.Net. Since I have done this in V.B.Net I decided to post it 
      in here for the people who will need it.</P>
      <P dir=ltr>I created this project as a single component to hook the mouse 
      and the keyboard system wide ( I might add some other hook types in this 
      component in the future if I have time). It is a library file 
      'WindowsHookLib' dll that can be referenced into various projects.</P>
      <P dir=ltr style="MARGIN-RIGHT: 0px">This component differs from what I 
      have seen in the similar articles by providing two more things.</P>
      <OL dir=ltr>
        <LI>
        <P>Preventing a message to be passed to othere windows.</P>
        <LI>
        <P>Raising 'MouseClick' and 'MouseDoubleClick' events. (never seen in 
        other low level hooks!)</P></LI></OL>
      <H2>Background</H2>
      <P>I won't discuses here about how the hooks work since there are plenty 
      of articles in this forum and in others that do very good job explaining 
      them. But instead I will go through the details of the component.</P>
      <P>The 'WindowsHookLib' component provides classes to low level hooks for 
      applications. It uses some Api functions to hook system wide.</P>
      <H2>
      <TABLE style="WIDTH: 30.8%; HEIGHT: 120px" cellSpacing=1 cellPadding=1 
      border=1>
        <TBODY>
        <TR>
          <TD>
            <P align=center><STRONG>Api Functions Used</STRONG></P></TD></TR>
        <TR>
          <TD>
            <P>SetWindowsHookEx</P></TD></TR>
        <TR>
          <TD>
            <P>UnhookWindowsHookEx</P></TD></TR>
        <TR>
          <TD>
            <P>CallNextHookEx</P></TD></TR>
        <TR>
          <TD>
            <P>WindowFromPoint</P></TD></TR></TBODY></TABLE></H2>
      <H3>Mouse Hook</H3>
      <P>The 'LLMouseHook' class from 'WindowsHookLib' is designed to hook the 
      mouse globally and raise some useful events. Since this hook is low level 
      and low level mouse hook doesn't get MouseClick and MouseDoubleClick 
      messages it simulates these events. In order to use the events, the class 
      object variable should be declared with 'WithEvents' key word.</P>
      <P>The class's 'MouseDown', 'MouseUp', 'MouseWheel' and 'MouseMove' event 
      handlers have a 'WindowsHookLib.MouseEventArgs' class object which 
      provides all relevant information about the mouse as does the 
      System.Windows.Forms.MouseEventArgs and two additional properties 
      'Handled' and 'Control'. You can set 'Handled' property to 'True' to 
      prevent the message to be passed to the other windows. The 'Control' 
      property provides the handle of the control under the mouse pointer.<BR>If 
      you decide to set the 'Handled' property in the 'MouseUp' event then it is 
      recommended to set it in the 'MouseDown' event as well for the application 
      performance. Conversely if you decide to set the 'Handled' property in the 
      'MouseDown' event then it is recommended to set it in the 'MouseUp' 
      event.<BR><BR><STRONG>Note:</STRONG> if you set the 'Handled' property in 
      the mentioned events unconditionally than you might not be able to use the 
      mouse. To condition (block the mouse message to be passed to the other 
      windows or controls) you should compare the 'Control' property's value 
      against allowed control handle(s). If the alowed controls' handle list 
      doesn't contain the 'Control' property value then you can set the 
      'Handled' property to 'True' otherewise don't set it.<BR>You can check the 
      demo project's examples to see how you can condition the mouse handled 
      process.<BR><BR><STRONG>Note:</STRONG> before you exit your application 
      you must call the hook objects' 'Dispose' method to uninstall the hook and 
      free the class variables.</P>
      <P>
      <TABLE style="WIDTH: 100%; HEIGHT: 172px" cellSpacing=1 cellPadding=1 
      border=1>
        <TBODY>
        <TR>
          <TD>
            <P align=center><STRONG>Method Name</STRONG></P></TD>
          <TD>
            <P align=center><STRONG>Discription</STRONG></P></TD>
          <TD>
            <P align=center><STRONG>Parameter</STRONG></P></TD>
          <TD>
            <P align=center><STRONG>Return Value</STRONG></P></TD></TR>
        <TR>
          <TD>InstallHook</TD>
          <TD>Installs the mouse hook globally.</TD>
          <TD>
            <P>throwEx (Boolean)</P></TD>
          <TD>Boolean</TD></TR>
        <TR>
          <TD>RemoveHook</TD>
          <TD>Removes the mouse hook.</TD>
          <TD>
            <P>throwEx (Boolean) </P></TD>
          <TD>Boolean</TD></TR>
        <TR>
          <TD>GetState</TD>
          <TD>Gets an enum value that identifies the hook state.</TD>
          <TD>None</TD>
          <TD>Enum</TD></TR>
        <TR>
          <TD>Dispose</TD>
          <TD>Unhooks the mouse (if it is hooked) and sets the class level 
            variables to point to nothing.</TD>
          <TD>None</TD>
          <TD>None</TD></TR></TBODY></TABLE></P>
      <P>
      <TABLE style="WIDTH: 100%" cellSpacing=1 cellPadding=1 border=1>
        <TBODY>
        <TR>
          <TD>
            <P align=center><STRONG>Event</STRONG></P></TD>
          <TD>
            <P align=center><STRONG>Discription</STRONG></P></TD></TR>
        <TR>
          <TD>StateChanged</TD>
          <TD>Fires the event if the mouse hook is 
installed/uninstalled.</TD></TR>
        <TR>
          <TD>MouseDown</TD>
          <TD>Fires the event if the mouse button is down.</TD></TR>
        <TR>
          <TD>MouseUp</TD>
          <TD>Fires the event if the mouse button is up.</TD></TR>
        <TR>
          <TD>MouseMove</TD>
          <TD>Fires the event if the mouse is moved.</TD></TR>
        <TR>
          <TD>MouseWheel</TD>
          <TD>Fires the event if the mouse vertical/horizontal wheels are 
            rotated.</TD></TR>
        <TR>
          <TD>MouseClick</TD>
          <TD>Fires the event if the mouse is clicked.</TD></TR>
        <TR>
          <TD>MouseDoubleClick</TD>
          <TD>Fires the event if the mouse is 
      double-clicked.</TD></TR></TBODY></TABLE></P>
      <H3>Keyboard Hook</H3>
      <P>The 'LLKeyboardHook' class from 'WindowsHookLib' can be used to hook 
      the keyboard globally. The class provides three events whose 'KeyDown' and 
      'KeyUp' event handlers contain 'WindowsHookLib.KeyEventArgs' object that 
      has all relevant information about the key as does the 
      System.Windows.Forms.KeyEventArgs.<BR>As with the mouse hook, you can set 
      the 'Handled' property to True in the 'KeyDown' and 'KeyUp' event handlers 
      to prevent the message to be passed to the other windows.</P>
      <P>
      <TABLE style="WIDTH: 100%; HEIGHT: 153px" cellSpacing=1 cellPadding=1 
      border=1>
        <TBODY>
        <TR>
          <TD>
            <P align=center><STRONG>Method Name</STRONG></P></TD>
          <TD>
            <P align=center><STRONG>Discription</STRONG></P></TD>
          <TD>
            <P align=center><STRONG>Parameter</STRONG></P></TD>
          <TD>
            <P align=center><STRONG>Return Value</STRONG></P></TD></TR>
        <TR>
          <TD>InstallHook</TD>
          <TD>Installs the keyboard hook globally.</TD>
          <TD>
            <P>throwEx(Boolean)</P></TD>
          <TD>Boolean</TD></TR>
        <TR>
          <TD>RemoveHook</TD>
          <TD>Removes the keyboard hook.</TD>
          <TD>
            <P>throwEx (Boolean)</P></TD>
          <TD>Boolean</TD></TR>
        <TR>
          <TD>GetState</TD>
          <TD>Gets an enum value that identifies the hook state.</TD>
          <TD>None</TD>
          <TD>Enum</TD></TR>
        <TR>
          <TD>Dispose</TD>
          <TD>Unhooks the keyboard (if it is hooked) and sets the class level 
            variables to point to nothing.</TD>
          <TD>None</TD>
          <TD>None</TD></TR></TBODY></TABLE></P>
      <P>
      <TABLE style="WIDTH: 100%" cellSpacing=1 cellPadding=1 border=1>
        <TBODY>
        <TR>
          <TD>
            <P align=center><STRONG>Event</STRONG></P></TD>
          <TD>
            <P align=center><STRONG>Discription</STRONG></P></TD></TR>
        <TR>
          <TD>StateChanged</TD>
          <TD>Fires the event if the keyboard hook is 
        installed/uninstalled.</TD></TR>
        <TR>
          <TD>KeyDown</TD>
          <TD>Fires the event if a keyboard button is down.</TD></TR>
        <TR>
          <TD>KeyUp</TD>
          <TD>Fires the event if the keyboard button is 
      up.</TD></TR></TBODY></TABLE></P>
      <H2>Using the code</H2>
      <P dir=ltr><STRONG>Note:</STRONG> you need to use the dll file by 
      referencing it in to your project, not the classes; otherwise they might 
      not work correctly. If you need the methods' discriptions, than you need 
      to copy the 'WindowsHookLib.xml' file into your project folder.</P><PRE lang=vb.net dir=ltr><SPAN class=code-comment>'</SPAN><SPAN class=code-comment>Class level declarations</SPAN>
<SPAN class=code-keyword>Dim</SPAN> <SPAN class=code-keyword>WithEvents</SPAN> gkh <SPAN class=code-keyword>As</SPAN> <SPAN class=code-keyword>New</SPAN> LLKeyboardHook
<SPAN class=code-keyword>Dim</SPAN> <SPAN class=code-keyword>WithEvents</SPAN> gmh <SPAN class=code-keyword>As</SPAN> <SPAN class=code-keyword>New</SPAN> LLMouseHook
<SPAN class=code-comment>'</SPAN><SPAN class=code-comment>Alowed control handle list</SPAN>
<SPAN class=code-keyword>Dim</SPAN> alowedList <SPAN class=code-keyword>As</SPAN> <SPAN class=code-keyword>New</SPAN> List(<SPAN class=code-keyword>Of</SPAN> <SPAN class=code-SDKkeyword>IntPtr</SPAN>)</PRE>
      <P lang=vb.net dir=ltr>
      <P lang=vb.net dir=ltr><PRE lang=vb.net><SPAN class=code-keyword>Try</SPAN>
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>Install the keyboard hook</SPAN>
    gkh.InstallHook()
<SPAN class=code-keyword>Catch</SPAN> ex <SPAN class=code-keyword>As</SPAN> Exception
    MessageBox.Show(<SPAN class=code-string>"</SPAN><SPAN class=code-string>Failed to install the keyboard hook!."</SPAN> _
    &amp; Environment.NewLine &amp; ex.Message, <SPAN class=code-string>"</SPAN><SPAN class=code-string>Keyboard Hook Error!"</SPAN>, _
    MessageBoxButtons.OK, MessageBoxIcon.<SPAN class=code-keyword>Error</SPAN>)
    Console.WriteLine(ex.Message)
<SPAN class=code-keyword>End</SPAN> <SPAN class=code-keyword>Try</SPAN></PRE>
      <P lang=vb.net><PRE lang=vb.net><SPAN class=code-keyword>Try</SPAN>
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>Remove the keyboard hook</SPAN>
    gkh.RemoveHook()
<SPAN class=code-keyword>Catch</SPAN> ex <SPAN class=code-keyword>As</SPAN> Exception
    Console.WriteLine(ex.Message)
<SPAN class=code-keyword>End</SPAN> <SPAN class=code-keyword>Try</SPAN></PRE>
      <P lang=vb.net><PRE lang=vb.net><SPAN class=code-keyword>Private</SPAN> <SPAN class=code-keyword>Sub</SPAN> gkh_KeyDown( _
<SPAN class=code-keyword>ByVal</SPAN> sender <SPAN class=code-keyword>As</SPAN> Object, _
<SPAN class=code-keyword>ByVal</SPAN> e <SPAN class=code-keyword>As</SPAN> WindowsHookLib.KeyEventArgs) <SPAN class=code-keyword>Handles</SPAN> gkh.KeyDown
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>Block Alt+PrintScreen key combination</SPAN>
    e.Handled = (e.Modifiers = Keys.Alt <SPAN class=code-keyword>AndAlso</SPAN> e.KeyCode = Keys.PrintScreen)
<SPAN class=code-keyword>End</SPAN> <SPAN class=code-keyword>Sub</SPAN></PRE>
      <P lang=vb.net><PRE lang=vb.net><SPAN class=code-keyword>Private</SPAN> <SPAN class=code-keyword>Sub</SPAN> gmh_MouseDown( _
<SPAN class=code-keyword>ByVal</SPAN> sender <SPAN class=code-keyword>As</SPAN> IntPtr, _
<SPAN class=code-keyword>ByVal</SPAN> e <SPAN class=code-keyword>As</SPAN> WindowsHookLib.MouseEventArgs) <SPAN class=code-keyword>Handles</SPAN> gmh.MouseDown
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>Set the Handled property for the mouse down event</SPAN>
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>to block the mouse down message for the </SPAN>
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>controls that are not in the alowedList.</SPAN>
    e.Handled = <SPAN class=code-keyword>Not</SPAN> <SPAN class=code-keyword>Me</SPAN>.alowedList.Contains(sender)
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>Do some other things here</SPAN>
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>...</SPAN>
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>...</SPAN>
<SPAN class=code-keyword>End</SPAN> <SPAN class=code-keyword>Sub</SPAN></PRE>
      <P lang=vb.net><PRE lang=vb.net><SPAN class=code-keyword>Private</SPAN> <SPAN class=code-keyword>Sub</SPAN> gmh_MouseUp( _
<SPAN class=code-keyword>ByVal</SPAN> sender <SPAN class=code-keyword>As</SPAN> IntPtr, _
<SPAN class=code-keyword>ByVal</SPAN> e <SPAN class=code-keyword>As</SPAN> WindowsHookLib.MouseEventArgs) <SPAN class=code-keyword>Handles</SPAN> gmh.MouseUp
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>Set the Handled property for the mouse up event</SPAN>
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>to block the mouse up message for the </SPAN>
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>controls that are not in the alowedList.</SPAN>
    e.Handled = <SPAN class=code-keyword>Not</SPAN> <SPAN class=code-keyword>Me</SPAN>.alowedList.Contains(sender)
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>Do some other things here</SPAN>
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>...</SPAN>
    <SPAN class=code-comment>'</SPAN><SPAN class=code-comment>...</SPAN>
<SPAN class=code-keyword>End</SPAN> <SPAN class=code-keyword>Sub</SPAN></PRE>
      <P lang=vb.net><BR>For more examples check the 'Windows Hook Demo Project' 
      zip file.</P>
      <H2>Points of Interest</H2>
      <P>I learned many things from this project like how to make dll file 
      component that can be used in various projects (VB.Net, C#, C++, J#) in 
      .Net environment. How to apply attributes to classes or methods that will 
      make the component professional.</P>
      <P>Since low level mouse hook doesn't get 'MouseClick' and 
      'MouseDoubleClick' event messages (which I believe are generated by a 
      window that gets 'MouseDown' and 'MouseUp' messages), I achieved to 
      simulate these events such that they are generated with the same pattern 
      as the windows 'MouseClick' and 'MouseDoubleClick' events.</P>
      <H2>WindowsHookLib information</H2>
      <UL>
        <LI>Author Name: Arman Ghazanchyan 
        <LI>Current Assembly Version 1.1.0.1<BR><A 
        href="http://www.vbforums.com/showthread.php?t=436321">External link to 
        WindowsHookLib</A> </LI></UL>
      <H2>History</H2>
      <P>Original Assembly Version 1.0.0.1</P>
      <P>Updated Assembly Version 1.0.0.2<BR>(Some minor changes that don't 
      affect the functionality)</P>
      <P>Updated Assembly Version 1.0.0.3<BR>(Hopefully this is the last update 
      of this kind. The update doesn't add any new feature to the WindowsHookLib 
      but it has been optimized to the most and it's OnMouse and OnKey event 
      methods has been declared as Protected Overridable so that in case of 
      inheritance they can be accessible. The update is recommended.)</P>
      <P>Updated Assembly Version 1.0.0.4<BR>I just made the WindowsHookLib as a 
      component that can be added to the VS toolbar so that it can be dragged 
      and dropped on to a form easily.<BR><BR>Updated Assembly Version 
      1.0.0.5<BR>(This update addresses to the LLMouseHook class.<BR>1. I 
      changed all mouse event sender parameters' data type to IntPtr that will 
      contain the handle of the control under the mouse.<BR>2. A shared method 
      "LLMouseHook.SynthesizeEvent" is added to the class that can be used to 
      synthesize a mouse event.)</P>
      <P>Updated Assembly Version 1.0.0.6<BR>(This update addresses to the 
      LLMouseHook class.<BR>1. This update includes a small bug fix in 
      LLMouseHook class. The mouse double-click event wasn’t firing after the 
      mouse hook once was removed.<BR>2. Some simplifications to the mouse 
      SynthesizeEvent method. The method is braked down to four methods (mouse 
      down, up, move and wheel) to simplify the parameters.)<BR><BR>Updated 
      Assembly Version 1.1.0.1<BR>(This update addresses to all hooks.<BR>1. The 
      WindowsHookLib assembly is signed.<BR>2. A Clipboard hook is added. - 
      New)</P><!-- Article Ends --><!-- Main Page Contents End --></DIV></SPAN>
      <FORM id=aspnetForm 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
      name=aspnetForm action=WindowsHookLib.aspx method=post>
      <DIV><INPUT id=__VIEWSTATE type=hidden 
      value=/wEPDwULLTEwMDUyNjYzMjhkZIczDZYCH3Qi+ePtP2bq/YHbbv4k 
      name=__VIEWSTATE> </DIV>
      <H2>License</H2>
      <DIV id=ctl00_LicenseTerms>
      <P>This article, along with any associated source code and files, is 
      licensed under <A href="http://www.codeproject.com/info/cpol10.aspx">The 
      Code Project Open License (CPOL)</A></P></DIV>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1538493">VBDT</A></B><BR><BR>
            <CENTER><IMG id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
            src="CodeProject Global Windows Hooks_ Free source code and programming help_files/{CA59A9E3-0B15-4294-94F7-42AFCB4D0471}.jpg"></CENTER><BR><SPAN 
            class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>I born and still alive!<BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow>
                <TD class=SmallText noWrap>Occupation: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Software 
                  Developer (Senior)</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt="United States" 
                  src="CodeProject Global Windows Hooks_ Free source code and programming help_files/US.gif" 
                  width=16> United 
        States</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE id=ctl00_PopularArticlesRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular VB.NET articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/vb/WritingGPSApplications1.aspx">Writing 
              Your Own GPS Applications: Part I</A>
              <DIV class=SmallText>What is it that GPS applications need to be 
              good enough to use for in-car navigation? Also, how does the 
              process of interpreting GPS data actually work? In this two-part 
              series, I will cover both topics and give you the skills you need 
              to write a commercial-grade GPS application.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/vb/using_propertygrid.aspx">Using 
              PropertyGrid Part-I</A>
              <DIV class=SmallText>Explains about PropertyGrid and how to use, 
              with detailed examples</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/vb/DockPanelSkin.aspx">A 
              Visual Studio 2005-like Interface</A>
              <DIV class=SmallText>Apply a theme that resembles Visual Studio 
              2005 to the DockPanel Suite, using an Extender class.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/vb/OutlookBar.aspx">Rich 
              OutlookBar in XP and Vista style</A>
              <DIV class=SmallText>Creating a rich OutlookBar in XP or Vista 
              style</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/vb/embeddedresources.aspx">Embedding 
              Icons In Your VB.NET Application</A>
              <DIV class=SmallText>How to embed and use icons in your 
              application, so you don't have to keep them as separate 
              files.</DIV></LI></UL>
            <H2></H2></TD>
          <TD><IFRAME 
            src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\ServeHTML(1).htm" 
            frameBorder=0 width=300 scrolling=no 
        height=250></IFRAME></TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
			var addtoMethod=1;
			var AddURL = document.location.href;
			var AddTitle = escape(document.title);
			DrawLinks(100, 0, "SmallText Bold", "AddTo") 
			</SCRIPT>
      </DIV>
      <TABLE class=ArticleUneditedHeader id=ctl00_RateArticleRow cellSpacing=0 
      cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD class=SmallText style="WHITE-SPACE: nowrap" align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px"><I><B>Rate this Article for 
                        us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV><INPUT id=__EVENTVALIDATION type=hidden 
      value=/wEWCAKdtbddAsCUxcMHAsGUxcMHAsKUxcMHAsOUxcMHAsSUxcMHAs/7760LArm6kOQLMAI9Ej/YIADkhxT+vHcUTlq5lQc= 
      name=__EVENTVALIDATION> </DIV></FORM>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d4287%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAnn%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fCWS_net_468x60.gif%26C%3dFalse%26id%3d4287%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22468%22%20height%3d%2260%22%3e%3c%2fa%3e"));</SCRIPT>
      <IFRAME 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/ServeLinks.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD>
            <FORM 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fvb%2fWindowsHookLib.aspx&amp;fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick 
            method=get><INPUT type=hidden value=445050 name=fid><INPUT 
            type=hidden 
            value=?floc=%2fKB%2fvb%2fWindowsHookLib.aspx&amp;fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick 
            name=currentQS><INPUT type=hidden value=/KB/vb/WindowsHookLib.aspx 
            name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 alt=FAQ 
                  src="CodeProject Global Windows Hooks_ Free source code and programming help_files/forum_faq.gif" 
                  width=16 align=middle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 alt=Search 
                  src="CodeProject Global Windows Hooks_ Free source code and programming help_files/forum_search.gif" 
                  width=16 align=top border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=445050">Search 
                  comments</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=submit></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></FORM></TD></TR>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 alt=new 
                  src="CodeProject Global Windows Hooks_ Free source code and programming help_files/forum_newmsg.gif" 
                  width=16 align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;floc=/KB/vb/WindowsHookLib.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 25 of 31 (Total in Forum: 31) (<A 
                  href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next</A></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD><!-- Column Headers -->
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0>
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2441961_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2441961xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2441961#xx2441961xx" 
                        name=2441961>bugs control keys persistence</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=196404">Lions_italy</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:33 26 
                        Feb '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2441961_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I have discovered that if there is 
                                a long time operation during event keydown the 
                                ALT ( may be other control key ) seems pressed 
                                in the next keydown event .<BR>Code sample is 
                                more easy I change the demo KeyDown event adding 
                                a time consuming on ALT F2 .<BR>If I press 
                                ALT-F2 the next F2 comes with ALT also if press 
                                only F2 without ALT.<BR>If I press ALT alone the 
                                situation reset normal.<BR><BR>Here the piece of 
                                code I change <BR><BR>Private Sub 
                                KeyboardHook_KeyDown(ByVal sender As Object, 
                                ByVal e As WindowsHookLib.KeyEventArgs) Handles 
                                KeyboardHook.KeyDown<BR><BR>'Set the key down 
                                Handled property<BR>e.Handled = 
                                Me.HandleKeyboardCheckBox.Checked<BR>If 
                                e.KeyCode = Keys.F2 And e.Alt 
                                Then<BR>Me.DisplayTextBox.AppendText(Environment.NewLine)<BR>Me.DisplayTextBox.AppendText("===================== 
                                Sleep 
                                1000")<BR>System.Threading.Thread.Sleep(1000)<BR>End 
                                If<BR>.<BR>.<BR>. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2441961&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2441961&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2441961">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2441961">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2441961&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2441961 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(196404,2441961);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2430217_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2430217xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2430217#xx2430217xx" 
                        name=2430217>Double click event and event up</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4189822">sprk78</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:12 16 
                        Feb '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2430217_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR><BR>I need to distinguish 
                                between the mouse events.<BR><BR>Double click , 
                                Mouse Down, Mouse up.<BR><BR>I want to presses 
                                on the mouse (double click) and to release it, 
                                and get only 2 messages boxes. One is mouse 
                                double click message, and the other is mouse up 
                                message.<BR><BR>How can i do that?<BR><BR>Thanks 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2430217&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2430217&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2430217">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2430217">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2430217&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2430217 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(4189822,2430217);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2467451_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2467451xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2467451#xx2467451xx" 
                        name=2467451>Re: Double click event and event up</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2093160">The_Mega_ZZTer</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">21:05 
                        14 Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2467451_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>The common way of distinguishing 
                                between double clicks and single clicks is 
                                usually not acting immediately on the first 
                                click, but waiting to see if a double click 
                                event fires soon after. If not, THEN the single 
                                click is acted on.<BR><BR>Considering Windows 
                                allows you to adjust the double click time in 
                                the Mouse control panel, this makes things 
                                tricky. The first step would be to figure out 
                                how to get this value and use it for your 
                                timeout value. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2467451&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2467451&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2430217">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2467451">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2467451&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2467451 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2093160,2467451);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2385808_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2385808xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2385808#xx2385808xx" 
                        name=2385808>Correction</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4570442">Raveheart</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">14:20 
                        10 Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2385808_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>The trace is after the AddHandler 
                                line, not actually in the handler, nothing 
                                happens there <IMG 
                                src="CodeProject Global Windows Hooks_ Free source code and programming help_files/smiley_confused.gif" 
                                align=top> <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2385808&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2385808&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2385808">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2385808">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2385808&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2385808 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(4570442,2385808);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2385796_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2385796xx></A><IMG height=16 alt=Question 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2385796#xx2385796xx" 
                        name=2385796>Running WindowsHookLib.dll from a 
                        service.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4570442">Raveheart</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">14:09 
                        10 Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2385796_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Thanks for some great code! I've 
                                got the dll working as it should from my own 
                                Forms app, but I need to run it as a service 
                                (unless you know a better way to get last input 
                                time of any logged in user). Everything seems to 
                                work fine, no error messages, but nothing 
                                feeding through to the callback function. I've 
                                set the service to interact with desktop but 
                                this hasn't helped. Any suggestions? Here's the 
                                bare bones of what I'm 
                                attempting...<BR><BR><CODE>Public Class 
                                MyServiceClass<BR>Friend WithEvents KbHook As 
                                WindowsHookLib.LLKeyboardHook<BR>Public Shared 
                                LastInputTicks as Integer<BR><BR>Protected 
                                Overrides Sub OnStart(ByVal args() As 
                                String)<BR><BR>LastInputTicks = 
                                Environment.TickCount<BR><BR>KbHook = New 
                                WindowsHookLib.LLKeyboardHook<BR>KbHook.InstallHook()<BR>AddHandler 
                                KbHook.KeyDown, AddressOf 
                                KbHook_KeyDown<BR><BR>Dim objLog As EventLog = 
                                New EventLog("Security")<BR>AddHandler 
                                objLog.EntryWritten, AddressOf 
                                SecurityLog_OnEntryWritten<BR>objLog.EnableRaisingEvents 
                                = True<BR>End Sub<BR><BR>Private Sub 
                                KbHook_KeyDown(ByVal sender As Object, ByVal e 
                                As KeyEventArgs)<BR>LastInputTicks = 
                                Environment.TickCount<BR>'Trace shows no 
                                errors<BR>End Sub<BR><BR>Private Sub 
                                SecurityLog_OnEntryWritten(ByVal [source] As 
                                Object, ByVal e As EntryWrittenEventArgs)<BR>'Do 
                                stuff until LastInputTicks hasn't changed for 
                                some time<BR>'Trace works here but 
                                LastInputTicks never changes<BR>End 
                                Sub<BR><BR>End Class</CODE> <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2385796&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2385796&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2385796">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2385796">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2385796&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2385796 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(4570442,2385796);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2391305_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2391305xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2391305#xx2391305xx" 
                        name=2391305>Re: Running WindowsHookLib.dll from a 
                        service.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1538493">VBDT</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">19:07 
                        15 Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2391305_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi Raveheart,<BR>The 
                                WindowsHookLib should work in windows service 
                                component since it is a component itself. I am 
                                not sure what causes the problem but one thing 
                                that catches my eye is that you declared the 
                                keyboard hook variable with “WithEvents” keyword 
                                and than used the “AddHandler” to add handler to 
                                a procedure. There is no need to use 
                                “AddHandler” if you use “WithEvents” keyword. 
                                <BR>With “WithEvents” keyword declared just 
                                select the kbHook from the top dropdown list of 
                                the VS in code designer and then selects the 
                                event from the right dropdown list of VS as you 
                                do with any object. This will make things easy 
                                since you don’t need to remove the added handler 
                                when the service removed or stopped. Check this 
                                suggestion and see if it works.<BR>Also, check 
                                if your service starts and runs correctly. It 
                                might be that it doesn’t start so keyboard never 
                                gets hooked.<BR><BR>Regards,<BR>VBDT 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2391305&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2391305&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2385796">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2391305">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2391305&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2391305 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1538493,2391305);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2393314_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2393314xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2393314#xx2393314xx" 
                        name=2393314>Re: Running WindowsHookLib.dll from a 
                        service.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4570442">Raveheart</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:22 17 
                        Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2393314_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Thanks VBDT, but I'm no further 
                                forward. <BR>The service runs fine. In fact, its 
                                threads loop long after there's been no user 
                                input and I'd like to abort them - the threads, 
                                not the users! From VS debug I can attach to its 
                                running process (except the 'OnStart' - 
                                obviously) and step through the code responding 
                                to other events, but a breakpoint on the KeyDown 
                                handler never gets hit (and the log doesn't get 
                                written to when the service is running 
                                normally). If I fake the Service OnStart method 
                                and run the whole thing from a form everything 
                                works perfectly <IMG 
                                src="CodeProject Global Windows Hooks_ Free source code and programming help_files/smiley_confused.gif" 
                                align=top> <BR>I'd be very grateful for any 
                                light shed. Do I need to set some Framework 
                                permissions?<BR><BR>Regards,<BR>R<BR><BR>Here's 
                                where I'm at:<BR><BR><CODE>Imports 
                                WindowsHookLib<BR>Public Class MyUnendingService 
                                ' Runs as Local System<BR><BR>Friend WithEvents 
                                KbHook As LLKeyboardHook<BR><BR>Protected 
                                Overrides Sub OnStart(ByVal args() As 
                                String)<BR>Try<BR>KbHook = New 
                                LLKeyboardHook<BR>KbHook.InstallHook()<BR>Log("OnStart: 
                                KbHook " &amp; KbHook.GetState.ToString()) 
                                <BR>'-&gt; From the log... "OnStart: KbHook 
                                Installed"<BR>Catch ex As 
                                Exception<BR>Log("Failed to install KbHook") 
                                '-&gt; No entry in the log<BR>End 
                                Try<BR><BR>'AddHandler here for the service to 
                                respond to its main event, all works as 
                                intended, can step through the process's code 
                                from attached debugger<BR><BR>End 
                                Sub<BR><BR>Protected Overrides Sub 
                                OnStop()<BR>Try<BR>KbHook.RemoveHook()<BR>Log("OnStop: 
                                KbHook " &amp; 
                                KbHook.GetState.ToString())<BR>'-&gt; From the 
                                log... "OnStop: KbHook Uninstalled"<BR>Catch ex 
                                As Exception<BR>Log("Failed to uninstall 
                                KbHook") '-&gt; Again, no log entry here<BR>End 
                                Try<BR>End Sub<BR><BR>Private Sub 
                                KbHook_KeyDown(ByVal sender As Object, ByVal e 
                                As WindowsHookLib.KeyEventArgs) Handles 
                                KbHook.KeyDown<BR>Log("Keyboard hammered 
                                repeatedly!") <BR>' Nothing appears in the log - 
                                Key press never gets here <IMG 
                                src="CodeProject Global Windows Hooks_ Free source code and programming help_files/smiley_mad.gif" 
                                align=top><BR>End Sub</CODE> <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2393314&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2393314&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2385796">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2393314">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2393314&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2393314 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(4570442,2393314);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2395298_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx2395298xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2395298#xx2395298xx" 
                        name=2395298>Re: Running WindowsHookLib.dll from a 
                        service. [modified]</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1538493">VBDT</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:04 
                        18 Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2395298_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi, I don’t see any problem with 
                                the code. I think it might not be possible to 
                                hook the keyboard in a service due to the 
                                requirement of the SetWindowsHookEx Api method 
                                that should be called from an application (in 
                                other words the WindowsHookLib should be 
                                associated with an application not a service). 
                                This might not be an accurate assumption since 
                                MS doesn’t say anything about hooking from 
                                service but I don't see anything that may cause 
                                the problem.<BR>Best regards,<BR>VBDT <BR><BR>
                                <DIV class=ForumMod>modified on Saturday, 
                                January 19, 2008 2:55:25 PM</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2395298&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2395298&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2385796">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2395298">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2395298&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2395298 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1538493,2395298);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2467452_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx2467452xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2467452#xx2467452xx" 
                        name=2467452>Re: Running WindowsHookLib.dll from a 
                        service.</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2093160">The_Mega_ZZTer</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">21:10 
                        14 Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2467452_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>What OS are you using? If you are 
                                using Vista you can forget about hooking the 
                                mouse and keyboard... I believe that is probably 
                                no longer allowed (you cannot use any UI API in 
                                services, and that may extend to mouse and 
                                keyboard functions).<BR><BR>Also you may want to 
                                check the user the service is running under... 
                                it might not have sufficient permissions (though 
                                it's doubtful this is the 
                                problem).<BR><BR>Either way the first step would 
                                be to check the return values of the WinAPI 
                                functions and make sure they aren't failing. 
                                You'll want to either write a line to the 
                                Windows Event Log or write a log file to disk... 
                                Remember on Vista both writing to console or 
                                using messageboxes won't do anything for a 
                                service!<BR><BR>You can throw a 
                                System.ComponentModel.Win32Exception right after 
                                the failed call to get a printable error 
                                message, or just make a Win32Exception without 
                                throwing it and get the message string from 
                                that.<BR><BR>IF you find your calls are failing, 
                                depending on why they're failing you may have to 
                                reconsider your service idea, or you may be able 
                                to work around it somehow. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2467452&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2467452&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2385796">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2467452">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2467452&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2467452 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2093160,2467452);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2366819_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2366819xx></A><IMG height=16 alt=Question 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2366819#xx2366819xx" 
                        name=2366819>Strange problem</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1007549">Gooberstain</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">17:32 
                        23 Dec '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2366819_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Everything works great except one 
                                strange thing. My software hooks double clicks. 
                                For some reason, when you install the hook, then 
                                uninstall it, then install it again, the 
                                double-click handler is never called. I can tell 
                                the hook is installed, but the routine that is 
                                supposed to handle double clicks does not get 
                                called. On the other hand, the single-click 
                                handler works as expected.<BR><BR>Just to be 
                                clear, the double-click handler does work the 
                                first time you install the hook. But if you then 
                                uninstall it and then reinstall it, it does not 
                                work. Single click handler has no 
                                problem.<BR><BR>This problem does not exist in 
                                the demo project, but it does in mine. Any ideas 
                                what could possibly be doing this?<BR><BR>Thanks 
                                a lot! <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2366819&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2366819&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2366819">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2366819">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2366819&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2366819 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1007549,2366819);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2386169_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2386169xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2386169#xx2386169xx" 
                        name=2386169>Re: Strange problem</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1538493">VBDT</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">22:48 
                        10 Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2386169_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi Gooberstain,<BR>Thanks for 
                                reporting the double-click problem. The problem 
                                was due to a small bug. In the remove method it 
                                was setting the double-click rectangle to empty 
                                rectangle which shouldn’t. The rectangle 
                                determines the system double click area and it 
                                is set ones when the object is created. As it 
                                was sett to an empty rectangle in the remove 
                                hook method it was not sett with the values in 
                                the install hook method.<BR><BR>Anyways the 
                                problem is fixed <IMG 
                                src="CodeProject Global Windows Hooks_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top> <BR>Best regards,<BR>Arman G. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2386169&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2386169&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2366819">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2386169">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2386169&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2386169 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1538493,2386169);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2296510_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2296510xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2296510#xx2296510xx" 
                        name=2296510>Brilliant!</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2197387">MagicPantsMan</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:59 
                        30 Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2296510_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Excellent work, thank you!<BR>Your 
                                library works out of the box perfectly.<BR>I 
                                also like the way you have exposed the API, its 
                                very clean and intuitive.<BR>Great work! 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2296510&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2296510&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2296510">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2296510">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2296510&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2296510 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2197387,2296510);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2269835_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2269835xx></A><IMG height=16 alt=Question 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2269835#xx2269835xx" 
                        name=2269835>Is this possible?File Path retrival</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4601150">mohandilli</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">21:39 
                        12 Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2269835_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hi all,<BR>This project is really 
                                rocking.Actually i need a solution for the 
                                problem berfied below<BR>When a file is clicked 
                                whether its possible to retrive the path of the 
                                selected file and write it to a log file. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2269835&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2269835&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2269835">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2269835">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2269835&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2269835 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(4601150,2269835);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2467454_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2467454xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2467454#xx2467454xx" 
                        name=2467454>Re: Is this possible?File Path 
                      retrival</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2093160">The_Mega_ZZTer</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">21:16 
                        14 Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2467454_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>If you want to log the files 
                                clicked in Windows Explorer, this library does 
                                not give you the appropriate tools. It would be 
                                like trying to start a car with a 
                                crowbar.<BR><BR>The scripting program AutoIt is 
                                better suited for this task (it SHOULD be able 
                                to detect a selection change in a listview, 
                                which seems to be what you want), but keep in 
                                mind the Explorer interface changes from Windows 
                                version to Windows version so don't expect your 
                                program to work on different versions of 
                                Windows... that said, the way AutoIt finds 
                                controls in windows, and the fact that Explorer 
                                windows have only one listview, it should 
                                theoretically work on most Windows versions if 
                                you get it working on one. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2467454&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2467454&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2269835">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2467454">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2467454&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2467454 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(2093160,2467454);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2251796_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2251796xx></A><IMG height=16 alt=Question 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2251796#xx2251796xx" 
                        name=2251796>Trying the code out</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4562120">Per 
                        Sderberg</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:10 1 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2251796_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR>This will be a superb 
                                feature to have, so I wrote the following test 
                                programme:<BR>-----------------------------------------<BR>Public 
                                Class Form1<BR>'Class level 
                                declarations<BR>Friend WithEvents gkh As New 
                                LLKeyboardHook<BR><BR>Private Sub 
                                Form1_FormClosed(ByVal sender As Object, ByVal e 
                                As System.Windows.Forms.FormClosedEventArgs) 
                                Handles Me.FormClosed<BR>Try<BR>'Remove the 
                                keyboard hook<BR>gkh.RemoveHook()<BR>Catch ex As 
                                Exception<BR>Console.WriteLine(ex.Message)<BR>End 
                                Try<BR>Me.gkh.Dispose()<BR>End 
                                Sub<BR><BR>Private Sub Form1_Load(ByVal sender 
                                As Object, ByVal e As System.EventArgs) Handles 
                                Me.Load<BR>Console.WriteLine("Keyboard Hook " 
                                &amp; Me.gkh.GetState.ToString)<BR>End 
                                Sub<BR><BR>Private Sub gkh_StateChanged(ByVal 
                                sender As Object, ByVal e As 
                                WindowsHookLib.StateChangedEventArgs) Handles 
                                gkh.StateChanged<BR>'Print the keyboard hook 
                                state in the KeyboardGroupBox name <BR><BR>If 
                                e.State = WindowsHookLib.HookState.Uninstalled 
                                Then<BR>'Clear the Handle Keyboard 
                                checkbox<BR><BR>End If<BR>End 
                                Sub<BR><BR><BR>Private Sub gkh_KeyDown( 
                                _<BR>ByVal sender As Object, _<BR>ByVal e As 
                                WindowsHookLib.KeyEventArgs) Handles 
                                gkh.KeyDown<BR><BR>e.Handled = (e.Modifiers = 
                                Keys.LWin Or e.Modifiers = 
                                Keys.RWin)<BR>e.Handled = (e.Modifiers = 
                                Keys.Alt AndAlso e.KeyCode = Keys.Escape)<BR>End 
                                Sub<BR><BR>Private Sub Button1_Click(ByVal 
                                sender As System.Object, ByVal e As 
                                System.EventArgs) Handles 
                                Button1.Click<BR>Try<BR>'Install the keyboard 
                                hook<BR>gkh.InstallHook()<BR><BR>Catch ex As 
                                Exception<BR>Console.WriteLine("Message:")<BR>Console.WriteLine(ex.Message)<BR>Console.WriteLine("Source:")<BR>Console.WriteLine(ex.Source)<BR>Console.WriteLine("StackTrace:")<BR>Console.WriteLine(ex.StackTrace)<BR><BR>MessageBox.Show("Failed 
                                to install the keyboard hook!." _<BR>&amp; 
                                Environment.NewLine &amp; ex.Message, "Keyboard 
                                Hook Error!", _<BR>MessageBoxButtons.OK, 
                                MessageBoxIcon.Error)<BR>Console.WriteLine(ex.Message)<BR>End 
                                Try<BR>End Sub<BR><BR>Private Sub 
                                Button2_Click(ByVal sender As System.Object, 
                                ByVal e As System.EventArgs) Handles 
                                Button2.Click<BR>Try<BR>'Remove the mouse 
                                hook<BR>gkh.RemoveHook()<BR>Catch ex As 
                                Exception<BR>Console.WriteLine("Message:")<BR>Console.WriteLine(ex.Message)<BR>Console.WriteLine("Source:")<BR>Console.WriteLine(ex.Source)<BR>Console.WriteLine("StackTrace:")<BR>Console.WriteLine(ex.StackTrace)<BR>End 
                                Try<BR><BR>End Sub<BR>End Class 
                                <BR>----------------------------------------------<BR>And 
                                added the source files and library according to 
                                the demo as enclosed. The demo I got to work 
                                perfectly.<BR>My aim is to prevent the windows 
                                logo button to be used and I wish to block LWIN, 
                                RWIN and ctrl-esc<BR>However when running the 
                                above programme and hitting the button1 gives an 
                                system.componentmodel.win32exception.<BR>Something 
                                went wrong in the environment. I run under XP 
                                pro.<BR>Any idea on what can be wrong would be 
                                greatly appriciated. <BR><BR>Per in Sweden 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2251796&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2251796&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2251796">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2251796">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2251796&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2251796 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(4562120,2251796);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2252279_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2252279xx></A><IMG height=16 alt=Answer 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2252279#xx2252279xx" 
                        name=2252279>Re: Trying the code out</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1538493">VBDT</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:50 1 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2252279_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I tested your code and there seems 
                                to be no problem with it. I don’t get any error. 
                                I also use XP pro. What is the error message? 
                                <BR>Anyways, I just want to say that LWin or 
                                RWin keys are not modifiers and unfortunately 
                                you can’t block these keys. These keys are 
                                reserved by the system and the windows start 
                                menu will appear before the hook process the 
                                message. There are some other hotkeys that low 
                                level keyboard hook or any other hook can’t 
                                block (for exp: Ctrl+Alt+Delete).<BR>Best 
                                regards,<BR>VBDT <BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2252279&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2252279&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2251796">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2252279">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2252279&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2252279 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1538493,2252279);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2253103_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2253103xx></A><IMG height=16 alt=Answer 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2253103#xx2253103xx" 
                        name=2253103>Re: Trying the code out</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4562120">Per 
                        Sderberg</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:56 2 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2253103_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR>Many thanks! Great with 
                                your help!<BR>Yes, the error disappeared after 
                                that I restarted the computer. <BR>It was my 
                                feeling also that I got the start menu before 
                                the hook gave it's trace writeline. i found 
                                several VB6 articles how to block the LWIN and 
                                RWIN in VB6 but yours is the first I found for 
                                VB.NET so I apppriciate your article very much! 
                                <IMG 
                                src="CodeProject Global Windows Hooks_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top><BR><BR>OK, then I suppose I will 
                                block the whole keyboard - that works 
                                (fortunately) in the application when I need to 
                                disallow the start menu.<BR>When I run your demo 
                                the whole keyboard is blocked when I mark the 
                                handle checkbox. So I will try with in the 
                                gkh_keydown add "e.handled = true" then that 
                                would solve the problem. If it doesn't I will 
                                post again.<BR>All the best and thanks 
                                again!<BR>Per <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2253103&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2253103&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2251796">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2253103">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2253103&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2253103 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(4562120,2253103);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2253791_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx2253791xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2253791#xx2253791xx" 
                        name=2253791>Re: Trying the code out</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1538493">VBDT</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:39 2 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2253791_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Actually, you are right about the 
                                demo blocks the LWin and RWin keys. I tested it 
                                again and it confirmed that. The reason I said 
                                it doesn’t because I tried it with a break point 
                                so and since it is breaking at the point the 
                                message is being passed. There is a time 
                                limitation for windows hooks; if they don’t 
                                return the message in the hook process then it 
                                will automatically be returned. Anyways, this is 
                                just an info, so you should be fine on 
                                this.<BR>Best regards,<BR>VBDT<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2253791&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2253791&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2251796">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2253791">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2253791&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2253791 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1538493,2253791);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2254620_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=88><A 
                        name=xx2254620xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2254620#xx2254620xx" 
                        name=2254620>Re: Trying the code out</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4562120">Per 
                        Sderberg</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:26 3 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2254620_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 88px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR>Yes, many thanks. However I 
                                do see a need to only block LWIN and RWIN (And 
                                ctrl-esc but that I can block with your 
                                hook!).<BR>When building an application you 
                                really don't wish to allow the user to run other 
                                stuff like setups in the control panel, etc. - 
                                Particulary for XP embedded applications where 
                                you might need to make maintenance but while the 
                                application is running the start menu should be 
                                unavailable.<BR>And if it would be possible to 
                                solve (it was obviously possible in VB6) also 
                                for VB.NET it would surely be fantastic. even 
                                though I don't need it now, I'm sure I will need 
                                it sooner or later. <IMG 
                                src="CodeProject Global Windows Hooks_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top><BR>Keep up the great 
                                work!<BR>Best,<BR>Per<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2254620&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2254620&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2251796">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2254620">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2254620&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2254620 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(4562120,2254620);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2254868_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=106><A 
                        name=xx2254868xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2254868#xx2254868xx" 
                        name=2254868>Re: Trying the code out [modified]</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1538493">VBDT</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:00 3 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2254868_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 106px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>So far all the combinations you 
                                mentioned in here can be blocked with this 
                                LLHook. The only combination that this hook or 
                                any other hook doesn’t block is 
                                Ctrl+Alt+Delete.<BR>Best 
                                regards,<BR>VBDT<BR><BR><BR>-- modified at 21:09 
                                Wednesday 3rd October, 2007 <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2254868&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2254868&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2251796">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2254868">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2254868&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2254868 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1538493,2254868);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2191403_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2191403xx></A><IMG height=16 alt=Question 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2191403#xx2191403xx" 
                        name=2191403>Altering key vales</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=911611">companyit</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:45 21 
                        Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2191403_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Great application, tow 
                                questions:<BR><BR>1) how can I make it catch a 
                                particular alt sequence Alt-U and then simulate 
                                keybord typing of extra character 
                                '\\server\users\gordon'<BR><BR>2) is it posible 
                                to find the current application that is in focus 
                                and adjust the behaviour 
                                <BR><BR>Gordon<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2191403&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2191403&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2191403">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2191403">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2191403&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2191403 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(911611,2191403);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2259696_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2259696xx></A><IMG height=16 alt=Answer 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2259696#xx2259696xx" 
                        name=2259696>Re: Altering key vales [modified]</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1538493">VBDT</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:48 5 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2259696_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>1. You can catch Alt-U key 
                                combination as it is shown in the demo project 
                                or the code example. If you are using VS 2005 
                                than you can use SendKey method of 
                                My.Computer.Keyboard class to send keys to the 
                                active window. If you don't use VS 2005 then you 
                                might want to use SendInput Api 
                                function.<BR><BR>2. To find the current window 
                                that is in focus you will need to use the 
                                "GetForegroundWindow" (if I am not mistaking) 
                                Api function to get the windows handle and from 
                                there you can use this handle with “FindWindow” 
                                Api function to get the name. There are many Api 
                                functions associated with windows so you can use 
                                one that suits your needs.<BR>Best 
                                regards,<BR>VBDT<BR><BR><BR><BR>-- modified at 
                                13:46 Sunday 7th October, 2007 <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2259696&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2259696&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2191403">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2259696">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2259696&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2259696 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1538493,2259696);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2187697_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2187697xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2187697#xx2187697xx" 
                        name=2187697>WindowsHookLib Source Files</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1265816">shabyb</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">13:00 
                        17 Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2187697_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I will be happy if you put the all 
                                sln files of ther WindowsHookLib project to 
                                download.<IMG 
                                src="CodeProject Global Windows Hooks_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top> <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2187697&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2187697&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2187697">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2187697">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2187697&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2187697 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1265816,2187697);
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2188321_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2188321xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2188321#xx2188321xx" 
                        name=2188321>Re: WindowsHookLib Source Files</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1265816">shabyb</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:17 18 
                        Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2188321_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I did what you say, but i have a 
                                problems to buils the class library.<BR>Some of 
                                the types declaration are missing.<BR>For 
                                example Type 'Keys','Rectangle', .. are not 
                                defined.<BR>I will appreciate your help to solve 
                                this problems.<BR><BR>Thanks<IMG 
                                src="CodeProject Global Windows Hooks_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top> <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2188321&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2188321&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2187697">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2188321">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2188321&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2188321 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(1265816,2188321);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2182873_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2182873xx></A><IMG height=16 alt=General 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;select=2182873#xx2182873xx" 
                        name=2182873>Exactly what I needed!</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=16 alt=member 
                        src="CodeProject Global Windows Hooks_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=695707">StefanTheProgrammer</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:29 15 
                        Aug '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2182873_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>It saved my day! <BR>Im working on 
                                a mediaplayer and had problem to get keypreview 
                                when sometimes wmp had focus and not my form. 
                                Now I can do whatever I want regardles what 
                                control has focus. Nice!<IMG 
                                src="CodeProject Global Windows Hooks_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top><IMG 
                                src="CodeProject Global Windows Hooks_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top> <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: top">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2182873&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445050&amp;select=2182873&amp;floc=/KB/vb/WindowsHookLib.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;sort=Position&amp;tid=2182873">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445050&amp;msg=2182873">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2182873&amp;obtid=3">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2182873 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT language=Javascript 
type=text/javascript>
												MsgVoteForm(695707,2182873);
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="C:\Documents and Settings\admin\Desktop\cryp\CodeProject Global Windows Hooks_ Free source code and programming help_files\t(1).gif" 
                  width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Sunday, March 23, 2008 2:46 AM &nbsp; &nbsp; 
                  Last Update:Sunday, March 23, 2008 4:09 AM</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><B>1</B> <A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/vb/WindowsHookLib.aspx?fid=445050&amp;df=90&amp;mpp=25&amp;noise=3&amp;sort=Position&amp;view=Quick&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next 
      »</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 alt=General 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_general.gif" 
      width=16 align=top> General &nbsp;&nbsp; <IMG height=16 alt=News 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_news.gif" 
      width=16 align=top> News &nbsp;&nbsp; <IMG height=16 alt=Question 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_question.gif" 
      width=16 align=top> Question &nbsp;&nbsp; <IMG height=16 alt=Answer 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_answer.gif" 
      width=16 align=top> Answer &nbsp;&nbsp; <IMG height=16 alt=Joke 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_joke.gif" 
      width=16 align=top> Joke &nbsp;&nbsp; <IMG height=16 alt=Admin 
      src="CodeProject Global Windows Hooks_ Free source code and programming help_files/msg_admin.gif" 
      width=16 align=top> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=19858">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy </A>| <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 13 Mar 2008<BR>Editor: <A 
            id=ctl00_ArticleEditor></A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2007 by 
            VBDT<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2008 
            <BR>Web18 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE>
<SCRIPT language=Javascript 
src="CodeProject Global Windows Hooks_ Free source code and programming help_files/front.asp" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Global Windows Hooks_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Global Windows Hooks_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Global Windows Hooks_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
new HVMenu(new menu_NavbarConfig());
//]]></SCRIPT>
</BODY></HTML>
