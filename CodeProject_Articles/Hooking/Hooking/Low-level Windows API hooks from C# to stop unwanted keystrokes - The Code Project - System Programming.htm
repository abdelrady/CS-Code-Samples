<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0053)http://www.codeproject.com/cs/system/CSLLKeyboard.asp -->
<HTML><HEAD><TITLE>Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=ISO-8859-1">
<META content=en-US name=MS.LOCALE>
<META 
content="Babies and other animals love nothing better than to have a whack at the keyboard, with all sorts of unpredictable results. This application demonstrates how to trap keystrokes before they can do any damage." 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="Emma Burrows" name=Author>
<META content="16 Jun 2006 14:00:00 GMT" name=Search.PublishDate>
<META content="25 Mar 2007 14:00:00 GMT" name=Search.RevisedDate>
<META content="Free source code, , Visual C++, MFC, Windows, Article" 
name=keywords>
<META 
content="Article content copyright Emma Burrows, 2006, everthing else Copyright © CodeProject, 1999-2007, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="The Code Project" 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK href="/favicon.ico" 
type=image/ico rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/oncopy.js"></SCRIPT>

<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
if (typeof(DemoUrl) != "undefined")
	document.write('<me' + 'ta http' + '-equiv="re' + 'fresh" con' + 'tent="1;url=' + DemoUrl + '">');
</SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white>
<SCRIPT 
src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/urchin.js" 
type=text/javascript>
</SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-1735123-1";
urchinTracker();
</SCRIPT>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3891&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FDevExpress%5FtheProblem%5Fleader%5F728x90%2Egif&C=False&id=3891&cb=8092723\" alt=\"\" border=0 width=728 height=90></a>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">4,359,651 members and 
            growing! &nbsp; 10,147 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2959938">abdelrady2030 
            </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/cs/system/CSLLKeyboard.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2959938">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/cs/system/CSLLKeyboard.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD class=SelCat><A 
            href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=8">Architect</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=9">SQL</A></TD>
          <TD noWrap><A href="http://www.codeproject.com/index.asp?cat=1">All 
            Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 300px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=300>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=3">C#</A>, <A 
            href="http://www.codeproject.com/?cat=5">.NET</A> &gt;&gt; <A 
            href="http://www.codeproject.com/cs/system/">System Programming</A> 
            &gt;&gt; <A 
            href="http://www.codeproject.com/cs/system/#Hardware">Hardware</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">Low-level Windows 
            API hooks from C# to stop unwanted keystrokes</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=761050">Emma 
            Burrows</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">Babies and other animals love nothing 
            better than to have a whack at the keyboard, with all sorts of 
            unpredictable results. This application demonstrates how to trap 
            keystrokes before they can do any damage.</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C#<BR>Windows (NT4, Win2K, 
            WinXP, Win2003), .NET<BR>Win32, VS, WinForms<BR>Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>17 Jun 
            2006</B><BR><SPAN style="PADDING-RIGHT: 0.3ex">Updated</SPAN>: <B>26 
            Mar 2007</B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: 
            <B>58,274</B> </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <DIV class=FeatureBlockHeader>Announcements</DIV>
            <DIV class="FeatureBlockContent RHFeatureBar">
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 5px; MARGIN-RIGHT: 10px" 
            height=20 alt=Comp 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/prize_winner_sm.gif" 
            width=10><A 
            href="http://www.codeproject.com/script/competitions/monthly/">Monthly 
            Competition</A></DIV></DIV>
            <CENTER>
            <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=3438&cb=8092732\" border=0 frameborder=0 scrolling=no width=160 height=600></IFRAME>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=CSLLKeyboard%2Fcsharp6%2F17%2F2006">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fcs%2Fsystem%2FCSLLKeyboard%2Easp&amp;guid=CSLLKeyboard%2Fcsharp6%2F17%2F2006">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp#__comments">Discuss</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/mail.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/script/recommend/form.asp?guid=CSLLKeyboard%2Fcsharp6%2F17%2F2006">Send 
                        to a friend</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>53 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/red.gif" 
                              width=14 border=0><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/white.gif" 
                              width=6 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        8.07</A>. Rating: <B>4.68</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <UL class=download>
              <LI><A 
              href="http://www.codeproject.com/cs/system/CSLLKeyboard/CSLLKeyboard_src.zip">Download 
              source files - 3.37 Kb</A> 
              <LI><A 
              href="http://www.codeproject.com/cs/system/CSLLKeyboard/CSLLKeyboard_demo.zip">Download 
              demo project (VS 2005) - 19.7 Kb</A> 
              <LI><A 
              href="http://www.codeproject.com/cs/system/CSLLKeyboard/CSLLKeyboard_2003_demo.zip">Download 
              demo project (VS 2003) - 12.5 KB</A> </LI></UL>
            <P><IMG height=316 alt="Sample Image - CSLLKeyboard.jpg" 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/CSLLKeyboard.jpg" 
            width=438></P>
            <H2>Introduction</H2>
            <P>Cats and babies have a lot in common. They both like eating the 
            house plants, and share the same hatred of closed doors. They also 
            love using keyboards, with the result that the important email you 
            were sending to your boss is dispatched in mid-sentence, your 
            accounts in Excel are embellished with four rows of gobbledygook, 
            and your failure to notice that Windows Explorer was open results in 
            several files moving to the Recycle Bin.</P>
            <P>The solution is an application which you can switch to as soon as 
            the keyboard is under threat, and which will ensure that any 
            keyboard activity is harmless. This article illustrates how the 
            keyboard can be neutralized in a C# application using a low-level 
            Windows API hook.</P>
            <H2>Background</H2>
            <P>There are a number of articles and code samples regarding hooks 
            in Windows, and some of them are listed at the end of this article. 
            Neutralizing the keyboard when children are around must be a common 
            need -- someone here wrote <A 
            href="http://www.codeproject.com/samples/ForTheKids.asp">almost 
            exactly the same thing in C++</A><A 
            href="http://www.codeproject.com/samples/ForTheKids.asp" 
            target=_blank>[^]</A>! However, when I was looking for source code 
            to create my application, I found very few .NET examples, and none 
            that involved a self-contained class in C#.</P>
            <P>The .NET framework gives managed access to the keyboard events 
            you'll need for most ordinary uses through <CODE>KeyPress</CODE>, 
            <CODE>KeyUp</CODE> and <CODE>KeyDown</CODE>. Unfortunately, these 
            events can't be used to stop Windows from processing key 
            combinations like Alt+Tab or the Windows Start key, which allow 
            users to navigate away from an application. The conveniently placed 
            Windows key in particular was irresistible to my baby son!</P>
            <P>The solution is to catch the keyboard events at the operating 
            system level rather than through the framework. To do this, the 
            application needs to use Windows API functions to add itself to the 
            "hook chain" of applications listening for keyboard messages from 
            the operating system. When it receives this type of message, the 
            application can selectively pass the message on, as it normally 
            should, or suppress it so that no further applications -- including 
            Windows -- can act on it. This article explains how.</P>
            <P>Please note, however, that this code only applies to NT-based 
            versions of Windows (NT, 2000 and XP), and that it isn't possible to 
            use this method to disable Ctrl+Alt+Delete (suggestions on how to do 
            that can be found in <A 
            href="http://msdn.microsoft.com/msdnmag/issues/02/09/CQA/default.aspx">this 
            MSDN Magazine Q&amp;A</A><A 
            href="http://msdn.microsoft.com/msdnmag/issues/02/09/CQA/default.aspx" 
            target=_blank>[^]</A>).</P>
            <H2>Using the code</H2>
            <P>For ease of use, I have attached three separate zip files to this 
            article. One contains only the <CODE>KeyboardHook</CODE> class which 
            is the main focus of this article. The others are complete projects 
            for an application called "Baby Keyboard Bash" which displays the 
            keys' names or coloured shapes in response to keystrokes. For ease 
            of use, I have included two projects, one for Microsoft Visual C# 
            2005 Express Edition and one for Visual Studio 2003.</P>
            <H3>Instantiating the class</H3>
            <P>The keyboard hook is set up and handled by the 
            <CODE>KeyboardHook</CODE> class in <EM>keyboard.cs</EM>. This class 
            implements <CODE>IDisposable,</CODE> so the simplest way to 
            instantiate it is to use the <CODE>using</CODE> keyword in the 
            application's <CODE>Main()</CODE> method, to enclose the 
            <CODE>Application.Run()</CODE> call. This will ensure that the hook 
            is set up as soon as the application starts and, more importantly, 
            is disabled as the application shuts down.</P>
            <P>The class raises an event to warn the application that a key has 
            been pressed, so it is important for the main form to have access to 
            the instance of <CODE>KeyboardHook</CODE> created in the 
            <CODE>Main()</CODE> method; the simplest solution is to store this 
            instance in a public member variable. In a Visual Studio 2003 
            project, this will usually go in the <CODE>Form1</CODE> class (or 
            whatever the application's main class is called), and in Visual 
            Studio 2005, in the <CODE>Program</CODE> class in 
            <EM>Program.cs</EM>.</P>
            <P><CODE>KeyboardHook</CODE> has three constructors to enable or 
            disable certain settings:</P>
            <UL>
              <LI><CODE>KeyboardHook()</CODE>: traps all keystrokes, passing 
              nothing to Windows or other applications. 
              <LI><CODE lang=cs>KeyboardHook(<EM>string param</EM>)</CODE>: 
              Converts the string to one of the values in the 
              <CODE>Parameters</CODE> enum and then calls the following 
              constructor: 
              <LI><CODE lang=cs>KeyboardHook(<EM>KeyboardHook.Parameters 
              enum</EM>)</CODE>: Depending on the value selected from the 
              <CODE>Parameters</CODE> enum, the following settings can be 
              enabled: 
              <UL class=enum>
                <LI><CODE>Parameters.AllowAltTab</CODE>: allows the user to 
                switch to other applications using Alt+Tab. 
                <LI><CODE>Parameters.AllowWindowsKey</CODE>: allows the user to 
                access the taskbar and Start menu using Ctrl+Esc or one of the 
                Windows keys. 
                <LI><CODE>Parameters.AllowAltTabAndWindows</CODE>: enables 
                Alt+Tab, Ctrl+Esc and the Windows keys. 
                <LI><CODE>Parameters.PassAllKeysToNextApp</CODE>: if the 
                parameter is true, all keystrokes will be passed to any other 
                listening applications, including Windows. </LI></UL></LI></UL>
            <P>Enabling Alt+Tab and/or the Windows keys allows the person who is 
            actually using the computer to switch to another application and 
            interact with it using the mouse while keystrokes continue to be 
            trapped by the keyboard hook. The <CODE>PassAllKeysToNextApp</CODE> 
            setting effectively disables the keystroke trapping; the class will 
            still set up a low-level keyboard hook and raise its 
            <CODE>KeyIntercepted</CODE> event, but it will also pass the 
            keyboard events to other listening applications.</P>
            <P>The simplest way to instantiate the class to trap all keystrokes 
            is therefore:</P><PRE lang=cs>public static KeyboardHook kh;

[STAThread]
static void Main()
{
  <SPAN class=cs-comment>//Other code</SPAN>
  using (kh = new KeyboardHook())
  {
    Application.Run(new Form1());
  }
</PRE>
            <H3>Handling the KeyIntercepted event</H3>
            <P>When a key is pressed, the <CODE>KeyboardHook</CODE> class raises 
            a <CODE>KeyIntercepted</CODE> event containing some 
            <CODE>KeyboardHookEventArgs</CODE>. This needs to be handled by a 
            method of the type <CODE>KeyboardHookEventHandler</CODE>, which can 
            be set up as follows:</P><PRE lang=cs>kh.KeyIntercepted += new KeyboardHook.KeyboardHookEventHandler(kh_KeyIntercepted);
</PRE>
            <P>The <CODE>KeyboardHookEventArgs</CODE> returns the following 
            information on the key that was pressed:</P>
            <UL>
              <LI><CODE>KeyName</CODE>: the key's name, obtained by casting the 
              trapped key code to <CODE>System.Windows.Forms.Keys</CODE>. 
              <LI><CODE>KeyCode</CODE>: the original key code returned by the 
              keyboard hook 
              <LI><CODE>PassThrough</CODE>: whether this instance of 
              <CODE>KeyboardHook</CODE> is configured to allow this keystroke 
              through to other applications. Checking this is useful if you want 
              to allow a user to switch to another application using Alt+Tab or 
              Ctrl+Esc/Windows keys. </LI></UL>
            <P>A method with the appropriate signature can then be used to 
            perform whatever tasks the keystroke calls for. Here is an example 
            from the enclosed sample application:</P><PRE lang=cs>void kh_KeyIntercepted(KeyboardHookEventArgs e)
{
  <SPAN class=cs-comment>//Check if this key event is being passed to</SPAN>
  <SPAN class=cs-comment>//other applications and disable TopMost in </SPAN>
  <SPAN class=cs-comment>//case they need to come to the front</SPAN>
  if (e.PassThrough)
  {
    this.TopMost = false;
  }
  ds.Draw(e.KeyName);
}
</PRE>
            <P>The rest of this article explains how the low-level keyboard hook 
            is implemented in <CODE>KeyboardHook</CODE>.</P>
            <H2>Implementing a low-level Windows API keyboard hook</H2>
            <P>The Windows API contains three methods in <EM>user32.dll</EM> 
            that are useful for this purpose:</P>
            <UL>
              <LI><CODE>SetWindowsHookEx</CODE>, which sets up the keyboard hook 

              <LI><CODE>UnhookWindowsHookEx</CODE>, which removes the keyboard 
              hook 
              <LI><CODE>CallNextHookEx</CODE>, which passes the keystroke 
              information to the next application listening for keyboard events 
              </LI></UL>
            <P>The key to creating an application which can hijack the keyboard 
            is to implement the first two methods, and forgo the third. The 
            result is that any keys pressed go no further than the 
            application.</P>
            <P>In order to achieve this, the first step is to include the 
            <CODE>System.Runtime.InteropServices</CODE> namespace and import the 
            API methods, starting with <CODE>SetWindowsHookEx</CODE>:</P><PRE lang=cs>using System.Runtime.InteropServices
...
<SPAN class=cs-comment>//Inside class:</SPAN>

[DllImport(<SPAN class=cpp-string>"user32.dll"</SPAN>, CharSet = CharSet.Auto, SetLastError = true)]
private static extern IntPtr SetWindowsHookEx(int idHook,
  LowLevelKeyboardProc lpfn, IntPtr hMod, uint dwThreadId);

</PRE>
            <P>The code to import <CODE>UnhookWindowsHookEx</CODE> and 
            <CODE>CallNextHookEx</CODE> is listed in the sections concerning 
            those methods further in this article.</P>
            <P>The next step is to call <CODE>SetWindowsHookEx</CODE> to set up 
            the hook, passing the following four parameters:</P>
            <UL>
              <LI><STRONG>idHook</STRONG>: This number determines the type of 
              hook to be set up. For example, <CODE>SetWindowsHookEx</CODE> can 
              also be used to hook into mouse events; <A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/setwindowshookex.asp">a 
              complete list can be found on MSDN</A><A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/setwindowshookex.asp">[^]</A>. 
              In this case, we're only interested in number 13, which is the 
              keyboard hook's id. To make the code more legible, this has been 
              assigned to the constant <CODE>WH_KEYBOARD_LL</CODE>. 
              <LI><STRONG>lpfn</STRONG>: A long pointer to the function that 
              will handle the keyboard events. In C#, the "pointer" is achieved 
              by passing an instance of a delegate type, referring to the 
              appropriate method. This is the method that will be called every 
              time the hook is used.<BR>An important point to note here is that 
              the delegate instance needs to be stored in a member variable in 
              the class. This is to prevent it being garbage collected as soon 
              as the first method call ends. 
              <LI><STRONG>hMod</STRONG>: An instance handle for the application 
              which is setting up the hook. Most of the samples I found simply 
              set this to <CODE>IntPtr.Zero</CODE>, on the grounds that it is 
              unlikely that there will be more than one instance of the 
              application. However, this code uses <CODE>GetModuleHandle</CODE> 
              from <EM>kernel32.dll</EM> to identify the exact instance to make 
              the class potentially more flexible. 
              <LI><STRONG>dwThreadId</STRONG>: The ID of the current thread. 
              Setting this to 0 makes the hook global, which is the appropriate 
              setting for a low-level keyboard hook. </LI></UL>
            <P><CODE>SetWindowsHookEx</CODE> returns a hook ID which will be 
            used to unhook the application when it shuts down, so this needs to 
            be stored in a member variable for future use. The relevant code 
            from the <CODE>KeyboardHook</CODE> class is as follows:</P><PRE lang=cs>private HookHandlerDelegate proc;
private IntPtr hookID = IntPtr.Zero;
private const int WH_KEYBOARD_LL = 13;


public KeyboardHook()
{
  proc = new HookHandlerDelegate(HookCallback);
  using (Process curProcess = Process.GetCurrentProcess())
  using (ProcessModule curModule = curProcess.MainModule)
  {
     hookID = SetWindowsHookEx(WH_KEYBOARD_LL, proc,
                    GetModuleHandle(curModule.ModuleName), 0);
  }
}
</PRE>
            <H3>Processing keyboard events</H3>
            <P>As mentioned above, <CODE>SetWindowsHookEx</CODE> requires a 
            pointer to the callback function that will be used to process the 
            keyboard events. It expects a function with the following 
            signature:</P><PRE lang=cs>LRESULT CALLBACK LowLevelKeyboardProc
(   int nCode,
    WPARAM wParam,
    LPARAM lParam
);
</PRE>
            <P>The C# method for setting up a "pointer to a function" is to use 
            a delegate, so the first step in giving 
            <CODE>SetWindowsHookEx</CODE> what it needs is to declare a delegate 
            with the right signature:</P><PRE lang=cs>    private delegate IntPtr HookHandlerDelegate(
        int nCode, IntPtr wParam, ref KBDLLHOOKSTRUCT lParam);
</PRE>
            <P>And then write a callback method with the same signature; this 
            method will contain all the code that actually processes the 
            keyboard event. In the case of <CODE>KeyboardHook</CODE>, it checks 
            whether the keystroke should be passed to other applications and 
            then raises the <CODE>KeyIntercepted</CODE> event. Here is a 
            simplified version without the keystroke handling code:</P><PRE lang=cs>private const int WM_KEYUP = 0x0101;
private const int WM_SYSKEYUP = 0x0105;

private IntPtr HookCallback(int nCode, IntPtr wParam, ref KBDLLHOOKSTRUCT lParam)
{
  <SPAN class=cs-comment>//Filter wParam for KeyUp events only - otherwise this code</SPAN>
  <SPAN class=cs-comment>//will execute twice for each keystroke (ie: on KeyDown and KeyUp)</SPAN>
  <SPAN class=cs-comment>//WM_SYSKEYUP is necessary to trap Alt-key combinations</SPAN>
  if (nCode &gt;= 0)
  { 
      if (wParam == (IntPtr)WM_KEYUP || wParam == (IntPtr)WM_SYSKEYUP)
      {
        <SPAN class=cs-comment>//Raise the event</SPAN>
        OnKeyIntercepted(new KeyboardHookEventArgs(lParam.vkCode, AllowKey));
      }
      <SPAN class=cs-comment>//Return a dummy value to trap the keystroke</SPAN>
      return (System.IntPtr)1;
  }
  <SPAN class=cs-comment>//The event wasn't handled, pass it to next application</SPAN>
  return CallNextHookEx(hookID, nCode, wParam, ref lParam);
}
</PRE>
            <P>A reference to <CODE>HookCallback</CODE> is then assigned to an 
            instance of <CODE>HookHandlerDelegate</CODE> and passed in the call 
            to <CODE>SetWindowsHookEx</CODE>, as illustrated in the previous 
            section.</P>
            <P>Whenever a keyboard event occurs, the following parameters will 
            be passed to <CODE>HookCallBack</CODE>:</P>
            <UL>
              <LI><STRONG>nCode</STRONG>: <A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/lowlevelkeyboardproc.asp">According 
              to the MSDN documentation</A><A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/lowlevelkeyboardproc.asp">[^]</A>, 
              the callback function should return the result of 
              <CODE>CallNextHookEx</CODE> if this value is less than zero. 
              Normal keyboard events will return an <CODE>nCode</CODE> of 0 or 
              more. </LI></UL>
            <UL>
              <LI><STRONG>wParam</STRONG>: This value indicates what type of 
              event occurred: key up or key down, and whether the key pressed 
              was a system key (left or right-hand Alt keys). </LI></UL>
            <UL>
              <LI><STRONG>lParam</STRONG>: A structure to store precise 
              information on the keystroke, such as the code of the key which 
              was pressed. The structure declared in <CODE>KeyboardHook</CODE> 
              is as follows: </LI></UL><PRE lang=cs>private struct KBDLLHOOKSTRUCT
{ 
  public int vkCode;
  int scanCode;
  public int flags;
  int time;
  int dwExtraInfo;
}
</PRE>
            <P>The two public parameters are the only ones used by the callback 
            method in<CODE> KeyboardHook</CODE>. <CODE>vkCoke</CODE> returns the 
            virtual key code, which can be cast to 
            <CODE>System.Windows.Forms.Keys</CODE> to obtain the key's name, 
            while <CODE>flags</CODE> indicates if this is an extended key (the 
            Windows Start key, for instance) or if the Alt key was pressed at 
            the same time. The complete code for the <CODE>HookCallback</CODE> 
            method illustrates which <CODE>flags</CODE> values to check for in 
            each case.</P>
            <P>If the information provided by <CODE>flags</CODE> and the other 
            components of the <CODE>KBDLLHOOKSTRUCT</CODE> are not needed, the 
            signature of the callback method and delegate can be changed as 
            follows:</P><PRE lang=cs>private delegate IntPtr HookHandlerDelegate(
        int nCode, IntPtr wParam, IntPtr lParam);</PRE>
            <P>In this case, <CODE>lParam</CODE> will return only the 
            <CODE>vkCode</CODE>.</P>
            <H3>Passing keystrokes to the next application</H3>
            <P>A well-behaved keyboard hook callback method should end by 
            calling the <CODE>CallNextHookEx</CODE> function and returning its 
            result. This ensures that other applications get a chance to handle 
            the keystrokes destined for them.</P>
            <P>However, the key functionality of the <CODE>KeyboardHook</CODE> 
            class is preventing keystrokes from being propagated to any further 
            applications. So whenever it processes a keystroke, 
            <CODE>HookCallback</CODE> returns a dummy value instead:</P><PRE lang=cs>return (System.IntPtr)1;</PRE>
            <P>On the other hand, it does call <CODE>CallNextHookEx</CODE> if it 
            didn't handle the event, or if the parameter passed with 
            <CODE>KeyboardHook</CODE>'s overloaded constructor allows certain 
            key combinations through.</P>
            <P><CODE>CallNextHookEx</CODE> is enabled by importing the function 
            from <EM>user32.dll</EM> as shown in the following code:</P><PRE lang=cs>[DllImport(<SPAN class=cpp-string>"user32.dll"</SPAN>, CharSet = CharSet.Auto, SetLastError = true)]
private static extern IntPtr CallNextHookEx(IntPtr hhk, int nCode,
  IntPtr wParam, ref KeyInfoStruct lParam);</PRE>
            <P>The imported method is then called by this line in the 
            <CODE>HookCallback</CODE> method, which ensures that all the 
            parameters received through the hook are passed on to the next 
            application:</P><PRE>CallNextHookEx(hookID, nCode, wParam, ref lParam);
</PRE>
            <P>As mentioned before, if the flags in <CODE>lParam</CODE> are not 
            relevant, the signature for the imported <CODE>CallNextHookEx</CODE> 
            can be changed to define <CODE>lParam</CODE> as 
            <CODE>System.IntPtr</CODE>.</P>
            <H3>Removing the hook</H3>
            <P>The last step in processing the hook is to remove it when the 
            instance of the <CODE>KeyboardHook</CODE> class is destroyed, using 
            the <CODE>UnhookWindowsHookEx</CODE> function imported from 
            <EM>user32.dll</EM> as follows. </P><PRE lang=cs>[DllImport(<SPAN class=cpp-string>"user32.dll"</SPAN>, CharSet = CharSet.Auto, SetLastError = true)]
[return: MarshalAs(UnmanagedType.Bool)]
private static extern bool UnhookWindowsHookEx(IntPtr hhk);
</PRE>
            <P>Since <CODE>KeyboardHook</CODE> implements 
            <CODE>IDisposable</CODE>, this can be done in the 
            <CODE>Dispose</CODE> method.</P><PRE lang=cs>public void Dispose()
{
  UnhookWindowsHookEx(hookID);
}</PRE>
            <P><CODE>hookID</CODE> is the id returned by the call to 
            <CODE>SetWindowsHookEx</CODE> in the constructor. This removes the 
            application from the hook chain.</P>
            <H2>Sources</H2>
            <P>Here are some good sources on Windows hooks in C# and in 
            general:</P>
            <UL>
              <LI>A good C# console application sample can be found in <A 
              href="http://blogs.msdn.com/toub/archive/2006/05/03/589423.aspx">Stephen 
              Toub's MSDN blog</A><A 
              href="http://blogs.msdn.com/toub/archive/2006/05/03/589423.aspx" 
              target=_blank>[^]</A> 
              <LI>For information on Windows API hooks in general, see <A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/setwindowshookex.asp">MSDN's 
              article on SetWindowsHookEx</A><A 
              href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/hooks/hookreference/hookfunctions/setwindowshookex.asp" 
              target=_blank>[^]</A> and its related links 
              <LI><A 
              href="http://www.codeproject.com/csharp/GlobalSystemHook.asp">A 
              Code Project article</A><A 
              href="http://www.codeproject.com/csharp/GlobalSystemHook.asp" 
              target=_blank>[^]</A> on a class for global hook in C#, which 
              illustrates how to set up the other available hooks, including for 
              mouse activity. </LI></UL>
            <P>It seems that articles in any language seem to attract at least 
            one response on the lines of "how do I do the same thing in (some 
            other language)?", so here are some samples I found:</P>
            <UL>
              <LI><A 
              href="http://www.codeguru.com/vb/gen/vb_system/keyboard/print.php/c4829/">A 
              keyboard hook sample in VB6</A><A 
              href="http://www.codeguru.com/vb/gen/vb_system/keyboard/print.php/c4829/" 
              target=_blank>[^]</A> 
              <LI><A 
              href="http://www.developer.com/net/vb/article.php/2193301">A 
              sample and article on the same thing in VB.NET</A><A 
              href="http://www.developer.com/net/vb/article.php/2193301" 
              target=_blank>[^]</A> 
              <LI><A 
              href="http://www.codeproject.com/samples/ForTheKids.asp">And again 
              in C++</A><A 
              href="http://www.codeproject.com/samples/ForTheKids.asp" 
              target=_blank>[^]</A> as part of a project with exactly the same 
              aim as this one! </LI></UL>
            <P>And nothing to do with Windows API hooks or C#, but I would like 
            to recommend Mike Ellison's excellent <A 
            href="http://www.codeproject.com/soap/WordCPArticleTemplate.asp">Word 
            2003 template</A> if you're ever planning to write an article for 
            Code Project!</P>
            <H2>History</H2>
            <UL>
              <LI><STRONG>1.4</STRONG> (23 Mar 07) - Fixed a bug which made Alt 
              key appear stuck when the program exited: 
              <UL>
                <LI>Changed <BR><CODE>if (nCode &gt;= 0 &amp;&amp; (wParam == 
                (IntPtr)WM_KEYUP || wParam == (IntPtr)WM_SYSKEYUP))</CODE><BR>to 
                <BR><CODE>if (nCode &gt;= 0)<BR>{<BR>if (wParam == 
                (IntPtr)WM_KEYUP || wParam == 
                (IntPtr)WM_SYSKEYUP)</CODE><BR>Many thanks to "Scottie Numbnuts" 
                for the solution. </LI></UL></LI></UL>
            <UL>
              <LI><STRONG>1.3</STRONG> (13 Feb 07) - Improved modifier key 
              support: 
              <UL>
                <LI>Added CheckModifiers() method 
                <LI>Deleted LoWord/HiWord methods as they weren't necessary 
                <LI>Implemented Barry Dorman's suggestion to AND GetKeyState 
                values with 0x8000 to get their result</LI></UL>
              <LI><STRONG>1.2</STRONG> (10 Jul 06) - Added support for modifier 
              keys: 
              <UL>
                <LI>Changed filter in HookCallback to WM_KEYUP instead of 
                WM_KEYDOWN 
                <LI>Imported GetKeyState from user32.dll 
                <LI>Moved native DLL imports to a separate internal class as 
                this is a Good Idea according to Microsoft's guidelines </LI></UL>
              <LI><STRONG>1.1</STRONG> (18 Jun 06) - Modified proc assignment in 
              constructor to make class backward compatible with 2003. 
              <LI><STRONG>1.0</STRONG> (17 Jun 06) - First version published on 
              Code Project. </LI></UL><!-- Article Ends --></DIV></SPAN>
            <SCRIPT 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>About Emma Burrows</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><IMG 
                  src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/{164BFCF5-0F2C-4B49-82B6-C6B877EAE057}.jpg"><BR></TD>
                <TD class=smallText>Emma's first steps in programming took 
                  place at primary school over twenty years ago, thanks to a 
                  TI-99/4A and the LOGO language. Following a Master's degree in 
                  English Studies (obtained, strangely enough, with a paper on 
                  the birth of the microcomputer), Emma started her career in 
                  IT. <BR><BR>Over the last ten years, she has worked as a 
                  localiser, technical writer, editor, web designer, systems 
                  administrator, team leader and support engineer for companies 
                  ranging from Microsoft to the more modest British software 
                  company Equisys. <BR><BR>Emma is currently expecting another 
                  baby after taking a break to have a first baby. Some day, 
                  perhaps when both babies have gone to university, she hopes to 
                  improve her C# and web development skills and, of course, 
                  write more articles for Code Project.
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=761050">here</A> 
                  to view Emma Burrows's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular System Programming articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/cs/system/wmi.asp">Windows 
                    Management Instrumentation (WMI) Implementation</A>
                    <DIV class=smallText>Implementing Windows Management 
                    Instrumentation (WMI) in your application.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/system/floppystepper.asp">Controlling 
                    Floppy Drive Stepper Motor via Parallel Port</A>
                    <DIV class=smallText>Controlling a floppy drive stepper 
                    motor using computer's parallel port</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/system/wmiproviderguide.asp">A 
                    simple guide to WMI providers</A>
                    <DIV class=smallText>How to write WMI providers in C#</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/system/everythingInAD.asp">Howto: 
                    (Almost) Everything In Active Directory via C#</A>
                    <DIV class=smallText>A collection of the most common Active 
                    Directory Tasks in C#</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2257&cb=8092737\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</SCRIPT>
                </TD></TR></TBODY></TABLE>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden value=CSLLKeyboard/csharp6/17/2006 
            name=vote_name> <INPUT type=hidden value=/cs/system/CSLLKeyboard.asp 
            name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD 
                style="PADDING-RIGHT: 2px; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; BACKGROUND-COLOR: #eee" 
                width=120 height=60>
                  <DIV align=center>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3486&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Fcp%5Fdaily%5F120x60%2Egif&C=False&id=3486&cb=8092740\" alt=\"\" border=0 width=120 height=60></a>");</SCRIPT>
                  </DIV></TD>
                <TD width=100>&nbsp;</TD>
                <TD width=468 height=60><SPAN id=AdBanner5>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3485&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Fcp%5Fdaily%5F468x60%2Egif&C=False&id=3485&cb=8092726\" alt=\"\" border=0 width=468 height=60></a>");</SCRIPT>
                  </SPAN></TD></TR></TBODY></TABLE></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=317058"><IMG 
                              height=15 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION 
                              value=3>Expanded</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 25 of 73 (Total: 
                              73) (<A 
                              href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <A class=HoverLink 
                              href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;fr=26" 
                              name=HoverNL>Next</A> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2059933_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2059933xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=2059933#xx2059933xx" 
                                name=2059933><B>Problems when hooking to the Esc 
                                key</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=340340"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Zoltan 
                                Balazs</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>11:17 30 
                                May 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2059933_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I 
                                played around with the solution attached to the 
                                article and noticed the following:<BR>if I try 
                                to display a window of any kind to the user as a 
                                response to the Esc key<BR>the application 
                                becomes iresponsive. It just locks for a few 
                                seconds. Have you got any ideas <BR>what's going 
                                on?<BR><BR>I replaced the kh_KeyIntercepted 
                                method as follows:<BR><CODE><PRE><BR>void kh_KeyIntercepted(KeyboardHook.KeyboardHookEventArgs e)<BR>{<BR>   switch (e.KeyCode)<BR>   {<BR>      case (int)Keys.Escape:<BR>          MessageBox.Show("test"); <BR>          break;<BR>   }<BR>}<BR></CODE></PRE><BR><BR>
                                <DIV class=ForumSig><SMALL><A 
                                href="http://www.netis.ro/" 
                                target=_blank>Network integrated 
                                solutions</A><BR><A 
                                href="http://www.codeproject.com/useritems/PraticalMvc.asp" 
                                target=_blank>A practical use of the MVC 
                                pattern</A></SMALL></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2059933">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2059933">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=2059933&amp;forumid=317058&amp;select=2059933#xx2059933xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=2059933#xx2059933xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=2059933#xx2059933xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(340340,2059933);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=2052331_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2052331xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=2052331#xx2052331xx" 
                                name=2052331><B>Normally using the keystrokes in 
                                my app</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3726450"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>JohannesAckermann</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>10:58 24 
                                May 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2052331_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Great 
                                article! One problem, and I'm sure I'm just 
                                being a total moron:<BR>The class you supplied 
                                block all the keystrokes wonderfully... so 
                                wonderfully in fact that even my own app doesn't 
                                see them! My question is this: without having to 
                                resort to SenKeys or something like that in the 
                                KeyHook event handler, how can I make my app 
                                accept keys as per usual but simply block any 
                                other apps from receiving them?<BR>I'm basically 
                                writing a standard app that must be the ONLY app 
                                accessable by the user of the PC. There is a 
                                close button which only closes the app if a 
                                correct password is entered. That's beside the 
                                point... the problem is that my app is just 
                                standard WindowsForms with textboxes etc. 
                                Implementing this class as is and doing nothing 
                                with the hooked keys results in my own app not 
                                getting the keystrokes... i.e. typing in a 
                                textbox does nothing. Now, can I somehow just 
                                let my app handle its own input, but block the 
                                rest (alt-tab,windowskey, etc)?<BR><BR>thanks in 
                                advance! 
                                <BR><BR>Johannes<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2052331">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2052331">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=2052331&amp;forumid=317058&amp;select=2052331#xx2052331xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=2052331#xx2052331xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=2052331#xx2052331xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3726450,2052331);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2052522_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2052522xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=2052522#xx2052522xx" 
                                name=2052522>Re: Normally using the keystrokes 
                                in my app</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>13:27 24 May 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2052522_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Have a 
                                look at form1.cs in the VS 2003 or 2005 sample 
                                projects to see how my sample application 
                                handles the keystrokes before they are blocked. 
                                Basically, you attach a handler to the keyboard 
                                class's KeyIntercepted event, and then you do 
                                whatever you want to do with the intercepted key 
                                strokes in the handler. In my case, I pass the 
                                info to another class to display coloured text 
                                or shapes.<BR><BR>HTH 
<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2052522">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2052522">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=2052331&amp;forumid=317058&amp;select=2052522#xx2052522xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=2052522#xx2052522xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=2052331#xx2052331xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(761050,2052522);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2052655_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2052655xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=2052655#xx2052655xx" 
                                name=2052655>Re: Normally using the keystrokes 
                                in my app</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3726450"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>JohannesAckermann&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>15:35 24 May 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2052655_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>Thanks for the 
                                reply.<BR><BR>I get exactly what you do in the 
                                sample, but it still doesn't solve my 
                                problem:<BR>Let's say I've got a standard 
                                textbox. The user clicks inside the textbox and 
                                start typing. Now the keyboard hook catches each 
                                key press, so the textbox doesn't get the 
                                keypress. The only way I managed to get the key 
                                passed on to the textbox as per usual is by 
                                calling SendKey, but this is not really a 
                                solution. Firstly it seems to be extremely slow, 
                                and secondly I have to write a uge switch 
                                statment to see if the key was a special key, 
                                because SendKey.Send wants special keys in curly 
                                braces, and characters as standard. I can't just 
                                pass everything in curly braces, because then 
                                all letter appear as capitals... which is the 
                                key, not the character. Also checking for Shift 
                                etc... it all becomes extremely complicated. 
                                Holding a key down also causes problem, like 
                                holding down Backspace made the app 
                                crash.<BR><BR>I basically just want my app to 
                                accept keypresses as per usual... e.g. when 
                                typing text into a text box I don't want to have 
                                to manually interperet what is being typed. All 
                                I actually want is to trap and discard 
                                System-wide key presses like Alt-Tab, the 
                                Windows Key etc.<BR><BR>Maybe I'm missing 
                                something simple in your documentation, and it 
                                is highly likely that I'm just being stupid, but 
                                I can't figure it out. Sorry!<BR><BR>Any advice 
                                would be greatly appreciated! 
                                <BR><BR>Johannes<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2052655">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2052655">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=2052331&amp;forumid=317058&amp;select=2052655#xx2052655xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=2052655#xx2052655xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=2052331#xx2052331xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3726450,2052655);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=2014002_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2014002xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=2014002#xx2014002xx" 
                                name=2014002><B>CheckModifiers() incorrect on 
                                Vista</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2843670"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>DarkInGray</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>23:55 30 
                                Apr 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2014002_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Emma, nice work, deeply appreciated.<IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_redface.gif" 
                                align=absMiddle><BR>Ever tested on Windows 
                                Vista?<BR>I ran demo code on two Vista machines 
                                and found "AllowAltTabAndWindows" mechanism does 
                                not work.<BR>I traced into the CheckModifiers() 
                                method, it seems that GetKeyState result bit 
                                test are not reflecting the actual key-up 
                                states.<BR>I'm not good enough at DLLImport 
                                interOps, so why those modifier bits incorrect 
                                are still mysterious to me.<BR>I'm using VS2005 
                                SP1 + KS2005_SP1_Vista_20070306 
                                <BR><BR>Thanks,<BR>DarkInGray<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2014002">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2014002">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=2014002&amp;forumid=317058&amp;select=2014002#xx2014002xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=2014002#xx2014002xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=2014002#xx2014002xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2843670,2014002);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1984764_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1984764xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1984764#xx1984764xx" 
                                name=1984764><B>Handling % 
character</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1269507"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>gkowaljow</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>16:05 11 
                                Apr 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1984764_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hello, 
                                I'm trying to use this class with a magnetic 
                                card reader.<BR>All the cards begin with a % 
                                simbol, the idea is to handle the keys pressed 
                                between the % and return (13). I´ve made some 
                                modifications to the code myself but I can´t 
                                solve the next problem.<BR><BR>% is made by 2 
                                keys 160 (LeftShift) y 53 (5), so, I have to 
                                handle the keyup only when the previous key was 
                                160 and the current key is 53, I thought that if 
                                I only handle the 53, it won't be a problem to 
                                let pass the Shift, but I can´t make the % 
                                handle, all the rest of the code untill the 
                                return works fine, but the % allways is 
                                displayed on screen.<BR><BR>Anybody knows some 
                                algorithm to make this work?<BR>Thanks a millon 
                                in advance.<BR>GK <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1984764">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1984764">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1984764&amp;forumid=317058&amp;select=1984764#xx1984764xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1984764#xx1984764xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1984764#xx1984764xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1269507,1984764);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1962886_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1962886xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1962886#xx1962886xx" 
                                name=1962886><B>Windows Keyboard 
                                Lock</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=454488"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Muhammed 
                                Sahin</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>4:28 28 
                                Mar 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1962886_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>This realy good 
                                works. But i have a question. Why lock my 
                                keyboard use this class. I can't press any key 
                                in windows just mouse. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1962886">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1962886">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1962886&amp;forumid=317058&amp;select=1962886#xx1962886xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1962886#xx1962886xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1962886#xx1962886xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 1.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(454488,1962886);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2004408_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2004408xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=2004408#xx2004408xx" 
                                name=2004408>Re: Windows Keyboard Lock</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>10:57 24 Apr 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2004408_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Sorry 
                                for the late response - I only just saw your 
                                question. Unfortunately, I'm not quite sure what 
                                you're asking. The purpose of the code is to 
                                prevent the keyboard from having any effect. In 
                                other words, you press a key and nothing happens 
                                - if this is what you're getting, then that's 
                                the whole point of the code. It's what it's 
                                designed to do. But let me know if I've 
                                misunderstood your question. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2004408">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=2004408">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1962886&amp;forumid=317058&amp;select=2004408#xx2004408xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=2004408#xx2004408xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1962886#xx1962886xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 4.2 (2 
                                votes).
                                <SCRIPT language=Javascript>MsgVoteForm(761050,2004408);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1955373_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1955373xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1955373#xx1955373xx" 
                                name=1955373><B>Not Behaving</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2782940"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>scottie_numbnuts</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>1:00 23 
                                Mar 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1955373_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I've 
                                been having problems with this code not behaving 
                                when the application exits. I've worked out what 
                                was causing my problems. The example seems to 
                                only check for keyup events. This means that all 
                                the keydown events are still being passed to the 
                                processes further down the hook chain. Thus 
                                simulating a stuck key to the operating 
                                system.<BR><BR>If you want to stop the 
                                keystrokes you need to stop all the events from 
                                being passed through. Simply change the If 
                                statement in the HookCallBack method 
                                <BR><BR><B>From:</B><BR><BR>if (nCode &gt;= 0 
                                &amp;&amp; (wParam == (IntPtr)WM_KEYUP || wParam 
                                == 
                                (IntPtr)WM_SYSKEYUP))<BR><BR><B>To:</B><BR><BR>if 
                                (nCode &gt;= 
                                0)<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1955373">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1955373">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1955373&amp;forumid=317058&amp;select=1955373#xx1955373xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1955373#xx1955373xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1955373#xx1955373xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2782940,1955373);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1956671_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1956671xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1956671#xx1956671xx" 
                                name=1956671>Re: Not Behaving</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>13:14 23 Mar 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1956671_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Good 
                                piece of troubleshooting! This sounds like it 
                                could be the solution to the problems some 
                                people have reported concerning the Alt key in 
                                particular. Because that seemed to be the only 
                                key affected, it didn't occur to me that all the 
                                WM_KEYDOWN messages were still getting through! 
                                <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_redface.gif" 
                                align=absMiddle><BR><BR>I'll have a play with it 
                                and see about making a version 1.4. Thanks again 
                                for the info! <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1956671">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1956671">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1955373&amp;forumid=317058&amp;select=1956671#xx1956671xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1956671#xx1956671xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1955373#xx1955373xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1956671);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1958709_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1958709xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1958709#xx1958709xx" 
                                name=1958709>Re: Not Behaving</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2782940"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>scottie_numbnuts&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>0:57 26 Mar 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1958709_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Glad I 
                                could be of help.<IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle><BR><BR>I wasn't 100% sure how 
                                to use your modifiers method so I made my own 
                                with an array list. If you're interested I'll 
                                send it to you.<BR><BR>Scott. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1958709">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1958709">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1955373&amp;forumid=317058&amp;select=1958709#xx1958709xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1958709#xx1958709xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1955373#xx1955373xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2782940,1958709);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1927366_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1927366xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1927366#xx1927366xx" 
                                name=1927366><B>Alt-Tab causes 
                                trouble</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=479711"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>kfawell</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>3:13 7 Mar 
                                '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1927366_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hello,<BR><BR>When I run 
                                the program and type the combo of Alt-Tab, the 
                                pop-up showing the processes actually gets 
                                shown. However, the process chosen is ignored. 
                                In other words, it seems that all keys 
                                combinations are ignored except Alt-Tab. And 
                                Alt-Tab does not work quite right even though it 
                                does "get through". Finally, after using Alt-Tab 
                                and exiting the program by clicking the 
                                close-box in the upper-right corner, some keys 
                                are temporarily suppressed for a short time, 
                                like 10 or 15 seconds. For example, pressing the 
                                Windows key does open the Start menu.<BR><BR>In 
                                short, Alt-Tab does not get "fully" 
                                suppressed.<BR><BR>Does this happen to you? Any 
                                ideas why it is happening on my 
                                machine?<BR><BR>Thank you. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1927366">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1927366">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1927366&amp;forumid=317058&amp;select=1927366#xx1927366xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1927366#xx1927366xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1927366#xx1927366xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(479711,1927366);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1929068_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1929068xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1929068#xx1929068xx" 
                                name=1929068>Re: Alt-Tab causes trouble</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2782940"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>scottie_numbnuts&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>22:15 7 Mar 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1929068_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I'm 
                                having a very similar problem, except instead of 
                                supressing keys it seems to be locking random 
                                modifier keys on. If I press 'l' key after 
                                exiting the program it locks the computer, 
                                implying that Windows believes I'm holding down 
                                the Start(Windows) key. It doesn't last just a 
                                few seconds, it stays that way for about 3 or 4 
                                minutes.<BR><BR>I haven't implemented it quite 
                                the way Emma shows. I declare KeyboardHook as a 
                                global in a form and then initialize it in the 
                                Form_Load method.<BR><BR>I've tried calling 
                                KeyboardHook.Dispose as the form is closing and 
                                also assigning null to variable, none of which 
                                has made any difference.<BR><BR>I'm using 
                                VS2005.<BR><BR>Thanks<IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle> <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1929068">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1929068">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1927366&amp;forumid=317058&amp;select=1929068#xx1929068xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1929068#xx1929068xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1927366#xx1927366xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2782940,1929068);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1921945_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1921945xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1921945#xx1921945xx" 
                                name=1921945><B>Question, about 
                                DirectX</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1674157"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>gehannan 
                                archmage</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>14:22 3 
                                Mar 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1921945_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I am 
                                new to C# and looking to make an application and 
                                have found your article that is close to want I 
                                need, I think? I am looking to artifically 
                                create a keypress and have been attempting to 
                                figure out your code. This is way above me 
                                currently and was hoping that you could tell me 
                                if an artifical keypress is possible? I am 
                                looking to have some event happen and then have 
                                the Enter key pressed or the Space key pressed. 
                                I also would like this to be able to go to 
                                another application. I have been trying the 
                                below code out below but does not seem to work 
                                and do not know enough about it to understand 
                                why it is failing.<BR><BR>So when I need an 
                                'Enter' 
                                pressed.<BR><BR>Program.kh.OnKeyIntercepted((new 
                                BattleClient.KeyboardHook.KeyboardHookEventArgs(asciiValue, 
                                true)));<BR><BR>Am I completely in the wrong 
                                ball field here?<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1921945">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1921945">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1921945&amp;forumid=317058&amp;select=1921945#xx1921945xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1921945#xx1921945xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1921945#xx1921945xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1674157,1921945);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1924384_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1924384xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1924384#xx1924384xx" 
                                name=1924384>Re: Question, about 
DirectX</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1674157"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>gehannan 
                                archmage&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>15:51 5 Mar 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1924384_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I 
                                messed with this most of Sunday and was unable 
                                to figure out a way to capture the keypress and 
                                then re-direct, that press as something else. 
                                So, a real 'a' pressed is re-directed into a 
                                fake but real 'b' press. Has anyone been able to 
                                do this with DirectX? 
<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1924384">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1924384">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1921945&amp;forumid=317058&amp;select=1924384#xx1924384xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1924384#xx1924384xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1921945#xx1921945xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1674157,1924384);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1925814_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1925814xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1925814#xx1925814xx" 
                                name=1925814>Re: Question, about 
DirectX</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>8:33 6 Mar 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1925814_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Sorry 
                                for the late response - I've been busy with 
                                other things. You're not the first person who 
                                has asked me how to convert keystrokes like 
                                this. Unfortunately, my code doesn't do it - it 
                                either passes the original keystroke or nothing 
                                at all. You can use SendKeys to add keystrokes 
                                but the original ones still go through as well. 
                                I've done no work with DirectX, so I don't know 
                                if that would help or not. <BR><BR>However, <A 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?select=1870998&amp;df=100&amp;tid=1870998&amp;forumid=317058&amp;exp=1&amp;mpp=50#xx1870998xx">in 
                                response to someone else's question below</A>[<A 
                                title="New Window" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?select=1870998&amp;df=100&amp;tid=1870998&amp;forumid=317058&amp;exp=1&amp;mpp=50#xx1870998xx" 
                                target=_blank>^</A>], Daniel Pistelli suggested 
                                a method which involved using my code to trap 
                                the keystroke, and then sending a message to 
                                another process which actually generates the 
                                replacement key. It's not beginner material, 
                                though, and I haven't tested it myself so I 
                                don't know how easy it would be to 
                                implement.<BR><BR>Converting keystrokes is such 
                                a popular request that I'm surprised no one has 
                                written an article about it. <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle> <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1925814">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1925814">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1921945&amp;forumid=317058&amp;select=1925814#xx1925814xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1925814#xx1925814xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1921945#xx1921945xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1925814);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1895488_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1895488xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1895488#xx1895488xx" 
                                name=1895488><B>"Repair" stuck key?</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3473767"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Raymond 
                                Verbruggen</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>4:57 15 
                                Feb 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1895488_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hello,<BR><BR>I have an old 
                                notebook which has the F12 key stuck.<BR>Could I 
                                use this demo program to run in background to 
                                filter away all F12 key actions, and still use 
                                all of my applications?<BR><BR>Kindest 
                                regards<BR>Raymond Verbruggen<BR>Netherlands 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1895488">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1895488">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1895488&amp;forumid=317058&amp;select=1895488#xx1895488xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1895488#xx1895488xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1895488#xx1895488xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3473767,1895488);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1901952_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1901952xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1901952#xx1901952xx" 
                                name=1901952>Re: "Repair" stuck key?</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2097"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Jamie 
                                Nordmeyer&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>16:27 19 Feb 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1901952_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>System 
                                level hooks like this one are very low level, 
                                and while useful, can chew up your CPU cycles if 
                                they're constantly processing. You can try it 
                                and see how well it works in your situation, but 
                                I'd think that a constantly striking key would 
                                bring your system to a halt. Again, try it and 
                                see. You never know. <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle> <BR><BR>
                                <DIV class=ForumSig><FONT 
                                style="FONT-WEIGHT: bold; COLOR: darkorange">Kyosa 
                                Jamie Nordmeyer - Taekwondo Yi (2nd) 
                                Dan<BR>Portland, Oregon, USA<BR><A 
                                href="http://www.defaultn.com/">http://www.defaultn.com/</A></FONT></DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1901952">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1901952">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1895488&amp;forumid=317058&amp;select=1901952#xx1901952xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1901952#xx1901952xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1895488#xx1895488xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 3.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(2097,1901952);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1910705_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1910705xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1910705#xx1910705xx" 
                                name=1910705>Re: "Repair" stuck key?</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3473767"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Raymond 
                                Verbruggen&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>16:30 24 Feb 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1910705_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=36><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hey 
                                everybody,<BR><BR>I'm glad to mention; it works 
                                fine!<BR><BR>I've captured the F12 keycode 
                                (which was the stucked key) and sent everything 
                                else to the next application.<BR>Also I have 
                                minimized the key repetition delay time and key 
                                repetition speed.<BR><BR>CPU load absolute 
                                minimum.<BR><BR>Thanks a lot for the 
                                code!<BR><BR>Raymond<BR>Netherlands 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1910705">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1910705">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1895488&amp;forumid=317058&amp;select=1910705#xx1910705xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1910705#xx1910705xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1895488#xx1895488xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3473767,1910705);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1893840_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1893840xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1893840#xx1893840xx" 
                                name=1893840><B>Great</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3178245"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Navneet 
                                Hegde</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>7:49 14 
                                Feb 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1893840_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Emma 
                                its great to get such a wonderful code , it 
                                refreshed my <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_redface.gif" 
                                align=absMiddle>brain<IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/rose.gif" 
                                align=absMiddle> <BR><BR>
                                <DIV class=ForumSig>Develop2Program &amp; 
                                Program2Develop</DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1893840">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1893840">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1893840&amp;forumid=317058&amp;select=1893840#xx1893840xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1893840#xx1893840xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1893840#xx1893840xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3178245,1893840);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1894108_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1894108xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1894108#xx1894108xx" 
                                name=1894108>Re: Great</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>9:56 14 Feb 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1894108_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thanks, 
                                I'm glad you liked it. There's an updated 
                                version coming out soon, as well! 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1894108">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1894108">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1893840&amp;forumid=317058&amp;select=1894108#xx1894108xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1894108#xx1894108xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1893840#xx1893840xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1894108);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1892015_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1892015xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1892015#xx1892015xx" 
                                name=1892015><B>Capturing more than one key at 
                                once?</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1839795"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Metallic-Red</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>8:29 13 
                                Feb 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1892015_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I've 
                                implemented this code in my application and am 
                                trying to create a key combination of Ctrl + Alt 
                                + L that will lock the program I am designing, 
                                though trying code such as the following doesn't 
                                seem to work, though of course single key 
                                captures 
                                work.<BR><BR>Program.m_keyboardHook.KeyIntercepted 
                                += new 
                                KeyboardHook.KeyboardHookEventHandler(m_keyboardHook_KeyIntercepted);<BR><BR>private 
                                static void 
                                m_keyboardHook_KeyIntercepted(KeyboardHook.KeyboardHookEventArgs 
                                e)<BR>{<BR>if (e.KeyName == 
                                Keys.Control.ToString() &amp;&amp; 
                                Keys.Alt.ToString() &amp;&amp; e.KeyName == 
                                Keys.L.ToString())<BR>{<BR>// TODO: Lock the 
                                form<BR>// TODO: Temporary 
                                messagebox<BR>MessageBox.Show("Works!");<BR>} 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1892015">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1892015">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1892015&amp;forumid=317058&amp;select=1892015#xx1892015xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1892015#xx1892015xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1892015#xx1892015xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1839795,1892015);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1892195_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1892195xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1892195#xx1892195xx" 
                                name=1892195>Re: Capturing more than one key at 
                                once?</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>10:11 13 Feb 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1892195_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>That 
                                particular code sample won't work, because 
                                KeyIntercepted will be raised once for each key 
                                as you let go of it... so e.KeyName will only 
                                ever have one value at a time (Keys.Control OR 
                                Keys.Alt etc) - not all three at once, which is 
                                what you're checking for.<BR><BR>However, I did 
                                a little test, and it looks as if putting the 
                                following code in the same place should solve 
                                your problem:<BR><BR><PRE>if (e.KeyName == "L")<BR>{<BR>  Keys test = Control.ModifierKeys;<BR>  if (test.ToString().Contains("Alt") &amp;&amp; <BR>            test.ToString().Contains("Control"))<BR>  {<BR>    MessageBox.Show("Ctrl+Alt+L is pressed");<BR>  }<BR>}</PRE>It 
                                works on my machine, anyway (that famous 
                                developer cry <IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/smiley_smile.gif" 
                                align=absMiddle> ). <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1892195">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1892195">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1892015&amp;forumid=317058&amp;select=1892195#xx1892195xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1892195#xx1892195xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1892015#xx1892015xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1892195);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1874143_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1874143xx></A><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1874143#xx1874143xx" 
                                name=1874143><B>Help Me Please?</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3723277"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Esonix</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>5:41 2 Feb 
                                '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1874143_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi<BR>I'm new in System 
                                programming.i've to implement a stand alone 
                                application<BR>using C# which will activate 
                                keyboard hooking on specifice process not on all 
                                processes running into the os.Actually hooking 
                                will be enabled or disabled through button.say i 
                                want to activat hooking on top most window.so 
                                when i press the button keyboard hooking will 
                                enabled on the process.other processes will be 
                                as simple as before.And when i disabled hooking 
                                using button then sysem default will be applied 
                                to the process.<BR>Is there anyone who can help 
                                me to solve the problem?Any idea i hope it will 
                                be very helpful to me. <BR><BR>
                                <DIV class=ForumSig>Md. Mostafijur 
                                Rahman</DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1874143">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1874143">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1874143&amp;forumid=317058&amp;select=1874143#xx1874143xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1874143#xx1874143xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1874143#xx1874143xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3723277,1874143);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1874313_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1874313xx></A><IMG 
                                height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;select=1874313#xx1874313xx" 
                                name=1874313>Re: Help Me Please?</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=761050"><IMG 
                                title="Click for User Profile" height=15 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Emma 
Burrows&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>7:26 2 Feb 
                                '07&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1874313_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/ind.gif" 
                                width=18><IMG 
                                src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>The 
                                WH_KEYBOARD_LL hook that my article illustrates 
                                is a global hook, but there is also a 
                                WH_KEYBOARD hook which is thread-specific. You 
                                then use a KeyboardHookProc instead of 
                                LowLevelKeyboardHookProc (MSDN will tell you 
                                more). I believe this should allow you to 
                                monitor keystrokes in another window, but I 
                                haven't tested it myself.<BR><BR>Aside from 
                                that, a search on keyloggers in Google might 
                                return some good starting points. Good luck with 
                                the research! <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1874313">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/system/CSLLKeyboard.asp&amp;df=100&amp;forumid=317058&amp;select=1874313">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;tid=1874143&amp;forumid=317058&amp;select=1874313#xx1874313xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1874313#xx1874313xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?msg=1874143#xx1874143xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(761050,1874313);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/t.gif" 
                              width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=#fbedbb>
                      <TD>
                        <TABLE cellPadding=2 width="100%">
                          <TBODY>
                          <TR>
                            <TD class=messagetitle>Last Visit: 21:03 Tuesday 
                              31st July, 2007</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <A class=HoverLink 
                              href="http://www.codeproject.com/cs/system/CSLLKeyboard.asp?df=100&amp;forumid=317058&amp;fr=26" 
                              name=HoverNL>Next</A> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 26 Mar 2007 </TD>
                <TD class=SmallText align=right>Article content copyright Emma 
                  Burrows, 2006<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2007</A>. <BR>Web17 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <SCRIPT 
      src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/front.asp" 
      type=text/javascript></SCRIPT>
      <BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="Low-level Windows API hooks from C# to stop unwanted keystrokes - The Code Project - System Programming_files/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  
            <A href="http://www.aspalliance.com/">ASP Alliance</A>  <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
            href="http://www.developersdex.com/">Developersdex</A>  <A 
            href="http://www.devguru.com/">DevGuru</A>  <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A>  
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
