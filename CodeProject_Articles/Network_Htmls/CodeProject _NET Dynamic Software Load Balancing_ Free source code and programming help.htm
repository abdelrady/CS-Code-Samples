<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0053)http://www.codeproject.com/KB/mcpp/loadbalancing.aspx -->
<HTML><HEAD><TITLE>CodeProject: .NET Dynamic Software Load Balancing. Free source code and programming help</TITLE>
<SCRIPT language=javascript src=""></SCRIPT>

<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="A Draft Implementation of an Idea for .NET Dynamic Software Load Balancing; Author: Stoyan Damov; Section: C++ / CLI; Chapter: Languages" 
name=Description>
<META 
content="VC7, .NET 1.0, VS.NET2002, C++/CLI, Windows, MFC, Dev, Intermediate,C++ / CLI,Languages,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("www.codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/jxs.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/bookmark.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/rateitem.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function MarkAns(MemberID,MsgID,QID) {
 document.write(unescape("%3Cdiv class=\"CallOut\"%3E"));
 document.write("Was this a good answer to your question? ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+", "+MsgID.toString()+",6,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"correct\" border=\"0\" align=\"absmiddle\" /%3E Yes%3C/a%3E"));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+","+MsgID.toString()+",7,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"correct\" style=\"margin-left:10px\" border=\"0\" align=\"absmiddle\" /%3E No%3C/a%3E"));
 document.write(unescape("%3C/div%3E"));
}
function MsgVFrm(MemberID,MsgID,GB,gp,bp,mt){
 if(!GB)document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"5":"1")+unescape(",0);\"%3E"));
 if(GB) document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;"); else for(var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"vote this message a " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ",0)\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"1":"5")+unescape(",0);\"%3E"));
 if(GB)document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" border=\"0\" alt=\"vote 5\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;&nbsp; "); else document.write(unescape("%3Cbr /%3E")); document.writeln(unescape("[%3Ca href='#xx") + MsgID.toString() +"xx' title='Report as Abuse' onclick='return ReportMsg(" + MemberID.toString());
 document.writeln(", " + MsgID.toString() + unescape(",-2)'%3EReport Message%3C/a%3E]"));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?"))
  return RateMsg(userid, msgid, score, 0);
 else return false;
}
function RateMsg(memberid, msgid, score, questionId) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4){
   if (req.status == 200){
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match&&match[1])?match[1]:"An error occured" + unescape("%3C/b%3E");
   } else
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString()+"&qid="+questionId.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK 
href="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/ForumClassicIE6.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" type=image/ico rel="shortcut icon">
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            id=ctl00_Logo 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; WIDTH: 225px; HEIGHT: 90px; BORDER-RIGHT-WIDTH: 0px" 
            alt="The Code Project" 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/logo225x90.gif"></A></TD>
          <TD class=HeaderBanner align=right width="100%">
            <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d7107%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fReseller_728x90.gif%26C%3dFalse%26adid%3d7107%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22728%22%20height%3d%2290%22%3e%3c%2fa%3e"));</SCRIPT>
          </TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">5,386,863 
                  members and growing! (14,391 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">Abdelrady_FCIS</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx">My 
                  Settings</A> | <A id=ctl00_MemberMenu_MyCodeProject 
                  href="http://www.codeproject.com/script/Membership/MyCodeProject.aspx"><B>My 
                  CodeProject</B></A> | <A id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/fave.gif" 
                  width=16 align=absMiddle border=0> My Bookmarks</A> | <A 
                  id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2fmcpp%2floadbalancing.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD noWrap><A href="http://www.codeproject.com/">Home</A></TD>
                <TD>&nbsp; </TD>
                <TD style="FONT-WEIGHT: normal" noWrap align=right>Current 
                  Site:</TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/">C++ / .NET</A></TD>
                <TD noWrap><A href="http://java.codeproject.com/">Java</A></TD>
                <TD noWrap><A href="http://sql.codeproject.com/">SQL</A></TD>
                <TD noWrap><A href="http://lamp.codeproject.com/">Linux / 
                  Unix</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus>
                  <DIV id=MenuPos 
                  style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=380>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
                        Board</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A> 
            » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A> » <A 
            id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/mcpp/index.aspx?#C++ / CLI - General">General</A> 
            <SPAN class=ArticleIntermediate 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Intermediate</SPAN> <SPAN 
            id=ctl00_ArticleTopHeader_LicenceTerms></SPAN><BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>.NET Dynamic Software Load 
            Balancing</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=39071">Stoyan 
            Damov</A></B><BR><BR><SPAN class=ArticleTopDescr 
            id=ctl00_ArticleTopHeader_ArticleDescr>A Draft Implementation of an 
            Idea for .NET Dynamic Software Load Balancing</SPAN> </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>C++/CLI, VC7, C++, 
            Windows, .NET, .NET 1.0, MFC, VS.NET2002, Visual Studio, 
            Dev</SPAN><BR><BR><SPAN style="WIDTH: 14ex">Posted</SPAN>: <B>9 Dec 
            2002</B><BR><SPAN style="WIDTH: 14ex">Updated</SPAN>: <B>9 Dec 
            2002</B> <BR><SPAN style="WIDTH: 14ex">Views</SPAN>: 
            <B>233,423</B><BR><SPAN style="WIDTH: 14ex">Bookmarked</SPAN>: 
            <B>153 times</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar" 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px">
      <TABLE cellPadding=2>
        <TBODY>
        <TR vAlign=center>
          <TD><IMG height=10 alt=Comp 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/startrek.gif" 
            width=24></TD>
          <TD><A 
            href="http://www.codeproject.com/script/Awards/Competition.aspx?cid=274">Summer 
            Code Competition!</A></TD></TR>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/info_24.png" 
            width=24></TD>
          <TD><A 
            href="http://www.codeproject.com/script/Awards/Competition.aspx?cid=270">New 
            thawte <BR>Scavenger Hunt!</A></TD></TR>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/info_24.png" 
            width=24 align=middle></TD>
          <TD><A id=ctl00_Announcements_CompLink 
            href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
            Competition</A></TD></TR></TBODY></TABLE></DIV>
      <DIV class=FeatureBlockHeader style="MARGIN-TOP: 7px">Want a new 
Job?</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <UL class=InfoList>
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=39">ASP.NET 
        Developer</A> at Atalasoft in United States
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=153">Senior 
        Software Engineer - Server Solutions</A> at Vital Images in United 
States
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=112">Software 
        Engineer (C# Windows .NET)</A> at Memeo Inc. in United States
        <LI><A href="http://www.codeproject.com/script/Jobs/List.aspx">View 
        Latest Jobs...</A></LI></UL></DIV>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2 style="DISPLAY: none">
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MI id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3 style="DISPLAY: none">
      <DIV class=MI id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4 style="DISPLAY: none">
      <DIV class=MI id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5>
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MIS id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV>
      <DIV class=MI id=Section126><A 
      href="http://www.codeproject.com/KB/codegen/">Code 
      Generation</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter12');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=12">Third 
      Party Products</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter12 style="DISPLAY: none">
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section124><A 
      href="http://www.codeproject.com/KB/solution-center/">Solution 
      Center</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
Board</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/kb/Showcase/">Product Showcase</A></DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/WhitePapers">WhitePapers / 
      Webcasts</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/QuestSQL">Quest SQL Zone</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/Acresso">InstallShield 
      2009</A></DIV><BR>
      <DIV style="MARGIN-BOTTOM: 10px; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d5302%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fIBMdeveloperWorks_150x80.gif%26C%3dFalse%26adid%3d5302%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22150%22%20height%3d%2280%22%3e%3c%2fa%3e"));</SCRIPT>
      </DIV>
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6705%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fsnowbound_160x600.gif%26C%3dFalse%26adid%3d6705%22%20alt%3d%22RasterMaster%20for%20.NET%22%20border%3d%220%22%20width%3d%22160%22%20height%3d%22600%22%3e%3c%2fa%3e"));</SCRIPT>
    </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION> <OPTION value=s>Jobs</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top>
            <TABLE>
              <TBODY>
              <TR>
                <TD class="SmallText Bold"><IMG 
                  id=ctl00_ArticleAwards_AR_ctl01_AI 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/prize_winner.gif"></TD>
                <TD class="SmallText Bold" style="WHITE-SPACE: nowrap">Prize 
                  winner in Competition ".NET Nov 2002" 
            <I></I></TD></TR></TBODY></TABLE>
            <DIV class=SmallText><IMG style="VERTICAL-ALIGN: middle" height=16 
            alt=print 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/print.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
            href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?display=Print">Print</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Broken Article?" 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/report.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_BrokenLnk 
            href="http://www.codeproject.com/script/Articles/Report.aspx?aid=3338">Report 
            Article</A> &nbsp; <IMG style="VERTICAL-ALIGN: middle" alt=Watch 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/watchon.png"> 
            <A class="" id=bmw_3338,2 onclick="return watchMe(3338, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=3338&amp;obtid=2&amp;bma=AddWatch" 
            name=ajaxBookmarkWatchLink>Watch</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN><SPAN 
            id=ctl00_ArticleHeaderLinks_ArticleBmkWatch_Message></SPAN>&nbsp; 
            <IMG style="VERTICAL-ALIGN: middle" height=16 alt=Bookmark 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/link.png" 
            width=16> <A class="" id=bm_3338,2 
            onclick="return bookmarkMe(3338, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=3338&amp;obtid=2&amp;bma=AddBookmark" 
            name=ajaxBookmarkLink>Bookmark</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN><SPAN 
            id=ctl00_ArticleHeaderLinks_ArticleBmk_Message></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Discuss 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/discuss.gif" 
            width=15> <A 
            href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#_comments">Discuss</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Recommend Article" 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/mail.gif" 
            width=16>&nbsp;<A id=ctl00_ArticleHeaderLinks_Recommend 
            href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=3338">Send&nbsp;to&nbsp;a&nbsp;friend</A> 
            </DIV></TD>
          <TD style="WIDTH: 100px; WHITE-SPACE: nowrap; TEXT-ALIGN: right">
            <TABLE id=CurRat>
              <TBODY>
              <TR>
                <TD>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=SmallText id=ctl00_ArticleRating_VL 
                      style="WHITE-SPACE: nowrap" align=right><SPAN 
                        id=ctl00_ArticleRating_VoteLabel>95 votes for this 
                        Article.</SPAN></TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=1>
                          <TBODY>
                          <TR>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD noWrap width=20 bgColor=white height=7><IMG 
                              height=7 
                              src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/red.gif" 
                              width=16 align=center 
                      border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=ctl00_ArticleRating_PopularityRow>
                      <TD class=SmallText align=right colSpan=2><A 
                        id=ctl00_ArticleRating_PopularityLnk 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                        9.50</A> <SPAN 
                        id=ctl00_ArticleRating_PopularityLbl></SPAN><SPAN 
                        id=ratingVal>Rating: <B>4.81</B> out of 
                    5</SPAN></TD></TR></TBODY></TABLE></TD>
                <TD>
                  <DIV>
                  <TABLE class=HistTable 
                  title="Voting Distribution. Recent data only">
                    <TBODY>
                    <TR>
                      <TD><IMG title="2 votes, 2.1%" height=1 
                        alt="2 votes, 2.1%" 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>1</TD>
                      <TD><IMG title="1 vote, 1.1%" height=1 
                        alt="1 vote, 1.1%" 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>2</TD>
                      <TD><IMG title="2 votes, 2.1%" height=1 
                        alt="2 votes, 2.1%" 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>3</TD>
                      <TD><IMG title="1 vote, 1.1%" height=1 
                        alt="1 vote, 1.1%" 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>4</TD>
                      <TD><IMG title="88 votes, 93.6%" height=20 
                        alt="88 votes, 93.6%" 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/pollcol.gif" 
                        width=10 
              border=0><BR>5</TD></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><SPAN 
      id=intelliTXT>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/mcpp/LoadBalancing/LoadBalancing_src.zip">Download 
        source code (zipped) - ~100 KB</A> 
        <LI>Latest source code and documentation (would be) available <A 
        href="http://free.top.bg/stoyan_damov/">here</A> soon. </LI></UL>
      <H2>In this article</H2>
      <OL type=1>
        <LI><A 
        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#intro">Introduction</A> 

        <OL type=a>
          <LI><A 
          href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#loadbalancing">A 
          Teeny-Weeny Intro to Clustering and Load Balancing</A> 
          <LI><A 
          href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#idea">My 
          Idea for Dynamic Software Load Balancing</A> </LI></OL>
        <LI><A 
        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#implementation">Architecture 
        and Implementation</A> 
        <OL type=a>
          <LI><A 
          href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#outlook">Architecture 
          Outlook</A> 
          <LI><A 
          href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#assemblies">Assemblies 
          &amp; Types</A> 
          <LI><A 
          href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#collaboration">Collaboration</A> 

          <LI><A 
          href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#details">Some 
          Implementation Details</A> </LI></OL>
        <LI><A 
        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#inaction">Load 
        Balancing in Action - Balancing a Web Farm</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#bcd">Building, 
        Configuring and Deploying the Solution</A> 
        <OL type=a>
          <LI><A 
          href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#configuration">Configuration</A> 

          <UL>
            <LI><A 
            href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#common_h">What's 
            so common in Common.h?</A> 
            <LI><A 
            href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#tweak">Tweaking 
            the configuration file</A> 
            <LI><A 
            href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#tweak2">... 
            and the other configuration file:)</A> </LI></UL>
          <LI><A 
          href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#deployment">Deployment</A> 
          </LI></OL>
        <LI><A 
        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#misc">Some 
        thoughts about MC++ and C#</A> 
        <OL type=a>
          <LI><A 
          href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#translation">Managed 
          C++ to C# Translation</A> 
          <LI><A 
          href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#CSvsMC">C#'s 
          readonly fields vs MC++ non-static const members</A> </LI></OL>
        <LI><A 
        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#bugs"><I>"Bugs 
        suck. Period."</I></A> 
        <LI><A 
        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#todos">TODO(s)</A> 

        <LI><A 
        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#conclusion">Conclusion</A> 

        <OL type=a>
          <LI><A 
          href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#final">A 
          (final) word about C#</A></LI></OL>
        <LI><A 
        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#disclaimer">Disclaimer</A> 
        </LI></OL>
      <P align=right><I>"Success is the ability to go from one failure to 
      another with no loss of enthusiasm."</I> <BR><B>Winston Churchill</B> </P>
      <H2>Introduction <A name=intro></A></H2>
      <P><SMALL><CODE><SPAN class=code-keyword>&lt;</SPAN>blog date=<SPAN 
      class=code-string>"</SPAN><SPAN class=code-string>2002-12-05"</SPAN><SPAN 
      class=code-keyword>&gt;</SPAN></CODE> Yay! I passed 70-320 today and I'm 
      now MCAD.NET. Expect the next article to cover XML Web Services, Remoting, 
      or Serviced Components:) <CODE><SPAN 
      class=code-keyword>&lt;</SPAN>/blog<SPAN 
      class=code-keyword>&gt;</SPAN></CODE></SMALL></P>
      <P>This article is about Load Balancing. Neither "Unleashed", nor 
      "Defined" -- "Implemented":) I'm not going to discuss in details what load 
      balancing is, its different types, or the variety of load balancing 
      algorithms. I'm not going to talk about proprieatary software like WLBS, 
      MSCS, COM+ Load Balancing or Application Center either. What I am going to 
      do in this article, is present you a custom .NET Dynamic Software Load 
      Balancing solution, that I've implemented in less than a week and the 
      issues I had to resolve to make it work. Though the source code is only 
      about 4 KLOC, by the end of this article, you'll see, that the solution is 
      good enough to balance the load of the web servers in a web farm. Enjoy 
      reading... </P>
      <H3>Everyone can read this article</H3>
      <P>...but not everybody would understand everything. To read, and 
      understand the article, you're expected to know what load balancing is in 
      general, but even if you don't, I'll explain it shortly -- so keep 
      reading. And to read the code, you should have some experience with 
      multithreading and network programming (TCP, UDP and multicasting) and a 
      basic knowledge of .NET Remoting. Contrarily of what C# developers think, 
      you shouldn't know Managed C++ to read the code. When you're writing 
      managed-only code, C# and MC++ source code looks almost the same with very 
      few differences, so I have even included a <A 
      href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#translation">section</A> 
      for C# developers which explains how to convert (most of the) MC++ code to 
      C#. </P>
      <P>I final warning, before you focus on the article -- I'm not a 
      professional writer, I'm just a dev, so don't expect too much from me 
      (that's my 3rd article). If you feel that you don't understand something, 
      that's probably because I'm not a native English speaker (I'm Bulgarian), 
      so I haven't been able to express what I have been thinking about. If you 
      find a grammatical nonsense, or even a typo, report it to me as a bug and 
      I'll be more than glad to "fix" it. And thanks for bearing this paragraph! 
      </P>
      <H3>A Teeny-Weeny Intro to Clustering and Load Balancing <A 
      name=loadbalancing></A></H3>
      <P>For those who don't have a clue what Load Balancing means, I'm about to 
      give a short explanation of clustering and load balancing. Very short 
      indeed, because I lack the time to write more about it, and because I 
      don't want to waste the space of the article with arid text. You're 
      reading an article at www.CodeProject.com, not at www.ArticleProject.com:) 
      The enlightened may <A 
      href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#idea">skip</A> 
      the following paragraph, and I encourage the rest to read it. </P>
      <P>Mission-critical applications must run 24x7, and networks need to be 
      able to scale performance to handle large volumes of client requests 
      without unwanted delays. A "server cluster" is a group of independent 
      servers managed as a single system for higher availability, easier 
      manageability, and greater scalability. It consists of two or more servers 
      connected by a network, and a cluster management software, such as WLBS, 
      MSCS or Application Center. The software provides services such as failure 
      detection, recovery, load balancing, and the ability to manage the servers 
      as a single system. Load balancing is a technique that allows the 
      performance of a server-based program, such as a Web server, to be scaled 
      by distributing its client requests across multiple servers within a 
      cluster of computers. Load balancing is used to enhance scalability, which 
      boosts throughput while keeping response times low. </P>
      <P>I should warn you that I haven't implemented a complete clustering 
      software, but only the load balancing part of it, so don't expect anything 
      more than that. Now that you have an idea what load balancing is, I'm sure 
      you don't know what is my idea for its implementation. So keep reading... 
      </P>
      <H3>My Idea for Dynamic Software Load Balancing <A name=idea></A></H3>
      <P>How do we know that a machine is busy? When we feel that our machine is 
      getting very slow, we launch the Task Manager and look for a hung instance 
      of iexplore.exe:) Seriously, we look at the CPU utilization. If it is low, 
      then the memory is low, and disk must be trashing. If we suspect anything 
      else to be the reason, we run the System Monitor and add some performance 
      counters to look at. Well, this works if you're around the machine and if 
      you have one or two machines to monitor. When you have more machines 
      you'll have to hire a person, and buy him a 20-dioptre glasses to stare at 
      all machines' System Monitor consoles and go crazy in about a week :). But 
      even if you could monitor your machines constantly you can't distribute 
      their workload manually, could you? Well, you could use some expensive 
      software to balance their load, but I assure you that you can do it 
      yourself and that's what this article is all about. While you are able to 
      "see" the performance counters, you can also collect their values 
      programmatically. And I think that if we combine some of them in a certain 
      way, and do some calculations, they could give you a value, that could be 
      used to determine the machine's load. Let's check if that's possible! </P>
      <P>Let's monitor the <CODE>\\Processor\% Processor Time\_Total</CODE> and 
      <CODE>\\Processor\% User Time\_Total</CODE> performance counters. You can 
      monitor them by launching Task Manager, and looking at the CPU utilization 
      in the "Performance" tab. (The red curve shows the % Procesor time, and 
      the green one -- the %User time). Stop or pause all CPU-intensive 
      applications (WinAMP, MediaPlayer, etc.) and start monitoring the CPU 
      utilization. You have noticed that the counter values stay almost 
      constant, right? Now, close Task Manager, wait about 5 seconds and start 
      it again. You should notice a big peak in the CPU utilization. In several 
      seconds, the peak vanishes. Now, if we were reporting performance counters 
      values instantly (as we get each counter sample), one could think that our 
      machine was extremely busy (almost 100%) at that moment, right? That's why 
      we're not going to report instant values, but we will collect several 
      samples of the counter's values and will report their average. That would 
      be fair enough, don't you think? No?! I also don't, I was just checking 
      you:) What about available memory, I/O, etc. Because the CPU utilization 
      is not enough for a realistic calculation of the machine's workload, we 
      should monitor more than one counter at a time, right? And because, let's 
      say, the current number of ASP.NET sessions is less important than the CPU 
      utilization we will give each counter a weight. Now the machine load will 
      be calculated as the sum of the weighted averages of all monitored 
      performance counters. You should be guession already my idea for dynamic 
      software load balancing. However, a picture worths thousand words, and an 
      ASCII one worths 2 thousand:) Here' is a real sample, and the machine load 
      calculation algorithm. In the example below, the machine load is 
      calculated by monitoring 4 performance counters, each configured to 
      collect its next sample value at equal intervals, and all counters collect 
      the same number of samples (this would be your usual case): </P><PRE>+-----------+  +-----------+  +-----------+  +-----------+
|% Proc Time|  |% User Time|  |ASP Req.Ex.|  |% Disk Time|
+-----------+  +-----------+  +-----------+  +-----------+
|Weight  <SPAN class=code-digit>0</SPAN>.4|  |Weight  <SPAN class=code-digit>0</SPAN>.3|  |Weight  <SPAN class=code-digit>0</SPAN>.2|  |Weight  <SPAN class=code-digit>0</SPAN>.5|
+-----------+  +-----------+  +-----------+  +-----------+
|         16|  |         55|  |         11|  |         15|
|         22|  |         20|  |          3|  |          7|
|          8|  |         32|  |         44|  |          4|
|         11|  |         15|  |         16|  |         21|
|         18|  |         38|  |         21|  |          3|
+-----+-----+  +-----+-----+  +-----+-----+  +-----+-----+
| Sum |   75|  | Sum |  160|  | Sum |   95|  | Sum |   50|
+-----+-----+  +-----+-----+  +-----+-----+  +-----+-----+
| Avg |   15|  | Avg |   32|  | Avg |   19|  | Avg |   10|
+-----+-----+  +-----+-----+  +-----+-----+  +-----+-----+
| WA  |  <SPAN class=code-digit>6</SPAN>.0|  | WA  |  <SPAN class=code-digit>9</SPAN>.6|  | WA  |  <SPAN class=code-digit>3</SPAN>.8|  | WA  |  <SPAN class=code-digit>5</SPAN>.0|
+-----+-----+  +-----+-----+  +-----+-----+  +-----+-----+
</PRE>
      <P><B></I>Legend:</B></I> 
      <DL>
        <DT>Sum 
        <DD>the sum of all counter samples 
        <DT>Avg 
        <DD>the average of all counter samples (Sum/Count) 
        <DT>WA 
        <DD>the weighted average of all counter samples (Sum/Count * Weight) 
        <DT>% Proc Time 
        <DD>(Processor\% Processor Time\_Total), the percentage of elapsed time 
        that the processor spends to execute a non-Idle thread. It is calculated 
        by measuring the duration of the idle thread is active in the sample 
        interval, and subtracting that time from interval duration. (Each 
        processor has an idle thread that consumes cycles when no other threads 
        are ready to run). This counter is the primary indicator of processor 
        activity, and displays the average percentage of busy time observed 
        during the sample interval. It is calculated by monitoring the time that 
        the service is inactive, and subtracting that value from 100% 
        <DT>% User Time 
        <DD>(Processor\% User Time\_Total) is the percentage of elapsed time the 
        processor spends in the user mode. User mode is a restricted processing 
        mode designed for applications, environment subsystems, and integral 
        subsystems. The alternative, privileged mode, is designed for operating 
        system components and allows direct access to hardware and all memory. 
        The operating system switches application threads to privileged mode to 
        access operating system services. This counter displays the average busy 
        time as a percentage of the sample time 
        <DT>ASP Req.Ex. 
        <DD>(ASP.NET Applications\Requests Executing\__Total__) is the number of 
        requests currently executing 
        <DT>% Disk Time 
        <DD>(Logical Disk\% Disk Time\_Total) is the percentage of elapsed time 
        that the selected disk drive was busy servicing read or write requests 
        </DD></DL>
      <P><CODE>Sum (% Proc Time) = <SPAN class=code-digit>16</SPAN> + <SPAN 
      class=code-digit>22</SPAN> + <SPAN class=code-digit>8</SPAN> + <SPAN 
      class=code-digit>11</SPAN> + <SPAN class=code-digit>18</SPAN> = <SPAN 
      class=code-digit>75</SPAN> <BR>Average (% Proc Time) = <SPAN 
      class=code-digit>75</SPAN> / <SPAN class=code-digit>5</SPAN> = <SPAN 
      class=code-digit>15</SPAN> <BR>Weighted Average (% Proc Time) = <SPAN 
      class=code-digit>15</SPAN> * <SPAN class=code-digit>0</SPAN>.<SPAN 
      class=code-digit>4</SPAN> = <SPAN class=code-digit>6</SPAN>.<SPAN 
      class=code-digit>0</SPAN> <BR>... <BR>MachineLoad = Sum (WeightedAverage 
      (EachCounter)) <BR>MachineLoad = <SPAN class=code-digit>6</SPAN>.<SPAN 
      class=code-digit>0</SPAN> + <SPAN class=code-digit>9</SPAN>.<SPAN 
      class=code-digit>6</SPAN> + <SPAN class=code-digit>3</SPAN>.<SPAN 
      class=code-digit>8</SPAN> + <SPAN class=code-digit>5</SPAN>.<SPAN 
      class=code-digit>0</SPAN> = <SPAN class=code-digit>24</SPAN>.<SPAN 
      class=code-digit>4</SPAN> </CODE></P>
      <H2>Architecture and Implementation <A name=implementation></A></H2>
      <P>I wondered about half a day how to explain the architecture to you. Not 
      that it is so complex, but because it would take too much space in the 
      article, and I wanted to show you some code, not a technical specification 
      or even a DSS. So I wondered whether to explain the architecture using a 
      "top-to-bottom" or "bottom-to-top" approach, or should I think out 
      something else? Finally, as most of you have already guessed, I decided to 
      explain it in my own mixed way:) First, you should learn of which 
      assemblies is the solution comprised of, and then you could read about 
      their collaboration, the types they contain and so on... And even before 
      that, I recommend you to read and understand two terms, I've used 
      throughout the article (and the source code's comments). </P>
      <DL>
        <DT>Machine Load 
        <DD>the overall workload (utilization) of a machine - in our case, this 
        is the sum of the weighted averages of all performance counters 
        (monitored for load balancing); if you've skipped the section "My Idea 
        for Dynamic Software Load Balancing", you may want to <A 
        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#idea">go 
        back</A> and read it 
        <DT>Fastest machine 
        <DD>the machine with the least current load </DD></DL>
      <H3>Architecture Outlook <A name=outlook></A></H3>
      <P>First, I'd like to appologize about the "diagrams". I can work with 
      only two software products that can draw the diagrams, I needed in this 
      article. I can't afford the first (and my company is not willing to pay 
      for it too:), and the second bedeviled me so much, that I dropped out of 
      the article one UML static structure diagram, a UML deployment diagram and 
      a couple of activity diagrams (and they were nearly complete). I won't 
      tell you the name of the product, because I like very much the company 
      that developed it. Just accept my appologies, and the pseudo-ASCII art, 
      which replaced the original diagrams. Sorry:) </P>
      <P>The load balancing software comes in three parts: a server, that 
      reports the load of the machine it is running on; a server that collects 
      such loads, no matter which machine they come from; and a library which 
      asks the collecting server which is the least loaded (fastest) machine. 
      The server that reports the machine's load is called "Machine Load 
      Reporting Server" (MLRS), and the server, that collects machine loads is 
      called "Machine Load Monitoring Server" (MLMS). The library's name "Load 
      Balancing Library" (LBL). You can <A 
      href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#deployment">deploy</A> 
      these three parts of the software as you like. For example, you could 
      install all of them on all machines. </P>
      <P>The MLRS server on each machine joins a special, designated for the 
      purpose of the load balancing, multicasts group, and sends messages, 
      containing the machine's load to the group's multicast IP address. Because 
      all MLMS servers join the same group at startup, they all receive each 
      machine load, so if you run both MLRS and MLMS servers on all machines, 
      they will know each other's load. So what? We have the machine loads, but 
      what do we do with them? Well, all MLMS servers store the machine loads in 
      a special data structure, which lets them quickly retrieve the least 
      machine load at any time. So all machines now know which is the fastest 
      one. Who cares? We haven't really used that information to balance any 
      load, right? How do we query MLMS servers which is the fastest machine? 
      The answer is that each MLMS registers a special singleton object with the 
      .NET Remoting runtime, so the LBL can create (or get) an instance of that 
      object, and ask it for the least loaded machine. The problem is that LBL 
      cannot ask simultaneously all machines about this (yet, but I'm thinking 
      on this issue), so it should choose one machine (of course, it could be 
      the machine, it is running on) and will hand that load to the client 
      application that needs the information to perform whatever load balancing 
      activity is suitable. As you will later see, I've used LBL in a web 
      application to distribute the workload between all web servers in web 
      farm. Below is a "diagram" which depicts in general the collaboration 
      between the servers and the library: </P><PRE>     +-----+          ______          +-----+
     |  A  |       __/      \__       |  B  |
     +-----+    __/            \__    +-----+
 +--<SPAN class=code-keyword>&gt;</SPAN>| LMS |<SPAN class=code-keyword>&lt;</SPAN>--/     Multicast    \--<SPAN class=code-keyword>&gt;</SPAN>| LMS |<SPAN class=code-keyword>&lt;</SPAN>--+
 |   |     |   /                  \   |     |   |
 |   | LRS |--<SPAN class=code-keyword>&gt;</SPAN>\__     Group    __/   |     |   |
 |   |     |      \__        __/      |     |   |
 |<SPAN class=code-keyword>&lt;</SPAN>--| LBL |       ^ \______/         | LBL |---+
 |   +-----+       |                  +-----+
 |                 |  +-----+
 |                 |  |  C  |
 |                 |  +-----+
 |                 |  |     |
 |                 |  |     |
 |                 +--| LRS |
 |     Remoting       |     |
 +--------------------| LBL |
                      +-----+
</PRE>
      <P><I>MLMS, MLRS and LBL Communication</I></P>
      <P><I><B>Note:</B> You should see the strange figure between the machines 
      as a cloud, i.e. it represents a LAN :) And one more thing -- if you don't 
      understand what multicasting is, don't worry, it is explained later in the 
      <A 
      href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#collaboration">Collaboration</A> 
      section.</I></P>
      <P>Now look at the "diagram" again. Let me remind you that when a machine 
      joins a multicast group, it receives all messages sent to that group, 
      including the messages, that the machine has sent. Machine A receives its 
      own load, and the load, reported by C. Machine B receives the load of A 
      and C (it does not report its load, because there's no MLRS server 
      installed on it). Machine C does not receive anything, because it has not 
      MLMS server installed. Because the machine C's LBL should connect (via 
      Remoting) to an MLMS server, and it has no such server installed, it could 
      connect to machine A or B and query the remoted object for the fastest 
      machine. On the "diagram" above, the LBL of A and C communicate with the 
      remoted object on machine A, while the LBL of B communicates with the 
      remoted object on its machine. As you will later see in the <A 
      href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#configuration">Configuration</A> 
      section, there are very few things that are hardcoded in the solution's 
      source code, so don't worry -- you will be able to tune almost everything. 
      </P>
      <H3>Assemblies &amp; Types<A name=assemblies> </A></H3>
      <P>The solution consists of 8 assemblies, but only three of them are of 
      some interest to us now: MLMS, MLRS, and LBL, located respectively in two 
      console applications 
      (<CODE>Machine<CODE>LoadMonitoringServer</CODE>.exe</CODE> and 
      <CODE>Machine<CODE>LoadReportingServer</CODE>.exe</CODE>) and one dynamic 
      link library (<CODE>LoadBalancingLibrary.dll</CODE>). Surprisingly, MLMS 
      and MLRS do not contain any types. However, they use several types get 
      their job done. You may wonder why I have designed them in that way. Why 
      hadn't I just implemented both servers directly in the executables. Well, 
      the answer is quite simple and reflects both my strenghts and weaknesses 
      as a developer. If you have the time to read about it, go ahead, otherwise 
      <A href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#asm">click 
      here</A> to skip the slight detour. </P>
      <P>GUI programming is what I hate (though I've written a bunch of GUI 
      apps). For me, it is a mundane work, more suitable for a designer than for 
      a developer. I love to build complex "things". Server-side applications 
      are my favorite ones. Multi-threaded, asynchronous programming -- that's 
      the "stuff" I <B>love</B>. Rare applications, that nobody "sees" except 
      for a few administrators, which configure and/or control them using some 
      sort of administration consoles. If these applications work as expected 
      the end-user will almost never know s/he is using them (e.g. in most 
      cases, a user browsing a web site does not realize that an IIS or Apache 
      server is processing her requests and is serving the content). Now, I've 
      written several Windows C++ services in the past, and I've written some 
      .NET Windows services recently, so I could easily convert MLMS and MLRS to 
      one of these. On the other hand I love console (CUI) applications so much, 
      and I like seing hundreds of tracing messages on the console, so I left 
      MLMS and MLRS in their CUI form for two reasons. The first reason is that 
      you can quickly see what's wrong, when something goes wrong (and it will, 
      at least once:), and the second one is because I haven't debugged .NET 
      Windows services (and because I have debugged C++ Windows services, I can 
      assure you that it's not "piece of cake"). Nevertheless, one can easily 
      convert both CUI applications in Windows services in less than half an 
      hour. I haven't implemented the server classes into the executables to 
      make it easier for the guy who would convert them into Windows services. 
      S/he'll need to write just 4 lines of code in the Window Service class's 
      to get the job done: </P>
      <OL type=1>
        <LI>declare the server member variable: <PRE lang=mc++>LoadXxxServer <SPAN class=code-keyword>__gc</SPAN>* server;
</PRE>
        <LI>instantiate and start it in the overridden <CODE>OnStart</CODE> 
        method: <PRE lang=mc++>    server = <SPAN class=code-keyword>new</SPAN> LoadXxxServer ();
    server-<SPAN class=code-keyword>&gt;</SPAN>Start ();
</PRE>
        <LI>stop it in the overriden <CODE>OnStop</CODE> method: <PRE lang=mc++>    server-<SPAN class=code-keyword>&gt;</SPAN>Stop ();
</PRE></LI></OL>
      <P><CODE>Xxx</CODE> is either <CODE>Monitoring</CODE> or 
      <CODE>Reporting</CODE>. I'm sure you understand me now why I have 
      implemented the servers' code in separate classes in separate libraries, 
      and not directly in the executables. </P>
      <P><A name=asm></A>I mentioned above that the solution consists of 8 
      assemblies, but as you remember, 2 of them (the CUIs) did not contain any 
      types, one of them was LBL, so what are the other 5? MLMS and MLRS use 
      respectively the types, contained in the libraries 
      <CODE>LoadMonitoringLibrary</CODE> (LML) and 
      <CODE>LoadReportingLibrary</CODE> (LRL). On the other hand, they and LBL 
      use common types, shared in an assembly, named <CODE>SharedLibrary</CODE> 
      (SL). So the assemblies are now MLMS + MLRS + LML + LRL + LBL + SL = 6. 
      The 7th is a simple CUI (not interesting) application, I used to test the 
      load balancing, so I'll skip it. The last assembly, is the web application 
      that demonstrates the load balancing in action. Below is a list of the 
      four most important assemblies that contain the types and logic for the 
      implementation of the load balancing solution. </P>
      <P><CODE>SharedLibary</CODE> (SL) - contains common and helper types, used 
      by LML, LRL and/or LBL. A list of the types (explained further) follows: 
      </P>
      <UL>
        <LI><CODE>ServerStatus</CODE> - enumeration, used by LML and LRL's 
        LoadXxxServer classes 
        <LI><CODE>WorkerDoneEventHandler</CODE> - delegate, ditto 
        <LI><CODE>Configurator</CODE> - utility class (I'll discuss later), 
        ditto 
        <LI><CODE>CounterInfo</CODE> - "struct" class, used by LRL and SL 
        <LI><CODE>ILoadBalancer</CODE> - interface, implemented in LML and used 
        by LBL 
        <LI><CODE>IpHelper</CODE> - utility class, used by LML and LRL 
        <LI><CODE>MachineLoad</CODE> - "struct" class (with MarshalByValue 
        semantics for the needs of the Remoting runtime), used by LML, LRL and 
        LBL 
        <LI><CODE>Tracer</CODE> - utility class, which most classes in LML and 
        LRL inherit in order to trace in the console in a consistent manner 
      </LI></UL>
      <P><I><B>NOTE:</B> <CODE>CounterInfo</CODE> is not exactly what C++ 
      developers call a "struct" class, because it does a lot of work behind the 
      scenes. Its implementation is non- trivial and includes topics like 
      timers, synchronization, and performance counters monitoring; look at the 
      <A 
      href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#details">Some 
      Implementation Details</A> section for more information about it. </I></P>
      <P><CODE>LoadMonitoringLibrary</CODE> (LML) - contains the 
      <CODE>LoadMonitoringServer</CODE> (LMS) class, used directly by MLMS, as 
      well as all classes, used internally in the LMS class. List of LML's types 
      (explained further) follows: </P>
      <UL>
        <LI><CODE>LoadMonitoringServer</CODE> - (LMS) class, the MLMS core 
        <LI><CODE>MachineLoadsCollection</CODE> - a simulation of a priority 
        queue that stores the machines' loads in a sorted manner, so it could 
        quickly return the least loaded machine (its implementation is more 
        interesting than its name) 
        <LI><CODE>LoadMapping</CODE> - "struct" class, used internally by 
        <CODE>MachineLoadsCollection</CODE> 
        <LI><CODE>CollectorWorker</CODE> - utility class, its only (public) 
        method is the worker thread that accepts and collects machine load 
        reports 
        <LI><CODE>ReporterWorker</CODE> - utility class, its only (public) 
        method is the worker thread that accepts LBL requests and reports 
        machine loads 
        <LI><CODE>WorkerTcpState</CODE> - "struct" class, used internally by the 
        <CODE>CollectorWorker</CODE> 
        <LI><CODE>WorkerUdpState</CODE> - "struct" class, used internally by the 
        <CODE>ReporterWorker</CODE> 
        <LI><CODE>ServerLoadBalancer</CODE> - a special Remoting-enabled 
        (MarshalByRefObject) class, which is registered for remoting as a 
        Singleton, and activated on the server side by LBL to service its 
        requests </LI></UL>
      <P><I><B>NOTE:</B> I used the <CODE>ReporterWorker</CODE> to implement the 
      first version of LBL in some faster, more lame way, but I've dropped it 
      later; now, LMS registers a Singleton object for the LBL requests; 
      however, LMS is still using (the fully functional) 
      <CODE>ReporterWorker</CODE> class, so one could build another kind of LBL 
      that connects to an MLMS and asks for the least loaded machine using a 
      simple TCP socket (I'm sorry that I've overwritten the old LBL library). 
      </I></P>
      <P><CODE>LoadReportingLibrary</CODE> (LRL) - contains the 
      <CODE>LoadReportingServer</CODE> (LRS) class, used directly by MLRS, as 
      well as all classes, used internally in the LRS class. List of LRL's types 
      (explained further) follows: </P>
      <UL>
        <LI><CODE>LoadReportingServer</CODE> - class, the MLRS core 
        <LI><CODE>ReportingWorker</CODE> - utility class, its only (public) 
        method is the worker thread that starts the monitoring of the 
        performance counters and periodically reports to one or more MLMS the 
        local machine's load </LI></UL>
      <P><CODE>LoadBalancingLibrary</CODE> (LBL) - contains just one class, 
      <CODE>ClientLoadBalance</CODE>r, which is instantiated by client 
      applications; the class contains only one (public) method, which is 
      "surprisingly" named <CODE>GetLeastMachineLoad</CODE> returning the least 
      loaded machine:) LBL connects to LML's <CODE>ServerLoadBalancer</CODE> 
      singleton object via Remoting. For more details, read the <A 
      href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#collaboration">following 
      section</A>. 
      <H3>Collaboration <A name=collaboration></A></H3>
      <P>In order to understand how the objects "talk" to each other within an 
      assembly and between assemblies (and on different machines), you should 
      understand some technical terms. Because they amount to about a page, and 
      maybe most of you do know what they mean, here's what I'll do: I'll give 
      you a list of the terms, and if you know them, click <A 
      href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#skipterms">here</A> 
      to read about the collaboration, otherwise, keep reading... The terms are: 
      delegate, worker, TCP, UDP, (IP) Multicasting, and Remoting. </P>
      <DL>
        <DT>Delegate 
        <DD>a secure, type-safe way to call a method of a class indirectly, 
        using a "reference" to that method; very similar to and at the same time 
        quite different from C/C++ function pointers (callbacks); 
        <DT>Worker 
        <DD>utility class, usually with just one method, which is started as a 
        separate thread; the class holds the data (is the state), needed by the 
        thread to do its job; 
        <DT>TCP 
        <DD>a connection-based, stream-oriented delivery protocol with 
        end-to-end error detection and correction. Connection-based means that a 
        communication session between hosts is established before exchanging 
        data. A host is any device on a TCP/IP network identified by a logical 
        IP address. TCP provides reliable data delivery and ease of use. 
        Specifically, TCP notifies the sender of packet delivery, guarantees 
        that packets are delivered in the same order in which they were sent, 
        retransmits lost packets, and ensures that data packets are not 
        duplicated; 
        <DT>UDP 
        <DD>a connectionless, unreliable transport protocol. Connectionless 
        means that a communication session between hosts is not established 
        before exchanging data. UDP is often used for one-to-many communications 
        that use broadcast or multicast IP datagrams. The UDP connectionless 
        datagram delivery service is unreliable because it does not guarantee 
        data packet delivery and no notification is sent if a packet is not 
        delivered. Also, UDP does not guarantee that packets are delivered in 
        the same order in which they were sent. Because delivery of UDP 
        datagrams is not guaranteed, applications using UDP must supply their 
        own mechanisms for reliability, if needed. Although UDP appears to have 
        some limitations, it is useful in certain situations. For example, 
        Winsock IP multicasting is implemented with UDP datagram type sockets. 
        UDP is very efficient because of low overhead. Microsoft networking uses 
        UDP for logon, browsing, and name resolution; 
        <DT>Multicasting 
        <DD>technology that allows data to be sent from one host and then 
        replicated to many others without creating a network traffic nightmare. 
        This technology was developed as an alternative to broadcasting, which 
        can negatively impact network bandwidth if used extensively. Multicast 
        data is replicated to a network only if processes running on 
        workstations in that network are interested in that data. Not all 
        protocols support the notion of multicasting -- on Win32 platforms, only 
        two protocols are capable of supporting multicast traffic: IP and ATM; 
        <DT>IP Multicasting 
        <DD>IP multicasting relies on a special group of addresses known as 
        multicast addresses. It is this group address that names a given group. 
        For example, if five machines all want to communicate with one another 
        via IP multicast, they all join the same group address. Once they are 
        joined, any data sent by one machine is replicated to every member of 
        the group, including the machine that sent the data. A multicast IP 
        address is a class D IP address in the range 224.0.0.0 through 
        239.255.255.255 
        <DT>Remoting 
        <DD>the process of communication between different operating system 
        processes, regardless of whether they are on the same computer. The .NET 
        remoting system is an architecture designed to simplify communication 
        between objects living in different application domains, whether on the 
        same computer or not, and between different contexts, whether in the 
        same application domain or not. </DD></DL>
      <P><A name=skipterms></A>I'll start from inside-out, i.e. I'll first 
      explain how various classes communicate with each other with the 
      assemblies, and then I'll explain how the assemblies collaborate between 
      them. </P>
      <H4>In-Assembly collaboration (a thread synchronization how-to:)</H4>
      <P>When the <CODE>LoadReportingServer</CODE> and 
      <CODE>LoadMonitoringServer</CODE> classes are instantiated, and their 
      <CODE>Start</CODE> methods are called, they launch respectively one or two 
      threads to do their job asynchronously (and to be able to respond to 
      "Stop" commands, of course). Well, if starting a thread is very easy, 
      controlling it is not that easy. For example, when the servers should 
      stop, they should notify the threads that they are about to stop, so the 
      threads could finish their job and exit appropriately. On the other hand, 
      when the servers launch the threads, they should be notified when the 
      threads are about to enter their thread loops and have executed their 
      initialization code. In the next couple of paragraphs I'll explain how 
      I've solved these synchronization issues, and if you know a cooler way, 
      let me know (with the message board below). In the paragraphs below, I'll 
      refer to the instances of the <CODE>LoadReportingServer</CODE> and 
      <CODE>LoadMonitoringServer</CODE> classes as "(the) server". </P>
      <P>When the <CODE>Start</CODE> method is executed, the LMS object creates 
      a worker class instance, passing it a reference to itself (this), a 
      reference to a delegate and some other useful variables that are not 
      interesting for this section. The server object then creates an 
      <CODE>AutoResetEvent</CODE> object in a unsignalled state. Then the LMS 
      object starts a new thread, passing for the <CODE>ThreadStart</CODE> 
      delegate the address of a method in the worker class. (I call a worker 
      class' method, launched as a thread a worker thread.) After the thread has 
      been started, the server object blocks, waiting (infinitely) for the event 
      object to be signalled. Now, when the thread's initialization code 
      completes, it calls back the server via the server- supplied delegate, 
      passing a boolean parameter showing whether its initialization code 
      executed successfully or something went wrong. The target method of the 
      delegate in the server class sets (puts in signalled state) the 
      <CODE>AutoResetEvent</CODE> object and records in a private boolean member 
      the result of the thread initialization. Setting the event object unblocks 
      the server: it now knows that the thread's startup code has completed, and 
      also knows the result of the thread's initialization. If the thread did 
      not manage to initialize successfully, it has already exited, and the 
      server just stops. If the thread succeeded to initialize, then it enters 
      its thread loop and waits for the server to inform it when it should exit 
      the loop (i.e. the server is stopping). One could argue that this "worker 
      thread-to-main thread" synchronization looks too complicated and he 
      <B>might</B> be right. If we only needed to know that the thread has 
      finished the initialization code (and don't care if it initialized 
      successfully) we could directly pass the worker a reference to the 
      <CODE>AutoResetEvent</CODE> object, and the thread would then set it to a 
      signalled state, but you saw that we need to know whether the thread has 
      initialized successfully or not. </P>
      <P>Now that was the more complex part. The only issue we have to solve now 
      is how to stop the thread, i.e. make it exit its thread loop. Well, that's 
      what I call a piece of cake. If you remember, the server has passed a 
      reference to itself (<CODE><SPAN class=code-keyword>this</SPAN></CODE>) to 
      the worker. The server has a <CODE>Status</CODE> property, which is an 
      enumeration, describing the state of the server (Starting, Started, 
      Stopping, Stopped). Because the thread has a reference to the server, in 
      its thread loop it checks (by invoking the <CODE>Status</CODE> property) 
      whether the server is not about to stop (<CODE>Status == 
      ServerStatus::Stopping</CODE>). If the server is stopping, so is the 
      thread, i.e. the thread exits silently and everything's OK. So when the 
      server is requested to stop, it modifies its private member variable 
      <CODE>status</CODE> to <CODE>Stopping</CODE> and <CODE>Join</CODE>s the 
      thread (waits for the thread to exit) for a configured interval of time. 
      If the thread exits in the specified amount of time, the server changes 
      its status to <CODE>Stopped</CODE> and we're done. However, a thread may 
      timeout while processing a request, so the server then aborts the thread 
      by calling the thread's <CODE>Abort</CODE> method. I've written the thread 
      loops in <CODE><SPAN class=code-keyword>try</SPAN>...<SPAN 
      class=code-keyword>catch</SPAN>...<SPAN 
      class=code-keyword>finally</SPAN></CODE> blocks and in their <CODE><SPAN 
      class=code-keyword>catch</SPAN></CODE> clause, the threads check whether 
      they die a violent death:), i.e. a <CODE>ThreadAbortException</CODE> was 
      raised by the server. The thread then executes its cleanup code and exits. 
      (And I thought that was easier to explain:) </P>
      <P>That much about how the server classes talk to worker classes (main 
      thread to worker threads). The rest of the objects in the assemblies 
      communicate using references to each other or via delegates. Now comes the 
      part that explains how the assemblies "talk" to each other, i.e. how the 
      MLRS sends its machine's load to the MLMS, and how LBL gets the minimum 
      machine load from MLMS. </P>
      <H4>Cross-machine assembly collaboration</H4>
      <P>I'll first "talk" how the MLRS reports the machine load to MLMS. To 
      save some space in the article (some of your bandwidth, and some typing 
      for me:), I'll refer to the <CODE>LoadReportingServer</CODE> class as LRS 
      and to the <CODE>LoadMonitoringServer</CODE> class as LMS. Do not confuse 
      them with the server applications, having an "M" prefix. </P>
      <P>LMS starts two worker threads. One for collecting machine loads, and 
      one for reporting the minimum load to interested clients. The former is 
      named <CODE>CollectorWorker</CODE>, and the latter -- 
      <CODE>ReporterWorker</CODE>. I've mentioned somewhere above that the 
      <CODE>ReporterWorker</CODE> is not so interesting, so I'll talk only about 
      the <CODE>CollectorWorker</CODE>. In the paragraphs below, I'll call it 
      simply a collector. When the collector thread is started, it creates a UDP 
      socket, binds it locally and adds it to a multicast group. That's the 
      collector's initialization code. It then enters a thread loop, 
      periodically polling the socket for arrived requests. When a request 
      comes, the collector reads the incomming data, parses it, validates it and 
      if it is a valid machine load report, it enters the load in the <A 
      href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#mach">machine 
      loads collection</A> of the LMS class. That's pretty much everything you 
      need to know about how MLMS accepts machine loads from MLRS. </P>
      <P>LRS starts one thread for reporting the current machine load. The 
      worker's name is <CODE>ReportingWorke</CODE>r, and I'll refer to it as 
      reporter. The initialization code of this thread is to start monitoring 
      the performance counters, create a UDP socket and make it a member of the 
      same multicast group that MLMS's collector object has joined. In its 
      thread loop, the reporter waits a predefined amount of time, then gets the 
      current machine load and sends it to the multicast endpoint. A network 
      device, called a "switch" then dispatches the load to all machines that 
      have joined the multicast group, i.e. all MLMS collectors will receive the 
      load, including the MLMS that runs on the MLRS machine (if a MLMS has been 
      installed and running there). </P>
      <P>Here comes the most interesting part -- how LBL queries which is the 
      machine with the least load (the fastest machine). Well, it is quite 
      simple and requires only basic knowledge about .NET Remoting. If you don't 
      understand Remoting, but you do understand DCOM, assume that .NET Remoting 
      compared to DCOM is what C++ is compared to C. You'll be quite close and 
      at the same time quite far from what Remoting really is, but you'll get 
      the idea. (In fact, I've read several books on DCOM, and some of them 
      refered to it as "COM Remoting Infrastructure"). When MLMS starts, it 
      registers a class named <CODE>ServerLoadBalancer</CODE> with the Remoting 
      runtime as a singleton (an object that is instantiated just once, and 
      further requests for its creation end up getting a reference to the same, 
      previously instantiated object). When a request to get the fastest machine 
      comes (<CODE>GetLeastMachineLoad</CODE> method gets called) the singleton 
      asks the <CODE>MachineLoadsCollection</CODE> object to return its least 
      load, and then hands it to the client object that made the remoted call. 
      </P>
      <P>Below is a story you would like to hear about remoted objects that need 
      to have parameter-less constructors. If you'd like to skip the story, <A 
      href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#skipstory">click 
      here</A>, otherwise enjoy... </P>
      <P>Now that all of you know that an object may be registered for remoting, 
      probably not many of you know that you do not have easy control over the 
      object's instantiation. Which means that you don't create an instance of 
      the singleton object and register it with the Remoting runtime, but rather 
      the Remoting runtime creates that object when it receives the first 
      request for the object's creation. Now, all server-activated objects must 
      have a parameter-less constructor, and the singleton is not an exception. 
      But we want to pass our <CODE>ServerLoadBalancer</CODE> class a reference 
      to the machine loads collection. I see <B>only</B> two ways to do that -- 
      the first one is to register the object with the Remoting runtime, create 
      an instance of it via Remoting and call an "internal" method 
      <CODE>Initialize</CODE>, passing the machine loads collection to it. At 
      first that sounded like a good idea and I did it just like that. Then I 
      launched the client testing application first, and the server after it. 
      Can you guess what happened? The client managed to create the singleton 
      first, and it was not initialized -- boom!!! Not what we expected, right? 
      So I thought a bit how to find a workaround. Luckily, it occured to me how 
      to hack this problem. I decided to make a static member of the 
      <CODE>LoadMonitoringServer</CODE> class, which would hold the machine 
      loads collection. At the begining it would be a <CODE>null</CODE> 
      reference, then when the server starts, I would set it to the server's 
      machine loads collection. Now when our "parameter-less constructed" 
      singleton object is instantiated for the first time by the Remoting 
      runtime, it would get the machine loads via the 
      <CODE>LoadMonitoringServer::StaticMachineLoads</CODE> member variable and 
      the whole problem has disappeared. I had to only mark the static member 
      variable as (<CODE><SPAN class=code-keyword>private</SPAN> <SPAN 
      class=code-keyword>public</SPAN></CODE>) so it is visible only within the 
      assembly. I know my appoach is a hack, and if you know a better pattern 
      that solves my problem, I'll be happy to learn it. </P>
      <P><A name=skipstory></A>Here's another interesting issue. How does the 
      client (LBL) compile against the remoted <CODE>ServerLoadBalancer</CODE> 
      class? Should it have a reference (#using "...dll") to LML or what? Well, 
      there is a solution to this problem, and I haven't invented it, thought 
      I'd like much:) I mentioned before, that the <CODE>SharedLibrary</CODE> 
      has some shared types, used by LBL, LMS and LRS. No, it's not what you're 
      thinking! I haven't put the <CODE>ServerLoadBalancer</CODE> class there 
      even if I wanted to, because it requires the 
      <CODE>MachineLoadsCollection</CODE> class, and the latter is located in 
      LML. What I consider an elegant solution, (and what I did) is defining an 
      interface in the <CODE>SharedLibrary</CODE>, which I implemented in the 
      <CODE>ServerLoadBalancer</CODE> class in LML. LBL tries to create the 
      <CODE>ServerLoadBalancer</CODE> via Remoting, but it does not explicitly 
      try to create a <CODE>ServerLoadBalancer</CODE> instance, but an instance, 
      implementing the <CODE>ILoadBalancer</CODE> interface. That's how it 
      works. LBL creates/activates the singleton on the LMS side via Remoting 
      and calls its <CODE>GetLeastMachineLoad</CODE> method to determine the 
      fastest machine. </P>
      <H2>Some Implementation Details <A name=details></A></H2>
      <P>Below is a list of helper classes that are cool, reusable or worth to 
      mention. I'll try to explain their cool sides, but you should definitely 
      peek at the source code to see them:) </P>
      <H3>Configurator</H3>
      <P>I like the .NET configuration classes very much, and I hate reinventing 
      the wheel, but this class is a specific configuration class for this 
      solution and is cooler than .NET configuration class in at least one 
      point. What makes the class cooler, is that it can notify certain objects 
      when the configuration changes, i.e. the underlying configuration file has 
      been modified with some text editor. So I've built my own configurator 
      class, which uses the FileSystemWatcher class to sniff for writes in the 
      configuration file, and when the file changes, the configurator object 
      re-loads the file, and raises an event to all subscribers that need to 
      know about the change. These subscribers are only two, and they are the 
      Load Monitoring and Reporting servers. When they receive the event, they 
      restart themselves, so they can reflect the latest changes immediately. 
      </P>
      <H3>CounterInfo</H3>
      <P>I used to call this class a "struct" one. I wasn't fair to it :), as it 
      is one of the most important classes in the solution. It wraps a 
      PerformanceCounter object in it, retrieves some sample values, and stores 
      them in a cyclic queue. What is a cyclic queue? Well, I guess there's no 
      such animal :) but as I have "invented" it, let's explain you what it is. 
      It is a simple queue with finite number of elements allowed to be added. 
      When the queue "overflows", it pops up the first element, and pushes the 
      new element into the queue. Here's an example of storing the numbers from 
      1 to 7 in a 5-element cyclic queue: </P><PRE lang=text>Pass    Queue            Running Total (Sum)
----    -----            -------------------
        []               =               0
1       [1]              = 0 + 1      =  1
2       [2 1]            = 1 + 2      =  3
3       [3 2 1]          = 3 + 3      =  6
4       [4 3 2 1]        = 6 + 4      = 10
5       [5 4 3 2 1]      = 10 + 5     = 15
6       [6 5 4 3 2]      = 15 - 1 + 6 = 20
7       [7 6 5 4 3]      = 20 - 2 + 7 = 25
</PRE>
      <P>Why do I need the cyclic queue? To have a limited state of each 
      monitored performance counter, of course. If pass 5 was the state of the 
      counter 3 seconds ago, the its average was 15/5 = 3, and if now we are at 
      pass 7, the counter's average is 20/5 = 4. Sounds reallistic, doesn't it? 
      So we use the cyclic queue to store the transitory counter samples and 
      know its average for the past N samples which were measured for the past M 
      seconds. You see how easy is calculated the running sum. Now the only 
      thing a counter should do to tell its average is ro divide the running sum 
      to the number of sample values it had collected. You know that the machine 
      load is the sum of the weigted averages of all monitored performance 
      counters for the given machine. But you might ask, what happens in the 
      following situation: </P>
      <P>We have two machines: A and B. Both are measuring just one counter, 
      their CPU utilization. A Machine Load Monitoring Server is running on a 
      third machine C, and a load balancing client is on fourth machine D. A and 
      B's Load Reporting Servers are just started. Their CounterInfo classes 
      have recorded respectively 50 and 100 (because the administrator on 
      machine B has just launched IE:). A and B are configured to report each 
      second, but they should report the weighted averages of 5 sample values. 1 
      second elapses, but both A and B has collected only 1 sample value. Now D 
      asks C which is the least loaded machine. Which one should be reported? A 
      or B? The answer is simple: None. No machine is allowed to report its load 
      unless it has collected the necessary number of sample values for all 
      performance counters. That means, that unless A and B has filled up their 
      cyclic queues for the very first time, they block and don't return their 
      weighted average to the caller (the LRS's reporter worker). </P>
      <H3>MachineLoadsCollection <A name=mach></A></H3>
      <P>This class is probably more tricky than interesting. Generally, it is 
      used to store the loads, that one or more LRS report to LMS. That's the 
      class' dumb side. One cool side of the class is that it stores the loads 
      in 3 different data structures to simulate one, that is missing in the 
      .NET BCL - a priority queue that can store multiple elements with the same 
      key, or in STL terms, something like </P><PRE>std::priority_queue <SPAN class=code-keyword>&lt;</SPAN>std::vector <SPAN class=code-keyword>&lt;</SPAN>X *<SPAN class=code-keyword>&gt;</SPAN>, ... <SPAN class=code-keyword>&gt;</SPAN></PRE>
      <P>I know that C++ die-hards know it by heart, but for the rest of the 
      audience: <CODE>std::priority_queue</CODE> is a template container adaptor 
      class that provides a restriction of functionality limiting access to the 
      top element of some underlying container type, which is always the largest 
      or of the highest priority. New elements can be added to the 
      <CODE>priority_queue</CODE> and the top element of the 
      <CODE>priority_queue</CODE> can be inspected or removed. I took the 
      definition from MSDN, but I'd like to correct it a little bit: you should 
      read "which is always the largest or of the highest priority" as "which is 
      always what the <CODE>less</CODE> functor returns as largest or of the 
      highest priority". At the beginning, I thought to use the 
      <CODE>priority_queue</CODE> template class, and put there <CODE><SPAN 
      class=code-string>"</SPAN><SPAN class=code-string>gcroot"</SPAN></CODE>-ed 
      references, but then I thought that it would be more confusing and 
      difficult than helping me, and you, the reader. Do you know what the 
      <CODE><SPAN class=code-string>"</SPAN><SPAN 
      class=code-string>gcroot"</SPAN></CODE> template does? No? Nevermind 
      then:) In .NET BCL classes, we have something which is very similiar to a 
      priority queue -- that's the <CODE>SortedList</CODE> class in 
      <CODE>System::Collections</CODE>. Because it can store any <CODE><SPAN 
      class=code-SDKkeyword>Object</SPAN></CODE>-based instances, we could put 
      <CODE>ArrayList</CODE> references in it to simulate a priority queue that 
      stores multiple elements with the same key. There's also a 
      <CODE>Hashtable</CODE> to help us solve certain problems, but we'll get to 
      it in a minute. Meanwhile, keep reading to understand why I need these 
      data structures in the first place. </P>
      <P>Machine loads do not enter the machine loads collection by name, i.e. 
      they are added to the loads collection with the key, being the machine's 
      load. That's why before each machine reports its load, it converts the 
      latter to unsigned long and then transmits it over the wire to LMS. It 
      helps restricting the number of stored loads, e.g. if machine A has a load 
      of 20.1, and machine B has a load of 20.2, then the collection considers 
      the loads as equal. When LMS "gets" the load, it adds it in the 
      <CODE>SortedList</CODE>, i.e. if we have three machines -- "A", "B", and 
      "C" with loads 40, 20 and 30, then the <CODE>SortedList</CODE> looks like: 
      </P><PRE lang=text><B:20>[C:30][A:40]
</PRE>
      <P>If anyone asks for the fastest machine, we always return the 1st 
      positional element in the sorted list, (because it is sorted in ascending 
      order). </P>
      <P>Well, I'd like it to be so simple, but it isn't. What happens when a 
      4th machine, "D" reports a load 20? You should have guessed by now why I 
      need to store an <CODE>ArrayList</CODE> for each load, so here is it in 
      action -- it stored the loads of machines B and D: </P><PRE lang=text>[D:20]
<B:20>[C:30][A:40]
</PRE>
      <P>Now, if anyone asks for the fastest machine, we will return the first 
      element of the <CODE>ArrayLis</CODE>t, that is stored in the first element 
      of the <CODE>SortedList</CODE>, right? It is machine "B". </P>
      <P>But then what happens when machine "B" reports another load, equal to 
      40? Shall we leave the first reported load? Of course, not! Otherwise, we 
      will return "B" as the fastest machine, where "D" would be the one with 
      the least load. So we should remove machine "B"'s older load from the 
      first <CODE>ArrayList</CODE> and insert its new load, wherever is 
      appropriate. Here's the data structure then: </P><PRE lang=text>            <B:40>
[D:20][C:30][A:40]
</PRE>
      <P>Now how did you find machine "B"'s older load in order to remove it? 
      Eh? I guess with your eyes. Here's where we need that 
      <CODE>Hashtable</CODE> I mentioned above. It is a mapping between a 
      machine's older load and the list it resides in currently. So when we add 
      a machine load, we first check whether the machine has reported a load 
      before, and if it did, we find the <CODE>ArrayList</CODE>, where the old 
      load was placed, remove it from the list, and add the new load to a new 
      list, right? Wrong. We have one more thing to do, but first let me show 
      you the problem, and you'll guess what else I've done to make the 
      collection work as expected. </P>
      <P>Imagine that machine "D" reports a new load -- 45. Now you'll say that 
      the data now looks like the one below: </P><PRE lang=text>      <B:40>
[C:30][A:40][D:45]
</PRE>
      <P>You wish it looks like this! But that's because I made a mistake when I 
      was trying to visualize the first loads. Actually the previous loads 
      collection looked like this: </P><PRE lang=text>^
|
M
A
C       .   .   .   .
H       .   .   .   .
I       .   .   .   .
N       .   .   .   .
E       .   .   B   .
S       D   C   A   .

LOAD    20  30  40  .   .   .   --&gt;
</PRE>
      <P>So you now will agree, that the collection actually looks like this: 
      </P><PRE lang=text>^
|
M
A
C       .   .   .   .
H       .   .   .   .
I       .   .   .   .
N       .   .   .   .
E       .   .   B   .
S       .   C   A   D

LOAD    20  30  40  45  .   .   --&gt;
</PRE>
      <P>Yes, the first list is empty, and when a request to find the least 
      loaded machine comes and you try to pop up the first element of the 
      <CODE>ArrayList</CODE> for load 20 (which is the least load), you'll get 
      <CODE>IndexOutOfRangeException</CODE>, as I got it a couple of times 
      before I debugged to understand what was happenning. So when we remove an 
      old load from an <CODE>ArrayList</CODE>, we should check whether it has 
      orphaned (is now empty), and if this is the case, we should remove the 
      <CODE>ArrayList</CODE> from the <CODE>SortedList</CODE> as well. </P>
      <P>Here's the code for the <CODE>Add</CODE> method:</P><PRE lang=mc++><SPAN class=code-keyword>void</SPAN> MachineLoadsCollection::Add (MachineLoad <SPAN class=code-keyword>__gc</SPAN>* machineLoad)
{
    DEBUG_ASSERT (<SPAN class=code-digit>0</SPAN> != machineLoad);
    <SPAN class=code-keyword>if</SPAN> (<SPAN class=code-digit>0</SPAN> == machineLoad)
        <SPAN class=code-keyword>return</SPAN>;

    <SPAN class=code-SDKkeyword>String</SPAN> <SPAN class=code-keyword>__gc</SPAN>* name = machineLoad-<SPAN class=code-keyword>&gt;</SPAN>Name;
    <SPAN class=code-keyword>double</SPAN> load = machineLoad-<SPAN class=code-keyword>&gt;</SPAN>Load;
    <SPAN class=code-SDKkeyword>Object</SPAN> <SPAN class=code-keyword>__gc</SPAN>* boxedLoad = <SPAN class=code-keyword>__box</SPAN> (load);

    rwLock-<SPAN class=code-keyword>&gt;</SPAN>AcquireWriterLock (Timeout::Infinite);

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> a list of all machines that have reported this particular
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> load value
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    ArrayList <SPAN class=code-keyword>__gc</SPAN>* loadList = <SPAN class=code-digit>0</SPAN>;

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> check whether any machine has reported such a load
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    <SPAN class=code-keyword>if</SPAN> (!loads-<SPAN class=code-keyword>&gt;</SPAN>ContainsKey (boxedLoad))
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> no, this is the first load with this value - create new list
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> and add the list to the main loads (sorted) list
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        loadList = <SPAN class=code-keyword>new</SPAN> ArrayList ();
        loads-<SPAN class=code-keyword>&gt;</SPAN>Add (boxedLoad, loadList);
    }
    <SPAN class=code-keyword>else</SPAN>
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> yes, one or more machines reported the same load already
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        loadList = <SPAN class=code-keyword>static_cast</SPAN><SPAN class=code-keyword>&lt;</SPAN>ArrayList <SPAN class=code-keyword>__gc</SPAN>*<SPAN class=code-keyword>&gt;</SPAN> (loads-<SPAN class=code-keyword>&gt;</SPAN>get_Item (boxedLoad));
    }

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> check if this machine has already reported a load previously
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    <SPAN class=code-keyword>if</SPAN> (!mappings-<SPAN class=code-keyword>&gt;</SPAN>ContainsKey (name))
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> no, the machine is reporting for the first time
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> insert the element and add the machine to the mappings
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        loadList-<SPAN class=code-keyword>&gt;</SPAN>Add (machineLoad);
        mappings-<SPAN class=code-keyword>&gt;</SPAN>Add (name, <SPAN class=code-keyword>new</SPAN> LoadMapping (machineLoad, loadList));
    }
    <SPAN class=code-keyword>else</SPAN>
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> yes, the machine has reported its load before
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> we should remove the old load; get its mapping
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        LoadMapping <SPAN class=code-keyword>__gc</SPAN>* mappedLoad =
            <SPAN class=code-keyword>static_cast</SPAN><SPAN class=code-keyword>&lt;</SPAN>LoadMapping <SPAN class=code-keyword>__gc</SPAN>*<SPAN class=code-keyword>&gt;</SPAN> (mappings-<SPAN class=code-keyword>&gt;</SPAN>get_Item (name));

        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get the old load, and the list we should remove it from
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        MachineLoad <SPAN class=code-keyword>__gc</SPAN>* oldLoad = mappedLoad-<SPAN class=code-keyword>&gt;</SPAN>Load;
        ArrayList <SPAN class=code-keyword>__gc</SPAN>* oldList = mappedLoad-<SPAN class=code-keyword>&gt;</SPAN>LoadList;

        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> remove the old mapping
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        mappings-<SPAN class=code-keyword>&gt;</SPAN>Remove (name);

        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> remove the old load from the old list
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        <SPAN class=code-keyword>int</SPAN> index = oldList-<SPAN class=code-keyword>&gt;</SPAN>IndexOf (oldLoad);
        oldList-<SPAN class=code-keyword>&gt;</SPAN>RemoveAt (index);

        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> insert the new load into the new list
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        loadList-<SPAN class=code-keyword>&gt;</SPAN>Add (machineLoad);

        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> update the mappings
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        mappings-<SPAN class=code-keyword>&gt;</SPAN>Add (name, <SPAN class=code-keyword>new</SPAN> LoadMapping (machineLoad, loadList));

        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> finally, check if the old load list is totally empty
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> and if so, remove it from the main (sorted) list
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        <SPAN class=code-keyword>if</SPAN> (oldList-<SPAN class=code-keyword>&gt;</SPAN>Count == <SPAN class=code-digit>0</SPAN>)
            loads-<SPAN class=code-keyword>&gt;</SPAN>Remove (<SPAN class=code-keyword>__box</SPAN> (oldLoad-<SPAN class=code-keyword>&gt;</SPAN>Load));
    }

    rwLock-<SPAN class=code-keyword>&gt;</SPAN>ReleaseWriterLock ();
}
</PRE>
      <P>Now, for the curious, here's the <CODE>get_MinimumLoad</CODE> 
      property's code:</P><PRE lang=mc++>MachineLoad <SPAN class=code-keyword>__gc</SPAN>* MachineLoadsCollection::get_MinimumLoad ()
{
    MachineLoad <SPAN class=code-keyword>__gc</SPAN>* load = <SPAN class=code-digit>0</SPAN>;

    rwLock-<SPAN class=code-keyword>&gt;</SPAN>AcquireReaderLock (Timeout::Infinite);

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if the collection is empty, no machine has reported
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> its machineLoad, so we return "null"
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    <SPAN class=code-keyword>if</SPAN> (loads-<SPAN class=code-keyword>&gt;</SPAN>Count <SPAN class=code-keyword>&gt;</SPAN> <SPAN class=code-digit>0</SPAN>)
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> the 1st element should contain one of the least
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> loaded machines -- they all have the same load
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> in this list
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        ArrayList <SPAN class=code-keyword>__gc</SPAN>* minLoadedMachines =
            <SPAN class=code-keyword>static_cast</SPAN><SPAN class=code-keyword>&lt;</SPAN>ArrayList <SPAN class=code-keyword>__gc</SPAN>*<SPAN class=code-keyword>&gt;</SPAN> (loads-<SPAN class=code-keyword>&gt;</SPAN>GetByIndex (<SPAN class=code-digit>0</SPAN>));
        load = <SPAN class=code-keyword>static_cast</SPAN><SPAN class=code-keyword>&lt;</SPAN>MachineLoad <SPAN class=code-keyword>__gc</SPAN>*<SPAN class=code-keyword>&gt;</SPAN> (minLoadedMachines-<SPAN class=code-keyword>&gt;</SPAN>get_Item (<SPAN class=code-digit>0</SPAN>));
    }

    rwLock-<SPAN class=code-keyword>&gt;</SPAN>ReleaseReaderLock ();

    <SPAN class=code-keyword>return</SPAN> (load);
}
</PRE>
      <P>Well, that's prety much about how the 
      <CODE>MachineLoadsCollection</CODE> class works in order to store the 
      machine loads, and return the least loaded machine. Now we will see what 
      else is cool about this class. I called it the Grim Reaper, and that's 
      what it is -- a method, named <CODE>GrimReaper</CODE> (GR), that runs 
      asynchronously (using a <CODE>Timer</CODE> class) and kills dead 
      machines!:) Seriously, GR knows the interval at which each machine, once 
      reported a load, should report it again. If a machine fails to report its 
      load in a timely manner it is removed from the 
      <CODE>MachineLoadsCollection</CODE> container. In this way, we guarantee 
      that a machine, that is now dead (or is disconnected from the network) 
      will not be returned as the fastest machine, at least not before it 
      reports again (it is brought back to the load balancing then). However, in 
      only about 30 lines of code, I managed to made two mistakes in the GR 
      code. The first one was very lame -- I was trying to remove an element 
      from a hash table while I was iterating over its elements, but the second 
      was a real bich! However, I found it quite quickly, because I love console 
      applications:) I was outputting a start (*) when GR was executing, and a 
      caret (^) when it was killing a machine. I then observed that even if the 
      (only) machine was reporting regularly its load, at some time, GR was 
      killing it! I was staring at the console at least for 3 minutes. The GR 
      code was simple, and I thought that there's no chance to make a mistake 
      there. I was wrong. It occured to me that I wasn't considering the fact, 
      that the GR code takes some time to execute. It was running fast enough, 
      but it was taking <B>some</B> interval of time. Well, during that time, GR 
      was locking the machine loads collection. And while the collection was 
      locked, the collector worker was blocked, waiting for the collection to be 
      unlocked, so it can enter the newly received load ther. So when the 
      collection was finally unlocked at the end of the GR code, the collector 
      entered the machine's load. You can guess what happens when the GR is 
      configured to run in shorter intervals and the machines report in longer 
      intervals. GR locks, and locks and locks, while the collector blocks, and 
      blocks and blocks, until a machine is delayed by the GR itself. However, 
      because GR is oblivious to the outer world, it thinks that the machine is 
      a dead one, so it removes the machine from the load balancing, until the 
      next time it reports a brand new load. My solution for this issue? I have 
      it in my head, but I'll implement it in the next version of the article, 
      because I really ran out of time. (I couldn't post the article for the 
      November's contest, because I couldn't finish this text in time. It looks 
      that writing text in plain English is more difficult than writing Managed 
      C++ code, and I don't want to miss December's contest too:) </P>
      <P>If anyone is interested, here is Grim Reaper's code:</P><PRE lang=mc++><SPAN class=code-keyword>void</SPAN> MachineLoadsCollection::GrimReaper (<SPAN class=code-SDKkeyword>Object</SPAN> <SPAN class=code-keyword>__gc</SPAN>* state)
{
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get the state we need to continue
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    MachineLoadsCollection <SPAN class=code-keyword>__gc</SPAN>* mlc = <SPAN class=code-keyword>static_cast</SPAN><SPAN class=code-keyword>&lt;</SPAN>MachineLoadsCollection <SPAN class=code-keyword>__gc</SPAN>*<SPAN class=code-keyword>&gt;</SPAN> (state);
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> temporarily suspend the timer
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    mlc-<SPAN class=code-keyword>&gt;</SPAN>grimReaper-<SPAN class=code-keyword>&gt;</SPAN>Change (Timeout::Infinite, Timeout::Infinite);
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> check if we are forced to stop
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    <SPAN class=code-keyword>if</SPAN> (!mlc-<SPAN class=code-keyword>&gt;</SPAN>keepGrimReaperAlive)
        <SPAN class=code-keyword>return</SPAN>;
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get the rest of the fields to do our work
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    ReaderWriterLock <SPAN class=code-keyword>__gc</SPAN>* rwLock = mlc-<SPAN class=code-keyword>&gt;</SPAN>rwLock;
    SortedList <SPAN class=code-keyword>__gc</SPAN>* loads = mlc-<SPAN class=code-keyword>&gt;</SPAN>loads;
    Hashtable <SPAN class=code-keyword>__gc</SPAN>* mappings = mlc-<SPAN class=code-keyword>&gt;</SPAN>mappings;
    <SPAN class=code-keyword>int</SPAN> reportTimeout = mlc-<SPAN class=code-keyword>&gt;</SPAN>reportTimeout;

    rwLock-<SPAN class=code-keyword>&gt;</SPAN>AcquireWriterLock (Timeout::Infinite);

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Bring out the dead :)
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> enumerating via an IDictionaryEnumerator, we can't delete
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> elements from the hashtable mappings; so we create a temporary
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> list of machines for deletion, and delete them after we have
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> finished with the enumeration
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    StringCollection <SPAN class=code-keyword>__gc</SPAN>* deadMachines = <SPAN class=code-keyword>new</SPAN> StringCollection ();

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> walk the mappings to get all machines
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    DateTime dtNow = DateTime::Now;
    IDictionaryEnumerator <SPAN class=code-keyword>__gc</SPAN>* dic = mappings-<SPAN class=code-keyword>&gt;</SPAN>GetEnumerator ();
    <SPAN class=code-keyword>while</SPAN> (dic-<SPAN class=code-keyword>&gt;</SPAN>MoveNext ())
    {
        LoadMapping <SPAN class=code-keyword>__gc</SPAN>* map = <SPAN class=code-keyword>static_cast</SPAN><SPAN class=code-keyword>&lt;</SPAN>LoadMapping <SPAN class=code-keyword>__gc</SPAN>*<SPAN class=code-keyword>&gt;</SPAN> (dic-<SPAN class=code-keyword>&gt;</SPAN>Value);
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> check whether the dead timeout has expired for this machine
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        TimeSpan tsDifference = dtNow.Subtract (map-<SPAN class=code-keyword>&gt;</SPAN>LastReport);
        <SPAN class=code-keyword>double</SPAN> difference = tsDifference.TotalMilliseconds;
        <SPAN class=code-keyword>if</SPAN> (difference <SPAN class=code-keyword>&gt;</SPAN> (<SPAN class=code-keyword>double</SPAN>) reportTimeout)
        {
            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> remove the machine from the data structures; it is
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> now considered dead and does not participate anymore
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> in the load balancing, unless it reports its load
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> at some later time
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>            <SPAN class=code-SDKkeyword>String</SPAN> <SPAN class=code-keyword>__gc</SPAN>* name = map-<SPAN class=code-keyword>&gt;</SPAN>Load-<SPAN class=code-keyword>&gt;</SPAN>Name;

            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get the old load, and the list we should remove it from
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>            MachineLoad <SPAN class=code-keyword>__gc</SPAN>* oldLoad = map-<SPAN class=code-keyword>&gt;</SPAN>Load;
            ArrayList <SPAN class=code-keyword>__gc</SPAN>* oldList = map-<SPAN class=code-keyword>&gt;</SPAN>LoadList;

            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> remove the old mapping (only add it to the deletion list)
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>            deadMachines-<SPAN class=code-keyword>&gt;</SPAN>Add (name);

            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> remove the old load from the old list
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>            <SPAN class=code-keyword>int</SPAN> index = oldList-<SPAN class=code-keyword>&gt;</SPAN>IndexOf (oldLoad);
            oldList-<SPAN class=code-keyword>&gt;</SPAN>RemoveAt (index);

            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> finally, check if the old load list is totally empty
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> and if so, remove it from the main list
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>            <SPAN class=code-keyword>if</SPAN> (oldList-<SPAN class=code-keyword>&gt;</SPAN>Count == <SPAN class=code-digit>0</SPAN>)
                loads-<SPAN class=code-keyword>&gt;</SPAN>Remove (<SPAN class=code-keyword>__box</SPAN> (oldLoad-<SPAN class=code-keyword>&gt;</SPAN>Load));
        }
    }

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> actually remove the dead machines from the mappings
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    <SPAN class=code-keyword>for</SPAN> (<SPAN class=code-keyword>int</SPAN> i=0; i<SPAN class=code-keyword>&lt;</SPAN>deadMachines-<SPAN class=code-keyword>&gt;</SPAN>Count; i++)
        mappings-<SPAN class=code-keyword>&gt;</SPAN>Remove (deadMachines-<SPAN class=code-keyword>&gt;</SPAN>get_Item (i));

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> cleanup
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    deadMachines-<SPAN class=code-keyword>&gt;</SPAN>Clear ();

    rwLock-<SPAN class=code-keyword>&gt;</SPAN>ReleaseWriterLock ();

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> resume the timer
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    mlc-<SPAN class=code-keyword>&gt;</SPAN>grimReaper-<SPAN class=code-keyword>&gt;</SPAN>Change (reportTimeout, reportTimeout);
}
</PRE>
      <H2>Load Balancing in Action - Balancing a Web Farm <A 
      name=inaction></A></H2>
      <P>I've built a super simple .NET Web application (in C#), that uses LBL 
      to perform a load balancing in a web farm. Though the application is very 
      little, it is interesting and deserves some space in this article, so here 
      we go. First, I've written a class that wraps the load balancing class 
      <CODE>ClientLoadBalancer</CODE> from LBL, named it <CODE>Helper</CODE>, 
      and implemented it as a singleton so the <CODE>Global</CODE> class of the 
      web application and the web page classes could see one instance of it. 
      Then I used it in the <CODE>Session_OnStart</CODE> method of the 
      <CODE>Global</CODE> class to redirect every new session's first HTTP 
      request to the most available machine. Furthermore, in the sample web 
      page, I've used it again to dynamically build URLs for further processing, 
      replacing the local host again with the fastest machine. Now one may argue 
      (and he might be right) that a user can spend a lot of time reading that 
      page, so when he eventually clicks on the "faster" link, the previously 
      faster machine could not be the fastest one at that time. Just don't 
      forget that hitting another machine's web application will cause its 
      <CODE>Session_OnStart</CODE> trigger again, so anyway, the user will be 
      redirected to the fastest machine. Now, if you don't get what am I talking 
      about, that's because I haven't shown any code yet. So here it its: </P><PRE lang=c#><SPAN class=code-keyword>protected</SPAN> <SPAN class=code-keyword>void</SPAN> Session_Start (<SPAN class=code-keyword>object</SPAN> sender, EventArgs e)
{
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get the fastest machine from the load balancer
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    <SPAN class=code-keyword>string</SPAN> fastestMachineName = Helper.Instance.GetFastestMachineName ();

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> we should check whether the fastest machine is not the machine,
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> this web application is running on, as then there'll be no sence
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> to redirect the request
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    <SPAN class=code-keyword>string</SPAN> thisMachineName = Environment.MachineName;
    <SPAN class=code-keyword>if</SPAN> (<SPAN class=code-SDKkeyword>String</SPAN>.Compare (thisMachineName, fastestMachineName, <SPAN class=code-keyword>false</SPAN>) != <SPAN class=code-digit>0</SPAN>)
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> it is another machine and we should redirect the request
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        <SPAN class=code-keyword>string</SPAN> fasterUrl = Helper.Instance.ReplaceHostInUrl (
            Request.Url.ToString (),
            fastestMachineName);
        Response.Redirect (fasterUrl);
    }
}
</PRE>
      <P>And here's the code in the sample web page: </P><PRE lang=c#><SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>void</SPAN> OnPageLoad (<SPAN class=code-keyword>object</SPAN> sender, EventArgs e)
{
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get the fastest machine and generate the new links with it
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    <SPAN class=code-keyword>string</SPAN> fastestMachineName = Helper.Instance.GetFastestMachineName ();
    link.Text = <SPAN class=code-SDKkeyword>String</SPAN>.Format (
        <SPAN class=code-string>"</SPAN><SPAN class=code-string>Next request will be processed by machine '{0}'"</SPAN>,
        fastestMachineName);
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> navigate to the same URL, but the host being the fastest machine
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    link.NavigateUrl = Helper.Instance.ReplaceHostInUrl (
        Request.Url.ToString (),
        fastestMachineName);
}
</PRE>
      <P>If you think that I hardcoded the settings in the <CODE>Helper</CODE> 
      class, you are wrong. First, I hate hardcoded or magic values in my code 
      (though you may see some in an article like this). Second, I was testing 
      the solution on my coleagues' computers, so writing several lines of code 
      in advance, helped me to avoid the inevitable otherwise re-compilations. I 
      just deployed the web application there. Here's the trivial C# code of the 
      <CODE>Helper</CODE> class (note that I have hardcoded the keys in 
      <CODE>Web.config</CODE> file ;-) </P><PRE lang=c#><SPAN class=code-keyword>class</SPAN> Helper
{
    <SPAN class=code-keyword>private</SPAN> Helper ()
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> assume failure(s)
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        loadBalancer = <SPAN class=code-keyword>null</SPAN>;
        <SPAN class=code-keyword>try</SPAN>
        {
            NameValueCollection settings = ConfigurationSettings.AppSettings;

            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> assume that MLMS is running on our machine and the web app
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> is configured to create its remoted object using the defaults;
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> if the user has configured another machine in the Web.config
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> running MLMS, try to get its settings and create the remoted
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> object on it
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>            <SPAN class=code-keyword>string</SPAN> machine = Environment.MachineName;
            <SPAN class=code-keyword>int</SPAN> port = <SPAN class=code-digit>14000</SPAN>;
            RemotingProtocol protocol = RemotingProtocol.TCP;

            <SPAN class=code-keyword>string</SPAN> machineName = settings [<SPAN class=code-string>"</SPAN><SPAN class=code-string>LoadBalancingMachine"</SPAN>];
            <SPAN class=code-keyword>if</SPAN> (machineName != <SPAN class=code-keyword>null</SPAN>)
                machine = machineName;

            <SPAN class=code-keyword>string</SPAN> machinePort = settings [<SPAN class=code-string>"</SPAN><SPAN class=code-string>LoadBalancingPort"</SPAN>];
            <SPAN class=code-keyword>if</SPAN> (machinePort != <SPAN class=code-keyword>null</SPAN>)
            {
                <SPAN class=code-keyword>try</SPAN>
                {
                    port = <SPAN class=code-keyword>int</SPAN>.Parse (machinePort);
                }
                <SPAN class=code-keyword>catch</SPAN> (FormatException)
                {
                }
            }

            <SPAN class=code-keyword>string</SPAN> machineProto = settings [<SPAN class=code-string>"</SPAN><SPAN class=code-string>LoadBalancingProtocol"</SPAN>];
            <SPAN class=code-keyword>if</SPAN> (machineProto != <SPAN class=code-keyword>null</SPAN>)
            {
                <SPAN class=code-keyword>try</SPAN>
                {
                    protocol = (RemotingProtocol) Enum.Parse (
                        <SPAN class=code-keyword>typeof</SPAN> (RemotingProtocol),
                        machineProto,
                        <SPAN class=code-keyword>true</SPAN>);
                }
                <SPAN class=code-keyword>catch</SPAN> (ArgumentException)
                {
                }
            }

            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> create a proxy to the remoted object
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>            loadBalancer = <SPAN class=code-keyword>new</SPAN> ClientLoadBalancer (
                machine,
                protocol,
                port);
        }
        <SPAN class=code-keyword>catch</SPAN> (Exception e)
        {
            <SPAN class=code-keyword>if</SPAN> (e <SPAN class=code-keyword>is</SPAN> OutOfMemoryException || e <SPAN class=code-keyword>is</SPAN> ExecutionEngineException)
                <SPAN class=code-keyword>throw</SPAN>;
        }
    }

    <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>string</SPAN> GetFastestMachineName ()
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> assume that the load balancing could not be created or it will fail
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        <SPAN class=code-keyword>string</SPAN> fastestMachineName = Environment.MachineName;
        <SPAN class=code-keyword>if</SPAN> (loadBalancer != <SPAN class=code-keyword>null</SPAN>)
        {
            MachineLoad load = loadBalancer.GetLeastMachineLoad ();
            <SPAN class=code-keyword>if</SPAN> (load != <SPAN class=code-keyword>null</SPAN>)
                fastestMachineName = load.Name;
        }
        <SPAN class=code-keyword>return</SPAN> (fastestMachineName);
    }

    <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>string</SPAN> ReplaceHostInUrl (<SPAN class=code-keyword>string</SPAN> url, <SPAN class=code-keyword>string</SPAN> newHost)
    {
        Uri uri = <SPAN class=code-keyword>new</SPAN> Uri (url);
        <SPAN class=code-keyword>bool</SPAN> hasUserInfo = uri.UserInfo.Length &gt; <SPAN class=code-digit>0</SPAN>;
        <SPAN class=code-keyword>string</SPAN> credentials = hasUserInfo ? uri.UserInfo : <SPAN class=code-string>"</SPAN><SPAN class=code-string>"</SPAN>;
        <SPAN class=code-keyword>string</SPAN> newUrl = <SPAN class=code-SDKkeyword>String</SPAN>.Format (
            <SPAN class=code-string>"</SPAN><SPAN class=code-string>{0}{1}{2}{3}:{4}{5}"</SPAN>,
            uri.Scheme,
            Uri.SchemeDelimiter,
            credentials,
            newHost,
            uri.Port,
            uri.PathAndQuery);
        <SPAN class=code-keyword>return</SPAN> (newUrl);
    }

    <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>static</SPAN> Helper Instance
    {
        <SPAN class=code-keyword>get</SPAN> { <SPAN class=code-keyword>return</SPAN> (instance); }
    }

    <SPAN class=code-keyword>private</SPAN> ClientLoadBalancer loadBalancer;
    <SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>static</SPAN> Helper instance = <SPAN class=code-keyword>new</SPAN> Helper ();
} <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Helper
</SPAN></PRE>
      <P>If you wonder how the servers look like when running, and what a great 
      look and feel I've designed for the web application, here's a screenshot 
      to disappoint you:) </P>
      <DIV align=center><IMG height=507 hspace=0 
      src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/InAction.png" 
      width=600 border=0> </DIV>
      <H2>Building, Configuring and Deploying the Solution <A name=bcd></A></H2>
      <P>There's a little trick you need to do, in order to load the solution 
      file. Open your IIS administration console (Start/Run... type 
      <CODE>inetmgr</CODE>) and create a new virtual directory 
      <CODE>LoadBalancingWebTest</CODE>. when you're asked about the folder, 
      choose <CODE>X:\Path\To\SolutionFolder\LoadBalancingWebTest</CODE>. You 
      can now open the solution file (<CODE>SoftwareLoadBalancing.sln</CODE>) 
      with no problems. Load it in Visual Studio .NET, build the 
      <CODE>SharedLibrary</CODE> project first, as the others depend on it, then 
      build LML and LRS, and then the whole solution. Note that the setup 
      projects won't build automatically so you should select and build them 
      manually. </P>
      <P><I><B>Note:</B> </I>When you compile the solution, you will get 15 
      warnings. All of them state: <CODE>warning C4935: assembly access 
      specifier modified from <SPAN class=code-string>'</SPAN><SPAN 
      class=code-string>xxx'</SPAN></CODE>, where <CODE>xxx</CODE> could be 
      <CODE><SPAN class=code-keyword>private</SPAN></CODE> or <CODE><SPAN 
      class=code-keyword>public</SPAN></CODE>. I don't know how to make the 
      compiler stop complaining about this. There are no other warnings at level 
      4. Sorry if these embarass you. </P>
      <P>That's it if you have VS.NET. If you don't, you can compile only the 
      web application, as it is written in C# and can be compiled with the free 
      C# compiler, coming with the .NET framework. Otherwise, buy a copy of 
      VS.NET, and become a CodeProject (and Microsoft) supporter :) BTW, I 
      realized right now, that I should write my next articles in C#, so the 
      "poor" guys like me can have some fun too. I'm sorry guys! I promise to 
      use C# in most of the next articles I attempt to write. </P>
      <H3>Configuration<A name=configuration> </A></H3>
      <P>If you look at the <CODE>Common.h</CODE> header, located in the 
      <CODE>SharedFiles</CODE> folder in the solution, you'll notice that I've 
      copied and pasted the meaning of all configuration keys from that file. 
      However, because I know you won't look at it until you've liked the 
      article (and it's high time do so, as it is comming to its end:), here's 
      the explanation of the XML configuration file, and various macros in 
      <CODE>Common.h</CODE>. </P>
      <H4>What's so common in Common.h? <A name=common_h></A></H4>
      <P>This header file is used by almost all projects in the solution. It has 
      several (helpful) macros I'm about to discuss, so if you're in the mood to 
      read about them, go ahead. Otherwise, <A 
      href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#tweak">click 
      here</A> to read only about the XML configuration file. </P>
      <P>First, I'm going to discuss the .NET member access modifiers. There are 
      5 of them, though you may use only four of them, unless you are writing IL 
      code. Existing languages refer to them in a different way, so I'll give 
      you a comparison table of their names and some explanations. </P>
      <TABLE cellSpacing=1 cellPadding=2 border=0>
        <TBODY>
        <TR vAlign=top>
          <TH>.NET term</TH>
          <TH>C# keyword(s)</TH>
          <TH>MC++ keyword(s)</TH>
          <TH>Explanation</TH></TR>
        <TR vAlign=top>
          <TD>private</TD>
          <TD>private</TD>
          <TD>private private</TD>
          <TD>the member is visible only in the class, it is defined in, and 
            is not visible from other assemblies; note the double use of the 
            <CODE><SPAN class=code-keyword>private</SPAN></CODE> keyword in MC++ 
            -- the first one (in this table) specifies whether the member is 
            visible from other assemblies, and the other specifies whether the 
            member is visible from other classes within the same assembly.</TD></TR>
        <TR class=altrow vAlign=top>
          <TD>public</TD>
          <TD>public</TD>
          <TD>public public</TD>
          <TD>visible from all assemblies and classes</TD></TR>
        <TR vAlign=top>
          <TD>family</TD>
          <TD>protected</TD>
          <TD>public protected</TD>
          <TD>visible from all assemblies, but can be used only from derived 
            classes</TD></TR>
        <TR class=altrow vAlign=top>
          <TD>family and assembly</TD>
          <TD>internal</TD>
          <TD>private public</TD>
          <TD>visible from all classes withing the assembly, but not visible 
            to external assemblies</TD></TR></TBODY></TABLE>
      <P>Because I like most the C# keywords, I <CODE><SPAN 
      class=code-preprocessor>#define</SPAN></CODE>d and used thoughout the code 
      four macros to avoid typing the double keywords in MC++: 
      <P><PRE code="mc++"><SPAN class=code-preprocessor>#define</SPAN> PUBLIC      <SPAN class=code-keyword>public</SPAN>  <SPAN class=code-keyword>public</SPAN>
<SPAN class=code-preprocessor>#define</SPAN> PRIVATE     <SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>private</SPAN>
<SPAN class=code-preprocessor>#define</SPAN> PROTECTED   <SPAN class=code-keyword>public</SPAN>  <SPAN class=code-keyword>protected</SPAN>
<SPAN class=code-preprocessor>#define</SPAN> INTERNAL    <SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>public</SPAN>
</PRE>
      <P>Here comes the more interesting "stuff". You have three options for 
      communication between a load reporting and monitoring servers: via UDP + 
      multicasting, UDP-only, or TCP. BTW, if I was writing the article in C#, 
      you wouldn't have them. Really! C# is so lame in preprocessing, and the 
      compiler writers were so wrong that they did not include some real 
      preprocessing capabilities in the compiler, that I have no words! 
      Nevertheless, I wrote the article in MC++, so I have the cool <CODE><SPAN 
      class=code-preprocessor>#define</SPAN></CODE> directives I needed so 
      badly, when I started to write the communication code of the classes. 
      There are two macros you can play with, to make the solution use one 
      communication protocol or another, and/or disable/enable multicasting. 
      Here are their definitions: </P><PRE lang=mc++><SPAN class=code-preprocessor>#define</SPAN> USING_UDP           <SPAN class=code-digit>1</SPAN>
<SPAN class=code-preprocessor>#define</SPAN> USING_MULTICASTS    <SPAN class=code-digit>1</SPAN>
</PRE>
      <P>Now, a C# guru:) will argue that I could still write the 
      protocol-independent code with several pairs of <CODE>#ifdef</CODE> and 
      <CODE><SPAN class=code-preprocessor>#endif</SPAN></CODE> directives. To 
      tell you the truth, I'm not a fan of this coding style. I'd rather define 
      a generic macro in such an <CODE><SPAN 
      class=code-preprocessor>#if</SPAN></CODE> block, and use it everywhere I 
      need it. So that's what I did. I've written macros that create TCP or UDP 
      sockets, connect to remote endpoints, and send and receive data via UDP 
      and TCP. Then I wrote several generic macros that follow the pattern 
      below: </P><PRE lang=mc++><SPAN class=code-preprocessor>#if</SPAN> defined(USING_UDP)
#   define SOCKET_CREATE(sock) SOCKET_CREATE_UDP(sock)
<SPAN class=code-preprocessor>#else</SPAN>
#   define SOCKET_CREATE(sock) SOCKET_CREATE_TCP(sock)
<SPAN class=code-preprocessor>#endif</SPAN>
</PRE>
      <P>You get the idea, right? No <CODE>#ifdef</CODE>s inside the real code. 
      I just write <CODE>SOCKET_CREATE (socket);</CODE> and the preprocessor 
      generates the code to create the appropriate socket. Here's another good 
      macro, I use for exception handling, but before that I'll give you some 
      rules (you probably know) about .NET exception handling: </P>
      <UL>
        <LI>Catch only the exceptions you can handle, and no more. This means 
        that if you expect the method you're calling to throw 
        <CODE>ArgumentNullException</CODE> and/or 
        <CODE>ArgumentOutOfRangeException</CODE>, you should write two catch 
        clauses and catch only these exceptions. 
        <LI>Another rule is to <B>never</B> "swallow" an exception you caught, 
        but cannot handle. You <B>must</B> re-throw it, so the caller of 
        <B>your</B> method knows why it failed. 
        <LI>This one relates to the 2nd rule: there are 2 exceptions you can do 
        nothing about but report them to the user and die: these are the 
        <CODE>OutOfMemoryException</CODE>, and 
        <CODE>ExecutionEngineException</CODE>. I don't know which one is worse 
        -- probably the latter, though if you're out of memory, there's almost 
        nothing you can do about it. </LI></UL>
      <P>Because I'm not writing production code here, I allowed myself to catch 
      (in most of the source code) <B>all</B> possible exceptions, when I don't 
      need to handle them except to know that something went bad. So I catch the 
      base class <CODE>Exception</CODE>. This violates all rules, I've written 
      above, but I wrote some code to fit into the second and third one -- if I 
      catch an <CODE>OutOfMemoryException</CODE> or 
      <CODE>ExecutionEngineException</CODE>, I re-throw it immediately. Here's 
      the macro I call, after I catch the generic <CODE>Exception</CODE> class: 
      </P><PRE lang=mc++><SPAN class=code-preprocessor>#define</SPAN> TRACE_EXCEPTION_AND_RETHROW_IF_NEEDED(e)        \
    System::Type <SPAN class=code-keyword>__gc</SPAN>* exType = e-<SPAN class=code-keyword>&gt;</SPAN>GetType ();          \
    <SPAN class=code-keyword>if</SPAN> (exType == __typeof (OutOfMemoryException) ||    \
        exType == __typeof (ExecutionEngineException))  \
        <SPAN class=code-keyword>throw</SPAN>;                                          \
    Console::WriteLine (                                \
        S<SPAN class=code-string>"</SPAN><SPAN class=code-string>\n{0}\n{1} ({2}/{3}): {4}\n{0}"</SPAN>,              \
        <SPAN class=code-keyword>new</SPAN> <SPAN class=code-SDKkeyword>String</SPAN> (L<SPAN class=code-string>'</SPAN><SPAN class=code-string>-'</SPAN>, <SPAN class=code-digit>79</SPAN>),                          \
        <SPAN class=code-keyword>new</SPAN> <SPAN class=code-SDKkeyword>String</SPAN> ((<SPAN class=code-keyword>char</SPAN> *) __FUNCTION__),             \
        <SPAN class=code-keyword>new</SPAN> <SPAN class=code-SDKkeyword>String</SPAN> ((<SPAN class=code-keyword>char</SPAN> *) __FILE__),                 \
        <SPAN class=code-keyword>__box</SPAN> (__LINE__),                               \
        e-<SPAN class=code-keyword>&gt;</SPAN>Message);
</PRE>
      <P>And finally, a word about assertions. C has <CODE>assert</CODE> macro, 
      VB had <CODE>Debug.Assert</CODE> method, .NET has a static method 
      <CODE>Assert</CODE> in the <CODE>Debug</CODE> class too. One of the 
      overloads of the method takes a boolean expression, and a string, 
      describing the test. C's <CODE>assert</CODE> is smarter. It just needs an 
      expression, and it builds the string, containing the expression 
      automatically by stringizing the expression. Now, I really hate the fact, 
      that C# lacks some real preprocessing features. However, MC++ (thanks 
      God!) was not slaughtered by the compiler writers (long live legacy code 
      support), so here's my .NET version of the C's <CODE>assert</CODE> macro: 
      </P><PRE lang=mc++><SPAN class=code-preprocessor>#define</SPAN> DEBUG_ASSERT(x) Debug::Assert (x, S#x)
</PRE>
      <P>If I was writing in C# the code for this article, I should have typed <PRE lang=c#>Debug.Assert (<SPAN class=code-keyword>null</SPAN> != objRef, <SPAN class=code-string>"</SPAN><SPAN class=code-string>null != objRef"</SPAN>);
</PRE>everywhere I needed to assert. In MC++, I just write <PRE lang=mc++>DEBUG_ASSERT (<SPAN class=code-digit>0</SPAN> != objRef);
</PRE>and it is automatically expanded into <PRE lang=mc++>Debug::Assert (<SPAN class=code-digit>0</SPAN> != objRef, S<SPAN class=code-string>"</SPAN><SPAN class=code-string>0 != objRef"</SPAN>);
</PRE>Not to speak about the <CODE>__LINE__</CODE>, <CODE>__FILE__</CODE> 
      and <CODE>__FUNCTION__</CODE> macros I could use in the 
      <CODE>DEBUG_ASSERT</CODE> macro! Now let's everybody scream loudly with 
      me: <B>"C# sucks!":)</B> 
      <H4>&nbsp;</H4>
      <H4>Tweaking the configuration file <A name=tweak></A></H4>
      <P>I know you're all smart guys (otherwise what the heck are you doing on 
      CodeProject?:), and smart guys don't need lengthy explanations, all they 
      need is to take a look at an example. So here it is -- the XML 
      configuration file, used by both the Machine Load Monitoring and Reporting 
      servers. The explanation of all elements is given below the file: </P><PRE lang=xml><SPAN class=code-SummaryComment>&lt;?</SPAN><SPAN class=code-SummaryComment>xml</SPAN> <SPAN class=code-SummaryComment>version</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>1.0"</SPAN> <SPAN class=code-SummaryComment>encoding</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>utf-8"</SPAN><SPAN class=code-SummaryComment>?</SPAN><SPAN class=code-SummaryComment>&gt;</SPAN>

<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>configuration</SPAN><SPAN class=code-keyword>&gt;</SPAN>

    <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute><CODE>LoadReportingServer</CODE></SPAN><SPAN class=code-keyword>&gt;</SPAN>

        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>IpAddress</SPAN><SPAN class=code-keyword>&gt;</SPAN>127.0.0.1<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>IpAddress</SPAN><SPAN class=code-keyword>&gt;</SPAN>
        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>Port</SPAN><SPAN class=code-keyword>&gt;</SPAN>12000<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>Port</SPAN><SPAN class=code-keyword>&gt;</SPAN>
        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>ReportingInterval</SPAN><SPAN class=code-keyword>&gt;</SPAN>2000<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>ReportingInterval</SPAN><SPAN class=code-keyword>&gt;</SPAN>

    <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute><CODE>LoadReportingServer</CODE></SPAN><SPAN class=code-keyword>&gt;</SPAN>

    <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute><CODE>LoadMonitoringServer</CODE></SPAN><SPAN class=code-keyword>&gt;</SPAN>

        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>IpAddress</SPAN><SPAN class=code-keyword>&gt;</SPAN>127.0.0.1<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>IpAddress</SPAN><SPAN class=code-keyword>&gt;</SPAN>
        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>CollectorPort</SPAN><SPAN class=code-keyword>&gt;</SPAN>12000<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>CollectorPort</SPAN><SPAN class=code-keyword>&gt;</SPAN>
        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>CollectorBacklog</SPAN><SPAN class=code-keyword>&gt;</SPAN>40<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>CollectorBacklog</SPAN><SPAN class=code-keyword>&gt;</SPAN>
        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>ReporterPort</SPAN><SPAN class=code-keyword>&gt;</SPAN>13000<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>ReporterPort</SPAN><SPAN class=code-keyword>&gt;</SPAN>
        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>ReporterBacklog</SPAN><SPAN class=code-keyword>&gt;</SPAN>40<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>ReporterBacklog</SPAN><SPAN class=code-keyword>&gt;</SPAN>
        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>MachineReportTimeout</SPAN><SPAN class=code-keyword>&gt;</SPAN>4000<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>MachineReportTimeout</SPAN><SPAN class=code-keyword>&gt;</SPAN>
        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>RemotingProtocol</SPAN><SPAN class=code-keyword>&gt;</SPAN>tcp<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>RemotingProtocol</SPAN><SPAN class=code-keyword>&gt;</SPAN>
        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>RemotingChannelPort</SPAN><SPAN class=code-keyword>&gt;</SPAN>14000<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>RemotingChannelPort</SPAN><SPAN class=code-keyword>&gt;</SPAN>

        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>PerformanceCounters</SPAN><SPAN class=code-keyword>&gt;</SPAN>
            <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>counter</SPAN> <SPAN class=code-attribute>alias</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>cpu"</SPAN>
                    <SPAN class=code-attribute>category</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>Processor"</SPAN>
                    <SPAN class=code-attribute>name</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>% Processor Time"</SPAN>
                    <SPAN class=code-attribute>instance</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>_Total"</SPAN>
                    <SPAN class=code-attribute>load-weight</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>0.3"</SPAN>
                    <SPAN class=code-attribute>interval</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>500"</SPAN>
                    <SPAN class=code-attribute>maximum-measures</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>5"</SPAN> <SPAN class=code-keyword>/</SPAN><SPAN class=code-keyword>&gt;</SPAN>
            <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>--</SPAN> <SPAN class=code-attribute>...</SPAN> <SPAN class=code-attribute>--</SPAN><SPAN class=code-keyword>&gt;</SPAN>
        <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>PerformanceCounters</SPAN><SPAN class=code-keyword>&gt;</SPAN>

    <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute><CODE>LoadMonitoringServer</CODE></SPAN><SPAN class=code-keyword>&gt;</SPAN>

<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>configuration</SPAN><SPAN class=code-keyword>&gt;</SPAN>
</PRE>
      <P>Even though you're smart, I know that some of you have some questions, 
      I am about to answer. First, I'm going to explain the purpose of all 
      elements and their attributes, and I'll cover some wierd settings, so read 
      on... (to save some space, I'll refer to the element 
      <CODE>LoadReportingServer</CODE> as <CODE>LRS</CODE>, and I'll write 
      <CODE>LMS</CODE> instead of <CODE>LoadMonitoringServer</CODE>). </P>
      <TABLE cellSpacing=1 cellPadding=2 border=0>
        <TBODY>
        <TR vAlign=top>
          <TH>Element/Attribute</TH>
          <TH>Meaning/Usage</TH></TR>
        <TR class=altrow vAlign=top>
          <TD><CODE>LRS/IpAddress</CODE></TD>
          <TD>When you're using UDP + multicasting (the default), the 
            <COD>IpAddress</CODE> is the IP address of the multicast group, MLMS 
            and MLRS join, in order to communicate. If you're not using 
            multicasting, but are still using UDP or TCP, this element specifies 
            the IP address (or the host name) of the MLMS server, MLRS report 
            to. Note that because you don't use multicasting, there's no way for 
            the MLRS servers to "multicast" their machine loads to <B>all</B> 
            MLMS servers. There's no doubt that this element's text should be 
            equal to <CODE>LMS/IpAddress</CODE> in any case. </TD></TR>
        <TR vAlign=top>
          <TD><CODE>LRS/Port</CODE></TD>
          <TD>Using UDP + multicasting, UDP only or TCP, that's the port to 
            which MLRS servers send, and at which MLMS servers receive machine 
            loads. </TD></TR>
        <TR class=altrow vAlign=top>
          <TD><CODE>LRS/ReportingInterval</CODE></TD>
          <TD>MLRS servers report machine loads to MLMS ones. The 
            <CODE>ReportingInterval</CODE> specifies the interval (in 
            milliseconds) at which, a MLRS server should report its load to one 
            or more MLMS servers. If you have paid attention in the <A 
            href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#details">Some 
            Implementation Details</A> section, I said, that even if the 
            interval has ellapsed, a machine may not report its load, because it 
            has not gathered the raw data it needs to calculate its load. See 
            the <CODE>counter</CODE> element's <CODE>interval</CODE> attribute 
            for more information. </TD></TR>
        <TR vAlign=top>
          <TD><CODE>LMS/IpAddress</CODE></TD>
          <TD>In the UDP + multicasting scenario, that's the multicast group's 
            IP address, as in the <CODE>LRS/IpAddress</CODE> element. When 
            you're using UDP or TCP only, this address is ignored. </TD></TR>
        <TR class=altrow vAlign=top>
          <TD><CODE>LMS/CollectorPort</CODE></TD>
          <TD>The port, on which MLMS servers accept TCP connections, or 
            receive data from, when using UDP. </TD></TR>
        <TR vAlign=top>
          <TD><CODE>LMS/CollectorBacklog</CODE></TD>
          <TD>This element specifies the maximum number of sockets, a MLMS 
            server will use, when configured for TCP communication. </TD></TR>
        <TR class=altrow vAlign=top>
          <TD><CODE>LMS/ReporterPort</CODE></TD>
          <TD>If haven't been reading the article carefully, you're probably 
            wondering what does this element specify. Well, in my first design, 
            I was not thinking that Remoting will serve me so well to build the 
            Load Balancing Library (LBL). I wrote a mini TCP server, which was 
            accepting TCP requests and returning the least loaded machine. 
            Because LBL had to connect to an MLMS server and ask which is the 
            fastest machine, you can imagine that I've written several overloads 
            of the <CODE>GetLeastLoadedMachine</CODE> method, accepting timeouts 
            and default machines, if there're no available machines at all. At 
            the moment I finished the LBL client, I decided that the design was 
            too lame, so I rewritten the LBL library from scratch (yeah, shit 
            happens:), using Remoting. Now, I regret to tell you that I've 
            overwritten the original library's source files. However, I left the 
            TCP server completely working -- it lives as the 
            <CODE>ReporterWorker</CODE> class, and persists in the 
            <CODE>ReporterWorker.h/.cpp</CODE> files in the 
            <CODE>LoadMonitoringLibrary</CODE> project. If you want to write an 
            alternative LBL library, be my guest -- just write some code to 
            connect to the LMS reporter worker and it will report the fastest 
            machine's load immediatelly. Note that the worker is accepting TCP 
            sockets, so you should always connect to it using TCP. </TD></TR>
        <TR vAlign=top>
          <TD><CODE>LMS/ReporterBacklog</CODE></TD>
          <TD>It's not difficult to figure out that this the backlog of the 
            TCP server I was talking about above. </TD></TR>
        <TR class=altrow vAlign=top>
          <TD><CODE>LMS/MachineReportTimeout</CODE></TD>
          <TD>Now that's an interesting setting. The 
            <CODE>MachineReportTimeout</CODE> is the biggest interval (in 
            milliseconds) at which a machine should report its successive load 
            in order to stay in the load balancing. This means, that if machine 
            has reported 5 seconds ago, and the timeout interval is set to 3 
            seconds, the machine is being removed from the load balancing. If it 
            later reports, it is back in business. I think this is a bit lame, 
            because one would like to configure each machine to report in 
            different intervals, but I don't have time (now) to fix this, so you 
            should learn to live with this "feature". One way to work around my 
            "lameness" is to give this setting a great enough value. Be warned 
            though, that if a machine is down, you won't be able to remove it 
            from the load balancing until this interval ellapses -- so don't 
            give it too big values. </TD></TR>
        <TR vAlign=top>
          <TD><CODE>LMS/RemotingProtocol</CODE></TD>
          <TD>Originally, I thought to use Remoting only over TCP. I thought 
            that HTTP would be too slow (it is one level above TCP in the OSI 
            stack). Then, after I recalled how complex Remoting was, I realized 
            that the HTTP protocol is blazingly faster than the Remoting itself. 
            So I decided to give you an option which protocol to use. Currently, 
            the solution supports only the TCP and HTTP protocols, but you can 
            easily extend it to use any protocol you wish. This setting accepts 
            a string, which is either "tcp" or "http" (without the quotes, of 
            course). </TD></TR>
        <TR class=altrow vAlign=top>
          <TD><CODE>LMS/RemotingChannelPort</CODE></TD>
          <TD>That's the port, MLMS uses to register and activate the load 
            balancing object with the Remoting runtime. </TD></TR>
        <TR vAlign=top>
          <TD><CODE>LMS/PerformanceCounters</CODE></TD>
          <TD>This element contains a collection of performance counters, used 
            to calculate the machine's load. Below are the given the attributes 
            of the <CODE>counter</CODE> XML element, used to describe a 
            <CODE>CounterInfo</CODE> object, I written about somewhere above. 
        </TD></TR>
        <TR class=altrow vAlign=top>
          <TD><CODE>counter/alias</CODE></TD>
          <TD>Though currently not used, this attribute specifies the alias 
            for the otherwise too long performance counter path. See the <A 
            href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#todos">TODO(s)</A> 
            section for the reason I've put this attribute. </TD></TR>
        <TR vAlign=top>
          <TD><CODE>counter/category</CODE></TD>
          <TD>The general category of the counter, e.g. 
            <CODE>Processor</CODE>, <CODE>Memory</CODE>, etc. </TD></TR>
        <TR class=altrow vAlign=top>
          <TD><CODE>counter/name</CODE></TD>
          <TD>The specific counter in the category, e.g. <CODE>% Processor 
            Time</CODE>, <CODE>Page reads/sec</CODE>, etc. </TD></TR>
        <TR vAlign=top>
          <TD><CODE>counter/instance</CODE></TD>
          <TD>If there are two or more instances of the counter, the 
            <CODE>instance</CODE> attribute specifies the exact instance of the 
            counter. For example, if you have two CPUs, then the first CPU's 
            instance is "0", the second one is "1", and both are named "_Total" 
          </TD></TR>
        <TR class=altrow vAlign=top>
          <TD><CODE>counter/load-weight</CODE></TD>
          <TD>The weight that balance the counter values. E.g. you can give 
            more weight to the values of <CODE>Processor\% Processor 
            Time\_Total</CODE> then to <CODE>Processor\% User Time\_Total</CODE> 
            ones. You get the idea. </TD></TR>
        <TR vAlign=top>
          <TD><CODE>counter/interval</CODE></TD>
          <TD>The interval (in milliseconds) at which a performance counter is 
            asked to return its next sample value. </TD></TR>
        <TR class=altrow vAlign=top>
          <TD><CODE>counter/maximum-measures</CODE></TD>
          <TD>The size of the cyclic queue (I talked about above), that stores 
            the transient state of a performance counter. In other words, the 
            element specifies how many counter values should be collected in 
            order to get a decent weighted average (WA). The counter does not 
            report its WA until it collects at least 
            <CODE>maximum-measures</CODE> of sample values. If the 
            <CODE>CounterInfo</CODE> class is asked to return its WA before it 
            collects the necessary number of sample values, it blocks and waits 
            until it has collected them. </TD></TR></TBODY></TABLE><BR>
      <H4>... and the other configuration file:)<A name=tweak2> <A></H4>
      <P>Which is "the other configuration file"? Well, it is the 
      <CODE>Web.config</CODE> file in the sample load-balanced web application. 
      It has 3 vital keys defined in the <CODE>appSettings</CODE> section. They 
      are the machine on which MLMS runs, and the Remoting port and protocol 
      where the machine has registered its remoted object. </P><PRE lang=xml><SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>appSettings</SPAN><SPAN class=code-keyword>&gt;</SPAN>
    <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>add</SPAN> <SPAN class=code-attribute>key</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>LoadBalancingMachine"</SPAN> <SPAN class=code-attribute>value</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>..."</SPAN> <SPAN class=code-keyword>/</SPAN><SPAN class=code-keyword>&gt;</SPAN>
    <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>add</SPAN> <SPAN class=code-attribute>key</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>LoadBalancingPort"</SPAN> <SPAN class=code-attribute>value</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>..."</SPAN> <SPAN class=code-keyword>/</SPAN><SPAN class=code-keyword>&gt;</SPAN>
    <SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-leadattribute>add</SPAN> <SPAN class=code-attribute>key</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>LoadBalancingProtocol"</SPAN> <SPAN class=code-attribute>value</SPAN><SPAN class=code-keyword>="</SPAN><SPAN class=code-keyword>..."</SPAN> <SPAN class=code-keyword>/</SPAN><SPAN class=code-keyword>&gt;</SPAN>
<SPAN class=code-keyword>&lt;</SPAN><SPAN class=code-keyword>/</SPAN><SPAN class=code-leadattribute>appSettings</SPAN><SPAN class=code-keyword>&gt;</SPAN>
</PRE>
      <P>You can figure out what the keys mean, as you have seen the code in the 
      <CODE>Helper</CODE> class of the web application. The last key accepts a 
      string, which can be either "TCP" or "HTTP" and nothing else. </P>
      <H3>Deployment<A name=deployment> </A></H3>
      <P>There are 7 ways to deploy the solution onto a single machine. That's 
      right -- seven. To shorten the article and lengthen my life, I'll refer to 
      the Machine Load Monitoring Server as LMS, to the Machine Load Reporting 
      Server as LRS, and the Load Balancing Library as LBL. Here're the 
      variations: </P>
      <OL type=1>
        <LI>LMS, LRS, LBL 
        <LI>LMS, LRS 
        <LI>LMS, LBL 
        <LI>LMS 
        <LI>LRS, LBL 
        <LI>LRS 
        <LI>LBL </LI></OL>
      <P>It is you, who decide what to install and where. But is me, who 
      developed the setup projects, so you have to pay some attention to what 
      I'm about to tell you. There are 4 setups. The first one is for sample 
      load-balanced web application. The second one is for the server part of 
      the solution, i.e. the Machine Load Monitoring and Reporting Servers. 
      They're bundled in one single setup, but it's your call which one you run, 
      once you've installed them. The 3rd setup contains only the load balancing 
      library and the 4th one contains the entire source code of the solution, 
      including the source for the setups. </P>
      <P>Here is a simple scenario to test whether the code works: (you should 
      have setup a multicast group on your LAN or ask an admin to do that). 
      We'll use 2 machines -- A and B. On machine A, build the 
      <CODE>SharedLibrary</CODE> project first, then build the whole solution 
      (you may skip the setup projects). Deploy the web application. Modify the 
      XML configuration file for MLMS and MRLS. Run the servers. Deploy the web 
      application, modify its <CODE>Web.config</CODE> file and launch it. Click 
      on the web page's link. It should work, and the load balancing should 
      redirect you to the same machine (A). Now deploy only MLRS, and the web 
      application to machine B. Modify the configuration files, but this time, 
      in <CODE>Web.config</CODE>, set the <CODE>LoadBalancingMachine</CODE> key 
      to "A". You've just explained to B's LBL to use machine A's remoted load 
      balancing object. Run MLRS on machine B. It should start to report B's 
      load to A's MLMS. Now do some CPU-intensive operation (if &lt; WinXP, 
      right-click the Desktop and drag your mouse behind the Task Bar; this 
      should give you about 100% CPU utilization) on machine A. Its web 
      application should redirect you to the web app on machine B. Now stop the 
      B's MLRS server. Launch B's web application. It should redirect you to A's 
      one. I guess that's it. Enjoy playing around with all possible deployment 
      scenarios:) </P>
      <H2>Some thoughts about MC++ and C# <A name=misc></A></H2>
      <H3>Managed C++ to C# translation<A name=translation> </A></H3>
      <P>There's nothing easier than converting pure managed C++ code to C#. 
      Just press Ctrl-H in your mind and replace the following sequences (this 
      will work only for my source files, as other developers may not use the 
      whitespace in the same way I use it). </P><PRE>MC++                C#
----                ----
::                  .
-<SPAN class=code-keyword>&gt;</SPAN>                  .
<SPAN class=code-keyword>__gc</SPAN>*
<SPAN class=code-keyword>__gc</SPAN>
<SPAN class=code-keyword>__sealed</SPAN> <SPAN class=code-keyword>__value</SPAN>
<SPAN class=code-keyword>using</SPAN> <SPAN class=code-keyword>namespace</SPAN>     <SPAN class=code-keyword>using</SPAN>
: <SPAN class=code-keyword>public</SPAN>            :
S<SPAN class=code-string>"</SPAN><SPAN class=code-string>                  "</SPAN>
<SPAN class=code-keyword>__box</SPAN> (x)           x
</PRE>
      <P>While the replacements above will translate 85% of the code, there're 
      several things you should do manually: </P>
      <UL>
        <LI>You have to translate all preprocessor directives, e.g. remove the 
        header guards (<CODE><SPAN class=code-preprocessor>#if</SPAN> !defined 
        (...) ... <SPAN class=code-preprocessor>#define</SPAN> ... <SPAN 
        class=code-preprocessor>#endif</SPAN></CODE>), and manually replace the 
        macros with the code, they are supposed to generate. 
        <LI>You have to convert all C++ casts to C# ones, i.e. <PRE lang=mc++><SPAN class=code-keyword>static_cast</SPAN><SPAN class=code-keyword>&lt;</SPAN>SomeType <SPAN class=code-keyword>__gc</SPAN>*<SPAN class=code-keyword>&gt;</SPAN> (expression) to
</PRE><PRE lang=c#>((SomeType) expression) or (expression <SPAN class=code-keyword>as</SPAN> SomeType)
</PRE>
        <LI>You have to put the appropriate access modifier keyword to all 
        members in a class, i.e. you should change: <PRE lang=mc++>PUBLIC:
    ... Method1 (...) {...}
    ... Variable1;
PRIVATE:
    ... Method3 (...) {...}
</PRE>to <PRE lang=c#><SPAN class=code-keyword>public</SPAN>  ... Method1 (...) {...}
<SPAN class=code-keyword>public</SPAN>  ... Variable1;
<SPAN class=code-keyword>private</SPAN> ... Method3 (...) {...}
</PRE>
        <LI>You have to combine the header and the implementation files into a 
        single C# source file. </LI></UL>
      <H3>C#'s readonly fields vs MC++ non-static const members<A name=CSvsMC> 
      </A></H3>
      <P>It is really frustrating that MC++ does not have an equivalent of C#'s 
      readonly fields (not properties). In C# one could write the following 
      class: </P><PRE lang=c#><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>class</SPAN> PerfCounter
{
    <SPAN class=code-keyword>public</SPAN> PerfCounter (<SPAN class=code-SDKkeyword>String</SPAN> fullPath, <SPAN class=code-keyword>int</SPAN> sampleInterval)
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> validate parameters
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        Debug.Assert (<SPAN class=code-keyword>null</SPAN> != fullPath);
        <SPAN class=code-keyword>if</SPAN> (<SPAN class=code-keyword>null</SPAN> == fullPath)
            <SPAN class=code-keyword>throw</SPAN> (<SPAN class=code-keyword>new</SPAN> ArgumentNullException (<SPAN class=code-string>"</SPAN><SPAN class=code-string>fullPath"</SPAN>));
        Debug.Assert (sampleInterval &gt; <SPAN class=code-digit>0</SPAN>);
        <SPAN class=code-keyword>if</SPAN> (sampleInterval &lt;= <SPAN class=code-digit>0</SPAN>)
            <SPAN class=code-keyword>throw</SPAN> (<SPAN class=code-keyword>new</SPAN> ArgumentOutOfRangeException (<SPAN class=code-string>"</SPAN><SPAN class=code-string>sampleInterval"</SPAN>));

        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> assign the values to the readonly fields
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        FullPath = fullPath;
        SampleInterval = sampleInterval;
    }

    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> these are marked public, and make a great replacement of
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> read-only (getter) properties
</SPAN>    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>readonly</SPAN> <SPAN class=code-SDKkeyword>String</SPAN>  FullPath;
    <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>readonly</SPAN> <SPAN class=code-keyword>int</SPAN>     SampleInterval;
}
</PRE>
      <P>You see that the C# programmer doesn't have to implement read-only 
      properties, because the readonly fields are good enough. In Managed C++, 
      you can simulate the readonly fields, by writing the following class: </P><PRE lang=mc++><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>__gc</SPAN> <SPAN class=code-keyword>class</SPAN> PerfCounter
{
<SPAN class=code-keyword>public</SPAN>:
    PerfCounter (<SPAN class=code-SDKkeyword>String</SPAN> <SPAN class=code-keyword>__gc</SPAN>* fullPath, <SPAN class=code-keyword>int</SPAN> sampleInterval) :
        FullPath (fullPath),
        SampleInterval (sampleInterval)
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> validate parameters
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        Debug::Assert (<SPAN class=code-digit>0</SPAN> != fullPath);
        <SPAN class=code-keyword>if</SPAN> (<SPAN class=code-digit>0</SPAN> == fullPath)
            <SPAN class=code-keyword>throw</SPAN> (<SPAN class=code-keyword>new</SPAN> ArgumentNullException (S<SPAN class=code-string>"</SPAN><SPAN class=code-string>fullPath"</SPAN>));
        Debug::Assert (sampleInterval <SPAN class=code-keyword>&gt;</SPAN> <SPAN class=code-digit>0</SPAN>);
        <SPAN class=code-keyword>if</SPAN> (sampleInterval <SPAN class=code-keyword>&lt;</SPAN>= <SPAN class=code-digit>0</SPAN>)
            <SPAN class=code-keyword>throw</SPAN> (<SPAN class=code-keyword>new</SPAN> ArgumentOutOfRangeException (S<SPAN class=code-string>"</SPAN><SPAN class=code-string>sampleInterval"</SPAN>));

        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> <U>the values have been assigned in the initialization list</U>
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> <U>of the constructor, we have nothing more to do -- COOL!&gt;</U>
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    }

<SPAN class=code-keyword>public</SPAN>:
    <SPAN class=code-keyword>const</SPAN> <SPAN class=code-SDKkeyword>String</SPAN> <SPAN class=code-keyword>__gc</SPAN>*  FullPath;
    <SPAN class=code-keyword>const</SPAN> <SPAN class=code-keyword>int</SPAN>           SampleInterval;
};
</PRE>
      <P>So far, so good. You're probably wondering why I am complaining about 
      MC++. It looks like the MC++ version is even cooler than the C# one. Well, 
      the example class was too simple. Now, imagine that when you find an 
      invalid parameter, you should change it to a default value, like in the C# 
      class below: </P><PRE lang=c#><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>class</SPAN> PerfCounter
{
    <SPAN class=code-keyword>public</SPAN> PerfCounter (<SPAN class=code-SDKkeyword>String</SPAN> fullPath, <SPAN class=code-keyword>int</SPAN> sampleInterval)
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> validate parameters
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        Debug.Assert (<SPAN class=code-keyword>null</SPAN> != fullPath);
        <SPAN class=code-keyword>if</SPAN> (<SPAN class=code-keyword>null</SPAN> == fullPath)
            <SPAN class=code-keyword>throw</SPAN> (<SPAN class=code-keyword>new</SPAN> ArgumentNullException (<SPAN class=code-string>"</SPAN><SPAN class=code-string>fullPath"</SPAN>));
        Debug.Assert (sampleInterval &gt; <SPAN class=code-digit>0</SPAN>);
        <B><SPAN class=code-comment>//</SPAN><SPAN class=code-comment> change to a reasonable default value
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        <SPAN class=code-keyword>if</SPAN> (sampleInterval &lt;= <SPAN class=code-digit>0</SPAN>)
            sampleInterval = DefaultSampleInterval;</B>

        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> you can STILL assign the values to the readonly fields
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        FullPath = fullPath;
        SampleInterval = sampleInterval;
    }

    <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>readonly</SPAN> <SPAN class=code-SDKkeyword>String</SPAN>  FullPath;
    <SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>readonly</SPAN> <SPAN class=code-keyword>int</SPAN>     SampleInterval;
    <SPAN class=code-keyword>private</SPAN> <SPAN class=code-keyword>const</SPAN> <SPAN class=code-keyword>int</SPAN>       DefaultSampleInterval = <SPAN class=code-digit>1000</SPAN>;
}
</PRE>
      <P>Now, the corresponding MC++ code will not compile, and you'll see why 
      below: </P><PRE lang=mc++><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>__gc</SPAN> <SPAN class=code-keyword>class</SPAN> CrashingPerfCounter
{
<SPAN class=code-keyword>public</SPAN>:
    CrashingPerfCounter (<SPAN class=code-SDKkeyword>String</SPAN> <SPAN class=code-keyword>__gc</SPAN>* fullPath, <SPAN class=code-keyword>int</SPAN> sampleInterval) :
        FullPath (fullPath),
        SampleInterval (sampleInterval)
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> validate parameters
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        Debug::Assert (<SPAN class=code-digit>0</SPAN> != fullPath);
        <SPAN class=code-keyword>if</SPAN> (<SPAN class=code-digit>0</SPAN> == fullPath)
            <SPAN class=code-keyword>throw</SPAN> (<SPAN class=code-keyword>new</SPAN> ArgumentNullException (S<SPAN class=code-string>"</SPAN><SPAN class=code-string>fullPath"</SPAN>));
        Debug::Assert (sampleInterval <SPAN class=code-keyword>&gt;</SPAN> <SPAN class=code-digit>0</SPAN>);
        <B><SPAN class=code-comment>//</SPAN><SPAN class=code-comment> the second line below will cause the compiler to
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> report "error C2166: l-value specifies const object"
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        <SPAN class=code-keyword>if</SPAN> (sampleInterval <SPAN class=code-keyword>&lt;</SPAN>= <SPAN class=code-digit>0</SPAN>)
            SampleInterval = DefaultSampleInterval;</B>

        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> <U>the values have been assigned in the initialization list</U>
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> <U>of the constructor, and that's <B>the only place</B> we can</U>
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> <U>initialize non-static const members -- NOT COOL!</U>
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>    }

<SPAN class=code-keyword>public</SPAN>:
    <SPAN class=code-keyword>const</SPAN> <SPAN class=code-SDKkeyword>String</SPAN> <SPAN class=code-keyword>__gc</SPAN>*  FullPath;
    <SPAN class=code-keyword>const</SPAN> <SPAN class=code-keyword>int</SPAN>           SampleInterval;

<SPAN class=code-keyword>private</SPAN>:
    <SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>const</SPAN> <SPAN class=code-keyword>int</SPAN>    DefaultSampleInterval = <SPAN class=code-digit>1000</SPAN>;
};
</PRE>
      <P>Now, one may argue, that we could initialize the const member 
      SampleInterval in the initialization list of the constructor like this: 
      </P><PRE lang=mc++>SampleInterval (sampleInterval <SPAN class=code-keyword>&gt;</SPAN> <SPAN class=code-digit>0</SPAN> ? sampleInterval : DefaultSampleInteval)
</PRE>
      <P>and he would be right. However, if we need to connect to a database 
      first, in order to do the check, or we need to perform several checks for 
      the parameter I can't figure out how to do this in the initialization 
      list. Do you? That's why MC++ sucks compared to C# for readonly fields. 
      Now, the programmer is forced to make the const fields non-const and 
      private, and write code to implement read-only properties, like this: </P><PRE lang=mc++><SPAN class=code-keyword>public</SPAN> <SPAN class=code-keyword>__gc</SPAN> <SPAN class=code-keyword>class</SPAN> LamePerfCounter
{
<SPAN class=code-keyword>public</SPAN>:
    LamePerfCounter (<SPAN class=code-SDKkeyword>String</SPAN> <SPAN class=code-keyword>__gc</SPAN>* fullPath, <SPAN class=code-keyword>int</SPAN> sampleInterval)
    {
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> validate parameters
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        Debug::Assert (<SPAN class=code-digit>0</SPAN> != fullPath);
        <SPAN class=code-keyword>if</SPAN> (<SPAN class=code-digit>0</SPAN> == fullPath)
            <SPAN class=code-keyword>throw</SPAN> (<SPAN class=code-keyword>new</SPAN> ArgumentNullException (S<SPAN class=code-string>"</SPAN><SPAN class=code-string>fullPath"</SPAN>));
        Debug::Assert (sampleInterval <SPAN class=code-keyword>&gt;</SPAN> <SPAN class=code-digit>0</SPAN>);
        <SPAN class=code-keyword>if</SPAN> (sampleInterval <SPAN class=code-keyword>&lt;</SPAN>= <SPAN class=code-digit>0</SPAN>)
            sampleInterval = DefaultSampleInterval;

        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> assign the values to the member variables
</SPAN>        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment>
</SPAN>        <SPAN class=code-keyword>this</SPAN>-<SPAN class=code-keyword>&gt;</SPAN>fullPath = fullPath;
        <SPAN class=code-keyword>this</SPAN>-<SPAN class=code-keyword>&gt;</SPAN>sampleInterval = sampleInterval;
    }

    <B><SPAN class=code-keyword>__property</SPAN> <SPAN class=code-SDKkeyword>String</SPAN> <SPAN class=code-keyword>__gc</SPAN>* get_FullPath ()
    {
        <SPAN class=code-keyword>return</SPAN> (fullPath);
    }

    <SPAN class=code-keyword>__property</SPAN> <SPAN class=code-keyword>int</SPAN> get_SampleInterval ()
    {
        <SPAN class=code-keyword>return</SPAN> (sampleInterval);
    }</B>

<B><SPAN class=code-keyword>private</SPAN></B>:
    <SPAN class=code-SDKkeyword>String</SPAN> <SPAN class=code-keyword>__gc</SPAN>*        fullPath;
    <SPAN class=code-keyword>int</SPAN>                 sampleInterval;
    <SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>const</SPAN> <SPAN class=code-keyword>int</SPAN>    DefaultSampleInterval = <SPAN class=code-digit>1000</SPAN>;
};
</PRE>
      <H2><I>"Bugs suck. Period."</I> <A name=bugs></A></H2>
      <P align=right><B>John Robins</B> </P>
      <P><I>"I trust that I and my colleagues will use my code correctly. To 
      avoid bugs, however, I verify everything. I verify the data that others 
      pass into my code, I verify my code's internal manipulations, I verify 
      every assumption I make in my code, I verify data my code passes to 
      others, and I verify data coming back from calls my code makes. If there's 
      something to verify, I verify it. This obsessive verification is nothing 
      personal against my coworkers, and I don't have any psychological problems 
      (to speak of). It's just that I know where the bugs come from; I also know 
      that you can't let anything by without checking it if you want to catch 
      your bugs as early as you can."</I> </P>
      <P align=right><B>John Robins</B></P>
      <P>I do what John preaches in his book, and you should do it too. Trust 
      me, but verify my code. I think I have debugged my code thoroughly, and I 
      haven't met bugs in it since the day before yesterday (when I started to 
      write the article). However, if you see one of those nasty creatures, let 
      me know. My e-mail is stoyan_damov[at]hotmail.com. </P>
      <P>Though I think I don't have bugs (statistically, I should have 8 bugs 
      in the 4 KLOC) I'd love to share an amazing Microsoft bug with you. It 
      caused me quite some time to find it, but unfortunatelly, I was not able 
      to reproduce it, when it disappeared (yes! it disappeared) later. I've 
      wrapped all of my classes in the namespace 
      <CODE>SoftwareLoadBalancing</CODE>. So far so good. Now I have several 
      shared classes in the <CODE>SharedLibrary</CODE> assembly. The Load 
      Monitoring Library uses one of these classes to do its job, so it is 
      <CODE><SPAN class=code-preprocessor>#using</SPAN></CODE> the 
      SharedLibrary. I was able to build LML several times, and then suddenly, 
      the linker complained that it cannot find the shared class I was using in 
      the namespace <CODE>SoftwareLoadBalancing</CODE>. I'll name that class X 
      to save myself some typing. I closed the solution, went to the 
      <CODE>Debug</CODE> folder of the shared library, deleted everything, 
      deleted all files in the common <CODE>Bin</CODE> folder and tried again. 
      Same result! I let the linker grumble for three more tries and then 
      launched the ILDAsm tool. When I looked at the 
      <CODE>SharedLibrary.dll</CODE>, I found that the class X was "wrapped" 
      twice in the namespace <CODE>SoftwareLoadBalancing</CODE>, i.e. it was now 
      <CODE>SoftwareLoadBalancing::SoftwareLoadBalancing::X</CODE>. Because I 
      wanted to do some tests and had no time to deal with the bug, I tried to 
      alias the namespace in LML like this: </P><PRE lang=mc++><SPAN class=code-keyword>using</SPAN> <SPAN class=code-keyword>namespace</SPAN> SLB = SoftwareLoadBalancing;
</PRE>
      <P>Then, I tried to access the X class, using the following construct: 
</P><PRE lang=mc++>SLB::SLB::X <SPAN class=code-keyword>__gc</SPAN>* x = <SPAN class=code-keyword>new</SPAN> SLB::SLB::X ();
</PRE>
      <P>Maybe I don't understand C++ namespace aliasing very well, or maybe the 
      documentation does not explain it, but what happened this time was that 
      the linker complained again, that it can't find 
      <CODE>SoftwareLoadBalancing::SLB::X</CODE> class!!! The compiler 
      "replaced" SLB with SoftwareLoadBalancing only once. Needless to say, I 
      was quite embarassed. Not only the compiler put my class wrapped in two 
      namespaces, but it was not helping me to work around the problem!:) Do you 
      know what I did then? I aliased the namespace in a way the linker or 
      compiler should understand: </P><PRE lang=mc++><SPAN class=code-keyword>using</SPAN> <SPAN class=code-keyword>namespace</SPAN> SLB = SoftwareLoadBalancing::SoftwareLoadBalancing;
</PRE>
      <P>Then, I tried to instantiate the X class like this: </P><PRE lang=mc++>SLB::X <SPAN class=code-keyword>__gc</SPAN>* x = <SPAN class=code-keyword>new</SPAN> SLB::X ();
</PRE>
      <P>I'm sure you don't know what happened then, because I was hiding a 
      simple fact from you. I was rebuilding each time. Now are you able to 
      guess what happened? The linker complained <B>again</B> that it cannot 
      find class X in the namespace 
      <CODE>SoftwareLoadBalancing::SoftwareLoadBalancing</CODE>. WTF?! I was 
      furious! I gone crazy! I launched ILDasm once again, and looked at the 
      <CODE>SharedLibrary</CODE>. The class was properly wrapped once in the 
      namespace <CODE>SoftwareLoadBalancing</CODE>. Now, I don't know if this is 
      a bug in the compiler or in the linker or in my mind. What I know is that 
      when I have such a problem next time, I won't go to chase unexisting bugs 
      in my source files, but will launch my love ILDasm and see whether I'm 
      doing something wrong, or Microsoft are trying to drive me crazy:) </P>
      <H2>TODO(s) <A name=todos></A></H2>
      <P>(So what the heck have you done, when there're so much TODOs?!)</P>
      <UL>
        <LI>Re-write MLMS and MLRS executables into .NET Windows services? 
        <LI>No management console - no time for that, but who knows, maybe in 
        the next version of the article, I'll build a configuration GUI, and 
        write some code to enable remote server management. 
        <LI>In this version, the machine load is calculated almost staticly, 
        i.e. counters and their weights are configurable, but the algorithm to 
        calculate the machine load is the same. If I have some time, (e.g. my 
        lovely wife goes on vacation to her home town for a while :), I'll 
        implement an expression interpreter so you guys would be able to type 
        arithmetic and boolean expressions (formulas) to calculate the machine 
        load as you wish, i.e. one could type expressions like: <PRE>cpu * <SPAN class=code-digit>0</SPAN>.<SPAN class=code-digit>2</SPAN> + ((sessions <SPAN class=code-keyword>&lt;</SPAN> <SPAN class=code-digit>10</SPAN>) * <SPAN class=code-digit>0</SPAN>.<SPAN class=code-digit>2</SPAN> + (sessions <SPAN class=code-keyword>&gt;</SPAN>= <SPAN class=code-digit>10</SPAN>) * <SPAN class=code-digit>0</SPAN>.<SPAN class=code-digit>5</SPAN>) * sessions
</PRE>
        <LI>Discover a better way to store machine loads (e.g. implementing a 
        real priority queue), though the current serves me well:) 
        <LI>Do you remember what I've written earlier in the article about 
        returning the least loaded machine? "Now, if anyone asks for the fastest 
        machine, we will return the first element of the <CODE>ArrayList</CODE>, 
        that is stored in the first element of the <CODE>SortedList</CODE>, 
        right?". Though I may seem to think right, actually I'm a bit wrong. 
        Imagine that we have 5 machines, reported the least load 10. Now imagine 
        that 100 queries for the least loaded machine arrive to the MLMS. If we 
        manage to answer the queries before machine B reports its load again, we 
        will send machine B as the fastest machine to all 100 queries. Once the 
        clients receive the answer, they'll all rush to overload machine B, so 
        next time, it may not even be able to report its load:) What we have to 
        do, is either to report the fastest machine in some round-robin way, or 
        return a random machine from the list of fastest machines. But that's 
        something I'll implement in the next version of the article. 
        <LI>Change the Grim Reaper's code so that it does not remove the machine 
        once it hadn't reported in time (which could be due to UDP packet loss, 
        not because the machine is dead). Rather have a configurable counter, 
        that decrements each time a machine fails to report its load in time, 
        and when the counter reaches zero, the machine is removed from the load 
        balancing. 
        <LI>SECURITY - there's no security code beside checking the parameters 
        in the methods, and the validity of the TCP/UDP requests that LMS 
        receives. If Michael Howard or David LeBlanc (the authors of the 
        <B>must</B>-read book "Writing Secure Code") have read this article, I'm 
        sure they'd rated it <B>zero</B>. I'm sorry! If I've implemented 
        security, there would be no article this month, and I really want to win 
        CodeProject's December contest:) 
        <LI>"Clean up" some classes. They use other classes' internal members 
        directly, and that's not very cool OO programming, don't you think? 
        <LI>Code coverage - I know that's not an item, which should go on a TODO 
        list, but though I could swear I've checked the entire code, do not 
        trust me and experiment putting the code in some really weird 
        situations. 
        <LI>Build a NDoc-generated .CHM documentation? Really, I don't have a 
        time. I work round the clock to meet some "Mission Impossible" 
        deadlines, and I steal from my teeny-weeny sleep time to write articles 
        like this. Maybe some day, maybe. 
        <LI>Write your feature request in the message board below, and I'll 
        consider implementing it for the next version of the article. </LI></UL>
      <H2>Conclusion <A name=conclusion></A></H2>
      <P>Thank you for reading the article! It was the longest article I've 
      written in my entire life (I started writing articles several months ago:) 
      I'm really impressed how patient you are! Now that I thanked you, I should 
      also say "Thanks!" to Microsoft, which brought us the marvelous .NET 
      technology. If .NET did not exist, I doubt if I would write such an 
      article, and even if I did, it wouldn't include the C++ source code. The 
      .NET framework makes programming so easy! It just forces you to write all 
      day long:) I feel like I'm not programming, but rather prototyping. It is 
      easier than VB was once. Really! </P>
      <P>Now let's see what you've learned (or just read) from the article: 
      <UL>
        <LI>what load balancing is in general 
        <LI>my idea for dynamic software load balancing, the architecture and 
        some of the implementation details 
        <LI>some multithreading issues and how to solve them 
        <LI>network programming basics, including TCP, UDP and multicasting 
        <LI>some (I hope) helpful tips and workarounds 
        <LI>that if COM is love, then .NET is PASSION 
        <LI>that I'm a pro-Microsoft guy:) </LI></UL>
      <P>AaaaaaaaaaaaaI forgot to tell you! Please do not post messages in the 
      message board below that teach me to not use <CODE><SPAN 
      class=code-keyword>__gc</SPAN>*</CODE>, when I could just type 
      <CODE>*</CODE>. I just love the <CODE><SPAN 
      class=code-keyword>__gc</SPAN></CODE> keyword, that's it:) </P>
      <P>Below, there are two books, I've read once upon a time, that served me 
      well to write this article's source code. You'll be surprised that they 
      are no .NET books. I'm not joking -- there're maybe over 250 .NET books, 
      and I've read 10 or so, that's why I can't recommend you any .NET book, 
      really. It wouldn't be fair if I say "Book X is the best on topic Y" 
      because I haven't read at least 1/2 of the .NET books to give you an 
      (authoritive) advice. The books below are not just a "Must-Have" and 
      "Must-Have-Read":) ones. They are priceless for the Windows developer. 
      Stop reading this article, and go buy them now! :) </P>
      <P><B>Programming Server-Side Applications for Microsoft Windows 2000 
      (ISBN 0-7356-0753-2) by Jeffrey Richter, Jason D. Clark </B></P>
      <P><I>"We developers know that writing error-tolerant code is what we 
      should do, but frequently we view the required attention to detail as 
      tedious and so omit it. We've become complacent, thinking that the 
      operating system will 'just take care of us.' Many developers out there 
      actually believe that memory is endless, and that leaking various 
      resources is OK because they know that the operatingm system will clean up 
      everything automatically when the process dies. Certainly many 
      applications are implemented in this way, and the results are not 
      devastating because the applications tend to run for short periods of time 
      and then are restarted. However, services run forever, and omitting the 
      proper error-recovery and resource-cleanup code is catastrophic!" </I></P>
      <P><B>Debugging Applications (ISBN 0-7356-0886-5), by John Robins </B></P>
      <P><I>"Bugs suck. Period. Bugs are the reason you endure death-march 
      projects with missed deadlines, late nights, and grouchy coworkers. Bugs 
      can truly make your life miserable because if enough of them creep in to 
      your software, customers will stop using your product and you could lose 
      your job. Bugs are serious business... As I was writing this book, NASA 
      lost a Mars space probe because of a bug that snuck in during the 
      requirements and design phase. With computers controlling more and more 
      mission-critical systems, medical devices, and superexpensive hardware, 
      bugs can no longer be laughed at or viewed as something that just happens 
      as a part of development." </I></P>
      <P>And the best text on Managed Extentions for C++ .NET (besides the 
      specification and the migration guide), which is not a book, but a 
      Microsoft Official Curriculum (MOC) course: "Programming with Managed 
      Extensions for Microsoft Visual C++ .NET" (2558). You should definitely 
      visit this course if you're planning to do <B>any</B> .NET development 
      using Managed C++. </P>
      <H3>A (final) word about C# <A name=final></A></H3>
      <P>Many of you are probably wondering why I have implemented this solution 
      in Managed C++, and not in C# since I'm writing only managed code. I know 
      that most of the .NET developers are on the C# bandwagon. So am I. I'm 
      programming in C# all day long. That's my job. However, I love C++ so 
      much, that I prefer to write in Managed C++. There are probably hundreds 
      of reasons I prefer MC++ to C#, and IJW (and unmanaged code in general) is 
      the probably the last on the list. C# has nothing to do with C or C++, 
      except for some slight similarities in the syntax, no matter that 
      Microsoft are trying to convince us in the opposite. It is way closer to 
      Java, than to C/C++. Do I sound extreme? Well, a C/C++ die-hard coleague 
      of mine (<A href="http://606u.dir.bg/">Boby -- http://606u.dir.bg/</A>) 
      forced himself to learn and use VB.NET in order to not forget C++ when he 
      was developing a .NET application. Now who's extreme?:) Microsoft are 
      pushing us very badly to forget C++, so they and some open-source C++ 
      die-hards are the only ones who use it:) Haven't you noticed? As of today, 
      the ATL list generates a couple of unique posts each day, compared to at 
      least 10-20, several months ago, before Microsoft suddenly decided to drop 
      it, and put it back in a week, when catcalled by the ATL community. And 
      what does Microsoft say about this, eh? COM is not dead! COM is here to 
      stay! ATL lives (somewhere in time). Blah, blah:) I adore .NET, but I 
      don't want to search for the "The C Programming Language" and "The C++ 
      Programming Language" books in the dusty bookshelves in 3 or 4 years, when 
      it will be replaced by some even-cooler technology. Long live C++!:) 
      Anyway, I was tempted to implement the solution in C#, because the monthly 
      prizes for it were better-looking:) </P>
      <H2>Disclaimer <A name=disclaimer></A></H2>
      <P>This software comes "AS IS" with all faults and with no warranties 
      whatsoever. If you find the source code or the article useful, wish me a 
      Merry Christmas:)&nbsp; </P>
      <P>Wishing you the merriest Christmas, and looking forward to seeing you 
      next year:)&nbsp; </P>
      <P>Stoyan 
      </P><!-- Article Ends --><!-- Main Page Contents End --></DIV></SPAN>
      <FORM id=aspnetForm 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
      name=aspnetForm action=loadbalancing.aspx method=post>
      <DIV><INPUT id=__VIEWSTATE type=hidden 
      value=/wEPDwULLTEwMDUyNjYzMjhkZJSKBafvv84WxOrZmfOipPU2KUsX 
      name=__VIEWSTATE> </DIV>
      <H2>License</H2>
      <DIV id=ctl00_LicenseTerms>
      <P>This article has no explicit license attached to it but may contain 
      usage terms in the article text or the download files themselves. If in 
      doubt please contact the author via the discussion board below.</P>
      <P>A list of licenses authors might use can be found <A 
      href="http://www.codeproject.com/info/Licenses.aspx">here</A></P></DIV>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=39071">Stoyan 
            Damov</A></B><BR><BR>
            <CENTER><IMG id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/{DD1B21C7-9EDF-4DD9-9BA2-A7DF83D27329}.jpg"></CENTER><BR><SPAN 
            class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>I'm crazy about programming, bleeding-edge technologies and my 
            wife, Irina. Thinking seriously to start living in Centurian 
            time.<BR><BR>The image shows me, happy <IMG title="Poke tongue" 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_tongue.gif" 
            align=top><BR><BR><A href="http://spaces.msn.com/members/stoyan/">My 
            blog</A><BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow>
                <TD class=SmallText noWrap>Occupation: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Web 
                  Developer</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt=Bulgaria 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/BG.gif" 
                  width=16> 
      Bulgaria</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE id=ctl00_PopularArticlesRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular C++ / CLI articles:</H2>
            <UL>
              <LI><A href="http://www.codeproject.com/KB/mcpp/quake2.aspx">Quake 
              II .NET</A>
              <DIV class=SmallText>A port of the famous C-language based game 
              engine to Visual C++ with a .NET managed heads-up display.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/mcpp/cppcliintro01.aspx">A 
              first look at C++/CLI</A>
              <DIV class=SmallText>A brief look at the new C++/CLI syntax and 
              how it improves over the old MC++ syntax</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/mcpp/get_the_ip_out_tcpclient.aspx">How 
              to get the clients IP address using TcpClient in Managed C++</A>
              <DIV class=SmallText>How to get the clients IP address using 
              TcpClient in Managed C++</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/mcpp/dotnetsetup.aspx">Enhanced 
              .NET Bootstrap Setup</A>
              <DIV class=SmallText>Modified Microsoft Setup program to install 
              required IE6, MSI 2.0 and .NET.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/mcpp/xpregex.aspx">xp_regex: 
              Regular Expressions in SQL Server 2000</A>
              <DIV class=SmallText>This is a SQL Server 2000 Extended Stored 
              Procedure writted in Managed C++. It allows you to use regular 
              expressions in T-SQL.</DIV></LI></UL>
            <H2></H2></TD>
          <TD><IFRAME 
            src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/ServeHTML.htm" 
            frameBorder=0 width=300 scrolling=no 
        height=250></IFRAME></TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
var socialLinks = new social();
socialLinks.addtoMethod=1;
socialLinks.DrawLinks("socialLinks", document.location.href, escape(document.title), 100, 0, "SmallText Bold", "AddTo");
</SCRIPT>
      </DIV>
      <TABLE class=RatingBar id=ctl00_RateArticleRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD id=ctl00_RateArticle_VoteResultDiv noWrap align=right 
                width="100%"><SPAN id=voteRes></SPAN><IMG id=loaderImg 
                  style="DISPLAY: none" height=16 alt=loading... 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/ajax-loader.gif" 
                  width=16> </TD>
                <TD class=SmallText id=voteTbl style="WHITE-SPACE: nowrap" 
                align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px; WHITE-SPACE: nowrap"><I><B>Rate 
                        this Article for us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm noWrap 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn onclick="return rateItem(3338,2);" type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV><INPUT id=__EVENTVALIDATION type=hidden 
      value=/wEWCALb8NMxAsCUxcMHAsGUxcMHAsKUxcMHAsOUxcMHAsSUxcMHAs/7760LArm6kOQLoa6aArY+N1kuAUJ2TVwwz+PctcA= 
      name=__EVENTVALIDATION> </DIV></FORM>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center"><IFRAME 
      src="C:\Documents and Settings\Administrator\Desktop\asqw\CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files\ServeHTML(1).htm" 
      frameBorder=0 width=468 scrolling=no height=58></IFRAME><IFRAME 
      src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/ServeLinks.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD>
            <FORM 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fmcpp%2floadbalancing.aspx&amp;fid=13760 
            method=get><INPUT type=hidden value=13760 name=fid><INPUT 
            type=hidden 
            value=?floc=%2fKB%2fmcpp%2floadbalancing.aspx&amp;fid=13760 
            name=currentQS><INPUT type=hidden value=/KB/mcpp/loadbalancing.aspx 
            name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 alt=FAQ 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/forum_faq.gif" 
                  width=16 align=middle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 alt=Search 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/forum_search.gif" 
                  width=16 align=top border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=13760">Search 
                  Messages</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=SetOpt></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></FORM></TD></TR>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 alt=new 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/forum_newmsg.gif" 
                  width=16 align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;floc=/KB/mcpp/loadbalancing.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 25 of 55 (Total in Forum: 55) (<A 
                  href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next</A></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0><!-- Column Headers -->
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2471005_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2471005xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=2471005#xx2471005xx" 
                        name=2471005>distribute client request across a set of 
                        servers</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4213222">ankita 
                        luniya</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:02 18 
                        Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2471005_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hii,<BR><BR>i am developing a 
                                client server application in C#..<BR><BR>In this 
                                multiple clients can connect 2 server. I am 
                                using a set of 4 servers so that the fault 
                                tolerance can be increased in case a server is 
                                down..its load can be shared by another server 
                                i.e. i am developing a distributed 
                                application.<BR><BR>now i want to know how these 
                                client requests can be distributed across the 
                                set of servers.<BR><BR>i mean suppose i want 
                                server should handle 25 clients at max...<BR>if 
                                26th client tries 2 connect to it it should 
                                redirect the clients to the another server whch 
                                is available...and if all servers are busy then 
                                display a message all servers busy..<BR><BR>so 
                                can u give me the code as to how load balancing 
                                can be done among multiple servers.<BR><BR>any 
                                help would be appreciated.thanks in 
                                advance<BR><BR>ankita luniya <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=2471005&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=2471005&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=2471005">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=2471005">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2471005&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2471005 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4213222,2471005,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2609018_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2609018xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=2609018#xx2609018xx" 
                        name=2609018>Re: distribute client request across a set 
                        of servers</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=5294610">pankajjoshi20</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">10:35 
                        23 Jun '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2609018_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>yaar i m working on the same 
                                project .if u get any helps so plz forward me 
                                the solution<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=2609018&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=2609018&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=2471005">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=2609018">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2609018&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2609018 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(5294610,2609018,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2437213_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2437213xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=2437213#xx2437213xx" 
                        name=2437213>web farm related</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3891986">Member 
                        3891986</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">5:29 22 
                        Feb '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2437213_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I am trying to use web farm 
                                wherein I need to implement load balancing but 
                                my aplication uses Session. I have read that 
                                Sessions do not work in web farm scenarios. Will 
                                this load balancing address that problem as 
                                well? <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=2437213&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=2437213&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=2437213">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=2437213">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2437213&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2437213 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3891986,2437213,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2390992_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2390992xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=2390992#xx2390992xx" 
                        name=2390992>windows NLB</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=165842">Noam 
                        Helfman</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:21 
                        15 Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2390992_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>In some cases it is also possible 
                                to just use windows NLB:<BR><A 
                                href="http://technet2.microsoft.com/windowsserver/en/library/1611cae3-5865-4897-a186-7e6ebd8855cb1033.mspx?mfr=true">http://technet2.microsoft.com/windowsserver/en/library/1611cae3-5865-4897-a186-7e6ebd8855cb1033.mspx?mfr=true</A>[<A 
                                title="New Window" 
                                href="http://technet2.microsoft.com/windowsserver/en/library/1611cae3-5865-4897-a186-7e6ebd8855cb1033.mspx?mfr=true" 
                                target=_blank>^</A>] <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=2390992&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=2390992&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=2390992">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=2390992">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2390992&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2390992 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(165842,2390992,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1486892_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1486892xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=1486892#xx1486892xx" 
                        name=1486892>load balance - help needed</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2819672">Raven 
                        Caelladore</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">17:01 
                        13 May '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1486892_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I loved this article; it's very 
                                well written. However, I'd like to go on a limb 
                                and ask, since I haven't been able to find it on 
                                my own, how do you get the processor load in 
                                Windows? I am developing a similar project, in 
                                'pure C', and I haven't been able to discover 
                                any hints on how you capture the processor load 
                                percentage in a given instant. My project 
                                involves both Linux and Windows applications and 
                                I have been able to have it work for Linux, but 
                                not Windows. Any hints? <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1486892&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1486892&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=1486892">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=1486892">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1486892&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1486892 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(2819672,1486892,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F1487966_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1487966xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=1487966#xx1487966xx" 
                        name=1487966>Re: load balance - help needed</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=39071">Stoyan 
                        Damov</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:02 15 
                        May '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1487966_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Read about the Performance Data 
                                Helper library (PDH) in MSDN. 
                                <BR><BR>Cheers,<BR>Stoyan<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1487966&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1487966&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=1486892">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=1487966">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1487966&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1487966 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(39071,1487966,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1335014_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1335014xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=1335014#xx1335014xx" 
                        name=1335014>C# Version</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=33391">Madmaximus</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">13:51 
                        13 Jan '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1335014_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR><BR>Do you still have plans 
                                to do this in C#? <IMG title="Big Grin" 
                                src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_biggrin.gif" 
                                align=top><BR><BR>Thanks, <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1335014&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1335014&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=1335014">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=1335014">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1335014&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1335014 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(33391,1335014,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1487967_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1487967xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=1487967#xx1487967xx" 
                        name=1487967>Re: C# Version</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=39071">Stoyan 
                        Damov</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:03 15 
                        May '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1487967_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>No <IMG title=Smile 
                                src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top> 
                                <BR><BR>Cheers,<BR>Stoyan<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1487967&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1487967&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=1335014">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=1487967">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1487967&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1487967 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(39071,1487967,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1283767_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1283767xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=1283767#xx1283767xx" 
                        name=1283767>we Updated?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=139169">leabre</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">15:51 
                        17 Nov '05 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1283767_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Just wondering if this project has 
                                been updated and if there's a way we can become 
                                privy to it?<BR><BR>Thanks,<BR>Shawn 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1283767&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1283767&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=1283767">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=1283767">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1283767&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1283767 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(139169,1283767,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1263090_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1263090xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=1263090#xx1263090xx" 
                        name=1263090>Interesting</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=15 alt=suss 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/usersuss.gif" 
                        width=14></TD>
                      <TD class=Frm_MsgAuthor>Anonymous</TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">18:05 
                        24 Oct '05 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1263090_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Interesting article, thanks, its 
                                given me a few ideas to play with, and i inly 
                                read the top 1/2! <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1263090&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1263090&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=1263090">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=1263090">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1263090&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt style="TEXT-ALIGN: right"><A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1263090&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=m">Edit</A>·<A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1263090&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=d">Delete</A><BR><SPAN 
                                id=MVF1263090 style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(0,1263090,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1237697_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1237697xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=1237697#xx1237697xx" 
                        name=1237697>load balance</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=15 alt=suss 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/usersuss.gif" 
                        width=14></TD>
                      <TD class=Frm_MsgAuthor>Anonymous</TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">23:38 
                        26 Sep '05 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1237697_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hi<BR>i want to code of load 
                                balance in java pls help me <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1237697&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1237697&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=1237697">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=1237697">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1237697&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt style="TEXT-ALIGN: right"><A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1237697&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=m">Edit</A>·<A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=1237697&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=d">Delete</A><BR><SPAN 
                                id=MVF1237697 style="WHITE-SPACE: nowrap">1.00/5 
                                (2 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(0,1237697,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F956190_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx956190xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=956190#xx956190xx" 
                        name=956190>I.n.t.e.r.e.s.t.i.n.g , but need help</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=15 alt=suss 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/usersuss.gif" 
                        width=14></TD>
                      <TD class=Frm_MsgAuthor>emmatty</TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">0:18 25 
                        Oct '04 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F956190_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello All,<BR><BR>I must agree 
                                that this article is best in its class. I need a 
                                little help on Load Balancing Servers.I am 
                                coding an ASP page that will dynamically create 
                                csv files and prompts user to download the csv 
                                .We are using load balancnig servers.Will this 
                                effect the creation and downloading of csv files 
                                in any way? Please help me on this.<BR><BR>Kind 
                                Regards,<BR>John <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=956190&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=956190&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=956190">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=956190">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=956190&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt style="TEXT-ALIGN: right"><A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=956190&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=m">Edit</A>·<A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=956190&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=d">Delete</A><BR><SPAN 
                                id=MVF956190 style="WHITE-SPACE: nowrap">2.00/5 
                                (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(0,956190,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F943571_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx943571xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=943571#xx943571xx" 
                        name=943571>WOWWWW!!!</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=979860">tupacs01</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:03 8 
                        Oct '04 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F943571_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I'm only half-way through this 
                                article, but I LOVE IT ALREADY!!! This is 
                                extremely well written, very informative and the 
                                author is extremely knowledgeable!!<BR><BR>2 
                                Things for the author - if you would like, I 
                                have a few graphics apps and would be happy to 
                                create some PNG format diagrams for your article 
                                <IMG title=Smile 
                                src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top><BR><BR>Also, I am working on a 
                                load-balancing type scheme that I would like to 
                                build directly into an app I'm creating. Your 
                                article has already given me several great 
                                ideas, but I would love an opportunity to 
                                discuss a couple of other ideas with you if 
                                possible. Of course, all my ideas may be 
                                addressed further down in your article, so let 
                                me keep reading <IMG title=Smile 
                                src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top><BR><BR>Thanks!!! <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=943571&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=943571&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=943571">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=943571">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=943571&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF943571 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(979860,943571,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F924112_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx924112xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=924112#xx924112xx" 
                        name=924112>Global HTTPApplication Variable</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1061667">mark_in_TV</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:21 14 
                        Sep '04 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F924112_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi, <BR><BR>First of all I like to 
                                say the article is really well 
                                written.<BR><BR>Secondly, I would like to ask 
                                how would using this technique affect the Global 
                                application store on each machine??<BR><BR>Would 
                                it be possible using the web.config to put the 
                                session and global variables in a DB? So all 
                                machines used these stores?<BR><BR>I know it 
                                works for Session but I have not had a chance to 
                                test it for Global variables. Do you think it 
                                would have a negative impact if there is alot of 
                                information stored in the Global?<BR><BR>Should 
                                I investigate some kind of storage that is 
                                contained between machines but is updated using 
                                publisher/subscriber model?<BR><BR>Any input 
                                would be much 
                                appreciated,<BR><BR>Regards,<BR><BR>Mark 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=924112&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=924112&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=924112">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=924112">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=924112&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF924112 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1061667,924112,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F794755_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx794755xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=794755#xx794755xx" 
                        name=794755>plz, answer!!</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=15 alt=suss 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/usersuss.gif" 
                        width=14></TD>
                      <TD class=Frm_MsgAuthor>Anonymous</TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:17 17 
                        Apr '04 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F794755_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>very professional!!<BR><BR>how u 
                                decide the weight of eache 
                                counter??<BR><BR>let's say that for one task one 
                                counter is more importans then for another 
                                one...<BR>plz, answer <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=794755&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=794755&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=794755">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=794755">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=794755&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt style="TEXT-ALIGN: right"><A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=794755&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=m">Edit</A>·<A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=794755&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=d">Delete</A><BR><SPAN 
                                id=MVF794755 style="WHITE-SPACE: nowrap">2.00/5 
                                (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(0,794755,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F795138_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx795138xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=795138#xx795138xx" 
                        name=795138>Re: plz, answer!!</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=39071">Stoyan 
                        Damov</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:15 18 
                        Apr '04 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F795138_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Well, that's why there's a 
                                configuration file, where *you* select the 
                                performance counters and their weight. It's you, 
                                who decide the weights. Open the .zip file, go 
                                to the "Shared Files" folder and take a look at 
                                the "PerformanceCounters" XML node in the 
                                "LoadBalancingConfiguration.xml" 
                                file.<BR><BR>Cheers,<BR>Stoyan 
                                <BR><BR><SMALL>VB.NET coders need 
                                "IntelliSense", C# coders only need their 
                                "CommonSense" and "IntelliGence". <BR>That's the 
                                difference <IMG title=Wink 
                                src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_wink.gif" 
                                align=top></SMALL> Robert Fuchs<BR><BR><B>Always 
                                optimize for size</B><BR><CODE><BR>#define class 
                                union<BR>#define struct union</CODE> <IMG 
                                title=Smile 
                                src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=795138&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=795138&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=794755">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=795138">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=795138&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF795138 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(39071,795138,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote Rt HdUnSel " id=F742996_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx742996xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=742996#xx742996xx" 
                        name=742996>plsss help me!!!!!</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=15 alt=suss 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/usersuss.gif" 
                        width=14></TD>
                      <TD class=Frm_MsgAuthor>Anonymous</TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:59 18 
                        Feb '04 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F742996_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><IMG title=Confused 
                                src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_confused.gif" 
                                align=top>hello,<BR>that was a gr8 article on 
                                load balancing. i read ur article but i could 
                                not understand how u managed to get the 
                                performance counters. that is the actual 
                                implementation of deriving the performance 
                                counters.<BR><BR>plsss correct me if i am 
                                wrong!!!!!<IMG title=OMG 
                                src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_OMG.gif" 
                                align=top><IMG title=Confused 
                                src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_confused.gif" 
                                align=top> <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=742996&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=742996&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=742996">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=742996">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=742996&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt style="TEXT-ALIGN: right"><A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=742996&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=m">Edit</A>·<A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=742996&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=d">Delete</A><BR><SPAN 
                                id=MVF742996 style="WHITE-SPACE: nowrap">5.00/5 
                                (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(0,742996,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F696231_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx696231xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=696231#xx696231xx" 
                        name=696231>can't handle session object?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=15 alt=suss 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/usersuss.gif" 
                        width=14></TD>
                      <TD class=Frm_MsgAuthor>azure_sss</TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:14 
                        20 Dec '03 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F696231_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I installed the application and 
                                everything works fine.But the only problem is 
                                that when the request is being redirected to a 
                                server for the first time,a new session is 
                                start.That means session objects can't be 
                                used.As far as I know,if you use cookie to 
                                maintain the session state,the cookie will be 
                                passed on every http request.So I think maybe 
                                it's the problem in reconstructing the 
                                url(ReplaceHostInUrl function?).Correct me if I 
                                get it wrong,thanks <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=696231&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=696231&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=696231">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=696231">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=696231&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt style="TEXT-ALIGN: right"><A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=696231&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=m">Edit</A>·<A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=696231&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=d">Delete</A><BR><SPAN 
                                id=MVF696231 style="WHITE-SPACE: nowrap">3.00/5 
                                (2 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(0,696231,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F621256_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx621256xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=621256#xx621256xx" 
                        name=621256>load balancing help !</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=434988">dharani</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">23:44 
                        25 Sep '03 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F621256_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello author / all<BR>Its a nice 
                                article . I have written a voice chat server . I 
                                want to load balance it. Thats I will run two 
                                copies of the server in two machines. One of two 
                                server copies will be ready for connection from 
                                clients . So when the connections come from 
                                clients I will have to "redirect or deflect " 
                                the connection attempt to the other copy . The 
                                problem is I dont know how to deflect the 
                                connectioon attempt coming to one machine ( to a 
                                IP+port)<BR>into a connection attempt for 
                                another IP+port ?<BR>please advise me<BR>I am 
                                using CSocket<BR>bye<BR>thank u 
                                <BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=621256&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=621256&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=621256">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=621256">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=621256&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF621256 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(434988,621256,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F622101_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx622101xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=622101#xx622101xx" 
                        name=622101>Re: load balancing help !</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=39071">Stoyan 
                        Damov</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">14:38 
                        26 Sep '03 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F622101_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><SMALL><B>dharani 
                                wrote:</B></SMALL><BR><I>Its a nice article 
                                </I><BR><BR>Thanks<IMG title=Smile 
                                src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top><BR><BR><SMALL><B>dharani 
                                wrote:</B></SMALL><BR><I>The problem is I dont 
                                know how to deflect the connectioon attempt 
                                coming to one machine ( to a IP+port)<BR>into a 
                                connection attempt for another IP+port 
                                ?</I><BR><BR>You can't do it that 
                                transparently... I suggest that you define some 
                                sort of a chat protocol, which supports 
                                redirects (something like Microsoft MSN 
                                messenger). Let's name a client with "C". Let's 
                                assume that the client can send a command 
                                "COMMAND". Here are two communication 
                                scenarios:<BR><BR>// client connects to the 
                                well-known server A (or it connects round-robin 
                                to one of many well-known servers, or whatever 
                                you think is good enough for your case<IMG 
                                title=Smile 
                                src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top><BR><BR><B>Scenario 1</B>: The server 
                                is not busy and serves the request 
                                immediately<BR><BR><CODE><BR>&lt;&lt; C connects 
                                to A &gt;&gt;<BR>C: COMMAND<BR>A: +OK // the 
                                server is not busy and serves the 
                                request<BR></CODE><BR><BR><B>Scenario 2</B>: The 
                                server may refuse a command and ask the client 
                                to re-issue it 
                                elsewhere<BR><BR><CODE><BR>&lt;&lt; C connects 
                                to A &gt;&gt;<BR>C: COMMAND<BR>A: -REDIRECT B // 
                                A suggests C to retry the command at 
                                B<BR>&lt;&lt; C connects to B &gt;&gt;<BR>C: 
                                COMMAND<BR>B: -REDIRECT X,Y // B suggests C to 
                                retry the command at either X or Y<BR>&lt;&lt; C 
                                connects to X&gt;&gt;<BR>C: COMMAND<BR>X: +OK // 
                                finally, X served C<BR></CODE><BR><BR>Your 
                                client pseudo C++ code will look something like 
                                this:<BR><BR><CODE><BR>// Error checking skipped 
                                for clarity<BR>SocketClient* pClient = new 
                                SocketClient();<BR>ArrayList* pServers = 
                                GetWellKnownServerNames();<BR>while 
                                (!pClient-&gt;Send(PickRandomServer(pServers), 
                                "COMMAND", &amp;pServers))<BR>{<BR>// you may 
                                want to try N number of times, have a timeout, 
                                etc.<BR>// instead of blocking infinitely, until 
                                a server becomes "available"<BR><BR>// note that 
                                after the Send call is done, pServers may be the 
                                ones,<BR>// suggested by the server, refused the 
                                request<BR>}<BR></CODE><BR><BR>Hope that 
                                helps,<BR><BR>Stoyan <BR><BR><SMALL>He who fails 
                                to design for performance, performs a design 
                                failure. <I>(Dov Bulka, David Mayhew in 
                                Efficient C++ Programming 
                                Techniques)</I></SMALL><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=622101&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=622101&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=621256">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=622101">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=622101&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF622101 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(39071,622101,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F622269_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx622269xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=622269#xx622269xx" 
                        name=622269>Re: load balancing help !</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=434988">dharani</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">20:24 
                        26 Sep '03 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F622269_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hello stoyan thank a lot!!<BR>This 
                                really is the idea i too had in mind . But first 
                                I dont know how to <BR>"Redirect" a connection 
                                attempt from a client to another server's IP+ 
                                port. And I looke dat ur pseudo code there u try 
                                sending connection attempts to a list of servers 
                                right ? But the scenario here is totally 
                                different coz to tell u what my code really does 
                                is :<BR><BR>My app is a proxy server for 
                                SHOUTcast mp3 voice streaming . The SHOUTcast 
                                (shoutcast.com) has a set of utilities called 
                                DSP plugin( the client ) and a SHOUTcast server. 
                                The purpose of both is that if u have a winamp 
                                player and with DSP installed u can broadcast ur 
                                voice / songs live to the SHOUTcast server 
                                running anywhere . SO when u connect from DSP to 
                                a particular SHOUTcast server it will recive the 
                                buffer from ur DSP ( ie winamp) and whenever any 
                                listeners want to listen to ur voice buffer it 
                                will send the voice buffer to them . So I wrote 
                                a proxy that will infact take the connection 
                                attempt from multiple DSPs My Proxy runs a copy 
                                of SHOUTCast server for each DSP ( ie 
                                broadcaster ) so this proxy avoids the 
                                workaround anybody has to do for running 
                                multiple voice transmission at a time . And this 
                                proxy will also take the listener attempt and 
                                will connect to the appropriate SHOUTcast server 
                                copies . sorry for so much of deatils !!<BR>I 
                                said this coz the client ( here DSP ..who 
                                braodcasts) program is not mine so I cannot 
                                possibly try for connection attempts to multiple 
                                servers !! So thats y want a deflecting mechnism 
                                . I hope u will be able to give me a good idea 
                                ..<BR>pl help me more to solve this out ..<BR>to 
                                put it in right words <BR>assume a server runs 
                                and listens at a IP 
                                <BR><BR>pServer--&gt;Listen()<BR>and when it 
                                gets connection attempt to it ..<BR>thats in the 
                                <BR>pServer--&gt;OnAccept()<BR>{<BR>//here we 
                                usually accept() the incoming connection as 
                                follows<BR>CMySocket* cltsock;<BR>cltSock=new 
                                CMySocket;<BR>pServer-&gt;Accept(*cltSock) // 
                                right ..? but what i want to so is <BR>//instead 
                                of accepting the connection here in the real 
                                proxy i want to forward the<BR>//connection to 
                                some other server copy running in another 
                                IP+port <BR>//i want to do this coz ..if I 
                                accept() the clt connection then this proxy 
                                will<BR>// also must take care of reciving the 
                                buffer which i should not do ..<BR>//but should 
                                instead have the other server receive the 
                                attempt ..and so on ...<BR><BR><BR>}<BR><BR>I 
                                hope u got what i said ...now please proceed 
                                from here ...<BR>thank u very much 
                                <BR>dharanibabus@hotmail.com<BR>NB: thank u CP 
                                for allowing me to talk to such nice helping 
                                minded ppl ...<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=622269&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=622269&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=621256">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=622269">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=622269&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF622269 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(434988,622269,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F382667_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx382667xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=382667#xx382667xx" 
                        name=382667>Remoting object instantiation</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=52702">pgbross</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">10:13 7 
                        Jan '03 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F382667_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Stoyan,<BR>With .NET Remoting it 
                                is acceptible to instantiate an object on a 
                                server using normal semantics and then use 
                                RemotingServices.Marshal to make the object 
                                accessible.<BR><BR>e.g.<BR><CODE>private void 
                                registerserverobject(int id)<BR>{<BR>TcpChannel 
                                chan;<BR>IDictionary channelProps=new 
                                Hashtable();<BR>channelProps["port"]=RAPORT;<BR>chan=new 
                                TcpChannel(channelProps, null, 
                                null);<BR>ChannelServices.RegisterChannel(chan);<BR>RAServerObject 
                                myobject=new 
                                RAServerObject(id);<BR>RemotingServices.Marshal(myobject, 
                                RAObjectURI);<BR>}</CODE><BR><BR>where RAPORT is 
                                the port to listen on and RAObjectURI is the 
                                desired URI.<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=382667&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=382667&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=382667">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=382667">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=382667&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF382667 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(52702,382667,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F384391_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx384391xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=384391#xx384391xx" 
                        name=384391>Re: Remoting object instantiation</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        height=15 alt=suss 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/usersuss.gif" 
                        width=14></TD>
                      <TD class=Frm_MsgAuthor>Stoyan Damov</TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:02 9 
                        Jan '03 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F384391_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>10x, I'll fix my stupidity in the 
                                next version...<BR><BR>Cheers,<BR>Stoyan 
                                <BR><BR><SMALL><I>Science may never come up with 
                                a better office-communication system than the 
                                coffee-break</I> (Earl 
                                Wilson)</SMALL><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=384391&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=384391&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=382667">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=384391">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=384391&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt style="TEXT-ALIGN: right"><A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=384391&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=m">Edit</A>·<A 
                                class=Frm_MHL 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=384391&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=d">Delete</A><BR><SPAN 
                                id=MVF384391 style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(0,384391,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F367119_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx367119xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=367119#xx367119xx" 
                        name=367119>and also words of thanks</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=91152">Tomer</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:14 
                        16 Dec '02 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F367119_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>to Sun and JAVA for giving 
                                Microsoft a foundation to base their .NET 
                                technology on <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=367119&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=367119&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=367119">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=367119">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=367119&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF367119 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(91152,367119,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F848250_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx848250xx></A><IMG height=16 alt=General 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;select=848250#xx848250xx" 
                        name=848250>Re: and also words of thanks</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=499267">stargazer_13</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:10 12 
                        Jun '04 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F848250_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>bla bla bla <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=848250&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=13760&amp;select=848250&amp;floc=/KB/mcpp/loadbalancing.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;tid=367119">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=13760&amp;msg=848250">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=848250&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF848250 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(499267,848250,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Tuesday, July 29, 2008 12:24 AM &nbsp; &nbsp; 
                  Last Update:Thursday, August 14, 2008 11:08 AM</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><B>1</B><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>2</A> <A class=Frm_HL 
                  href="http://www.codeproject.com/KB/mcpp/loadbalancing.aspx?fid=13760&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next 
      »</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 alt=General 
      src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_general.gif" 
      width=16 align=top> General &nbsp;&nbsp; <IMG height=16 alt=News 
      src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_news.gif" 
      width=16 align=top> News &nbsp;&nbsp; <IMG height=16 alt=Question 
      src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_question.gif" 
      width=16 align=top> Question &nbsp;&nbsp; <IMG height=16 alt=Answer 
      src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_answer.gif" 
      width=16 align=top> Answer &nbsp;&nbsp; <IMG height=16 alt=Joke 
      src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_joke.gif" 
      width=16 align=top> Joke &nbsp;&nbsp; <IMG height=16 alt=Rant 
      src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_rant.gif" 
      width=16 align=top> Rant &nbsp;&nbsp; <IMG height=16 alt=Admin 
      src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/msg_admin.gif" 
      width=16 align=top> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=3338">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy </A>| <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 9 Dec 2002<BR>Editor: <A 
            id=ctl00_ArticleEditor 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1">Chris 
            Maunder</A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2002 by Stoyan 
            Damov<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2008 
            <BR>Web13 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE>
      <CENTER></CENTER></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE><BR>
<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject _NET Dynamic Software Load Balancing_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
new HVMenu(new menu_NavbarConfig());
//]]></SCRIPT>
</BODY></HTML>
