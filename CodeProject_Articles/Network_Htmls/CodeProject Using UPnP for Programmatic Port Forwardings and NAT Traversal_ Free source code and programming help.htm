<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0049)http://www.codeproject.com/KB/IP/PortForward.aspx -->
<HTML><HEAD><TITLE>CodeProject: Using UPnP for Programmatic Port Forwardings and NAT Traversal. Free source code and programming help</TITLE>
<SCRIPT language=javascript src=""></SCRIPT>

<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="Universal Plug-n-Play lets your program create and edit port mappings in your router over the network.; Author: Mike O'Neill; Section: Internet / Network; Chapter: Web Development" 
name=Description>
<META 
content="VC6, NT4, Win2K, WinXP, VS6, MFC, Dev, Intermediate,Internet / Network,Web Development,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("www.codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/jxs.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/bookmark.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/rateitem.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function MarkAns(MemberID,MsgID,QID) {
 document.write(unescape("%3Cdiv class=\"CallOut\"%3E"));
 document.write("Was this a good answer to your question? ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+", "+MsgID.toString()+",6,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"correct\" border=\"0\" align=\"absmiddle\" /%3E Yes%3C/a%3E"));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+","+MsgID.toString()+",7,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"correct\" style=\"margin-left:10px\" border=\"0\" align=\"absmiddle\" /%3E No%3C/a%3E"));
 document.write(unescape("%3C/div%3E"));
}
function MsgVFrm(MemberID,MsgID,GB,gp,bp,mt){
 if(!GB)document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"5":"1")+unescape(",0);\"%3E"));
 if(GB) document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;"); else for(var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"vote this message a " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ",0)\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"1":"5")+unescape(",0);\"%3E"));
 if(GB)document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" border=\"0\" alt=\"vote 5\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;&nbsp; "); else document.write(unescape("%3Cbr /%3E")); document.writeln(unescape("[%3Ca href='#xx") + MsgID.toString() +"xx' title='Report as Abuse' onclick='return ReportMsg(" + MemberID.toString());
 document.writeln(", " + MsgID.toString() + unescape(",-2)'%3EReport Message%3C/a%3E]"));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?"))
  return RateMsg(userid, msgid, score, 0);
 else return false;
}
function RateMsg(memberid, msgid, score, questionId) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4){
   if (req.status == 200){
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match&&match[1])?match[1]:"An error occured" + unescape("%3C/b%3E");
   } else
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString()+"&qid="+questionId.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK 
href="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/ForumClassicIE6.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" type=image/ico rel="shortcut icon">
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            id=ctl00_Logo 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; WIDTH: 225px; HEIGHT: 90px; BORDER-RIGHT-WIDTH: 0px" 
            alt="The Code Project" 
            src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/logo225x90.gif"></A></TD>
          <TD class=HeaderBanner align=right width="100%">
            <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6721%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fxoreax_808_leader_728x90.gif%26C%3dFalse%26adid%3d6721%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22728%22%20height%3d%2290%22%3e%3c%2fa%3e"));</SCRIPT>
          </TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">5,386,863 
                  members and growing! (14,492 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">Abdelrady_FCIS</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx">My 
                  Settings</A> | <A id=ctl00_MemberMenu_MyCodeProject 
                  href="http://www.codeproject.com/script/Membership/MyCodeProject.aspx"><B>My 
                  CodeProject</B></A> | <A id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/fave.gif" 
                  width=16 align=absMiddle border=0> My Bookmarks</A> | <A 
                  id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2fIP%2fPortForward.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD noWrap><A href="http://www.codeproject.com/">Home</A></TD>
                <TD>&nbsp; </TD>
                <TD style="FONT-WEIGHT: normal" noWrap align=right>Current 
                  Site:</TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/">C++ / .NET</A></TD>
                <TD noWrap><A href="http://java.codeproject.com/">Java</A></TD>
                <TD noWrap><A href="http://sql.codeproject.com/">SQL</A></TD>
                <TD noWrap><A href="http://lamp.codeproject.com/">Linux / 
                  Unix</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus>
                  <DIV id=MenuPos 
                  style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=380>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
                        Board</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
            Development</A> » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/IP/">Internet / Network</A> » <A 
            id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/IP/index.aspx?#Internet / Network - General">General</A> 
            <SPAN class=ArticleIntermediate 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Intermediate</SPAN> <SPAN 
            id=ctl00_ArticleTopHeader_LicenceTerms></SPAN><BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>Using UPnP for Programmatic 
            Port Forwardings and NAT Traversal</SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=208786">Mike 
            O'Neill</A></B><BR><BR><SPAN class=ArticleTopDescr 
            id=ctl00_ArticleTopHeader_ArticleDescr>Universal Plug-n-Play lets 
            your program create and edit port mappings in your router over the 
            network.</SPAN> </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>VC6, C++Windows, NT4, 
            Win2K, WinXP, MFC, VS6, Visual Studio, Dev</SPAN><BR><BR><SPAN 
            style="WIDTH: 14ex">Posted</SPAN>: <B>2 Mar 2006</B><BR><SPAN 
            style="WIDTH: 14ex">Updated</SPAN>: <B>14 Mar 2006</B> <BR><SPAN 
            style="WIDTH: 14ex">Views</SPAN>: <B>113,301</B><BR><SPAN 
            style="WIDTH: 14ex">Bookmarked</SPAN>: <B>92 times</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar" 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px">
      <TABLE cellPadding=2>
        <TBODY>
        <TR vAlign=center>
          <TD><IMG height=10 alt=Comp 
            src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/startrek.gif" 
            width=24></TD>
          <TD><A 
            href="http://www.codeproject.com/script/Awards/Competition.aspx?cid=274">Summer 
            Code Competition!</A></TD></TR>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/info_24.png" 
            width=24></TD>
          <TD><A 
            href="http://www.codeproject.com/script/Awards/Competition.aspx?cid=270">New 
            thawte <BR>Scavenger Hunt!</A></TD></TR>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/info_24.png" 
            width=24 align=middle></TD>
          <TD><A id=ctl00_Announcements_CompLink 
            href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
            Competition</A></TD></TR></TBODY></TABLE></DIV>
      <DIV class=FeatureBlockHeader style="MARGIN-TOP: 7px">Want a new 
Job?</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <UL class=InfoList>
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=93">Lead 
        Graphical User Interface Developer</A> at ECTPay in United States
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=50">Senior 
        .NET Programmer/Architect</A> at Greater Than Solutions in United States
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=143">C#/ 
        ASP.NET Developer</A> at LiveOffice in United States
        <LI><A href="http://www.codeproject.com/script/Jobs/List.aspx">View 
        Latest Jobs...</A></LI></UL></DIV>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2>
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MIS id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3 style="DISPLAY: none">
      <DIV class=MI id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4 style="DISPLAY: none">
      <DIV class=MI id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5 style="DISPLAY: none">
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV>
      <DIV class=MI id=Section126><A 
      href="http://www.codeproject.com/KB/codegen/">Code 
      Generation</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter12');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=12">Third 
      Party Products</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter12 style="DISPLAY: none">
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section124><A 
      href="http://www.codeproject.com/KB/solution-center/">Solution 
      Center</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
Board</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/kb/Showcase/">Product Showcase</A></DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/WhitePapers">WhitePapers / 
      Webcasts</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/QuestSQL">Quest SQL Zone</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/Acresso">InstallShield 
      2009</A></DIV><BR>
      <DIV style="MARGIN-BOTTOM: 10px; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d5302%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fIBMdeveloperWorks_150x80.gif%26C%3dFalse%26adid%3d5302%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22150%22%20height%3d%2280%22%3e%3c%2fa%3e"));</SCRIPT>
      </DIV>
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6125%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fBCG2_160x600.gif%26C%3dFalse%26adid%3d6125%22%20alt%3d%22Business%20Components%20Gallery%20Pro%20-%20Windows%20GUI%20solutions.%22%20border%3d%220%22%20width%3d%22160%22%20height%3d%22600%22%3e%3c%2fa%3e"));</SCRIPT>
    </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION> <OPTION value=s>Jobs</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top>
            <TABLE>
              <TBODY></TBODY></TABLE>
            <DIV class=SmallText><IMG style="VERTICAL-ALIGN: middle" height=16 
            alt=print 
            src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/print.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
            href="http://www.codeproject.com/KB/IP/PortForward.aspx?display=Print">Print</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Broken Article?" 
            src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/report.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_BrokenLnk 
            href="http://www.codeproject.com/script/Articles/Report.aspx?aid=13285">Report 
            Article</A> &nbsp; <IMG style="VERTICAL-ALIGN: middle" alt=Watch 
            src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/watchon.png"> 
            <A class="" id=bmw_13285,2 onclick="return watchMe(13285, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=13285&amp;obtid=2&amp;bma=AddWatch" 
            name=ajaxBookmarkWatchLink>Watch</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN><SPAN 
            id=ctl00_ArticleHeaderLinks_ArticleBmkWatch_Message></SPAN>&nbsp; 
            <IMG style="VERTICAL-ALIGN: middle" height=16 alt=Bookmark 
            src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/link.png" 
            width=16> <A class="" id=bm_13285,2 
            onclick="return bookmarkMe(13285, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=13285&amp;obtid=2&amp;bma=AddBookmark" 
            name=ajaxBookmarkLink>Bookmark</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN><SPAN 
            id=ctl00_ArticleHeaderLinks_ArticleBmk_Message></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Discuss 
            src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/discuss.gif" 
            width=15> <A 
            href="http://www.codeproject.com/KB/IP/PortForward.aspx#_comments">Discuss</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Recommend Article" 
            src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/mail.gif" 
            width=16>&nbsp;<A id=ctl00_ArticleHeaderLinks_Recommend 
            href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=13285">Send&nbsp;to&nbsp;a&nbsp;friend</A> 
            </DIV></TD>
          <TD style="WIDTH: 100px; WHITE-SPACE: nowrap; TEXT-ALIGN: right">
            <TABLE id=CurRat>
              <TBODY>
              <TR>
                <TD>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=SmallText id=ctl00_ArticleRating_VL 
                      style="WHITE-SPACE: nowrap" align=right><SPAN 
                        id=ctl00_ArticleRating_VoteLabel>59 votes for this 
                        Article.</SPAN></TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=1>
                          <TBODY>
                          <TR>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD noWrap width=20 bgColor=white height=7><IMG 
                              height=7 
                              src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/red.gif" 
                              width=15 align=center 
                      border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=ctl00_ArticleRating_PopularityRow>
                      <TD class=SmallText align=right colSpan=2><A 
                        id=ctl00_ArticleRating_PopularityLnk 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                        8.38</A> <SPAN 
                        id=ctl00_ArticleRating_PopularityLbl></SPAN><SPAN 
                        id=ratingVal>Rating: <B>4.73</B> out of 
                    5</SPAN></TD></TR></TBODY></TABLE></TD>
                <TD>
                  <DIV>
                  <TABLE class=HistTable 
                  title="Voting Distribution. Recent data only">
                    <TBODY>
                    <TR>
                      <TD><IMG title="1 vote, 1.7%" height=1 
                        alt="1 vote, 1.7%" 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>1</TD>
                      <TD><IMG title="2 votes, 3.4%" height=1 
                        alt="2 votes, 3.4%" 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>2</TD>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>3</TD>
                      <TD><IMG title="5 votes, 8.5%" height=1 
                        alt="5 votes, 8.5%" 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>4</TD>
                      <TD><IMG title="51 votes, 86.4%" height=20 
                        alt="51 votes, 86.4%" 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/pollcol.gif" 
                        width=10 
              border=0><BR>5</TD></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><SPAN 
      id=intelliTXT>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/IP/PortForward/Demo-PortForward.zip">Download 
        the PortForward demo project (includes a release-build executable that 
        you can run without the need to compile) - 131 Kb</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/IP/PortForward/PortForward-Installation-Package.zip">Download 
        an installation package (installs the PortForward utility, together with 
        a user-oriented "Help" file) - 462 Kb</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/IP/PortForward/CPortForwardEngine.zip">Source 
        code for the PortForward engine only - 11.5 Kb</A> </LI></UL>
      <P><IMG height=403 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/Basic-Screenshot.gif" 
      width=600></P>
      <H2><A name=topmost>Contents</A></H2>
      <UL>
        <LI><A 
        href="http://www.codeproject.com/KB/IP/PortForward.aspx#Introduction">Introduction</A> 

        <LI><A 
        href="http://www.codeproject.com/KB/IP/PortForward.aspx#Requirements">Requirements 
        for UPnP</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/IP/PortForward.aspx#Debate">The 
        debate: Convenience vs. Security</A> 
        <LI><A href="http://www.codeproject.com/KB/IP/PortForward.aspx#Demo">The 
        demo program</A> 
        <UL>
          <LI><A 
          href="http://www.codeproject.com/KB/IP/PortForward.aspx#Engine">The 
          engine</A> 
          <LI><A href="http://www.codeproject.com/KB/IP/PortForward.aspx#UI">The 
          UI</A> </LI></UL>
        <LI><A 
        href="http://www.codeproject.com/KB/IP/PortForward.aspx#Installation">Installation 
        package</A> 
        <LI><A href="http://www.codeproject.com/KB/IP/PortForward.aspx#Rant">A 
        quick rant</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/IP/PortForward.aspx#Bibliography">Bibliography 
        and reference materials</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/IP/PortForward.aspx#Version">License 
        information</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/IP/PortForward.aspx#History">History</A> 
        </LI></UL>
      <H2><A name=Introduction>Introduction</A></H2>
      <P>Universal Plug-n-Play ("UPnP") is an attempt to extend the concept of 
      ordinary plug-n-play, so that it applies to more than just your own 
      machine: it applies to the whole network. For example, with ordinary 
      plug-n-play, when a new peripheral is connected to your machine, it is 
      automatically discovered and configured from your machine without access 
      to the peripheral itself. UPnP extends this idea to the network: when a 
      new network device is connected to the network, it can be automatically 
      discovered over the network, and configured remotely from your machine 
      over the network.</P>
      <P>The idea is that a device can dynamically join a wired or wireless 
      network, obtain an IP address, convey its capabilities, and learn about 
      the presence and capabilities of other devices all over the network. UPnP 
      envisions a future where all devices are networkable and controllable over 
      the network, such as light switches, thermostats, toasters, automobiles, 
      etc. More information can be found <A href="http://www.upnp.org/" 
      target=_blank>here</A>.</P>
      <P>Since 2002, most routers have UPnP capability. This allows you to solve 
      one of the more vexing problems for users of network programs that must 
      accept an incoming connection from the Internet. Examples of these 
      programs include P2P file sharing programs, interactive games and gaming, 
      video conferencing, and web or proxy servers. To allow others on the 
      Internet to connect to these programs, it is necessary to configure the 
      router to accept incoming connections and to route the connection to a 
      local machine on the LAN behind the router. This process is called "port 
      forwarding" or "NAT traversal" ("Network Address Translation").</P>
      <P>For the ordinary user, this process can be daunting. Moreover, it's 
      often not easy to explain how to configure a router for port forwarding, 
      for the reason that the method differs for each different type of router 
      by each different manufacturer.</P>
      <P>UPnP works perfectly in this situation. With it, you can map a 
      port-forwarding programmatically without user interaction.</P>
      <P>This article describes a utility that discovers current port mappings 
      on a UPnP-enabled router, and allows you to add/edit/delete mappings. The 
      utility is conceptually broken into two pieces: an engine that performs 
      the actual work, and the UI that uses the engine. This way, it should be 
      possible for you to re-use the engine for your own purposes.</P>
      <P><SMALL><A 
      href="http://www.codeproject.com/KB/IP/PortForward.aspx#topmost">go back 
      to top</A></SMALL></P>
      <H2><A name=Requirements>Requirements for UPnP</A></H2>
      <P>To be able to remotely configure a router over a network from a local 
      machine, you need the following:</P>
      <UL>
        <LI>UPnP on the local machine: Basically, you must have Windows® XP, any 
        service pack. Older versions of Windows, including the very-popular 
        Windows® 2000, will <B>not</B> work, as they do not have UPnP 
        capability. It might also be necessary to enable UPnP, since a 
        UPnP-capable OS does not necessarily have it turned on by default. 
        <LI>UPnP on your router: Most routers manufactured since 2002 will have 
        UPnP capability. Again, it might be necessary to enable UPnP on the 
        router, since it might not be turned on by default. </LI></UL>
      <P>In addition, if there is a firewall on the local machine, it must be 
      configured to allow the underlying TCP and UDP communications on which 
      UPnP relies. Specifically, it must be configured to pass TCP port 2869 and 
      UDP port 1900.</P>
      <P><SMALL><A 
      href="http://www.codeproject.com/KB/IP/PortForward.aspx#topmost">go back 
      to top</A></SMALL></P>
      <H2><A name=Debate>The debate: Convenience vs. Security</A></H2>
      <P>Before going on, it's worthwhile to point out the current debate over 
      whether it makes any sense to include UPnP capability on a router.</P>
      <P>Proponents argue based on convenience: It's hard to configure a router 
      for port forwarding, and average users are not able to do it easily. There 
      are different methods for each different router, and even if you can find 
      the correct method, understanding it requires the user to learn confusing 
      network terminology.</P>
      <P>Opponents argue that there's a significant security risk: Routers 
      insulate local networks from the wilds of the Internet, by blocking 
      incoming connections that are almost always malicious. This insulation is 
      at the hardware level, and as such, it is often more effective than 
      software such as software firewalls. Most users rely on this added layer 
      of insulation to protect machines on their local network, and the average 
      user relies on it without even being aware of it. But since UPnP allows 
      <B>any</B> program, even malicious programs, to create a port mapping 
      through the router, this added layer of insulation disappears. Moreover, 
      with UPnP, the port mapping can be created even without any knowledge of 
      the administrative password to the router, and thus can be created without 
      the knowledge or consent of the user.</P>
      <P>For me, I side with the opponents of UPnP for routers. The added layer 
      of security is a true benefit, and it benefits those most likely to need 
      it (i.e., relatively unsophisticated users who are most often targeted by 
      malicious programs). Moreover, although manual configuration of port 
      mappings is complicated, the programs that absolutely need it are also 
      complicated, and require a relatively higher level of user sophistication 
      anyway. Finally, there are many alternative program architectures that do 
      not rely on accepting incoming connections from the Internet (and hence do 
      not need port mappings at all); these architectures usually require a 
      third machine somewhere on the Internet (such as a rendezvous server or a 
      relay server), but they eliminate the need for incoming connections, and 
      operate just fine with outgoing connections only.</P>
      <P>But "security through obscurity" is never the answer. UPnP is here. 
      Here's how to use it.</P>
      <P><SMALL><A 
      href="http://www.codeproject.com/KB/IP/PortForward.aspx#topmost">go back 
      to top</A></SMALL></P>
      <H2><A name=Demo>The demo program</A></H2>
      <P>The demo program is conceptually broken into two parts: an engine for 
      the discovery of port mappings and for changing them, and a UI that uses 
      the engine to allow the user to do what he wants. The source code itself 
      is set up in a VC++ 6.0 workspace with four different configurations: 
      Unicode and non-Unicode, debug and release for both.</P>
      <P>Microsoft's implementation of UPnP relies on COM, so you might need to 
      become familiar with COM-style types such as <CODE>BSTR</CODE> and 
      <CODE>VARIANT</CODE>. The source code makes liberal use of ATL macros such 
      as <CODE>T2OLE</CODE> for conversion, where needed.</P>
      <P><SMALL><A 
      href="http://www.codeproject.com/KB/IP/PortForward.aspx#topmost">go back 
      to top</A></SMALL></P>
      <H3><A name=Engine>The engine</A></H3>
      <P>The engine actually performs three distinct types of tasks: device 
      discovery (i.e., finding the router and getting the device information 
      about it), retrieval of and changes to port mappings, and change-event 
      notifications. Here are the <CODE><SPAN 
      class=code-keyword>public</SPAN></CODE> methods:</P><PRE><SPAN class=code-comment>//</SPAN><SPAN class=code-comment> simplified view of PortForwardEngine.h
</SPAN>
<SPAN class=code-keyword>class</SPAN> CPortForwardEngine  
{
<SPAN class=code-keyword>public</SPAN>:

    CPortForwardEngine();
    <SPAN class=code-keyword>virtual</SPAN> ~CPortForwardEngine();
    
    HRESULT ListenForUpnpChanges(
        CPortForwardChangeCallbacks *pCallbacks = NULL);
    HRESULT StopListeningForUpnpChanges( );

    BOOL GetDeviceInformationUsingThread( HWND hWnd ); 
    BOOL GetMappingsUsingThread( HWND hWnd ); 
    BOOL EditMappingUsingThread( PortMappingContainer&amp; oldMapping, 
                       PortMappingContainer&amp; newMapping, HWND hWnd ); 
    BOOL AddMappingUsingThread( PortMappingContainer&amp; newMapping, 
                                                         HWND hWnd );
    BOOL DeleteMappingUsingThread( PortMappingContainer&amp; oldMapping, 
                                                         HWND hWnd ); 
    
    std::vector<SPAN class=code-keyword>&lt;</SPAN>PortMappingContainer<SPAN class=code-keyword>&gt;</SPAN> GetPortMappingVector() <SPAN class=code-keyword>const</SPAN>;  
    DeviceInformationContainer GetDeviceInformationContainer() <SPAN class=code-keyword>const</SPAN>;
    
    BOOL IsAnyThreadRunning() <SPAN class=code-keyword>const</SPAN>;  
};</PRE>
      <P>The first thing you might notice is the reliance on threads. As 
      implemented by Microsoft, UPnP relies on COM, and in this instance, COM is 
      slow, usually requiring around three (3) seconds to complete, and 
      sometimes requiring as many as ten (10) seconds. Not all the COM-related 
      UPnP methods block during the time that they execute, but many do. The 
      engine is therefore multi-threaded so that calls to its methods will not 
      block your UI.</P>
      <P>The threads created by the engine post notification messages to your UI 
      to advise your application of progress through the thread's execution, and 
      to advise you when the thread is complete. This is the reason why the 
      threaded functions each take a <CODE>HWND</CODE> as a parameter; this 
      parameter is the window to which messages are posted. The same message is 
      used for all of the engine's functions; the message is a <CODE>UINT</CODE> 
      named <CODE>UWM_PORT_FORWARD_ENGINE_THREAD_NOTIFICATION</CODE>. The 
      meaning of the message is encoded in the <CODE>WPARAM</CODE> and 
      <CODE>LPARAM</CODE> values of the message. The actual value of the message 
      is obtained by a call to <CODE>::RegisterWindowMessage()</CODE>, so your 
      UI must be prepared to handle registered messages. For MFC users, this 
      means that your message map will use the 
      <CODE>ON_REGISTERED_MESSAGE()</CODE> macro.</P>
      <P>The <CODE>IsAnyThreadRunning()</CODE> function is provided so that you 
      can test whether any thread is running, before the shut-down of the 
      program. This allows the thread object to <CODE><SPAN 
      class=code-keyword>delete</SPAN></CODE> itself, and prevents unintended 
      memory leaks of <CODE>CWinThread</CODE> objects.</P>
      <P>For device discovery, your application should call the 
      <CODE>GetDeviceInformationUsingThread()</CODE> function, which tries to 
      find a UPnP-enabled router on the local network and to obtain information 
      about the router (such as model name, manufacturer etc.) if a router is 
      found. When the thread is finished (as signified by the thread's posting 
      of a <CODE>UWM_PORT_FORWARD_ENGINE_THREAD_NOTIFICATION</CODE> message), 
      the UI can call <CODE>GetDeviceInformationContainer()</CODE> to get a 
      structure containing information about the device. Device discovery is 
      based on the COM interface <CODE>IUPnPDeviceFinder</CODE>, which is part 
      of Microsoft's "Control Point API". Documentation can be found at MSDN 
      entitled "<A 
      href="http://msdn.microsoft.com/library/en-us/upnp/upnp/control_point_api_with_upnp_technology_reference.asp" 
      target=_blank>Control Point API Reference</A>".</P>
      <P>Here's an explanation of the inner workings of 
      <CODE>GetDeviceInformationUsingThread()</CODE>. Inside the thread created 
      by the <CODE>GetDeviceInformationUsingThread()</CODE> function, 
      <CODE>CoCreateInstance()</CODE> is called to get an instance of 
      <CODE>IUPnPDeviceFinder</CODE>, and 
      <CODE>IUPnPDeviceFinder::FindByType()</CODE> is called to get a 
      <CODE>IUPnPDevices</CODE> collection of devices that match the requested 
      type of device. The collection is enumerated/traversed to find each 
      individual <CODE>IUPnPDevice</CODE> interface, and the following functions 
      are called on the <CODE>IUPnPDevice</CODE> interface (see <A 
      href="http://msdn.microsoft.com/library/en-us/upnp/upnp/iupnpdevice.asp" 
      target=_blank>the MSDN documentation for 
<CODE>IUPnPDevice</CODE></A>):</P><PRE>IUPnPDevice::IconURL()
IUPnPDevice::get_Property()
IUPnPDevice::get_Children()
IUPnPDevice::get_Description()
IUPnPDevice::get_FriendlyName()
IUPnPDevice::get_HasChildren()
IUPnPDevice::get_IsRootDevice()
IUPnPDevice::get_ManufacturerName()
IUPnPDevice::get_ManufacturerURL()
IUPnPDevice::get_ModelNumber()
IUPnPDevice::get_ModelName()
IUPnPDevice::get_ModelNumber()
IUPnPDevice::get_ModelURL()
IUPnPDevice::get_ParentDevice()
IUPnPDevice::get_PresentationURL()
IUPnPDevice::get_RootDevice()
IUPnPDevice::get_SerialNumber()
IUPnPDevice::get_Services()
IUPnPDevice::get_Type Uniform()
IUPnPDevice::get_UniqueDeviceName()
IUPnPDevice::get_UPC()</PRE>
      <P>Frankly speaking, once the <CODE>IUPnPDevices</CODE> collection is 
      obtained, the code is a bit tedious. The code is based in part on the 
      sample code found at MSDN: "<A 
      href="http://msdn.microsoft.com/library/en-us/upnp/upnp/device_collections_returned_by_synchronous_searches.asp" 
      target=_blank>Device Collections Returned by Synchronous 
Searches</A>".</P>
      <P>For retrieval of mappings, your application should call the 
      <CODE>GetMappingsUsingThread()</CODE> function. When the function's thread 
      completes (again, as signified by the thread's posting of a 
      <CODE>UWM_PORT_FORWARD_ENGINE_THREAD_NOTIFICATION</CODE> message to your 
      UI), the UI can call <CODE>GetPortMappingVector()</CODE> to get a 
      <CODE>std::vector</CODE> which contains a collection of structures, each 
      containing information about one mapping. Your application can also make 
      changes to the mappings using the three self-explanatory functions of 
      <CODE>EditMappingUsingThread()</CODE>, 
      <CODE>AddMappingUsingThread()</CODE>, and 
      <CODE>DeleteMappingUsingThread()</CODE>.</P>
      <P>The <CODE>GetMappingsUsingThread()</CODE> function is based on the COM 
      interface <CODE>IUPnPNAT</CODE>, which is part of Microsoft's "NAT 
      Traversal API". Documentation on this interface is scarce. For some 
      reason, Microsoft has chosen to group this API with its API for "Internet 
      Connection Sharing and Internet Connection Firewall". In addition to the 
      difficulties caused by grouping NAT traversal with connection sharing, the 
      on-line MSDN documentation for the NAT Traversal API does not have a 
      separate entry in the table of contents, and does not sync well. The base 
      page for documentation on <CODE>IUPnPNAT</CODE> is found at <A 
      href="http://msdn.microsoft.com/library/en-us/ics/ics/portal.asp" 
      target=_blank>MSDN</A>, entitled (simply) "IUPnPNAT".</P>
      <P>Inside the thread created by the <CODE>GetMappingsUsingThread()</CODE> 
      function, <CODE>CoCreateInstance()</CODE> is called to get an instance of 
      <CODE>IUPnPNAT</CODE>, and 
      <CODE>IUPnPNAT::get_StaticPortMappingCollection()</CODE> is called to get 
      a <CODE>IStaticPortMappingCollection</CODE> collection of static port 
      mappings. The collection is enumerated/traversed to find each individual 
      <CODE>IStaticPortMapping</CODE> interface, and the following functions are 
      called on the <CODE>IStaticPortMapping</CODE> interface (see <A 
      href="http://msdn.microsoft.com/library/en-us/ics/ics/istaticportmapping.asp" 
      target=_blank>the MSDN documentation for 
      <CODE>IStaticPortMapping</CODE></A>):</P><PRE>IStaticPortMapping::get_ExternalIPAddress()
IStaticPortMapping::get_ExternalPort()
IStaticPortMapping::get_InternalPort()
IStaticPortMapping::get_Protocol()
IStaticPortMapping::get_InternalClient()
IStaticPortMapping::get_Enabled()
IStaticPortMapping::get_Description()</PRE>
      <P>Much the same processing is performed inside the threads created by the 
      other port-mapping functions (i.e., inside the threads created by 
      <CODE>EditMappingUsingThread()</CODE>, 
      <CODE>AddMappingUsingThread()</CODE>, and 
      <CODE>DeleteMappingUsingThread()</CODE>), except that different ones of 
      the <CODE>IStaticPortMapping</CODE> functions are called, as follows:</P><PRE>IStaticPortMapping::Enable()
IStaticPortMapping::EditDescription()
IStaticPortMapping::EditInternalPort()
IStaticPortMapping::EditInternalClient()</PRE>
      <P>Event notification is interesting: every time there is a change in your 
      router's configuration, it broadcasts (UDP) the change over the network. 
      Microsoft's COM interface to UPnP can be configured to listen for these 
      broadcasts, and to call callbacks within your program (if you register the 
      callbacks properly). The changes are most commonly a change in a port 
      mapping, but a notification is also received when there is a change in the 
      router's external IP address.</P>
      <P>Implementation of event notification requires an actual implementation 
      of all the <CODE><SPAN class=code-keyword>virtual</SPAN></CODE> functions 
      for the two COM interfaces of <CODE>INATExternalIPAddressCallback</CODE> 
      and <CODE>INATNumberOfEntriesCallback</CODE>. Then, an interface to the 
      <CODE>IUPnPNAT</CODE>'s event manager (<CODE>INATEventManager</CODE>) is 
      obtained through a call to <CODE>IUPnPNAT::get_NATEventManager()</CODE>. 
      Using the <CODE>INATEventManager</CODE> interface, it's possible to 
      register the implementation of the derived 
      <CODE>INATExternalIPAddressCallback</CODE> interface 
      (<CODE>INATEventManager::put_ExternalIPAddressCallback()</CODE>) and to 
      register the implementation of the derived 
      <CODE>INATNumberOfEntriesCallback</CODE> interface 
      (<CODE>INATEventManager::put_NumberOfEntriesCallback()</CODE>).</P>
      <P>Because <CODE>INATExternalIPAddressCallback</CODE> and 
      <CODE>INATNumberOfEntriesCallback</CODE> are, in a sense, COM servers, it 
      is necessary to run them in the same thread as your main program, and 
      that's how they're implemented (in a single-threaded apartment ("STA") 
      model). Thus, event notifications are not run in a separate thread, unlike 
      all the other functions we have discussed so far.</P>
      <P>To get these notifications in your application, call 
      <CODE>ListenForUpnpChanges()</CODE>. The function takes a pointer to a 
      <CODE>CPortForwardChangeCallbacks</CODE> object, but if you pass in 
      <CODE>NULL</CODE>, the engine will use a default object. 
      (<CODE>CPortForwardChangeCallbacks</CODE> is defined in the same source 
      and header files as <CODE>CPortForwardEngine</CODE>, which is usually not 
      recommended but which helps to keep these classes all in one place.) The 
      default object simply displays a <CODE>::MessageBox()</CODE> indicating 
      that there has been a change. For more elaborate handling of 
      change-notification-events, derive your own class from 
      <CODE>CPortForwardChangeCallbacks</CODE> and override the <CODE><SPAN 
      class=code-keyword>virtual</SPAN></CODE> functions 
      <CODE>OnNewNumberOfEntries()</CODE> and 
      <CODE>OnNewExternalIPAddress()</CODE>. Here is the definition of the 
      <CODE>CPortForwardChangeCallbacks</CODE> class:</P><PRE><SPAN class=code-keyword>class</SPAN> CPortForwardChangeCallbacks  
{
<SPAN class=code-keyword>public</SPAN>:
    CPortForwardChangeCallbacks();
    <SPAN class=code-keyword>virtual</SPAN> ~CPortForwardChangeCallbacks();
    
    <SPAN class=code-keyword>virtual</SPAN> HRESULT OnNewNumberOfEntries( 
                        <SPAN class=code-keyword>long</SPAN> lNewNumberOfEntries );
    <SPAN class=code-keyword>virtual</SPAN> HRESULT OnNewExternalIPAddress( 
                        BSTR bstrNewExternalIPAddress );
    
};</PRE>
      <P>To use your <CODE>CPortForwardChangeCallbacks</CODE>-derived class, 
      <CODE><SPAN class=code-keyword>new</SPAN></CODE> one of them on the heap 
      and pass its pointer to the <CODE>ListenForUpnpChanges()</CODE> function, 
      like so:</P><PRE>ListenForUpnpChanges( <SPAN class=code-keyword>new</SPAN> CMyDerivedPortForwardChangeCallbacks() );</PRE>
      <P>You do not need to keep track of the new'd pointer; the engine will 
      automatically delete the object for you when it's finished with it.</P>
      <P><SMALL><A 
      href="http://www.codeproject.com/KB/IP/PortForward.aspx#topmost">go back 
      to top</A></SMALL></P>
      <H3><A name=UI>The UI</A></H3>
      <P>The UI uses the engine in fairly unsurprising ways. When the program is 
      started, it immediately calls 
      <CODE>GetDeviceInformationUsingThread()</CODE> to get and display 
      information about any UPnP-enabled routers on the LAN. If a router is 
      found, its name is displayed, and more information about it can be 
      displayed by clicking on the "More information ..." button, which displays 
      all the information obtained from the 
      <CODE>GetDeviceInformationUsingThread()</CODE> function in the following 
      dialog:</P>
      <P><IMG height=396 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/DeviceInfo.gif" 
      width=323></P>
      <P>Below the list of port mappings are four buttons that allow the user to 
      retrieve port mappings from the router and to edit/add/delete them. 
      Clicking one of these buttons invokes a corresponding one of the thread 
      functions <CODE>GetMappingsUsingThread()</CODE>, 
      <CODE>EditMappingUsingThread()</CODE>, 
      <CODE>AddMappingUsingThread()</CODE>, or 
      <CODE>DeleteMappingUsingThread()</CODE>. In addition, hidden progress bar 
      controls are shown, and other changes are made to the appearance of the 
      UI. Here's an example of the dialog that you see when a port mapping is 
      added; a similar dialog is displayed when a mapping is edited. Only a 
      confirmation-style dialog is displayed when a mapping is deleted.</P>
      <P><IMG height=254 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/AddMapping.gif" 
      width=272></P>
      <P>As mentioned above, the threads post messages to the UI to advise it of 
      the thread's progress. Here's a simplified view of the message-handler in 
      the UI, which responds to these messages:</P><PRE><SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>const</SPAN> <SPAN class=code-keyword>int</SPAN> msgPortRetrieve = 
       0x00F0 &amp; CPortForwardEngine::EnumPortRetrieveDone;
<SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>const</SPAN> <SPAN class=code-keyword>int</SPAN> msgDeviceInfo = 
       0x00F0 &amp; CPortForwardEngine::EnumDeviceInfoDone;
<SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>const</SPAN> <SPAN class=code-keyword>int</SPAN> msgAddMapping = 
       0x00F0 &amp; CPortForwardEngine::EnumAddMappingDone;
<SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>const</SPAN> <SPAN class=code-keyword>int</SPAN> msgEditMapping = 
       0x00F0 &amp; CPortForwardEngine::EnumEditMappingDone;
<SPAN class=code-keyword>static</SPAN> <SPAN class=code-keyword>const</SPAN> <SPAN class=code-keyword>int</SPAN> msgDeleteMapping = 
       0x00F0 &amp; CPortForwardEngine::EnumDeleteMappingDone;

afx_msg LRESULT 
  CPortForwardView::OnMappingThreadNotificationMessage(
  WPARAM wParam, LPARAM lParam)
{
    <SPAN class=code-keyword>switch</SPAN> ( wParam &amp; 0x00F0 )
    {
    <SPAN class=code-keyword>case</SPAN> msgPortRetrieve:
        
        <SPAN class=code-keyword>if</SPAN> ( wParam == CPortForwardEngine::EnumPortRetrieveInterval )
        {
            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> this is a periodic notification message;
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> update the progress control
</SPAN>            
            m_ctlProgressComUpdate.SetPos( lParam );
        }
        <SPAN class=code-keyword>else</SPAN> <SPAN class=code-keyword>if</SPAN> ( wParam == CPortForwardEngine::EnumPortRetrieveDone )
        {
            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> the thread is finished
</SPAN>            
            <SPAN class=code-keyword>if</SPAN> ( !SUCCEEDED(lParam) )
            {
                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> error: display message and take other action
</SPAN>            }
            <SPAN class=code-keyword>else</SPAN>
            {
                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> finished with no error,
</SPAN>                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get the vector of mappings and use it
</SPAN>                
                std::vector<SPAN class=code-keyword>&lt;</SPAN>CPortForwardEngine::
                     PortMappingContainer<SPAN class=code-keyword>&gt;</SPAN> mappingContainer;
                mappingContainer = 
                  m_PortForwardEngine.GetPortMappingVector();
        
                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> display the port mapping and otherwise use them, etc....
</SPAN>            }

            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> restore the appearance of the UI
</SPAN>        }
        
        <SPAN class=code-keyword>break</SPAN>;
        
    <SPAN class=code-keyword>case</SPAN> msgDeviceInfo:
        
        <SPAN class=code-keyword>if</SPAN> ( wParam == CPortForwardEngine::EnumDeviceInfoInterval )
        {
            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> this is a periodic notification message;
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> update the progress control
</SPAN>            
            m_ctlProgressIgdDeviceInfo.SetPos( lParam );
        }
        <SPAN class=code-keyword>else</SPAN> <SPAN class=code-keyword>if</SPAN> ( wParam == CPortForwardEngine::EnumDeviceInfoDone )
        {
            <SPAN class=code-keyword>if</SPAN> ( SUCCEEDED(lParam) )
            {
                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> finished with no error;
</SPAN>                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> get device information and use it
</SPAN>
                m_DeviceInfoContainer =  
                  m_PortForwardEngine.GetDeviceInformationContainer( );

                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> display the device information
</SPAN>                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> and otherwise use it, etc...
</SPAN>            }
            <SPAN class=code-keyword>else</SPAN>
            {
                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> error: display message and take other action                
</SPAN>            }

            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> restore the appearance of the UI
</SPAN>
        }
        
        <SPAN class=code-keyword>break</SPAN>;
        
    <SPAN class=code-keyword>case</SPAN> msgAddMapping:
        
        <SPAN class=code-keyword>if</SPAN> ( wParam == CPortForwardEngine::EnumAddMappingInterval )
        {
            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> this is a periodic notification message;
</SPAN>            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> update the progress control
</SPAN>            
            m_ctlProgressAddUpdate.SetPos( lParam );
        }
        <SPAN class=code-keyword>else</SPAN> <SPAN class=code-keyword>if</SPAN> ( wParam == CPortForwardEngine::EnumAddMappingDone )
        {
            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> the thread is finished
</SPAN>            
            <SPAN class=code-keyword>if</SPAN> ( !SUCCEEDED(lParam) )
            {
                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> error: display message and take other action                
</SPAN>            }
            <SPAN class=code-keyword>else</SPAN>
            {
                <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> finished with no error
</SPAN>            }

            <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> restore the appearance of the UI
</SPAN>
        }
        
        <SPAN class=code-keyword>break</SPAN>;
        
    <SPAN class=code-keyword>case</SPAN> msgEditMapping:
        
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> ... same as above for msgAddMapping
</SPAN>        
        <SPAN class=code-keyword>break</SPAN>;
        
    <SPAN class=code-keyword>case</SPAN> msgDeleteMapping:
        
        <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> ... same as above for msgAddMapping
</SPAN>        
        <SPAN class=code-keyword>break</SPAN>;
        
    <SPAN class=code-keyword>default</SPAN>:
        ASSERT ( FALSE );  <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> should never get here
</SPAN>    }
    <SPAN class=code-keyword>return</SPAN> 0L;
}</PRE>
      <P>The <CODE><SPAN class=code-keyword>enum</SPAN></CODE>s are defined in 
      the <CODE>CPortForwardEngine</CODE> class. Basically, there are five kinds 
      of messages (as measured by the <CODE>WPARAM</CODE> value of the message): 
      messages for device information, for port mapping retrieval, for editing a 
      mapping, for deleting a mapping, and for adding a mapping. There's a 
      separate section of a <CODE><SPAN class=code-keyword>switch</SPAN></CODE> 
      statement for each different type of message, and each section then 
      interprets the value passed by the <CODE>LPARAM</CODE> of the message.</P>
      <P>The precise values of the <CODE>WPARAM</CODE>s and the 
      <CODE>LPARAM</CODE>s are explained in the comments in the source code for 
      the engine.</P>
      <P>Change-event notifications are selected by checking the box labeled 
      "Automatically listen for changes in the router". When this box is 
      checked, the UI calls the engine's <CODE>ListenForUpnpChanges()</CODE> 
      function, providing the engine with a pointer to a 
      <CODE>CPortForwardChangeCallbacks</CODE>-derived object. The derived class 
      is only a bit more complex than the default class: it simply displays a 
      message asking the user if he wants to update the list of port mappings 
      automatically now or manually later. Here's an example of the notification 
      dialog when a change is detected in the number of mappings; a similar 
      dialog is also displayed if a change is detected in the external IP 
      address of the router:</P>
      <P><IMG height=139 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/ChangeDetected.gif" 
      width=360></P>
      <P>The UI also has a built-in web server, which is a nice feature for 
      testing whether a port-forward mapping is operational. The user checks the 
      box labeled "Start Web server", which in turn enables the web-server 
      controls on the right-hand side of the display. The user can then test for 
      incoming Internet connectivity, with the test results being displayed in 
      the user's default browser.</P>
      <P>To get this to work, the user must create a port mapping on the same 
      port as the listening port (which defaults to the arbitrary value of 
      "9542" in the program). Once the port mapping has been created, and the 
      program is set to listen for incoming connections, the test will cause a 
      connection to be made to an external web-based proxy, which in turn will 
      connect back through the user's machine using the newly-created port 
      mapping. A successful test will look like this:</P>
      <P><IMG height=356 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/Congratulations.gif" 
      width=526></P>
      <P>If the test fails, it's possible that the external proxy is not working 
      properly. The program is pre-configured with two proxies, so one of them 
      should always be working. New proxies can be added (and non-working ones 
      deleted) through modifications to the program's <I>PortForward.ini</I> 
      file. Other changes can also be made to this <I>ini</I> file, which is 
      largely self-explanatory.</P>
      <P><SMALL><A 
      href="http://www.codeproject.com/KB/IP/PortForward.aspx#topmost">go back 
      to top</A></SMALL></P>
      <H2><A name=Installation>Installation package</A></H2>
      <P>The download includes an installation package that installs the 
      PortForward executable along with a short "Help" file 
      (<I>PortForward.chm</I>). The installation package is named 
      "<I>PortForward100-Setup.exe</I>", and the only changes made to your 
      machine are the creation of a new directory (usually "<I>c:\\Program 
      Files\PortForward</I>") and installation there of the executable and a few 
      support files. There are no other changes made to your machine, not in the 
      registry, not in the Windows folder, not anywhere else. There's even an 
      un-installation program, so you can install the program with confidence. 
      This installation package was built using <A 
      href="http://www.jrsoftware.org/isinfo.php" target=_blank>Inno Setup</A>, 
      which I highly recommend.</P>
      <P><SMALL><A 
      href="http://www.codeproject.com/KB/IP/PortForward.aspx#topmost">go back 
      to top</A></SMALL></P>
      <H2><A name=Rant>A quick rant</A></H2>
      <P>Although this article is finished, I can't resist the opportunity for a 
      quick rant.</P>
      <P>Why is it so hard to find documentation about this stuff? COM is 
      difficult enough as it is (at least for me) without those difficulties 
      being compounded by documentation that's hard to find, poorly organized, 
      and incomplete. Microsoft's documentation for the <CODE>IUPnPNAT</CODE> 
      interface, for example, is terrible. Just learning that 
      <CODE>IUPnPNAT</CODE> is the interface you need is hard (search MSDN for 
      "NAT Traversal API" and you won't find it). Once you determine that 
      <CODE>IUPnPNAT</CODE> is the right interface, you're faced with a 
      documentation that's poorly organized (why is it grouped as part of the 
      ICS/Firewall API?) and largely incomplete. As one example, you can use the 
      <CODE>IUPnPNAT</CODE> interface to get a collection of port mappings 
      called <CODE>IStaticPortMappingCollection</CODE>, from which you can get 
      an enumerator for each individual mapping. Not terribly straightforward, 
      but normal enough in the COM world. But the enumerator that's returned is 
      actually an <CODE>IUnknown</CODE>, and you need to guess at which one of 
      the ga-jillion different kinds of <CODE>IEnumXXXX</CODE>s it actually is 
      (it's an <CODE>IEnumVARIANT</CODE>, in case you're interested, which might 
      seem evident after the fact but it certainly was not clear to me 
      beforehand).</P>
      <P>And that's nothing compared to the pain of implementing callback 
      interfaces for the <CODE>INATEventManager</CODE>.</P>
      <P>Web searching doesn't help much either. At the time of writing 
      (February 2006), a Google search for <CODE>IUPnPNAT</CODE> turned up 
      exactly 36 hits. 36!! And most of those hits were from people looking for 
      help.</P>
      <P>Likewise, the documentation for <CODE>IUPnPDeviceFinder</CODE> could be 
      much better. For example, to find a router, you need to give 
      <CODE>IUPnPDeviceFinder</CODE> a <CODE>BSTR</CODE> that "specifies the 
      type URI for the device". What's that? Searching at the <A 
      href="http://www.upnp.org/" target=_blank>UPnP.org</A> website provided no 
      help; there's nothing there that gives examples of the URI naming 
      convention, or provides examples of the commonly-used URIs.</P>
      <P>At the end of the day, the "type URI" for a router turns out to be 
      "urn:schemas-upnp-org:device:InternetGatewayDevice:1". No kidding. Does 
      that surprise you or in any way seem to you like it might be 
      self-explanatory or intuitive?</P>
      <P>Rant over. Thanks for listening.</P>
      <P><SMALL><A 
      href="http://www.codeproject.com/KB/IP/PortForward.aspx#topmost">go back 
      to top</A></SMALL></P>
      <H2><A name=Bibliography>Bibliography and reference materials</A></H2>
      <P>Here, in one place, is a list of all the articles and links mentioned 
      in the article, as well as a few extra articles that might be helpful. 
      Clicking the link will open a new window.</P>
      <P>General UPnP and NAT translation links:</P>
      <UL>
        <LI><A href="http://www.upnp.org/" target=_blank>UPnP.org</A> 
        <LI><A 
        href="http://www.microsoft.com/technet/prodtechnol/winxppro/deploy/nattrnsv.mspx" 
        target=_blank>Overview of Network Address Translation (NAT) in Windows 
        XP</A> 
        <LI><A 
        href="http://www.microsoft.com/technet/prodtechnol/winxppro/evaluate/nat_upnp.mspx" 
        target=_blank>Ensuring Great Experiences with NAT Traversal and 
        Universal Plug and Play in Windows XP</A> </LI></UL>
      <P>COM-related links:</P>
      <UL>
        <LI>"<A 
        href="http://msdn.microsoft.com/library/en-us/upnp/upnp/control_point_api_with_upnp_technology_reference.asp" 
        target=_blank>Control Point API Reference</A>", which is used for UPnP 
        device discovery. 
        <LI>"<A 
        href="http://msdn.microsoft.com/library/en-us/upnp/upnp/iupnpdevicefinder.asp" 
        target=_blank>IUPnPDeviceFinder</A>", which is the starting interface 
        device discovery using UPnP. 
        <LI><A 
        href="http://msdn.microsoft.com/library/en-us/upnp/upnp/device_collections_returned_by_synchronous_searches.asp" 
        target=_blank>Sample code</A> for traversing/enumerating through the 
        device collection returned by 
        <CODE>IUPnPDeviceFinder::FindByType()</CODE>. 
        <LI>"<A 
        href="http://msdn.microsoft.com/library/en-us/ics/ics/network_address_translation_traversal_reference.asp" 
        target=_blank>Network Address Translation Traversal Reference</A>", also 
        known aa the "NAT Traversal API". 
        <LI>"<A 
        href="http://msdn.microsoft.com/library/en-us/ics/ics/portal.asp" 
        target=_blank>IUPnPNAT</A>", which is the starting interface for UPnP 
        control over port mappings in a router. </LI></UL>
      <P>Inno Setup:</P>
      <UL>
        <LI><A href="http://www.jrsoftware.org/isinfo.php" target=_blank>Inno 
        Setup</A> 
        <LI><A href="http://www.istool.org/default.aspx/" 
        target=_blank>ISTools</A>, a graphical front-end for creating Inno 
        scripts. </LI></UL>
      <P><SMALL><A 
      href="http://www.codeproject.com/KB/IP/PortForward.aspx#topmost">go back 
      to top</A></SMALL></P>
      <H2><A name=Version>License information</A></H2>
      <P>The source code is licensed under the <A 
      href="http://en.wikipedia.org/wiki/MIT_License" target=_blank>MIT 
      X11-style open source license</A>. Basically, under this license, you can 
      use/modify the code for almost anything you want. For a comparison with 
      the BSD-style license and the much more restrictive GNU GPL-style license, 
      click <A href="http://en.wikipedia.org/wiki/BSD_and_GPL_licensing" 
      target=_blank>here</A>.</P>
      <H2><A name=History>History</A></H2>
      <UL>
        <LI>2<SUP>nd</SUP> March, 2006 
        <UL>
          <LI>Original release of the code and this article. </LI></UL>
        <LI>12<SUP>th</SUP> March, 2006 
        <UL>
          <LI>Updated the article to include a few more graphics and other 
          changes. No change to the code. </LI></UL></LI></UL>
      <P><SMALL><A 
      href="http://www.codeproject.com/KB/IP/PortForward.aspx#topmost">go back 
      to 
      top</A></SMALL></P><!-- Article Ends --><!-- Main Page Contents End --></DIV></SPAN>
      <FORM id=aspnetForm 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
      name=aspnetForm action=PortForward.aspx method=post>
      <DIV><INPUT id=__VIEWSTATE type=hidden 
      value=/wEPDwULLTEwMDUyNjYzMjhkZMXOnva5idFxMzuNnyT8zqrY6Cm8 
      name=__VIEWSTATE> </DIV>
      <H2>License</H2>
      <DIV id=ctl00_LicenseTerms>
      <P>This article has no explicit license attached to it but may contain 
      usage terms in the article text or the download files themselves. If in 
      doubt please contact the author via the discussion board below.</P>
      <P>A list of licenses authors might use can be found <A 
      href="http://www.codeproject.com/info/Licenses.aspx">here</A></P></DIV>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=208786">Mike 
            O'Neill</A></B><BR><BR>
            <CENTER><IMG id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
            src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/{F26CCF55-3B82-4EBF-8BE7-3F023319AFB5}.jpg"></CENTER><BR><SPAN 
            class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>Mike O'Neill is a patent attorney in Southern California, where 
            he specializes in computer and software-related patents. He programs 
            as a hobby, and in a vain attempt to keep up with and understand the 
            technology of his clients.<BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt="United States" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/US.gif" 
                  width=16> United 
        States</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE id=ctl00_PopularArticlesRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular Internet / Network articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/AsyncSocketServerandClien.aspx">An 
              Asynchronous Socket Server and Client</A>
              <DIV class=SmallText>An asynchronous socket server and client with 
              encryption and compression.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/MyDownloader.aspx">MyDownloader: 
              A Multi-thread C# Segmented Download Manager</A>
              <DIV class=SmallText>Sample application that manages multiple 
              segmented downloads and supports HTTP, FTP and YouTube video 
              downloads</DIV>
              <LI><A href="http://www.codeproject.com/KB/IP/ndk.aspx">Network 
              Development Kit 2.0</A>
              <DIV class=SmallText>Network Development Kit is a set of simple 
              classes for a client-server architecture.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/drvfltip.aspx">Developing 
              Firewalls for Windows 2000/XP</A>
              <DIV class=SmallText>An article about developing Firewalls for 
              Windows 2000/XP</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/iocp_server_client.aspx">A 
              simple IOCP Server/Client Class</A>
              <DIV class=SmallText>This source code uses the advanced IOCP 
              technology which can efficiently serve multiple clients. It also 
              presents some solutions to practical problems that arise with the 
              IOCP programming API, and provides a simple echo client/server 
              with file transfer.</DIV></LI></UL>
            <H2></H2></TD>
          <TD>
            <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6421%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252f300x250.png%26C%3dFalse%26adid%3d6421%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22300%22%20height%3d%22250%22%3e%3c%2fa%3e"));</SCRIPT>
          </TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
var socialLinks = new social();
socialLinks.addtoMethod=1;
socialLinks.DrawLinks("socialLinks", document.location.href, escape(document.title), 100, 0, "SmallText Bold", "AddTo");
</SCRIPT>
      </DIV>
      <TABLE class=RatingBar id=ctl00_RateArticleRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/IP/PortForward.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD id=ctl00_RateArticle_VoteResultDiv noWrap align=right 
                width="100%"><SPAN id=voteRes></SPAN><IMG id=loaderImg 
                  style="DISPLAY: none" height=16 alt=loading... 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/ajax-loader.gif" 
                  width=16> </TD>
                <TD class=SmallText id=voteTbl style="WHITE-SPACE: nowrap" 
                align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px; WHITE-SPACE: nowrap"><I><B>Rate 
                        this Article for us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm noWrap 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn onclick="return rateItem(13285,2);" type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV><INPUT id=__EVENTVALIDATION type=hidden 
      value=/wEWCALN0Z7cDALAlMXDBwLBlMXDBwLClMXDBwLDlMXDBwLElMXDBwLP+++tCwK5upDkC+GO4HhQlTxSMaRLQo+pYbnVVigw 
      name=__EVENTVALIDATION> </DIV></FORM>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center">
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6723%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fxoreax_808_leader_468x60.gif%26C%3dFalse%26adid%3d6723%22%20alt%3d%22Xoreax%20cuts%20VS%20build%20times%20by%20up%20to%2090%25%22%20border%3d%220%22%20width%3d%22468%22%20height%3d%2260%22%3e%3c%2fa%3e"));</SCRIPT>
      <IFRAME 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/ServeHTML.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD>
            <FORM 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fIP%2fPortForward.aspx&amp;fid=275054 
            method=get><INPUT type=hidden value=275054 name=fid><INPUT 
            type=hidden value=?floc=%2fKB%2fIP%2fPortForward.aspx&amp;fid=275054 
            name=currentQS><INPUT type=hidden value=/KB/IP/PortForward.aspx 
            name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 alt=FAQ 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/forum_faq.gif" 
                  width=16 align=middle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 alt=Search 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/forum_search.gif" 
                  width=16 align=top border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=275054">Search 
                  Messages</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=SetOpt></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></FORM></TD></TR>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 alt=new 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/forum_newmsg.gif" 
                  width=16 align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;floc=/KB/IP/PortForward.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 25 of 66 (Total in Forum: 66) (<A 
                  href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next</A></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0><!-- Column Headers -->
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2604375_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2604375xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=2604375#xx2604375xx" 
                        name=2604375>Port Forward a Range</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=637213">aprivate</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:04 19 
                        Jun '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2604375_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi<BR>Is it possible to port 
                                forward a port range as opposed<BR>to 1 
                                port?<BR><BR>Allan<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2604375&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2604375&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=2604375">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=2604375">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2604375&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2604375 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(637213,2604375,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2564660_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2564660xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=2564660#xx2564660xx" 
                        name=2564660>port forwarding wizard has the same 
                        function</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3009516">upredsun</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">22:09 
                        21 May '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2564660_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Port Forwarding Wizard has the 
                                same function of "Router Management" and it has 
                                a lot of other function. <BR><BR>
                                <DIV class=ForumSig>Best,<BR>Kevin 
                                Jo<BR>http://www.upredsun.com<BR>**Easily and 
                                automatically build tcp-based or udp-based 
                                network protocol source 
                                code**</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2564660&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2564660&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=2564660">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=2564660">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2564660&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2564660 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3009516,2564660,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2565741_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2565741xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=2565741#xx2565741xx" 
                        name=2565741>Re: port forwarding wizard has the same 
                        function</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=208786">Mike 
                        O'Neill</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">10:40 
                        22 May '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2565741_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>
                                <BLOCKQUOTE class=FQ>
                                <DIV class=FQA>upredsun wrote:</DIV>Port 
                                Forwarding Wizard has the same function of 
                                "Router Management" and it has a lot of other 
                                function. ... 
                                <BR>http://www.upredsun.com</BLOCKQUOTE><BR>And 
                                you charge $19.00 for it, and you hide the 
                                source code.<BR><BR>See <A 
                                href="https://www.regnow.com/softsell/nph-softsell.cgi?item=15875-8">https://www.regnow.com/softsell/nph-softsell.cgi?item=15875-8</A>[<A 
                                title="New Window" 
                                href="https://www.regnow.com/softsell/nph-softsell.cgi?item=15875-8" 
                                target=_blank>^</A>]<BR><BR>So this helps us 
                                how?<BR><BR>Sounds like blatant spam to me. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2565741&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2565741&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=2564660">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=2565741">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2565741&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2565741 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(208786,2565741,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2517865_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2517865xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=2517865#xx2517865xx" 
                        name=2517865>Why it showed "name not found" for IGD name 
                        ?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=100389">Bigbermusa</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:33 22 
                        Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2517865_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR><BR>First machine could 
                                work fine to retrieve information and completely 
                                port forwarding from a DSL router modem 4 ports 
                                but,second machine could not work to get all 
                                informations and it showed "name not found" for 
                                IGD name.<BR>Both connected to same DSL router 
                                modem with a wire and used windows xp SP2 
                                OS.<BR><BR>Please suggest any point did not 
                                correctly config yet and how to resolve that 
                                ?<BR><BR>Thank you in advance.<BR><BR>Bigbermusa 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2517865&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2517865&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=2517865">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=2517865">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2517865&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2517865 
                                style="WHITE-SPACE: nowrap">4.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(100389,2517865,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2480629_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2480629xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=2480629#xx2480629xx" 
                        name=2480629>Cross-platform</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=534719">rvangaal</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">4:23 26 
                        Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2480629_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Nice article. Too bad I'm looking 
                                for a cross-platform solution, and the method of 
                                passing messages through Windows handles is 
                                unfortunate. A cleaner non-GUI dependent API 
                                would have been nicer.<BR>But still, thanks for 
                                documenting, it's indeed VERY hard to find info 
                                on UPnP, and MS documentation never really 
                                helps. The code that is created is not quite 
                                readable, that's not, IMHO, what API's should 
                                look like (not criticizing you, but the 
                                developers of API's). <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2480629&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2480629&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=2480629">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=2480629">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2480629&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2480629 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(534719,2480629,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2452400_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2452400xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=2452400#xx2452400xx" 
                        name=2452400>Compile error</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4724911">joyfulpizza</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:01 5 
                        Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2452400_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Great work <IMG title=Smile 
                                src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/smiley_smile.gif" 
                                align=top> <BR>I met some error while compiling 
                                this project, and I am sure I have the lastest 
                                SDKs.<BR>this message is <BR>error C2061: syntax 
                                error:'__RPC__in_opt'<BR><BR>It seems to be that 
                                I am using wrong version of SDK?<BR>i am using 
                                v6.1.<BR><BR>Thanks in advance~ <IMG title=Laugh 
                                src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/smiley_laugh.gif" 
                                align=top> <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2452400&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2452400&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=2452400">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=2452400">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2452400&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2452400 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4724911,2452400,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2432814_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2432814xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=2432814#xx2432814xx" 
                        name=2432814>Why "Unable to add mapping"?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3147171">Member 
                        3147171</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:26 19 
                        Feb '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2432814_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Loopback test : 
                                "success"<BR><BR>but<BR><BR>Add new entry : 
                                "Unable to add mapping"<BR><BR>Why?<BR>What 
                                conditions are required? <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2432814&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2432814&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=2432814">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=2432814">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2432814&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2432814 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3147171,2432814,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2430390_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2430390xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=2430390#xx2430390xx" 
                        name=2430390>Port mapping keep deleting/Disappearing 
                        from IGD - Help please</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4365801">Member 
                        4365801</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:53 
                        16 Feb '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2430390_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>This is a very strange 
                                thing.<BR><BR>Mapping ;<BR>I map the dameware 
                                port: 6129 to my local ip: 192.168.2.5<BR>It 
                                appear in the list ( program list )<BR>It also 
                                appear in IGD list<BR><BR>Issue ;<BR>After a day 
                                or two it disappear from the IGD list 
                                automatically and I can not access the program 
                                as the mapping is gone.<BR><BR><BR>Note : <BR>I 
                                do not use any router. I have my pc connected 
                                directly to Bell modem which is a DHCP/DNS 
                                server.<BR><BR>Anyone can figure it out why the 
                                mapping keep deleting by itself and what can be 
                                done to stop this. Please kindly email me your 
                                valuable suggessions at 
                                mrana254@gmail.com<BR><BR>This thing is making 
                                me crazy as I cant access the pc until I 
                                physically go to the pc and repeat the steps to 
                                add the mapping <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2430390&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2430390&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=2430390">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=2430390">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2430390&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2430390 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4365801,2430390,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2276363_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2276363xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=2276363#xx2276363xx" 
                        name=2276363>Callbacks not working?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4624710">seafishkakakaka</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:11 17 
                        Oct '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2276363_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I've changed number of port 
                                mappings using my own tool (which isn't using 
                                COM) and didn't get any response from your 
                                program. <BR>Also is ti possible to track a new 
                                UPnP device on a network or when UPnP device is 
                                no longer available.<BR>Basically, I need to 
                                know without doing discovery by timings whether 
                                I am still connected to device or not. Or if 
                                device changed or there is a new device on the 
                                network - then I can map my port.<BR><BR>Thanks. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2276363&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2276363&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=2276363">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=2276363">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2276363&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2276363 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4624710,2276363,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1980138_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1980138xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1980138#xx1980138xx" 
                        name=1980138>Portable SDK for UPNP</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1909392">ramytabet</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:51 9 
                        Apr '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1980138_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I am actually looking for an open 
                                source AND portable SDK/framework for 
                                UPNP,<BR>and have found the open source project 
                                libupnp for linux but i dont know if it 
                                <BR>portable and if so, does anyone know how to 
                                compile it using VC2005?<BR><BR>I would also 
                                appreciate if you could point me to another SDK 
                                (for c/c++ 
                                usage)<BR><BR>Thanks,<BR><BR>RAMY.<BR><BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1980138&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1980138&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1980138">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1980138">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1980138&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1980138 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(1909392,1980138,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1849920_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1849920xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1849920#xx1849920xx" 
                        name=1849920>Port Mapping Collection not 
retrieved</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1544793">Vasiliy 
                        Moiseyev</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">2:24 18 
                        Jan '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1849920_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hello.<BR>Thank you for a good 
                                article.<BR>I have some question: application 
                                recognizes my IGD but could not retrieve port 
                                mappings and add mine. If you know - can you 
                                explain in which situations it could be. MSDN 
                                didn't help me. IGD is set on linux machine, and 
                                I'd tried to map ports through linux app for map 
                                port testing - and it is working, but under 
                                windows - not.<BR>Thank you. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1849920&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1849920&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1849920">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1849920">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1849920&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1849920 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1544793,1849920,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1910604_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1910604xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1910604#xx1910604xx" 
                        name=1910604>Re: Port Mapping Collection not 
                        retrieved</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1909392">ramytabet</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">10:51 
                        24 Feb '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1910604_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi Vasiliy,<BR><BR>I did stumble 
                                across the same problem too and after many 
                                trial<BR>and error testing and the help of my 
                                wok colleague (thanks Elia <BR>for this one!) 
                                the answer lies in the following;<BR><BR>Even 
                                thought you have upnp enabled on the IGD (that's 
                                why ur able<BR>to "discover" ur IGD);<BR><BR>You 
                                need to enable the check box "Allow other 
                                network users to control<BR>or disable the 
                                shared internet connection" in the connection 
                                properties<BR>page. This will actually allow any 
                                upnp enabled software to modify the 
                                port<BR>forwarding on the gateway (IGD) thus 
                                allowing them to add or remove 
                                ports.<BR><BR>Best 
                                regards,<BR><BR>RAMY<BR>(Lebanon) 
                                <BR><BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1910604&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1910604&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1849920">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1910604">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1910604&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1910604 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1909392,1910604,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1846193_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1846193xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1846193#xx1846193xx" 
                        name=1846193>Problem Linking</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=768649">Le-Chuck2000</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:05 16 
                        Jan '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1846193_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi Everybody, when I compile I 
                                obtain these 
                                errors:<BR><BR>Linking...<BR>PortForwardEngine.obj 
                                : error LNK2001: unresolved external symbol 
                                _IID_IUPnPDevice<BR>PortForwardEngine.obj : 
                                error LNK2001: unresolved external symbol 
                                _CLSID_UPnPDeviceFinder<BR>PortForwardEngine.obj 
                                : error LNK2001: unresolved external symbol 
                                _IID_IUPnPDeviceFinder<BR>PortForwardEngine.obj 
                                : error LNK2001: unresolved external symbol 
                                _IID_IStaticPortMapping<BR>PortForwardEngine.obj 
                                : error LNK2001: unresolved external symbol 
                                _IID_INATNumberOfEntriesCallback<BR>PortForwardEngine.obj 
                                : error LNK2001: unresolved external symbol 
                                _IID_INATExternalIPAddressCallback<BR>Release/PortForward.exe 
                                : fatal error LNK1120: 6 unresolved 
                                externals<BR>Error executing link.exe.<BR><BR>I 
                                use Visual Studio 6.0, Windows XP and February 
                                2003 SDK <BR><BR>Best Regards, Abel 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1846193&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1846193&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1846193">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1846193">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1846193&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1846193 
                                style="WHITE-SPACE: nowrap">4.00/5 (4 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(768649,1846193,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote HdUnSel " id=F1846776_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1846776xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1846776#xx1846776xx" 
                        name=1846776>Re: Problem Linking</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=208786">Mike 
                        O'Neill</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:24 16 
                        Jan '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1846776_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>That's the setup of my system too, 
                                so it should be possible to make it 
                                work.<BR><BR>Make certain that the February 2003 
                                SDK is at the top of the list of search 
                                directories. Go to Tools-&gt;Options, and then 
                                click the "Directories" tab. Under the "Show 
                                directories for" dropdown, make certain that the 
                                2003 SDK is at the top of the list, in each of 
                                the "include", "library" and "source" 
                                selections.<BR><BR>Best regards,<BR>Mike 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1846776&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1846776&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1846193">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1846776">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1846776&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1846776 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(208786,1846776,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F1806902_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1806902xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1806902#xx1806902xx" 
                        name=1806902>Not working on D-link DSL-502T</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3632668">sunilnmu</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">22:31 
                        15 Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1806902_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Really usefull tool! But it not 
                                working with D-link DSL-502T router. I have 
                                Windows XP SP2 installed on my PC (Also I 
                                enabled UPnP service). D-link DSL-502T support 
                                UPnP but I don't find any way to enable/disable 
                                UPnP on routers home page ( So i considered it 
                                is enabled by default ). <BR>After running this 
                                utility it give message 'name not found'. Plz. 
                                check this n reply me. <BR>Thanks. <BR><BR>Sunil 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1806902&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1806902&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1806902">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1806902">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1806902&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1806902 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(3632668,1806902,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1807265_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1807265xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1807265#xx1807265xx" 
                        name=1807265>Re: Not working on D-link DSL-502T</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=208786">Mike 
                        O'Neill</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:41 16 
                        Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1807265_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I am not familiar with the D-Link 
                                DSL-502T, but according to its data sheets (at 
                                <A 
                                href="http://www.dlink.com.au/Products.aspx?Sec=1&amp;Sub1=1&amp;Sub2=2&amp;PID=48">http://www.dlink.com.au/Products.aspx?Sec=1&amp;Sub1=1&amp;Sub2=2&amp;PID=48</A>[<A 
                                title="New Window" 
                                href="http://www.dlink.com.au/Products.aspx?Sec=1&amp;Sub1=1&amp;Sub2=2&amp;PID=48" 
                                target=_blank>^</A>]), it's a business-style 
                                router that appears to have built-in NAT 
                                protection that blocks and re-directs certain 
                                ports to limit the services that outside users 
                                can access your network. A DMZ setting can be 
                                applied to a <I><B>single</B></I> client IP 
                                address (such as a Web server) behind the 
                                router, but the rest of the machines at the 
                                home/office are "protected".<BR><BR>So, it might 
                                not be possible to perform port-forwarding with 
                                the firmware of this particular 
                                router.<BR><BR>On the other hand, it should be. 
                                Modern routers should allow you to configure 
                                them however you want.<BR><BR>See if it's 
                                possible to configure the router 
                                manually.<BR><BR>It's also odd that you cannot 
                                find a congifuration screen to turn UPnP "on". 
                                According to the data sheet, your DSL-502T 
                                definitely has UpNp support, but it's doubtful 
                                that the default setting is "on". Try harder to 
                                find it.<BR><BR>Mike <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1807265&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1807265&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1806902">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1807265">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1807265&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1807265 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(208786,1807265,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1790207_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1790207xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1790207#xx1790207xx" 
                        name=1790207>Error message: 'Natupnp.h': No such file or 
                        directory</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=368845">yhliang</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:30 5 
                        Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1790207_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Dear Mike,<BR><BR>This is 
                                Hsiang.<BR>When I build the this project, I got 
                                error messages like that "'Natupnp.h': No such 
                                file or directory."<BR>The IDE I used VC .Net 
                                2005.<BR><BR>I need to do something? 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1790207&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1790207&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1790207">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1790207">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1790207&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1790207 
                                style="WHITE-SPACE: nowrap">1.00/5 (5 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(368845,1790207,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F1800331_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1800331xx></A><IMG height=16 alt=Answer 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1800331#xx1800331xx" 
                        name=1800331>Re: Error message: 'Natupnp.h': No such 
                        file or directory</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1545664">mic_suz</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">22:30 
                        11 Dec '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1800331_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>For 'Natupnp.h', you must install 
                                'Windows Server 2003 SP1 Platform SDK ' from 
                                MSDN website: <A 
                                href="http://www.microsoft.com/downloads/details.aspx?FamilyId=A55B6B43-E24F-4EA3-A93E-40C0EC4F68E5&amp;displaylang=en">http://www.microsoft.com/downloads/details.aspx?FamilyId=A55B6B43-E24F-4EA3-A93E-40C0EC4F68E5&amp;displaylang=en</A>[<A 
                                title="New Window" 
                                href="http://www.microsoft.com/downloads/details.aspx?FamilyId=A55B6B43-E24F-4EA3-A93E-40C0EC4F68E5&amp;displaylang=en" 
                                target=_blank>^</A>]<BR><BR>After you installed 
                                it, you will find Natupnp.h in C:\Program 
                                Files\Microsoft Platform SDK\Includes. You also 
                                have to tell Visual Studio where to find them. 
                                In Visual Studio, click Tools, Options. In the 
                                Projects folder, select VC++ Directories. Under 
                                Show directories for:, choose Include Files. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1800331&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1800331&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1790207">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1800331">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1800331&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1800331 
                                style="WHITE-SPACE: nowrap">1.75/5 (5 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(1545664,1800331,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F2033433_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2033433xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=2033433#xx2033433xx" 
                        name=2033433>Re: Error message: 'Natupnp.h': No such 
                        file or directory</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1889566">zetaaac</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:28 12 
                        May '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2033433_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>You need to install Microsoft SDK. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2033433&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=2033433&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1790207">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=2033433">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2033433&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2033433 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(1889566,2033433,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote Rt HdUnSel " id=F1756433_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1756433xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1756433#xx1756433xx" 
                        name=1756433>Multiple / Cascading routers 
                      [modified]</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1909392">ramytabet</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:56 14 
                        Nov '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1756433_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>First of all, thank you very much 
                                for this article/project which cleared out<BR>a 
                                lot of issues and i most say it is way better 
                                than MSDN own documentation.<BR><BR>Anyway i was 
                                wondering if the code works with multiple 
                                routers in series<BR>(cascading routers) 
                                automatically or does it require some changing 
                                to it?<BR><BR>I am unable to test this situation 
                                now but i do need my application to 
                                forward<BR>port from behind many routers like 
                                for example, a wireless router connected to 
                                <BR>DSL supplied router.<BR><BR>Thanks in 
                                advance,<BR><BR>RAMY. <BR><BR><BR>-- modified at 
                                3:25 Friday 26th January, 2007 <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1756433&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1756433&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1756433">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1756433">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1756433&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1756433 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(1909392,1756433,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1862575_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1862575xx></A><IMG height=16 alt=Answer 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1862575#xx1862575xx" 
                        name=1862575>Re: Multiple / Cascading routers 
                        [modified]</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1909392">ramytabet</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:16 26 
                        Jan '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1862575_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I figured out the answer just see 
                                the "Multiple layer" 
                                discussion.<BR><BR>RAMY<BR>(Lebanon)<BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1862575&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1862575&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1756433">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1862575">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1862575&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1862575 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1909392,1862575,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1730501_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1730501xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1730501#xx1730501xx" 
                        name=1730501>re: The debate: Convenience vs. 
                      Security</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=441972">MisterDuck</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:55 
                        27 Oct '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1730501_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I think one thing opponents of 
                                UPnP commonly overlook is that if some malicious 
                                program is opening ports on a NAT device, a 
                                network's security has already been broken. In 
                                other words, a user inside the network had to 
                                run a rogue executable that can now do any 
                                number of evil things; opening ports on the 
                                firewall is the least of a user's worries. 
                                <BR><BR>All UPnP would allow is one additional 
                                venue (to the massive number that have already 
                                been compromised) for a rogue application to 
                                exploit. But at this point in time, traversing a 
                                user's firewall isn't an issue, because the 
                                application is sitting behind it. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1730501&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1730501&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1730501">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1730501">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1730501&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1730501 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(441972,1730501,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1741247_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1741247xx></A><IMG height=16 alt=General 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1741247#xx1741247xx" 
                        name=1741247>Re: re: The debate: Convenience vs. 
                        Security</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=208786">Mike 
                        O'Neill</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">17:45 3 
                        Nov '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1741247_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Interesting perspective, but I 
                                think it might be a bit "black and white" in a 
                                world with many shades of gray. It's true that a 
                                user must have compromised his computer. But 
                                that's increasingly easy to do, even 
                                inadvertently by experienced users (cross-site 
                                scripting etc). Moreover, there's a difference 
                                between a user that compromises his own 
                                computer, and a user that compromises his 
                                computer in a way that compromises the entire 
                                network. Finally, it would take only a tiny 
                                compromise, such as a small trojan, which would 
                                thereafter be able to open bigger and bigger 
                                holes in the network. For example, starting with 
                                a small trojan, it could conceivably be possible 
                                to end up with a system so compromised that it 
                                was hosting an illegal download server (with 
                                UPnP to open and map the ports).<BR><BR>I 
                                continue to adhere to the view stated in the 
                                article, that UPnP control over routers is 
                                inadvisable. But that viewpoint has already left 
                                the station.<BR><BR>Best,<BR>Mike <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1741247&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1741247&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1730501">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1741247">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1741247&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1741247 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(208786,1741247,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F1706945_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx1706945xx></A><IMG height=16 alt=Question 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1706945#xx1706945xx" 
                        name=1706945>What's the SDK version ?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3090204">wang_hunter97</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">23:40 
                        10 Oct '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1706945_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>This is a great program, but I 
                                have compilation errors when I tried to compile 
                                it.<BR>Can you tell the SDK version?<BR>Many 
                                thanks.<BR><BR><BR>Wang<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1706945&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1706945&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1706945">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1706945">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1706945&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1706945 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3090204,1706945,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F1707944_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx1707944xx></A><IMG height=16 alt=Answer 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;select=1707944#xx1707944xx" 
                        name=1707944>Re: What's the SDK version ?</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=208786">Mike 
                        O'Neill</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">10:27 
                        11 Oct '06 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F1707944_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>I used the February 2003 version 
                                of the SDK.<BR><BR>What are your compilation 
                                errors, and what IDE are you using? The download 
                                for the project is a VC++ 6.0 
                                project.<BR><BR>Best,<BR>Mike <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1707944&amp;floc=/KB/IP/PortForward.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=275054&amp;select=1707944&amp;floc=/KB/IP/PortForward.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;tid=1706945">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=275054&amp;msg=1707944">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=1707944&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF1707944 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(208786,1707944,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Tuesday, July 29, 2008 12:24 AM &nbsp; &nbsp; 
                  Last Update:Thursday, August 14, 2008 11:06 AM</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><B>1</B><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>2</A> <A class=Frm_HL 
                  href="http://www.codeproject.com/KB/IP/PortForward.aspx?fid=275054&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next 
      »</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 alt=General 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_general.gif" 
      width=16 align=top> General &nbsp;&nbsp; <IMG height=16 alt=News 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_news.gif" 
      width=16 align=top> News &nbsp;&nbsp; <IMG height=16 alt=Question 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_question.gif" 
      width=16 align=top> Question &nbsp;&nbsp; <IMG height=16 alt=Answer 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_answer.gif" 
      width=16 align=top> Answer &nbsp;&nbsp; <IMG height=16 alt=Joke 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_joke.gif" 
      width=16 align=top> Joke &nbsp;&nbsp; <IMG height=16 alt=Rant 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_rant.gif" 
      width=16 align=top> Rant &nbsp;&nbsp; <IMG height=16 alt=Admin 
      src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/msg_admin.gif" 
      width=16 align=top> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=13285">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy </A>| <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 14 Mar 2006<BR>Editor: <A 
            id=ctl00_ArticleEditor 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1823121">Rinish 
            Biju</A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2006 by Mike 
            O'Neill<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2008 
            <BR>Web18 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE>
      <CENTER></CENTER></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE><BR>
<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Using UPnP for Programmatic Port Forwardings and NAT Traversal_ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
new HVMenu(new menu_NavbarConfig());
//]]></SCRIPT>
</BODY></HTML>
