<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0048)http://www.codeproject.com/KB/IP/HTTPFilter.aspx -->
<HTML><HEAD><TITLE>CodeProject: Developing a SOHO HTTP filter step by step . Free source code and programming help</TITLE>
<META http-equiv=Content-Type content="text/html; charset=utf-8">
<META 
content="The main goal of this article is to explain the practical details of low level network security programming.; Author: eternalnetworker; Section: Internet / Network; Chapter: Web Development" 
name=Description>
<META 
content="VC7.1, Win2K, Win2003, VS.NET2003, C, MFC, Dev, Beginner, Advanced,Internet / Network,Web Development,Free source code, tutorials" 
name=Keywords>
<META content="The Code Project" name=Author>
<META content=General name=Rating>
<META content="index, follow" name=Robots>
<META content="1 days" name=Revisit-After><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK title=CodeProject 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK 
href="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/CodeProject.css" 
type=text/css rel=stylesheet><LINK 
href="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/ForumClassic.css" 
type=text/css rel=stylesheet>
<SCRIPT type=text/javascript>
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</SCRIPT>

<SCRIPT type=text/javascript>
   var pageTracker = _gat._getTracker("UA-1735123-1");
   pageTracker._setDomainName("www.codeproject.com");
   pageTracker._setSessionTimeout("1200"); // 20 mins
   pageTracker._initData();
   pageTracker._trackPageview();
</SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/oncopy.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/jxs.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/bookmark.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/rateitem.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function ToggleMenu(itemName)
{
	var elm = document.getElementById(itemName);
	var i,others = document.getElementById('SectionMenu');
	for(i=0; i < others.childNodes.length; i++)
	{
		var other = others.childNodes[i];
		if ((other.className == 'MenuSectionBlock') && (other != elm))
			other.style.display='none';
	}
	if (elm.style.display == 'block') elm.style.display='none';
	else elm.style.display='block';
	return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/addto.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
function MarkAns(MemberID,MsgID,QID) {
 document.write(unescape("%3Cdiv class=\"CallOut\"%3E"));
 document.write("Was this a good answer to your question? ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+", "+MsgID.toString()+",6,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"correct\" border=\"0\" align=\"absmiddle\" /%3E Yes%3C/a%3E"));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" "));
 document.write("onclick=\"RateMsg("+MemberID.toString()+","+MsgID.toString()+",7,"+QID.toString()+");\"");
 document.write(unescape("%3E"));
 document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"correct\" style=\"margin-left:10px\" border=\"0\" align=\"absmiddle\" /%3E No%3C/a%3E"));
 document.write(unescape("%3C/div%3E"));
}
function MsgVFrm(MemberID,MsgID,GB,gp,bp,mt){
 if(!GB)document.write("Rate this message: ");
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"5":"1")+unescape(",0);\"%3E"));
 if(GB) document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/good.png\" alt=\"good\" border=\"0\" align=\"absmiddle\" /%3E "+gp+" "+mt+"%3C/a%3E "));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_down.gif\" alt=\"vote 1\" border=\"0\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;"); else for(var i=1; i<=5;i++)
  document.write(unescape("%3Ca class=\"Frm_MHL\" href=\"#xx" + MsgID.toString() + "xx\" title=\"vote this message a " + i.toString() + "\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", " + i.toString() + ",0)\"%3E%3Cb%3E" + i.toString() + "%3C/b%3E%3C/a%3E "));
 document.write(unescape("%3Ca href=\"#xx" + MsgID.toString() + "xx\" onclick=\"RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ","));document.write((GB?"1":"5")+unescape(",0);\"%3E"));
 if(GB)document.write(unescape("%3Cimg height=\"20\" width=\"20\" src=\"/script/Forums/Images/bad.png\" alt=\"bad\" border=\"0\" align=\"absmiddle\" /%3E "+bp+" "+mt+"%3C/a%3E"));
 else document.write(unescape("%3Cimg height=\"14\" width=\"14\" src=\"/script/Forums/Images/thumbs_up.gif\" border=\"0\" alt=\"vote 5\" align=\"middle\" /%3E%3C/a%3E "));
 if(GB)document.write(" &nbsp;&nbsp; "); else document.write(unescape("%3Cbr /%3E")); document.writeln(unescape("[%3Ca href='#xx") + MsgID.toString() +"xx' title='Report as Abuse' onclick='return ReportMsg(" + MemberID.toString());
 document.writeln(", " + MsgID.toString() + unescape(",-2)'%3EReport Message%3C/a%3E]"));
}

function ReportMsg(userid, msgid, score) {
 if (confirm("Are you sure you want to report this message?"))
  return RateMsg(userid, msgid, score, 0);
 else return false;
}
function RateMsg(memberid, msgid, score, questionId) {
 var req = new ActiveXObject("MSXML2.XMLHTTP");
 req.onreadystatechange = function() {
  if (req.readyState == 4){
   if (req.status == 200){
    var respText = req.responseText;
    var re = new RegExp(unescape("\%3Cdiv\%3E([^\%3C]*)\%3C/div\%3E"), "g");
    var match = re.exec(respText);
    voteStatus.innerHTML = unescape("%3Cb%3E") + (match&&match[1])?match[1]:"An error occured" + unescape("%3C/b%3E");
   } else
    voteStatus.innerHTML = unescape("%3Cb style='color:red'%3EFailed!") + req.statusText + unescape("%3C/b%3E");
  }
 }
 var voteStatus = document.getElementById("MVF" + msgid);
 if (!voteStatus) return;
 voteStatus.innerHTML = unescape("%3Cb style='color:green'%3EVoting...%3C/b%3E");
 var strAction = "/script/Forums/Vote.aspx?js=1&fmid="+memberid.toString()+"&select="+msgid.toString()+"&score="+score.toString()+"&qid="+questionId.toString();
 req.open("GET", strAction, true);
 req.send(null);
  return false;
}
//]]></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
var Selected = "-1";

function SwitchMessage(e, msgId)
{
  if (!msgId) {
    if(!e)e=window.event;
    var target=e.target?e.target:e.srcElement;
    while(target&&target.id!='DynMessLink')target=target.parentNode;
    if(!target||target.id!='DynMessLink')return;
    msgId=target.name;
  }
  if(Selected&&Selected!=""){
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body) body.style.display = 'none';
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if(head) head.className = head.className.replace("Sel", "UnSel");
  }
  if(Selected==msgId.toString())
    Selected="";
  else {
    Selected=msgId.toString();
    var body=eval("document.getElementById('F" + Selected + "_h1')");
    if(body){
      if(body.style.display=='none') body.style.display='';
      else body.style.display = 'none';
    }
    var head=eval("document.getElementById('F" + Selected + "_h0')");
    if (head) 
      head.className = head.className.replace("UnSel", "Sel");
    if(body&&head&&body.style.display!='none'){
      document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
      EnsureMessageVisible(Selected, true);
    }
  }
  if (e){if(e.preventDefault)e.preventDefault;else e.returnValue=false;}
  return false;
}

//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/ShortCuts.js" 
type=text/javascript></SCRIPT>
<LINK 
href="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/ForumClassicIE6.css" 
type=text/css rel=stylesheet><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" type=image/ico rel="shortcut icon">
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY>
<TABLE id=ctl00_AT cellSpacing=0 cellPadding=0 border=0>
  <TBODY>
  <TR vAlign=top>
    <TD colSpan=2>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR>
          <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG 
            id=ctl00_Logo 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; WIDTH: 225px; HEIGHT: 90px; BORDER-RIGHT-WIDTH: 0px" 
            alt="The Code Project" 
            src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/logo225x90.gif"></A></TD>
          <TD class=HeaderBanner align=right width="100%">
            <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6952%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252f728x90-SQLSrvrSprawl.gif%26C%3dFalse%26adid%3d6952%22%20alt%3d%22%22%20border%3d%220%22%20width%3d%22728%22%20height%3d%2290%22%3e%3c%2fa%3e"));</SCRIPT>
          </TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 
              width="100%"><TBODY>
              <TR>
                <TD class=SmallText style="FONT-WEIGHT: bold">5,386,863 
                  members and growing! (14,057 online)</TD>
                <TD align=right>
                  <DIV class=MemberNavBarText 
                  id=ctl00_MemberMenu_LoggedOnOptions><A 
                  id=ctl00_MemberMenu_MyProfile 
                  href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2959938">Abdelrady_FCIS</A> 
                  | <A id=ctl00_MemberMenu_MySettings 
                  href="http://www.codeproject.com/script/Membership/Modify.aspx">My 
                  Settings</A> | <A id=ctl00_MemberMenu_MyCodeProject 
                  href="http://www.codeproject.com/script/Membership/MyCodeProject.aspx"><B>My 
                  CodeProject</B></A> | <A id=ctl00_MemberMenu_MyBookmarks 
                  href="http://www.codeproject.com/script/Bookmarks/List.aspx?obtid=2"><IMG 
                  height=16 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/fave.gif" 
                  width=16 align=absMiddle border=0> My Bookmarks</A> | <A 
                  id=ctl00_MemberMenu_MyArticles 
                  href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=2959938">My 
                  Articles</A> | <A id=ctl00_MemberMenu_Signout 
                  href="http://www.codeproject.com/script/Membership/LogOff.aspx?rp=%2fKB%2fIP%2fHTTPFilter.aspx">Sign 
                  out</A> </DIV></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 
            cellPadding=0>
              <TBODY>
              <TR>
                <TD noWrap><A href="http://www.codeproject.com/">Home</A></TD>
                <TD>&nbsp; </TD>
                <TD style="FONT-WEIGHT: normal" noWrap align=right>Current 
                  Site:</TD>
                <TD class=SelCat noWrap><A 
                  href="http://www.codeproject.com/">C++ / .NET</A></TD>
                <TD noWrap><A href="http://java.codeproject.com/">Java</A></TD>
                <TD noWrap><A href="http://sql.codeproject.com/">SQL</A></TD>
                <TD noWrap><A href="http://lamp.codeproject.com/">Linux / 
                  Unix</A></TD>
                <TD width="100%">&nbsp;</TD>
                <TD id=ctl00_TopNavBar_RightMenus>
                  <DIV id=MenuPos 
                  style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
                  <TABLE 
                  style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
                  cellSpacing=0 cellPadding=0 width=380>
                    <TBODY>
                    <TR vAlign=center>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/info/FAQ.aspx">Help!</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Articles/Latest.aspx">Articles</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Forums/List.aspx">Message 
                        Boards</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
                        Board</A></TD>
                      <TD 
                      style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                      noWrap><A 
                        href="http://www.codeproject.com/Lounge.aspx">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top colSpan=2><A name=_top></A>
      <TABLE class=ArticleHeader id=ctl00_ArticleTopHeader_HeaderTable 
      cellSpacing=0 cellPadding=3 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=SmallText><A id=ctl00_ArticleTopHeader_ChapterLink 
            href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
            Development</A> » <A id=ctl00_ArticleTopHeader_SectionLink 
            href="http://www.codeproject.com/KB/IP/">Internet / Network</A> » <A 
            id=ctl00_ArticleTopHeader_SubsectionLink 
            href="http://www.codeproject.com/KB/IP/index.aspx?#Internet / Network - HTTP">HTTP</A> 
            <SPAN class=ArticleBeginner 
            id=ctl00_ArticleTopHeader_SkillLevel>&nbsp;&nbsp;&nbsp; 
            Beginner</SPAN> <SPAN class=SmallText 
            id=ctl00_ArticleTopHeader_LicenceTerms 
            style="MARGIN-LEFT: 40px">License: <A 
            href="http://www.codeproject.com/info/cpol10.aspx">The Code Project 
            Open License (CPOL)</A></SPAN> <BR><BR>
            <H1><SPAN class=ArticleTopTitle 
            id=ctl00_ArticleTopHeader_ArticleTitle>Developing a SOHO HTTP filter 
            step by step </SPAN></H1><B>By <A 
            href="http://www.codeproject.com/script/Articles/MemberArticles.aspx?amid=47108">eternalnetworker</A></B><BR><BR><SPAN 
            class=ArticleTopDescr id=ctl00_ArticleTopHeader_ArticleDescr>The 
            main goal of this article is to explain the practical details of low 
            level network security programming.</SPAN> </TD>
          <TD class=SmallText style="WIDTH: 210px"><SPAN 
            id=ctl00_ArticleTopHeader_ArticleAttributes>C, VC7.1, C++Windows, 
            Win2K, Win2003, MFC, VS.NET2003, Visual Studio, 
            Dev</SPAN><BR><BR><SPAN style="WIDTH: 14ex">Posted</SPAN>: <B>6 Aug 
            2007</B><BR><SPAN style="WIDTH: 14ex">Updated</SPAN>: <B>26 Aug 
            2007</B> <BR><SPAN style="WIDTH: 14ex">Views</SPAN>: 
            <B>23,711</B><BR><SPAN style="WIDTH: 14ex">Bookmarked</SPAN>: <B>29 
            times</B><BR></TD></TR>
        <TR>
          <TD colSpan=2>
            <TABLE width="100%">
              <TBODY>
              <TR>
                <TD></TD>
                <TD class=SmallText style="WHITE-SPACE: nowrap" 
              align=right></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR vAlign=top>
    <TD class=LHNavBar id=ctl00_LeftNavCell>
      <DIV class=FeatureBlockHeader>Announcements</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar" 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px">
      <TABLE cellPadding=2>
        <TBODY>
        <TR vAlign=center>
          <TD><IMG height=10 alt=Comp 
            src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/startrek.gif" 
            width=24></TD>
          <TD><A 
            href="http://www.codeproject.com/script/Awards/Competition.aspx?cid=274">Summer 
            Code Competition!</A></TD></TR>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/info_24.png" 
            width=24></TD>
          <TD><A 
            href="http://www.codeproject.com/script/Awards/Competition.aspx?cid=270">New 
            thawte <BR>Scavenger Hunt!</A></TD></TR>
        <TR vAlign=center>
          <TD><IMG height=24 alt=Comp 
            src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/info_24.png" 
            width=24 align=middle></TD>
          <TD><A id=ctl00_Announcements_CompLink 
            href="http://www.codeproject.com/Feature/ArticleCompetition/">Monthly 
            Competition</A></TD></TR></TBODY></TABLE></DIV>
      <DIV class=FeatureBlockHeader style="MARGIN-TOP: 7px">Want a new 
Job?</DIV>
      <DIV class="FeatureBlockContent RHFeatureBar">
      <UL class=InfoList>
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=77">ASP.NET 
        C# VB.NET SQL Developer</A> at High Power Consulting, Inc. in United 
        States
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=50">Senior 
        .NET Programmer/Architect</A> at Greater Than Solutions in United States
        <LI><A 
        href="http://www.codeproject.com/script/Jobs/View.aspx?jid=112">Software 
        Engineer (C# Windows .NET)</A> at Memeo Inc. in United States
        <LI><A href="http://www.codeproject.com/script/Jobs/List.aspx">View 
        Latest Jobs...</A></LI></UL></DIV>
      <DIV id=SectionMenu>
      <DIV class=MenuCat>Chapters</DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter1');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=1">Desktop 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter1 style="DISPLAY: none">
      <DIV class=MI id=Section1><A 
      href="http://www.codeproject.com/KB/buttons/">Button Controls</A></DIV>
      <DIV class=MI id=Section15><A 
      href="http://www.codeproject.com/KB/clipboard/">Clipboard</A></DIV>
      <DIV class=MI id=Section2><A 
      href="http://www.codeproject.com/KB/combobox/">Combo &amp; List 
      Boxes</A></DIV>
      <DIV class=MI id=Section67><A 
      href="http://www.codeproject.com/KB/dialog/">Dialogs and Windows</A></DIV>
      <DIV class=MI id=Section107><A 
      href="http://www.codeproject.com/KB/gadgets/">Desktop Gadgets</A></DIV>
      <DIV class=MI id=Section16><A 
      href="http://www.codeproject.com/KB/docview/">Document / View</A></DIV>
      <DIV class=MI id=Section4><A 
      href="http://www.codeproject.com/KB/edit/">Edit Controls</A></DIV>
      <DIV class=MI id=Section17><A 
      href="http://www.codeproject.com/KB/files/">Files and Folders</A></DIV>
      <DIV class=MI id=Section3><A 
      href="http://www.codeproject.com/KB/grid/">Grid &amp; Data 
      Controls</A></DIV>
      <DIV class=MI id=Section5><A 
      href="http://www.codeproject.com/KB/list/">List Controls</A></DIV>
      <DIV class=MI id=Section6><A 
      href="http://www.codeproject.com/KB/menus/">Menus</A></DIV>
      <DIV class=MI id=Section14><A 
      href="http://www.codeproject.com/KB/miscctrl/">Miscellaneous</A></DIV>
      <DIV class=MI id=Section18><A 
      href="http://www.codeproject.com/KB/printing/">Printing</A></DIV>
      <DIV class=MI id=Section95><A 
      href="http://www.codeproject.com/KB/progress/">Progress Controls</A></DIV>
      <DIV class=MI id=Section11><A 
      href="http://www.codeproject.com/KB/selection/">Selection 
      Controls</A></DIV>
      <DIV class=MI id=Section19><A 
      href="http://www.codeproject.com/KB/shell/">Shell and IE 
      programming</A></DIV>
      <DIV class=MI id=Section68><A 
      href="http://www.codeproject.com/KB/smart/">Smart Client</A></DIV>
      <DIV class=MI id=Section8><A 
      href="http://www.codeproject.com/KB/splitter/">Splitter Windows</A></DIV>
      <DIV class=MI id=Section9><A 
      href="http://www.codeproject.com/KB/static/">Static &amp; Panel 
      Controls</A></DIV>
      <DIV class=MI id=Section10><A 
      href="http://www.codeproject.com/KB/statusbar/">Status Bar</A></DIV>
      <DIV class=MI id=Section7><A 
      href="http://www.codeproject.com/KB/tabs/">Tabs &amp; Property 
      Pages</A></DIV>
      <DIV class=MI id=Section12><A 
      href="http://www.codeproject.com/KB/toolbars/">Toolbars &amp; Docking 
      windows</A></DIV>
      <DIV class=MI id=Section13><A 
      href="http://www.codeproject.com/KB/tree/">Tree Controls</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter2');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=2">Web 
      Development</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter2>
      <DIV class=MI id=Section70><A 
      href="http://www.codeproject.com/KB/ajax/">Ajax and Atlas</A></DIV>
      <DIV class=MI id=Section27><A 
      href="http://www.codeproject.com/KB/applications/">Applications &amp; 
      Tools</A></DIV>
      <DIV class=MI id=Section85><A 
      href="http://www.codeproject.com/KB/asp/">ASP</A></DIV>
      <DIV class=MI id=Section89><A 
      href="http://www.codeproject.com/KB/aspnet/">ASP.NET</A></DIV>
      <DIV class=MI id=Section28><A 
      href="http://www.codeproject.com/KB/webforms/">ASP.NET Controls</A></DIV>
      <DIV class=MI id=Section38><A 
      href="http://www.codeproject.com/KB/ATL-Server/">ATL Server</A></DIV>
      <DIV class=MI id=Section29><A 
      href="http://www.codeproject.com/KB/web-cache/">Caching</A></DIV>
      <DIV class=MI id=Section91><A 
      href="http://www.codeproject.com/KB/web-image/">Charts, Graphs and 
      Images</A></DIV>
      <DIV class=MI id=Section25><A 
      href="http://www.codeproject.com/KB/scripting/">Client side 
      scripting</A></DIV>
      <DIV class=MI id=Section30><A 
      href="http://www.codeproject.com/KB/custom-controls/">Custom 
      Controls</A></DIV>
      <DIV class=MI id=Section23><A 
      href="http://www.codeproject.com/KB/HTML/">HTML / CSS</A></DIV>
      <DIV class=MIS id=Section22><A 
      href="http://www.codeproject.com/KB/IP/">Internet / Network</A></DIV>
      <DIV class=MI id=Section24><A 
      href="http://www.codeproject.com/KB/ISAPI/">ISAPI</A></DIV>
      <DIV class=MI id=Section33><A 
      href="http://www.codeproject.com/KB/server-management/">Site &amp; Server 
      Management</A></DIV>
      <DIV class=MI id=Section34><A 
      href="http://www.codeproject.com/KB/session/">Session State</A></DIV>
      <DIV class=MI id=Section113><A 
      href="http://www.codeproject.com/KB/silverlight/">Silverlight</A></DIV>
      <DIV class=MI id=Section36><A 
      href="http://www.codeproject.com/KB/trace/">Trace and Logs</A></DIV>
      <DIV class=MI id=Section31><A 
      href="http://www.codeproject.com/KB/user-controls/">User 
Controls</A></DIV>
      <DIV class=MI id=Section37><A 
      href="http://www.codeproject.com/KB/validation/">Validation</A></DIV>
      <DIV class=MI id=Section35><A 
      href="http://www.codeproject.com/KB/viewstate/">View State</A></DIV>
      <DIV class=MI id=Section26><A 
      href="http://www.codeproject.com/KB/WAP/">WAP / WML</A></DIV>
      <DIV class=MI id=Section32><A 
      href="http://www.codeproject.com/KB/web-security/">Web Security</A></DIV>
      <DIV class=MI id=Section20><A 
      href="http://www.codeproject.com/KB/webservices/">Web 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter9');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=9">Enterprise 
      Systems</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter9 style="DISPLAY: none">
      <DIV class=MI id=Section98><A 
      href="http://www.codeproject.com/KB/MCMS/">Content Management 
      Server</A></DIV>
      <DIV class=MI id=Section99><A 
      href="http://www.codeproject.com/KB/biztalk/">Microsoft BizTalk 
      Server</A></DIV>
      <DIV class=MI id=Section102><A 
      href="http://www.codeproject.com/KB/exchange/">Microsoft 
Exchange</A></DIV>
      <DIV class=MI id=Section90><A 
      href="http://www.codeproject.com/KB/office/">Office Development</A></DIV>
      <DIV class=MI id=Section101><A 
      href="http://www.codeproject.com/KB/sharepoint/">SharePoint 
      Server</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter3');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=3">Multimedia</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter3 style="DISPLAY: none">
      <DIV class=MI id=Section42><A 
      href="http://www.codeproject.com/KB/audio-video/">Audio and 
Video</A></DIV>
      <DIV class=MI id=Section44><A 
      href="http://www.codeproject.com/KB/directx/">DirectX</A></DIV>
      <DIV class=MI id=Section46><A 
      href="http://www.codeproject.com/KB/GDI/">GDI</A></DIV>
      <DIV class=MI id=Section47><A 
      href="http://www.codeproject.com/KB/GDI-plus/">GDI+</A></DIV>
      <DIV class=MI id=Section43><A 
      href="http://www.codeproject.com/KB/graphics/">General Graphics</A></DIV>
      <DIV class=MI id=Section45><A 
      href="http://www.codeproject.com/KB/openGL/">OpenGL</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter4');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=4">Database</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter4 style="DISPLAY: none">
      <DIV class=MI id=Section66><A 
      href="http://www.codeproject.com/KB/database/">Database</A></DIV>
      <DIV class=MI id=Section100><A 
      href="http://www.codeproject.com/KB/reporting-services/">SQL Reporting 
      Services</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter8');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=8">Platforms, 
      Frameworks &amp; Libraries</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter8 style="DISPLAY: none">
      <DIV class=MI id=Section83><A 
      href="http://www.codeproject.com/KB/atl/">ATL</A></DIV>
      <DIV class=MI id=Section117><A 
      href="http://www.codeproject.com/KB/MFC/">MFC</A></DIV>
      <DIV class=MI id=Section88><A 
      href="http://www.codeproject.com/KB/stl/">STL</A></DIV>
      <DIV class=MI id=Section84><A 
      href="http://www.codeproject.com/KB/wtl/">WTL</A></DIV>
      <DIV class=MI id=Section49><A 
      href="http://www.codeproject.com/KB/COM/">COM / COM+</A></DIV>
      <DIV class=MI id=Section76><A 
      href="http://www.codeproject.com/KB/dotnet/">.NET Framework</A></DIV>
      <DIV class=MI id=Section92><A 
      href="http://www.codeproject.com/KB/winsdk/">Win32/64 SDK &amp; 
      OS</A></DIV>
      <DIV class=MI id=Section108><A 
      href="http://www.codeproject.com/KB/vista/">Vista API</A></DIV>
      <DIV class=MI id=Section110><A 
      href="http://www.codeproject.com/KB/vista-security/">Vista 
      Security</A></DIV>
      <DIV class=MI id=Section82><A 
      href="http://www.codeproject.com/KB/cross-platform/">Cross 
      Platform</A></DIV>
      <DIV class=MI id=Section69><A 
      href="http://www.codeproject.com/KB/game/">Game Development</A></DIV>
      <DIV class=MI id=Section73><A 
      href="http://www.codeproject.com/KB/mobile/">Mobile Development</A></DIV>
      <DIV class=MI id=Section106><A 
      href="http://www.codeproject.com/KB/WC/">Windows CardSpace</A></DIV>
      <DIV class=MI id=Section103><A 
      href="http://www.codeproject.com/KB/WCF/">Windows Communication 
      Foundation</A></DIV>
      <DIV class=MI id=Section104><A 
      href="http://www.codeproject.com/KB/WPF/">Windows Presentation 
      Foundation</A></DIV>
      <DIV class=MI id=Section105><A 
      href="http://www.codeproject.com/KB/WF/">Windows Workflow 
      Foundation</A></DIV>
      <DIV class=MI id=Section119><A 
      href="http://www.codeproject.com/KB/library/">Libraries</A></DIV>
      <DIV class=MI id=Section122><A 
      href="http://www.codeproject.com/KB/powershell/">Windows 
      Powershell</A></DIV>
      <DIV class=MI id=Section123><A 
      href="http://www.codeproject.com/KB/linq/">LINQ</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter5');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=5">Languages</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter5 style="DISPLAY: none">
      <DIV class=MI id=Section71><A href="http://www.codeproject.com/KB/cpp/">C 
      / C++ Language</A></DIV>
      <DIV class=MI id=Section72><A 
      href="http://www.codeproject.com/KB/mcpp/">C++ / CLI</A></DIV>
      <DIV class=MI id=Section93><A 
      href="http://www.codeproject.com/KB/cs/">C#</A></DIV>
      <DIV class=MI id=Section78><A 
      href="http://www.codeproject.com/KB/msil/">MSIL</A></DIV>
      <DIV class=MI id=Section86><A 
      href="http://www.codeproject.com/KB/vbscript/">VBScript</A></DIV>
      <DIV class=MI id=Section87><A 
      href="http://www.codeproject.com/KB/vb/">VB.NET</A></DIV>
      <DIV class=MI id=Section115><A 
      href="http://www.codeproject.com/KB/vb-interop/">VB6 Interop</A></DIV>
      <DIV class=MI id=Section77><A 
      href="http://www.codeproject.com/KB/net-languages/">Other .NET 
      Languages</A></DIV>
      <DIV class=MI id=Section21><A 
      href="http://www.codeproject.com/KB/XML/">XML</A></DIV>
      <DIV class=MI id=Section96><A 
      href="http://www.codeproject.com/KB/java/">Java</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter6');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=6">General 
      Programming</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter6 style="DISPLAY: none">
      <DIV class=MI id=Section57><A 
      href="http://www.codeproject.com/KB/recipes/">Algorithms &amp; 
      Recipes</A></DIV>
      <DIV class=MI id=Section64><A 
      href="http://www.codeproject.com/KB/bugs/">Bugs &amp; 
Workarounds</A></DIV>
      <DIV class=MI id=Section79><A 
      href="http://www.codeproject.com/KB/collections/">Collections</A></DIV>
      <DIV class=MI id=Section56><A 
      href="http://www.codeproject.com/KB/security/">Cryptography &amp; 
      Security</A></DIV>
      <DIV class=MI id=Section50><A 
      href="http://www.codeproject.com/KB/datetime/">Date and Time</A></DIV>
      <DIV class=MI id=Section52><A 
      href="http://www.codeproject.com/KB/DLL/">DLLs &amp; Assemblies</A></DIV>
      <DIV class=MI id=Section80><A 
      href="http://www.codeproject.com/KB/exception/">Exception 
      Handling</A></DIV>
      <DIV class=MI id=Section81><A 
      href="http://www.codeproject.com/KB/locale/">Localisation</A></DIV>
      <DIV class=MI id=Section53><A 
      href="http://www.codeproject.com/KB/macros/">Macros and Add-ins</A></DIV>
      <DIV class=MI id=Section54><A 
      href="http://www.codeproject.com/KB/tips/">Programming Tips</A></DIV>
      <DIV class=MI id=Section55><A 
      href="http://www.codeproject.com/KB/string/">String handling</A></DIV>
      <DIV class=MI id=Section58><A 
      href="http://www.codeproject.com/KB/threads/">Threads, Processes &amp; 
      IPC</A></DIV>
      <DIV class=MI id=Section59><A 
      href="http://www.codeproject.com/KB/winhelp/">WinHelp / 
      HTMLHelp</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter10');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=10">Graphics 
      / Design</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter10 style="DISPLAY: none">
      <DIV class=MI id=Section40><A 
      href="http://www.codeproject.com/KB/expression/">Expression</A></DIV>
      <DIV class=MI id=Section114><A 
      href="http://www.codeproject.com/KB/usability/">Usability</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter11');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=11">Development 
      Lifecycle</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter11 style="DISPLAY: none">
      <DIV class=MI id=Section51><A 
      href="http://www.codeproject.com/KB/debug/">Debug Tips</A></DIV>
      <DIV class=MI id=Section39><A 
      href="http://www.codeproject.com/KB/architecture/">Design and 
      Architecture</A></DIV>
      <DIV class=MI id=Section112><A 
      href="http://www.codeproject.com/KB/install/">Installation</A></DIV>
      <DIV class=MI id=Section41><A 
      href="http://www.codeproject.com/KB/work/">Work Issues</A></DIV>
      <DIV class=MI id=Section126><A 
      href="http://www.codeproject.com/KB/codegen/">Code 
      Generation</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter7');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=7">General 
      Reading</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter7 style="DISPLAY: none">
      <DIV class=MI id=Section60><A 
      href="http://www.codeproject.com/KB/books/">Book Chapters</A></DIV>
      <DIV class=MI id=Section61><A 
      href="http://www.codeproject.com/KB/book-reviews/">Book Reviews</A></DIV>
      <DIV class=MI id=Section109><A 
      href="http://www.codeproject.com/KB/hardware-review/">Hardware 
      Reviews</A></DIV>
      <DIV class=MI id=Section63><A 
      href="http://www.codeproject.com/KB/interviews/">Interviews</A></DIV>
      <DIV class=MI id=Section62><A 
      href="http://www.codeproject.com/KB/scrapbook/">Scrapbook</A></DIV>
      <DIV class=MI id=Section48><A 
      href="http://www.codeproject.com/KB/system/">Hardware &amp; 
      System</A></DIV></DIV>
      <DIV class=MenuChapter><A onclick="return ToggleMenu('Chapter12');" 
      href="http://www.codeproject.com/script/Content/Chapter.aspx?chptId=12">Third 
      Party Products</A></DIV>
      <DIV class=MenuSectionBlock id=Chapter12 style="DISPLAY: none">
      <DIV class=MI id=Section65><A 
      href="http://www.codeproject.com/KB/showcase/">Product Showcase</A></DIV>
      <DIV class=MI id=Section124><A 
      href="http://www.codeproject.com/KB/solution-center/">Solution 
      Center</A></DIV></DIV></DIV><BR>
      <DIV class=MenuCat>Services</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/script/Jobs/List.aspx">Job 
Board</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/coffee.aspx">Code Project 
      Coffee</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Services/TradePub.aspx">Free 
      Magazines</A></DIV><BR>
      <DIV class=MenuCat>Feature Zones</DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/kb/Showcase/">Product Showcase</A></DIV>
      <DIV class=MenuChapter><A href="http://www.codeproject.com/Zones/IBM">IBM 
      DeveloperWorks</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/WhitePapers">WhitePapers / 
      Webcasts</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/QuestSQL">Quest SQL Zone</A></DIV>
      <DIV class=MenuChapter><A 
      href="http://www.codeproject.com/Zones/Acresso">InstallShield 
      2009</A></DIV><BR>
      <DIV style="MARGIN-BOTTOM: 10px; TEXT-ALIGN: center"><IFRAME 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/ServeHTML.htm" 
      frameBorder=0 width=150 scrolling=no height=80></IFRAME></DIV>
      <SCRIPT type=text/javascript>document.write(unescape("%3ca%20href%3d%22http%3a%2f%2fwww.codeproject.com%2fRedir.aspx%3fadid%3d6722%26way%3dban%22%20target%3d%22_blank%22%20rel%3d%22nofollow%22%3e%3cimg%20src%3d%22http%3a%2f%2fwww.codeproject.com%2fscript%2fAdm%2fServeImg.aspx%3fFile%3d%252fscript%252fadmentor%252fimages%252fxoreax_160x600.gif%26C%3dFalse%26adid%3d6722%22%20alt%3d%22Xoreax%20cuts%20VS%20build%20times%20by%20up%20to%2090%25%22%20border%3d%220%22%20width%3d%22160%22%20height%3d%22600%22%3e%3c%2fa%3e"));</SCRIPT>
    </TD>
    <TD class=ArticlePane vAlign=top>
      <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD style="WIDTH: 60%; WHITE-SPACE: nowrap" vAlign=center 
            align=right><FORM style="MARGIN: 0px" name=Search 
            action=/info/search.aspx method=get><B>Search &nbsp;</B> <INPUT 
            class=SmallText style="WIDTH: 200px" name=artkw> <SELECT 
            class=SmallText style="FONT-WEIGHT: bold" name=sbo> <OPTION 
              value=kw selected>Articles</OPTION> <OPTION 
              value=fm>Messages</OPTION> <OPTION value=s>Jobs</OPTION></SELECT> <INPUT class=SmallText style="FONT-WEIGHT: bold" type=submit value=" Go! "> 
            &nbsp; </FORM></TD>
          <TD class=TinyText style="WHITE-SPACE: nowrap"><A 
            href="http://www.codeproject.com/info/search.aspx">Advanced 
            Search</A><BR><A 
            href="http://www.codeproject.com/script/Content/SiteMap.aspx">Sitemap</A> 
            | <A id=ctl00_SearchBarCtrl_AddToIESearchLnk 
            title="Add The Code Project to your IE search Providers" 
            onclick="window.external.AddSearchProvider('http://www.codeproject.com/info/OpenSearch.xml');return false;" 
            href="http://www.codeproject.com/">Add to IE Search</A> 
        </TD></TR></TBODY></TABLE><SPAN id=ctl00_ResultMessage></SPAN>
      <DIV id=ctl00_ArtDiv>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD vAlign=top>
            <TABLE>
              <TBODY></TBODY></TABLE>
            <DIV class=SmallText><IMG style="VERTICAL-ALIGN: middle" height=16 
            alt=print 
            src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/print.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_PrintLnk 
            href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?display=Print">Print</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Broken Article?" 
            src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/report.gif" 
            width=16> <A id=ctl00_ArticleHeaderLinks_BrokenLnk 
            href="http://www.codeproject.com/script/Articles/Report.aspx?aid=19886">Report 
            Article</A> &nbsp; <IMG style="VERTICAL-ALIGN: middle" alt=Watch 
            src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/watchon.png"> 
            <A class="" id=bmw_19886,2 onclick="return watchMe(19886, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=19886&amp;obtid=2&amp;bma=AddWatch" 
            name=ajaxBookmarkWatchLink>Watch</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN><SPAN 
            id=ctl00_ArticleHeaderLinks_ArticleBmkWatch_Message></SPAN>&nbsp; 
            <IMG style="VERTICAL-ALIGN: middle" height=16 alt=Bookmark 
            src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/link.png" 
            width=16> <A class="" id=bm_19886,2 
            onclick="return bookmarkMe(19886, 2);" 
            href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=19886&amp;obtid=2&amp;bma=AddBookmark" 
            name=ajaxBookmarkLink>Bookmark</A> <SPAN class=TinyText 
            style="VISIBILITY: hidden"></SPAN><SPAN 
            id=ctl00_ArticleHeaderLinks_ArticleBmk_Message></SPAN>&nbsp; <IMG 
            style="VERTICAL-ALIGN: middle" height=16 alt=Discuss 
            src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/discuss.gif" 
            width=15> <A 
            href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx#_comments">Discuss</A> 
            &nbsp; <IMG style="VERTICAL-ALIGN: middle" height=16 
            alt="Recommend Article" 
            src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/mail.gif" 
            width=16>&nbsp;<A id=ctl00_ArticleHeaderLinks_Recommend 
            href="http://www.codeproject.com/script/common/TellFriend.aspx?obtid=2&amp;obid=19886">Send&nbsp;to&nbsp;a&nbsp;friend</A> 
            </DIV></TD>
          <TD style="WIDTH: 100px; WHITE-SPACE: nowrap; TEXT-ALIGN: right">
            <TABLE id=CurRat>
              <TBODY>
              <TR>
                <TD>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=SmallText id=ctl00_ArticleRating_VL 
                      style="WHITE-SPACE: nowrap" align=right><SPAN 
                        id=ctl00_ArticleRating_VoteLabel>10 votes for this 
                        Article.</SPAN></TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=1>
                          <TBODY>
                          <TR>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD width=20 bgColor=white height=7><IMG height=7 
                              src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/red.gif" 
                              width=20 align=center border=0></TD>
                            <TD noWrap width=20 bgColor=white height=7><IMG 
                              height=7 
                              src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/red.gif" 
                              width=10 align=center 
                      border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR id=ctl00_ArticleRating_PopularityRow>
                      <TD class=SmallText align=right colSpan=2><A 
                        id=ctl00_ArticleRating_PopularityLnk 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=1">Popularity: 
                        4.48</A> <SPAN 
                        id=ctl00_ArticleRating_PopularityLbl></SPAN><SPAN 
                        id=ratingVal>Rating: <B>4.48</B> out of 
                    5</SPAN></TD></TR></TBODY></TABLE></TD>
                <TD>
                  <DIV>
                  <TABLE class=HistTable 
                  title="Voting Distribution. Recent data only">
                    <TBODY>
                    <TR>
                      <TD><IMG title="1 vote, 10.0%" height=2 
                        alt="1 vote, 10.0%" 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/pollcol.gif" 
                        width=10 border=0><BR>1</TD>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>2</TD>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>3</TD>
                      <TD><IMG title="0 votes, 0.0%" height=1 
                        alt="0 votes, 0.0%" src="" width=10 border=0><BR>4</TD>
                      <TD><IMG title="9 votes, 90.0%" height=20 
                        alt="9 votes, 90.0%" 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/pollcol.gif" 
                        width=10 
              border=0><BR>5</TD></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><SPAN 
      id=intelliTXT>
      <DIV id=contentdiv><!-- Main Page Contents Start --><!-- Article Starts -->
      <UL class=download>
        <LI><A 
        href="http://www.codeproject.com/KB/IP/HTTPFilter/HTTPFilter_src.zip">Download 
        source - 36.3 KB</A> 
        <LI><A 
        href="http://www.codeproject.com/KB/IP/HTTPFilter/HTTPFilter_demo.zip">Download 
        demo project - 23 KB</A> </LI></UL>
      <P><IMG height=486 alt="Screenshot - screenshot.gif" 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/screenshot.gif" 
      width=524></P>
      <P><IMG height=300 alt="Screenshot - blocked.jpg" 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/blocked.jpg" 
      width=496></P>
      <H2>1. Abstract</H2>
      <P>Most web filters work inline, meaning that all outgoing and incoming 
      packets are passed through a filter driver. While this approach has its 
      benefits, it has a big flaw: the filtering process affects the data 
      transfer throughput. This project presents an experimental remedy to this 
      issue by putting the filter engine in sniffer mode. This way, the 
      filtering process and the data transfer act independently.</P>
      <H2>2. Requirements</H2>
      <UL>
        <LI>The article expects the reader to be familiar with C++ and TCP/IP 
        concepts. 
        <LI>The source code uses the following libraries: 
        <UL>
          <LI>Winsock. 
          <LI>Ethereal: A packet capture and network analyzer. </LI></UL>
        <LI>The code was compiled and built with VC7 on Windows Server 2003. 
        </LI></UL>
      <H2>3. Introduction</H2>
      <P>The main goal of this article is to explain the practical details of 
      low level network programming. There are many commercial and open source 
      firewalls and HTTP filters available on both Linux and Windows. But, 
      internally, most of them follow the same approach to finding their 
      targets. The References section of this article provides you handy books 
      related to this topic.</P>
      <P>Particularly, a web filter could act in two modes to inspect outgoing 
      packets for blacklist keywords: Inline mode and Sniffer mode. We also 
      explain both these modes of operation and compare them.</P>
      <H2>4. Background</H2>
      <P>This section explains the TCP/IP protocol stack, the HTTP protocol 
      behavior, and the Boyer-Moore algorithm for fast pattern matching. If you 
      think that you have enough experience and knowledge and want to get your 
      hands dirty, please continue to section 7 (Implementation).</P>
      <P>A mission critical system is totally different from an office 
      application. Imagine that your team plans to develop a firewall, or web 
      filter, or even a secure proxy server which processes tons of packets in a 
      few seconds. Well, what are the main characteristics of such systems?</P>
      <P>Being fail-safe, high-performing, full-featured, and Green, are a few. 
      By Green, I mean the system should not eat out the CPU and the memory of 
      the hosted platform. Meanwhile, in such an expensive project, there is no 
      room for logical mistakes due to lack of technical knowledge! In a typical 
      environment, your last result must be deployed in the model below:</P>
      <P><IMG height=242 alt="Screenshot - HttpFilter.jpg" 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/HttpFilter.jpg" 
      width=490></P>
      <H3>4.1 TCP/IP protocol stack</H3>
      <P>As the name describes, TCP/IP refers to a number of protocols, each of 
      which was developed for a purpose. In order to understand an HTTP session 
      establishment process, we should know at-least the following protocols: 
      Ethernet II, ARP, IP, TCP, UDP, HTTP, and DNS.</P>
      <H3>4.2 Ethernet II</H3>
      <P>The Ethernet II frame format was defined by the Ethernet specification 
      created by Digital, Intel, and Xerox before the IEEE 802.3 Specification. 
      The Ethernet II frame format is also known as the DIX frame format.</P>
      <P>Ethernet II consist of the following fields (totally 26 bytes + a 
      payload from 46 bytes to 1500 bytes):</P>
      <UL>
        <LI><STRONG>Preamble</STRONG> (8 bytes) consisting of 7 bytes of 
        alternating 1s and 0s (each byte is the bit sequence 10101010) to 
        synchronize a receiving station, and a 1-byte 10101011 sequence that 
        indicates the start of a frame. The Preamble provides receiver 
        synchronization and frame delimitation services. 
        <LI><STRONG>Destination Address</STRONG> (6 bytes) indicates the 
        destination's address. The destination can be a unicast, a multicast, or 
        Ethernet broadcast address. A unicast address is also known as an 
        individual, physical, hardware, or MAC address. For the Ethernet 
        broadcast address, all 48 bits are set to 1 to create the address 
        0xFF-FF-FF-FF-FF-FF. 
        <LI><STRONG>Source Address</STRONG> (6 bytes) indicates the sending 
        node's unicast address. 
        <LI><STRONG>EtherType</STRONG> (2 bytes) indicates the upper layer 
        protocol contained within the Ethernet frame. For an IP datagram, the 
        field is set to 0x0800. For an ARP message, the EtherType field is set 
        to 0x0806. For a complete list, see the References section. 
        <LI><STRONG>Payload</STRONG> consists of a protocol data unit (PDU) of 
        an upper layer protocol. Ethernet II can send a maximum-sized payload of 
        1500 bytes. Because of the Ethernet's collision detection facility, 
        Ethernet II frames must send a minimum payload size of 46 bytes. 
        <LI><STRONG>FCS</STRONG> (4 bytes) provides bit-level integrity 
        verification on the bits in the Ethernet II frame using the CRC 
        algorithm. </LI></UL>
      <P>A typical capture shows you the fields below (FCS and Preamble are 
      excluded):</P><PRE lang=text>    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
    | destination   | source       | protocol |                   |
    | mac address   | mac address  | type     | IP DATAGRAM       |
    | (6 bytes)     | (6 bytes)    | 0X0800   |                   |
    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</PRE>
      <H3>4.3 ARP</H3>
      <P>ARP is a broadcast-based, request-reply protocol that provides a 
      dynamic address resolution facility to map the next-hop IP addresses to 
      their corresponding MAC addresses.</P>
      <P>There are two facts regarding the datalink layer that show we need 
      ARP:</P>
      <OL>
        <LI>When an Ethernet frame is sent from one host on a LAN to another, it 
        is the 48-bit Ethernet address that determines for which interface the 
        frame is destined. The device driver software never looks at the 
        destination IP address in the IP datagram. 
        <LI>The next-hop IP address is not necessarily the same as the 
        destination IP address of the IP datagram. The result of the route 
        determination process for every outgoing IP datagram is a next-hop 
        interface and a next-hop IP address. For direct deliveries to 
        destinations on the same subnet, the next-hop IP address is the 
        datagram's destination IP address. For indirect deliveries to remote 
        destinations, the next-hop IP address is the IP address of a router on 
        the same Subnet as the forwarding host. To get that device as a next 
        hop, the packet needs its hardware address. </LI></OL>
      <H3>4.4 IP</H3>
      <P>IP, the heart of the TCP/IP protocol suite, provides connectionless, 
      unreliable delivery of data. By unreliable, we mean that there is no 
      guarantee that a datagram successfully gets to its destination. By 
      connectionless, we mean that the IP doesn't maintain any information 
      regarding successive datagrams. On the other hand, each datagram is 
      handled independently. IP makes the best effort to deliver packets to the 
      next hop or the final destination. End-to-end reliability is the 
      responsibility of upper layer protocols such as TCP.</P>
      <P>An IP header contains the following fields which we need to know for 
      packet processing later:</P>
      <UL>
        <LI><STRONG>Version</STRONG> (4 bytes): Indicates the format of the 
        Internet header. 
        <LI><STRONG>IHL</STRONG> (4 bytes): Is the length of the IP header in 32 
        bit words. 
        <LI>Type of service or <STRONG>TOS</STRONG> (1 byte) </LI></UL>
      <P>As the name indicates, it specifies how much the IP packet is important 
      for us. Some intermediate devices evaluate this field in the case of high 
      loads and prioritizes the datagram. In RFC 791 (Internet Protocol), this 
      field is structured as follows:</P><PRE lang=text>     0     1     2     3     4     5     6     7

      +-----+-----+-----+-----+-----+-----+-----+-----+
      |                 |     |     |     |     |     |
      |   PRECEDENCE    |  D  |  T  |  R  |  0  |  0  |
      |                 |     |     |     |     |     |
      +-----+-----+-----+-----+-----+-----+-----+-----+
  D &gt;&gt; Delay
  T    &gt;&gt; Throughput
  R    &gt;&gt; Reliability
  Bit6 and Bit7    &gt;&gt; reserved</PRE>
      <UL>
        <LI>Total length (2 bytes): 
        <P>The total size of the header + the payload. The total length field, 
        conceptually, allows the length of a datagram to be up to 65,535 bytes, 
        although such a long packet is impractical for most hosts and network 
        devices. Later, we study what a MTU is and how it may help us to put 
        this in reality.</P>
        <P>Anyway, remember that the IP header is only 20 bytes, and if there 
        are any options, the length can go as high as 60 bytes. No more!</P>
        <LI>ID (2 bytes): 
        <P>Assigned by the sender so that the receiver can decrement the 
        fragmented IP packets due to the MTU value.</P>
        <P>For the second time, I have mentioned "MTU", so let us see what the 
        MTU is. Most of the data you generate while, for example, surfing the 
        web, are bulk data. It means that the size of data is big. The 
        underlying media access protocol splits the bulk to smaller parts so 
        that it can send them seamlessly over the network infrastructure. In the 
        case of the HTTP 802.3 Ethernet Protocol, the maximum size of a datagram 
        is 1500 bytes. This number is called MTU, and stands for Maximum 
        Transmission Unit. In case you want to transmit 15000 bytes of data to 
        your mate, the protocol stack splits your message to 10 * 1500 bytes and 
        transmits them one by one. If we put 20 bytes for the IP header, 1480 
        byes remain for the transport layer header and the payload. This is 
        where ID comes into picture. The protocol stack splits the message to 10 
        smaller messages and assigns a unique ID in the IP header. When the 
        receiver gets all the pieces, it can do further processing over the 
        whole message.</P>
        <LI>Flags (3 bits): 
        <P>Says if the datagram is a part of the fragmented data or not.</P><PRE lang=text>         0   1   2
        +---+---+---+
        |   | D | M |
        | 0 | F | F |
        +---+---+---+</PRE>
        <LI>Fragment Offset (13 bits): 
        <P>An 8-byte chunk of data is called a fragment block. The number in the 
        Fragment Offset field reports the size of the offset in fragment blocks. 
        The Fragment Offset field is 13 bits long, so offsets can range from 0 
        to 8191 fragment blocks—corresponding to offsets from 0 to 65,528 
        bytes.</P>
        <LI>TTL (1 byte): 
        <P>This field says how long a datagram could remain alive in a network 
        system. It measures time in seconds.</P>
        <LI>Protocol (1 byte): 
        <P>Indicates the upper layer protocol type. For example:</P><PRE lang=text>1 &gt;&gt; ICMP
2 &gt;&gt; GIMP
4 &gt;&gt; IP in IP encapsulation
6 &gt;&gt; TCP
17 &gt;&gt; ADP
41 &gt;&gt; IPV6
47 &gt;&gt; Generic routing encapsulation (ARE)
50 &gt;&gt; IP security encapsulation security payload (ESP)
51 &gt;&gt; IP security authentication header (AH)
89 &gt;&gt; ASP</PRE>
        <LI>Header checksum (2 bytes): 
        <P>To measure the integrity of the header, the protocol stack handler 
        performs a CRC on the header and compares it with the checksum value. It 
        is a kind of sanity check.</P>
        <LI>Source IP Address and Destination IP Address (each 4 bytes). 
        <LI>Options (variable length): 
        <P>Maintains a list of optional information for the datagram.</P><PRE lang=text>   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |Version|  IHL  |Type of Service|          Total Length         |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |         Identification        |Flags|      Fragment Offset    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Time to Live |    Protocol   |         Header Checksum       |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                       Source Address                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Destination Address                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Options                    |    Padding    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ </PRE></LI></UL>
      <H3>4.5 TCP</H3>
      <P>TCP is a fully formed Transport Layer protocol that provides a reliable 
      data-transfer service and a method to pass TCP-encapsulated data to the 
      Application Layer protocol. TCP has the following characteristics:</P>
      <UL>
        <LI><STRONG>Connection oriented</STRONG>: Before any send or receive, 
        both sides of data transfer must negotiate a TCP connection using a TCP 
        three-way handshake process. TCP connections are terminated through a 
        graceful TCP 4-way termination process. 
        <LI><STRONG>Full duplex</STRONG>: From one pipe, data can be sent and 
        received simultaneously. TCP does this job perfectly, gaining from the 
        sequence number and acknowledgment number fields in its header. 
        <LI><STRONG>Reliable</STRONG>: Data sent on a TCP connection is 
        sequenced, and a positive acknowledgment is expected from the receiver. 
        If no acknowledgment is received, the segment is retransmitted. 
        <LI><STRONG>Flow control</STRONG>: To avoid sending too much data at one 
        time and congesting the routers of the IP inter-network, TCP implements 
        sender-side flow control that gradually scales the amount of data sent 
        at one time. To avoid having the sender send data that the receiver 
        cannot buffer, TCP implements a receiver-side flow control that 
        indicates the amount of space left in the receiver's buffer. 
        <LI><STRONG>Segmentation of application layer data</STRONG>: TCP 
        segments data obtained from the Application Layer process so that it 
        will fit within an IP datagram sent on the Network Interface Layer link. 
        TCP peers exchange the maximum-sized segment that each can receive, and 
        adjust the TCP maximum segment size using a Path Maximum Transmission 
        Unit (PMTU) discovery. 
        <LI><STRONG>One to one delivery of data</STRONG>: TCP connections are a 
        logical point-to-point circuit between two Application Layer protocols. 
        TCP does not provide a one-to-many delivery service. </LI></UL>
      <P>The figure below shows a TCP segment encapsulated in an IP 
datagram:</P><PRE lang=text>&lt;--------------- IP datagram ------------------&gt;
++++++++++++++++++++++++++++++++++++++++++++++++
|   IP    |  TCP    |          TCP             |
| Header  | Header  |         Data             |
++++++++++++++++++++++++++++++++++++++++++++++++
20 bytes  20 bytes
At-least  At-least</PRE>
      <P>TCP header:</P><PRE lang=text>   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          Source Port          |       Destination Port        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                        Sequence Number                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Acknowledgment Number                      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  Data |           |U|A|P|R|S|F|                               |
   | Offset| Reserved  |R|C|S|S|Y|I|            Window             |
   |       |           |G|K|H|T|N|N|                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           Checksum            |         Urgent Pointer        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                    Options                    |    Padding    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                             data                              |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</PRE>
      <UL>
        <LI><STRONG>Source Port</STRONG> (2 bytes): The source port number. 
        <LI><STRONG>Destination Port</STRONG> (2 bytes): The destination port 
        number. 
        <LI><STRONG>Sequence Number</STRONG> (4 bytes): Indicates the outgoing 
        byte-stream-based sequence number of the segment's first octet. 
        <LI><STRONG>Acknowledgment Number</STRONG> (4 bytes): If the ACK control 
        bit is set, this field indicates the sequence number of the next octet 
        in the incoming byte stream that the receiver expects to receive. 
        <LI><STRONG>Data Offset</STRONG> (4 bits): Indicates where the TCP 
        segment data begins. The Data Offset field is also the TCP header's 
        size. Just as in the IP header's Header Length field, the Data Offset 
        field is the number of 32-bit words (4-byte blocks) in the TCP header. 
        For the smallest TCP header (no options), the Data Offset field is set 
        to 5 (0x5), indicating that the segment data begins in the twentieth 
        octet offset starting from the beginning of the TCP segment (the offset 
        starts its count at 0). With a Data Offset field set to its maximum 
        value of 15 (0xF), the largest TCP header, including TCP options, can be 
        60 bytes long. 
        <LI><STRONG>Reserved</STRONG> (6 bits): Reserved for future use. Must be 
        zero. 
        <LI><STRONG>Control Bits</STRONG> (6 bits from left to right): 
        <UL>
          <LI><STRONG>URG</STRONG>: Urgent pointer field significant 
          <LI><STRONG>ACK</STRONG>: Acknowledgment field significant 
          <LI><STRONG>PSH</STRONG>: Push function 
          <LI><STRONG>RST</STRONG>: Reset the connection 
          <LI><STRONG>SYN</STRONG>: Synchronize sequence numbers 
          <LI><STRONG>FIN</STRONG>: No more data from sender </LI></UL>
        <LI><STRONG>Window</STRONG> (2 bytes): The number of data octets 
        beginning with the one indicated in the acknowledgment field which the 
        sender of this segment is willing to accept. 
        <LI><STRONG>Checksum</STRONG> (2 bytes): The checksum field is the 16 
        bit one's complement of the one's complement sum of all 16 bit words in 
        the header and text. While computing the checksum, the checksum field 
        itself is replaced with zeros. 
        <P>To compute a TCP checksum, we need to consider a TCP pseudo header. 
        The TCP pseudo header is used to associate the TCP segment with the IP 
        header. The TCP pseudo header is added to the beginning of the TCP 
        segment only during the checksum calculation, and is not sent as part of 
        the TCP segment. The use of the TCP pseudo header assures the receiver 
        that a routing or fragmentation process did not improperly modify the 
        key fields in the IP header.</P><PRE lang=text>+--------+--------+--------+--------+
|           Source Address          |
+--------+--------+--------+--------+
|         Destination Address       |
+--------+--------+--------+--------+
|  zero  |PROTOCOL|    TCP Length   |
+--------+--------+--------+--------+</PRE>
        <LI><STRONG>Urgent Pointer</STRONG> (2 bytes): This field communicates 
        the current value of the urgent pointer as a positive offset from the 
        sequence number in this segment. The Urgent Pointer points to the 
        sequence number of the octet following the urgent data. This field is 
        only interpreted in segments with the <STRONG>URG</STRONG> control bit 
        set. 
        <LI><STRONG>Options</STRONG> (variable): Options may occupy space at the 
        end of the TCP header, and are a multiple of 8 bits in length. 
        <LI><STRONG>Padding</STRONG> (variable): The TCP header padding is used 
        to ensure that the TCP header ends and data begins on a 32 bit boundary. 
        The padding is composed of zeros. </LI></UL>
      <H3>4.6 UDP</H3>
      <P>UDP is a simple, datagram-oriented, transport layer protocol: each 
      output operation by a process produces exactly one UDP datagram, which 
      causes one IP datagram to be sent. This is different from a 
      stream-oriented protocol such as TCP, where the amount of data written by 
      an application may have little relationship to what actually gets sent in 
      a single IP datagram.</P><PRE lang=text>+--------+--------+--------+--------+  ----
|     Source   2  | Destination   2 |    |
|      Port  bytes|    Port    bytes|    |
+--------+--------+--------+--------+  8 bytes
|     2 bytes     |     2 bytes     |    |
|     Length      |    Checksum     |    |
+--------+--------+--------+--------+  ----
|                                   |  
|          data octets              |
+-----------------------------------+</PRE>
      <H3>4.7 DNS</H3>
      <P>The Domain Name System, or DNS, is a distributed database that is used 
      by TCP/IP applications to map between hostnames and IP addresses, and to 
      provide electronic mail routing information. We use the term distributed 
      because no single site on the Internet knows all the information. Each 
      site (university department, campus, company, or department within a 
      company, for example) maintains its own database of information, and runs 
      a server program that other systems across the Internet (clients) can 
      query. The DNS provides the protocol that allows clients and servers to 
      communicate with each other.</P>
      <P>From an application's point of view, access to the DNS is through a 
      resolver. On Windows and Unix hosts, the resolver is accessed primarily 
      through two library functions, <CODE>gethostbyname()</CODE> and 
      <CODE>gethostbyaddr()</CODE>, which are linked with the application when 
      the application is built. The first takes a hostname and returns an IP 
      address, and the second takes an IP address and looks up a hostname. The 
      resolver contacts one or more name servers to do the mapping.</P>
      <P>Note that DNS is an application layer protocol which is implemented 
      over the UDP transport protocol.</P>
      <H3>4.8 HTTP</H3>
      <P>Simply put, HTTP is the protocol behind the World Wide Web. With every 
      web transaction, HTTP is invoked.</P>
      <H4>HTTP headers</H4>
      <P>There are four types of header for HTTP:</P>
      <UL>
        <LI><STRONG>General headers</STRONG> indicate general information such 
        as the date, or whether the connection should be maintained. They are 
        used by both clients and servers. 
        <LI><STRONG>Request headers</STRONG> are used only for client requests. 
        They convey the client's configuration and desired document format to 
        the server. 
        <LI><STRONG>Response headers</STRONG> are used only in server responses. 
        They describe the server's configuration and information about the 
        requested URL. 
        <LI><STRONG>Entity headers</STRONG> describe the document format of the 
        data being sent between a client and a server. </LI></UL>
      <P>Although Entity headers are most commonly used by the server when 
      returning a requested document, they are also used by clients when using 
      the POST or PUT methods.</P>
      <H4>Client requests</H4>
      <UL>
        <LI><STRONG>GET</STRONG> is used to retrieve a resource on the server. 
        <LI><STRONG>HEAD</STRONG> is used to retrieve some information about the 
        document, but don't need the document itself. 
        <LI><STRONG>POST</STRONG> says that you are providing some information 
        of your own (i.e., in forms). This may change the state of the server in 
        some way, such as creating a record in a database. 
        <LI><STRONG>PUT</STRONG> is used to replace or create a new document on 
        the server. 
        <LI><STRONG>DELETE</STRONG> is used to remove a document on the server. 
        <LI><STRONG>TRACE</STRONG> is used for protocol debugging purposes. 
        <LI><STRONG>OPTIONS</STRONG> is used when the client looks for other 
        methods which can be used on the document. 
        <LI><STRONG>CONNECT</STRONG> is used when a client needs to talk to an 
        HTTPS server through a proxy server. </LI></UL>
      <P>Other HTTP methods that you may see (LINK, UNLINK, and PATCH) are less 
      clearly defined.</P>
      <P>For the reader of this article, only an understanding of the GET method 
      is needed. This is the main method used for document retrieval. The 
      response to a GET request can be generated by the server in many ways.</P>
      <P>After the client uses the GET method in its request, the server 
      responds with a status line, headers, and data requested by the client. If 
      the server cannot process the request, due to an error or lack of 
      authorization, the server usually sends an explanation in the entity-body 
      of the response.</P>
      <P>For example:</P>
      <H4>A client request</H4><PRE lang=text>GET / HTTP/1.1\r\n
Accept: */*\r\n
Referer: http://www.google.com\r\n
Accept-Language: en-us\r\n
UA-CPU: x86\r\n
Accept-Encoding: gzip, deflate\r\n
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; 
                         .NET CLR 1.1.4322)\r\n
Host: www.google.com\r\n
Connection: Keep-Alive\r\n
Cache-Control: no-cache\r\n
Cookie: PREF=ID=76325601198c7def:LD=en:CR=2:TM=1184565890:
              LM=1186242386:S=ofiC-IBOMCVySJCP\r\n
\r\n</PRE>
      <H4>The server response</H4><PRE lang=text>HTTP/1.0 200 OK\r\n
Cache-Control: private\r\n
Content-Type: text/html; charset=UTF-8\r\n
Content-Encoding: gzip\r\n
Server: GWS/2.1\r\n
Content-Length: 2976\r\n
Date: Sat, 04 Aug 2007 15:46:45 GMT\r\n
X-Cache: MISS from netcache-1\r\n
Connection: keep-alive\r\n
\r\n</PRE>
      <H3>4.9 Performing pattern search by using the Boyer-Moore algorithm</H3>
      <P>The Boyer-Moore approach is very interesting. It doesn't need to 
      actually check every character of the string to be searched, but rather 
      skips over some of them. Let's say we want to find a word "ROTTEN" in a 
      string like <EM>HTTP://WWW.WEBSERVER.COM/ROTTEN HTTP/1.1</EM>. Using the 
      Boyer-Moore algorithm, we have the following steps:</P><PRE lang=text>HTTP:<STRONG>/</STRONG>/WWW.<STRONG>W</STRONG>EBSER<STRONG>V</STRONG>ER.CO<STRONG>M</STRONG>/ROTT<STRONG>E</STRONG>N HTTP/1.1

ROTTEN</PRE>
      <UL>
        <LI>First, we fetch "/" because it stands in the same position as the 
        last character of the pattern. 
        <LI>There is no "/" in the pattern. So the search fails. 
        <LI>Move the pattern right along 6 characters. So 'N' stands under 'W'. 
        Match fails because there's no 'W' either. 
        <LI>Move the pattern right along 6 characters. So 'N' stands under 'V'. 
        Match fails because there's no 'V' either. Also, for 'M', a similar 
        state will happen. 
        <LI>Move the pattern right along 6 characters. So 'N' stands under 'E'. 
        A match is found. There is an 'E' in the pattern. So, move the pattern 
        right along a single place so both 'E's line up. And, compare right to 
        left until the exact match is found. </LI></UL>
      <P>This is exactly what we want. I had a comparison between Boyer-Moore 
      and other case insensitive pattern matching methods. The results were much 
      more efficient when I used Boyer-Moore. For more information about the 
      Boyer-Moore pattern matching algorithm, please Google the topic.</P>
      <H2>5. An HTTP request life-time</H2>
      <P>In this section, we going to describe what happens until a page is 
      downloaded from the Internet. Say, you open up your favorite Web browser, 
      and type <EM>http://www.google.com</EM> in your address bar. Again, 
      remember our network model.</P>
      <P>Please run Ethereal, select your outgoing interface, and start 
      capturing. You can check for all the information below, in Ethereal.</P>
      <OL>
        <LI>The browser tries to resolve the address to its corresponding IP 
        address. To do this, it makes a single function call to 
        <CODE>gethostbyname()</CODE>. This function generates a DNS query. A DNS 
        query, as described in section 4.7, is a UDP datagram which is destined 
        to the DNS server which is set in the TCP/IP properties. The TCP/IP 
        handler takes a look at the destination IP address and realizes that the 
        client IP address and the server IP address are in different subnets, so 
        decides to forward the packet to the next hop, which is our gateway. To 
        do this, the driver looks for the gateway's MAC address in the local ARP 
        table. If, by any reason, the gateway's MAC address is not among the 
        resolved address, TCP/IP broadcasts an ARP request in the subnet to get 
        the corresponding MAC address. Upon receiving the gateway's MAC address, 
        the client makes the final packet and puts it on the wire. Then, the 
        packet is received by the gateway. The gateway looks at the destination 
        IP address and realizes that this packet doesn't belong to itself, so 
        decides to forward this to the next hop. From now, the packet traverses 
        a global route until it successfully gets to the destination. The 
        destination protocol handler then hands away the packet to the proper 
        application layer service, which is the DNS in this case. Finally, the 
        DNS server fetches the related IP address and makes a DNS response 
        destined to the sender. 
        <LI>Destination IP address in hand, our client protocol stack can now 
        establish a TCP session with the peer. 
        <P>The "three-way handshake" is the procedure used to establish a 
        connection. This procedure, normally, is initiated by one TCP and 
        responded to by another TCP.</P>
        <P>The figure below shows the exact process in our example:</P><PRE lang=text>      You                                                         web server

1.  CLOSED                                                       LISTEN

2.  SYN-SENT    --&gt; &lt;SEQ=ISN1&gt;&lt;CTL=SYN&gt;&lt;ACK=0&gt;               --&gt; SYN-RECEIVED

3.  ESTABLISHED &lt;-- &lt;SEQ=ISN2&gt;&lt;ACK=ISN1+1&gt;&lt;CTL=SYN,ACK&gt;      &lt;-- SYN-RECEIVED

4.  ESTABLISHED --&gt; &lt;SEQ=ISN1+1&gt;&lt;ACK=ISN2+1&gt;&lt;CTL=ACK&gt;        --&gt; ESTABLISHED

5.  ESTABLISHED --&gt; &lt;SEQ=ISN1+1&gt;&lt;ACK=ISN2+1&gt;&lt;CTL=ACK&gt;&lt;DATA&gt;  --&gt; ESTABLISHED</PRE>
        <P>In line 2 of the figure, you begin by sending a <CODE>SYN</CODE> 
        segment indicating that you will use sequence numbers starting with the 
        sequence number <CODE>ISN1</CODE>. In line 3, the server sends a 
        <CODE>SYN</CODE> and acknowledges the <CODE>SYN</CODE> it received from 
        you. Note that the acknowledgment field indicates that the server is now 
        expecting to hear the sequence <CODE>ISN1</CODE>+1, acknowledging the 
        SYN which occupied the sequence <CODE>ISN1</CODE>. At line 4, you 
        respond with an empty segment containing an <CODE>ACK</CODE> for the 
        server's <CODE>SYN</CODE>.</P>
        <LI>The application layer transactions begins. 
        <P>In line 5, you send some data. Note that the sequence number of the 
        segment in line 5 is the same as in line 4 because the <CODE>ACK</CODE> 
        does not occupy the sequence number space. As a result, <CODE><SPAN 
        class=code-keyword>&lt;</SPAN>DATA<SPAN 
        class=code-keyword>&gt;</SPAN></CODE> contains the following 
        statements:</P><PRE lang=text>GET / HTTP/1.1\r\n
Accept: */*\r\n
Referer: http://www.google.com\r\n
Accept-Language: en-us\r\n
UA-CPU: x86\r\n
Accept-Encoding: gzip, deflate\r\n
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; 
                         .NET CLR 1.1.4322)\r\n
Host: www.google.com\r\n
Connection: Keep-Alive\r\n
Cache-Control: no-cache\r\n
Cookie: PREF=ID=76325601198c7def:LD=en:CR=2:
          TM=1184565890:LM=1186242386:S=ofiC-IBOMCVySJCP\r\n
\r\n</PRE>
        <LI>The server receives the client's request and responds back with some 
        data. 
        <LI>Finishing data transfer. To do this, TCP provides you with two 
        choices: TCP reset and TCP graceful termination. 
        <P>TCP resets are usually sent when something goes wrong ether for the 
        client or the server. To see a real TCP reset, simply type 
        <EM>http://www.codeproject.com</EM> in your address bar and press the 
        Esc button after a few moments. A TCP reset packet is a 40 byte datagram 
        with the TCP flags set to 0x0004 (RST). On the other hand, we have a 
        graceful connection termination which is a 4-way sequence.</P><PRE lang=text>         You                                               web server

  1.  ESTABLISHED                                          ESTABLISHED

  2.  (Close)
      FIN-WAIT-1  --&gt; &lt;SEQ=ISN1&gt;&lt;ACK=ISN2&gt;&lt;CTL=FIN,ACK&gt;    --&gt; CLOSE-WAIT

  3.  FIN-WAIT-2  &lt;-- &lt;SEQ=ISN2&gt;&lt;ACK=ISN1+1&gt;&lt;CTL=ACK&gt;      &lt;-- CLOSE-WAIT

  4.                                                       (Close)
      TIME-WAIT   &lt;-- &lt;SEQ=ISN2&gt;&lt;ACK=ISN1+1&gt;&lt;CTL=FIN,ACK&gt;  &lt;-- LAST-ACK

  5.  TIME-WAIT   --&gt; &lt;SEQ=ISN1+1&gt;&lt;ACK=ISN2+1&gt;&lt;CTL=ACK&gt;    --&gt; CLOSED

  6.  (2 MSL)
      CLOSED</PRE>
        <P>Note that the TCP connection terminations do not have to use four 
        segments. In some cases, segments 2 and 3 are combined. The result is a 
        <CODE>FIN</CODE>-<CODE>ACK</CODE>/<CODE>FIN</CODE>-<CODE>ACK</CODE>/<CODE>ACK</CODE> 
        sequence.</P></LI></OL>
      <H2>6. Our solution for implementing a web filter</H2>
      <P>The solution is fairly simple. The following sequence is used to filter 
      a matched web request:</P>
      <OL>
        <LI>Capture packets. 
        <LI>Distinguish TCP packets which are destined to port 80 or 8080. 
        <LI>Look for a 'GET /' in the first four bytes of the data. If not 
        found, continue with the next captured packet. 
        <LI>Perform a Boyer-Moore pattern match over the data against the 
        blacklist keywords. If not found, continue with the next captured 
        packet. 
        <LI>Send a TCP reset to the server and a block page to the client. 
      </LI></OL>
      <H2>7. Implementation</H2>
      <P>This section explains the core functionality of our HTTP filter in 
      details. All functionalities are available in the source code in the 
      <CODE>CProcessPacket</CODE> class.</P>
      <H3>7.1 Capturing packets with a raw socket</H3>
      <P>The fastest way to capture incoming traffic without using a NDIS low 
      level driver is to use a Winsock raw socket. Although, you should note 
      that a raw socket cannot capture in promiscuous mode. This means that the 
      socket captures only traffic that is destined to its own address.</P><PRE><SPAN class=code-keyword>if</SPAN>((m_sniffSocket = socket(AF_INET, SOCK_RAW, IPPROTO_IP))==SOCKET_ERROR)
{        
    <SPAN class=code-keyword>return</SPAN> <SPAN class=code-digit>0</SPAN>;
}
PIP_ADAPTER_INFO pAdapterInfo = m_AdapterInfo; <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Adapter information</SPAN>

u_long <SPAN class=code-keyword>in</SPAN> = <SPAN class=code-digit>0</SPAN>;
<SPAN class=code-keyword>do</SPAN> {
    <SPAN class=code-keyword>if</SPAN> (strcmp (in_szSourceDevice, pAdapterInfo-<SPAN class=code-keyword>&gt;</SPAN>AdapterName ) == <SPAN class=code-digit>0</SPAN>)
    {
        <SPAN class=code-keyword>break</SPAN>; <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> we found selected adapter</SPAN>

    }
    in++;
    pAdapterInfo = pAdapterInfo-<SPAN class=code-keyword>&gt;</SPAN>Next;    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Progress through</SPAN>
}
<SPAN class=code-keyword>while</SPAN>(pAdapterInfo);  
        

<SPAN class=code-keyword>struct</SPAN> sockaddr_in src;
memset(&amp;src, <SPAN class=code-digit>0</SPAN>, <SPAN class=code-keyword>sizeof</SPAN>(src));
src.sin_addr.S_un.S_addr = 
   inet_addr (pAdapterInfo-<SPAN class=code-keyword>&gt;</SPAN>IpAddressList.IpAddress.<SPAN class=code-SDKkeyword>String</SPAN>);        
src.sin_family      = AF_INET;
src.sin_port        = <SPAN class=code-digit>0</SPAN>;
<SPAN class=code-keyword>if</SPAN> (bind(m_sniffSocket,(<SPAN class=code-keyword>struct</SPAN> sockaddr *)&amp;src,<SPAN class=code-keyword>sizeof</SPAN>(src)) == SOCKET_ERROR)
{            
    <SPAN class=code-keyword>return</SPAN> <SPAN class=code-digit>0</SPAN>;
}

<SPAN class=code-keyword>int</SPAN> j=1;
<SPAN class=code-keyword>if</SPAN> (WSAIoctl(m_sniffSocket, SIO_RCVALL, &amp;j, 
             <SPAN class=code-keyword>sizeof</SPAN>(j), <SPAN class=code-digit>0</SPAN>, <SPAN class=code-digit>0</SPAN>, &amp;in,<SPAN class=code-digit>0</SPAN>, <SPAN class=code-digit>0</SPAN>) == SOCKET_ERROR)
{            
    <SPAN class=code-keyword>return</SPAN> <SPAN class=code-digit>0</SPAN>;
}</PRE>
      <P>And, then, in a separate thread, we process the captured packets:</P><PRE>    <SPAN class=code-keyword>int</SPAN>  res = <SPAN class=code-digit>0</SPAN>;
    <SPAN class=code-keyword>char</SPAN> *pkt_data = (<SPAN class=code-keyword>char</SPAN> *)malloc(<SPAN class=code-digit>65536</SPAN>); 
    <SPAN class=code-keyword>char</SPAN>                    m_pLogString[<SPAN class=code-digit>256</SPAN>];        
    Packet                    p;
    
    <SPAN class=code-keyword>if</SPAN> (pkt_data == NULL)
    {        
        <SPAN class=code-keyword>return</SPAN> <SPAN class=code-digit>0</SPAN>;
    }

    SetEvent(_this-<SPAN class=code-keyword>&gt;</SPAN>m_hThrdReadyEvent);
    
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> Capture packet</SPAN>

    <SPAN class=code-keyword>do</SPAN>
    {
        res = recvfrom(_this-<SPAN class=code-keyword>&gt;</SPAN>m_sniffSocket,pkt_data,<SPAN class=code-digit>65536</SPAN>,<SPAN class=code-digit>0</SPAN>,<SPAN class=code-digit>0</SPAN>,<SPAN class=code-digit>0</SPAN>); 
        <SPAN class=code-keyword>if</SPAN>(res <SPAN class=code-keyword>&gt;</SPAN> <SPAN class=code-digit>0</SPAN>)    
        {            
            ZeroMemory(&amp;p, <SPAN class=code-keyword>sizeof</SPAN> (Packet));
            
            DecodeIP((u_int8_t*)pkt_data, res, &amp;p);

            <SPAN class=code-keyword>if</SPAN> (p.banned == <SPAN class=code-digit>1</SPAN>)
            {
                FilterHttpRequest(&amp;p);

                <SPAN class=code-keyword>char</SPAN> ip_string_src[<SPAN class=code-digit>17</SPAN>];
                <SPAN class=code-keyword>char</SPAN> ip_string_dst[<SPAN class=code-digit>17</SPAN>];

                memcpy (ip_string_src, inet_ntoa(p.iph-<SPAN class=code-keyword>&gt;</SPAN>ip_src), <SPAN class=code-digit>17</SPAN>);
                memcpy (ip_string_dst, inet_ntoa(p.iph-<SPAN class=code-keyword>&gt;</SPAN>ip_dst), <SPAN class=code-digit>17</SPAN>);

                sprintf (m_pLogString,
                         <SPAN class=code-string>"</SPAN><SPAN class=code-string>Keyword \'%s\' is detected in a request"</SPAN> 
                         <SPAN class=code-string>"</SPAN><SPAN class=code-string> from %s to %s. Session Droped!"</SPAN>, 
                         p.matched, ip_string_src, ip_string_dst);

                m_pFilterLog-<SPAN class=code-keyword>&gt;</SPAN>AddLog(m_pLogString);
                
            }

        }
    } 
    <SPAN class=code-keyword>while</SPAN> (res <SPAN class=code-keyword>&gt;</SPAN> <SPAN class=code-digit>0</SPAN>);</PRE>
      <H3>7.2 Distinguishing HTTP packets</H3>
      <P>In this section, we process the portions of the captured packet to find 
      the Ethernet, IP, and TCP header fields. To perform this, we need a couple 
      of handy structs to lay data over them.</P><PRE><SPAN class=code-keyword>struct</SPAN> IPHdr
{
    u_int8_t ip_verhl;      <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> version &amp; header length */</SPAN>
    u_int8_t ip_tos;        <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> type of service */</SPAN>
    u_int16_t ip_len;       <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> datagram length */</SPAN>
    u_int16_t ip_id;        <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> identification  */</SPAN>
    u_int16_t ip_off;       <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> fragment offset */</SPAN>
    u_int8_t ip_ttl;        <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> time to live field */</SPAN>
    u_int8_t ip_proto;      <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> datagram protocol */</SPAN>
    u_int16_t ip_csum;      <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> checksum */</SPAN>
    <SPAN class=code-keyword>struct</SPAN> in_addr ip_src;  <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> source IP */</SPAN>
    <SPAN class=code-keyword>struct</SPAN> in_addr ip_dst;  <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> dest IP */</SPAN>
};

<SPAN class=code-keyword>struct</SPAN> TCPHdr
{
    u_int16_t th_sport;     <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> source port */</SPAN>
    u_int16_t th_dport;     <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> destination port */</SPAN>
    u_int32_t th_seq;       <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> sequence number */</SPAN>
    u_int32_t th_ack;       <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> acknowledgement number */</SPAN>
    u_int8_t th_offx2;     <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> offset and reserved */</SPAN>
    u_int8_t th_flags;
<SPAN class=code-preprocessor>#define</SPAN>    TH_FIN    0x01
<SPAN class=code-preprocessor>#define</SPAN>    TH_SYN    0x02
<SPAN class=code-preprocessor>#define</SPAN>    TH_RST    0x04
<SPAN class=code-preprocessor>#define</SPAN>    TH_PSH    0x08
<SPAN class=code-preprocessor>#define</SPAN>    TH_ACK    0x10
<SPAN class=code-preprocessor>#define</SPAN>    TH_URG    0x20
    u_int16_t th_win;       <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> window */</SPAN>
    u_int16_t th_sum;       <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> checksum */</SPAN>
    u_int16_t th_urp;       <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> urgent pointer */</SPAN>
};

<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> our helper struct to hold packet information in one place</SPAN>

<SPAN class=code-keyword>struct</SPAN> Packet
{
    
    u_int8_t            *pkt;    <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> base pointer to the raw packet data */</SPAN>
    
    
    IPHdr                *iph;   <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> and orig. headers for ICMP_*_UNREACH family */</SPAN>
    u_int32_t            ip_options_len;
    u_int8_t            *ip_options_data;


    TCPHdr                *tcph;
    u_int32_t            tcp_options_len;
    u_int8_t            *tcp_options_data;


    u_int8_t            *data;            <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> packet payload pointer */</SPAN>
    u_int16_t            dsize;           <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> packet payload size */</SPAN>

    
    
    u_int8_t            http_state;       <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> HTTP request / HTTP response */</SPAN>
    u_int8_t            banned;           <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Indicate if the request should be sensored */</SPAN>
    <SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-keyword>char</SPAN>        matched[<SPAN class=code-digit>128</SPAN>];    <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Keyword that this request 
                                             matched to - maximum 128 byte*/</SPAN>
    
<SPAN class=code-preprocessor>#define</SPAN>    CLIENT_REQUEST    0x01
<SPAN class=code-preprocessor>#define</SPAN>    SERVER_RESPONSE    0x02
<SPAN class=code-preprocessor>#define</SPAN>    NOT_HTTP        0x04

    
    u_int8_t frag_flag;     <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> flag to indicate a fragmented packet */</SPAN>
    u_int16_t frag_offset;  <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> fragment offset number */</SPAN>
    u_int8_t mf;            <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> more fragments flag */</SPAN>
    u_int8_t df;            <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> don't fragment flag */</SPAN>
    u_int8_t rf;            <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> IP reserved bit */</SPAN>
};</PRE>
      <P>Now, we can retrieve all the header information stored in the captured 
      packet. To perform this step, you should know the related protocol 
      specifications which we explained in section 4.</P><PRE>Packet p;
    
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> lay the IP struct over the raw data */</SPAN>
p-<SPAN class=code-keyword>&gt;</SPAN>iph = (IPHdr *) (pkt_data); 
    
<SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> Decode only TCP headers */</SPAN>
<SPAN class=code-keyword>if</SPAN> (p-<SPAN class=code-keyword>&gt;</SPAN>iph-<SPAN class=code-keyword>&gt;</SPAN>ip_proto == <SPAN class=code-digit>6</SPAN>)
{
    <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> lay TCP on top of the data cause there is enough of it! */</SPAN>
    p-<SPAN class=code-keyword>&gt;</SPAN>tcph = (TCPHdr *) (pkt_data + IP_HEADER_LEN);
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> set pinter at the beginning of TCP header </SPAN>

    <SPAN class=code-keyword>if</SPAN> (p-<SPAN class=code-keyword>&gt;</SPAN>tcph-<SPAN class=code-keyword>&gt;</SPAN>th_flags &amp; TH_ACK <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> If is request */</SPAN>
        &amp;&amp; p-<SPAN class=code-keyword>&gt;</SPAN>tcph-<SPAN class=code-keyword>&gt;</SPAN>th_flags &amp; TH_PSH)
         {
             <SPAN class=code-keyword>if</SPAN>(p-<SPAN class=code-keyword>&gt;</SPAN>tcph-<SPAN class=code-keyword>&gt;</SPAN>th_dport != htons(<SPAN class=code-digit>80</SPAN>) &amp;&amp;
                <SPAN class=code-comment>/*</SPAN><SPAN class=code-comment> If target service is not HTTP */</SPAN>
                p-<SPAN class=code-keyword>&gt;</SPAN>tcph-<SPAN class=code-keyword>&gt;</SPAN>th_dport != htons(<SPAN class=code-digit>8080</SPAN>) )
             <SPAN class=code-keyword>return</SPAN> ;
             <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> continue in 7-3 }</SPAN>

         }
}</PRE>
      <H3>7.3 Looking for 'GET /' in the first 4 bytes</H3><PRE>p-<SPAN class=code-keyword>&gt;</SPAN>data = (<SPAN class=code-keyword>unsigned</SPAN> <SPAN class=code-SDKkeyword>byte</SPAN>*)(pkt_data + ETHERNET_HEADER_LEN + 
           IP_HEADER_LEN + TCP_HEADER_LEN)
<SPAN class=code-comment>//</SPAN><SPAN class=code-comment> find payload position</SPAN>


<SPAN class=code-keyword>if</SPAN>( p-<SPAN class=code-keyword>&gt;</SPAN>data[<SPAN class=code-digit>0</SPAN>] == <SPAN class=code-string>'</SPAN><SPAN class=code-string>G'</SPAN> &amp;&amp;
        p-<SPAN class=code-keyword>&gt;</SPAN>data[<SPAN class=code-digit>1</SPAN>] == <SPAN class=code-string>'</SPAN><SPAN class=code-string>E'</SPAN> &amp;&amp;
        p-<SPAN class=code-keyword>&gt;</SPAN>data[<SPAN class=code-digit>2</SPAN>] == <SPAN class=code-string>'</SPAN><SPAN class=code-string>T'</SPAN> &amp;&amp;
        p-<SPAN class=code-keyword>&gt;</SPAN>data[<SPAN class=code-digit>3</SPAN>] == <SPAN class=code-string>'</SPAN><SPAN class=code-string> '</SPAN> &amp;&amp;
        p-<SPAN class=code-keyword>&gt;</SPAN>data[<SPAN class=code-digit>4</SPAN>] == <SPAN class=code-string>'</SPAN><SPAN class=code-string>/'</SPAN> 
        )
{
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> continue in 7-4</SPAN>

}</PRE>
      <H3>7.4 Performing a Boyer-Moore pattern matching algorithm on the 
      payload</H3>
      <P>As I explained earlier, the Boyer-Moore is fast pattern matching 
      algorithm which follows a non-liner approach to find a match.</P><PRE><SPAN class=code-keyword>if</SPAN> (CheckPattern(p-<SPAN class=code-keyword>&gt;</SPAN>data, len))
{
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> A match found, session must be filtered!</SPAN>
    <SPAN class=code-comment>//</SPAN><SPAN class=code-comment> continue in 7-5</SPAN>
}</PRE>
      <H3>7.5 Finishing the data transaction by sending a bunch of packets to 
      both directions</H3>
      <P>Perhaps, this section is the most tricky part of the article. Here, I 
      again remind that our HTTP filter works in Sniffer mode. As a result, we 
      should do our best to prevent our reliable TCP engines on both sides liven 
      up the session by resynchronizing.</P>
      <OL>
        <LI>Let's say we grasp a target HTTP GET packet with the following TCP 
        information: <PRE lang=text>SEQ = ISN1 ACK = ISN2 
Direction = To Server</PRE>
        <LI>Again, due to the fact that we are operating in a monitor mode, we 
        should get rid of server resynchronization attempts. For this purpose, I 
        sent a TCP reset to the server to stop the TCP state machine for a 
        while. <PRE lang=text>SEQ = ISN1 ACK = ISN2
FLAGS = RST 
Direction = To Server.</PRE>
        <LI>Sending a block page to the client: <PRE lang=text>SEQ = ISN2 ACK = ISN1 + Len(GET)
FLAGS = FIN | ACK
Direction = To Client.</PRE>
        <P>Note that the implemented routine is available in 
        <CODE>CProcessPacket::SensorHttpRequest</CODE>.</P></LI></OL>
      <H2>8. Special consideration</H2>
      <P>While it's a choice for the SOHO environment, our HTTP filter is a less 
      common type of filtering solution for enterprise networks. This comes from 
      the fact that the sniffing mode doesn't guarantee a synchronized reaction 
      against TCP sessions because it doesn't stand against packet flows. 
      Compare it with a football stadium before and after a game. Before the 
      game, guards can inspect fans one by one and check their tickets. After 
      the game, fans just rush outdoors, and it is fairly easy for an insurgent 
      to get out of sight. At least, in my city, it's this way! ;)</P>
      <P>It's a matter of one-by-one inspection! Along with its reliability, a 
      one-by-one inspection has a big flaw: "a slow inspector could slow down 
      the whole movement".</P>
      <H2>9. Future work</H2>
      <UL>
        <LI>Make the concept more reliable by performing asynchronous analysis 
        in background threads 
        <LI>Replace the core capturing functionalities with a network driver 
        hook available in both Windows and Unix platforms 
        <LI>Replacing the Boyer-Moore with a multi-pattern search so that dozens 
        of patterns are evaluated in a single search 
        <LI>Look for your ideas or requests </LI></UL>
      <H2>10. Revision history</H2>
      <UL>
        <LI>Initial release - 2007-08-06 
        <LI>Code comments improved - 2007-08-07 
        <LI>Total review; Excluding Winpcap and Libnet from the project; 
        Performing both capture and send raw packets by using the raw socket 
        functionality available in WinSock - 2007-08-26 </LI></UL>
      <H2>11. My test environments</H2>
      <UL>
        <LI>Ethernet LAN 
        <LI>WLAN 802.11/bg standard sub-network </LI></UL>
      <P>Anyway, if you experience any malfunction, please report it. Thanks in 
      advance! </P>
      <H2>12. References</H2>
      <OL>
        <LI>TCP/IP Illustrated, Volume 1 The Protocols W. Richard Stevens 
        <LI>RFC 793, RFC 791, RFC 768, RFC 826, RFC 1034, RFC 1035. Refer to <A 
        href="http://www.ietf.org/rfc.html" target=_blank>IETF</A> 
        <LI><A 
        title="Network programming forum - Network security programming forum" 
        href="http://www.packetforum.com/" target=_blank>Network programming and 
        network security programming forum</A> 
        <LI><A href="http://www.ethereal.com/" target=_blank>Ethereal</A> 
        <LI><A href="http://www.winpcap.org/" target=_blank>Winpcap</A> 
        <LI>Windows server 2003 TCP/IP and services. Technical reference by 
        Josef Davies and Thomas Lee. 
        <LI>HTTP pocket reference by Clinton Wong, O'Reilly May 2000. </LI></OL><!-- Article Ends --><!-- Main Page Contents End --></DIV></SPAN>
      <FORM id=aspnetForm 
      style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
      name=aspnetForm action=HTTPFilter.aspx method=post>
      <DIV><INPUT id=__VIEWSTATE type=hidden 
      value=/wEPDwULLTEwMDUyNjYzMjhkZNj0la+ie+Bza/lEZWEFrb3111OZ 
      name=__VIEWSTATE> </DIV>
      <H2>License</H2>
      <DIV id=ctl00_LicenseTerms>
      <P>This article, along with any associated source code and files, is 
      licensed under <A href="http://www.codeproject.com/info/cpol10.aspx">The 
      Code Project Open License (CPOL)</A></P></DIV>
      <H2>About the Author</H2>
      <TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhotoTable 
          style="WIDTH: 155px" vAlign=top><B><A 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></B><BR><BR>
            <CENTER></CENTER><BR><SPAN class=SmallText 
            id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberType></SPAN></TD>
          <TD>Reza Shadmani.<BR>I enjoy whatever which could be called 
            "engine"!<BR><BR>
            <TABLE>
              <TBODY>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_jobTitleRow>
                <TD class=SmallText noWrap>Occupation: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle>Software 
                  Developer (Senior)</SPAN></TD></TR>
              <TR id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_locationRow>
                <TD class=SmallText>Location: </TD>
                <TD width="100%"><SPAN class=SmallText 
                  id=ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation><IMG 
                  height=11 alt=Canada 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/CA.gif" 
                  width=16> 
      Canada</SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <TABLE id=ctl00_PopularArticlesRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR vAlign=top>
          <TD style="WIDTH: 100%">
            <H2>Other popular Internet / Network articles:</H2>
            <UL>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/AsyncSocketServerandClien.aspx">An 
              Asynchronous Socket Server and Client</A>
              <DIV class=SmallText>An asynchronous socket server and client with 
              encryption and compression.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/MyDownloader.aspx">MyDownloader: 
              A Multi-thread C# Segmented Download Manager</A>
              <DIV class=SmallText>Sample application that manages multiple 
              segmented downloads and supports HTTP, FTP and YouTube video 
              downloads</DIV>
              <LI><A href="http://www.codeproject.com/KB/IP/ndk.aspx">Network 
              Development Kit 2.0</A>
              <DIV class=SmallText>Network Development Kit is a set of simple 
              classes for a client-server architecture.</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/drvfltip.aspx">Developing 
              Firewalls for Windows 2000/XP</A>
              <DIV class=SmallText>An article about developing Firewalls for 
              Windows 2000/XP</DIV>
              <LI><A 
              href="http://www.codeproject.com/KB/IP/iocp_server_client.aspx">A 
              simple IOCP Server/Client Class</A>
              <DIV class=SmallText>This source code uses the advanced IOCP 
              technology which can efficiently serve multiple clients. It also 
              presents some solutions to practical problems that arise with the 
              IOCP programming API, and provides a simple echo client/server 
              with file transfer.</DIV></LI></UL>
            <H2></H2></TD>
          <TD><IFRAME 
            src="C:\Documents and Settings\Administrator\Desktop\asqw\CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files\ServeHTML(1).htm" 
            frameBorder=0 width=300 scrolling=no 
        height=250></IFRAME></TD></TR></TBODY></TABLE>
      <DIV id=ctl00_AddTo_AddTo style="MARGIN: 10px">
      <SCRIPT language=JavaScript type=text/javascript>
var socialLinks = new social();
socialLinks.addtoMethod=1;
socialLinks.DrawLinks("socialLinks", document.location.href, escape(document.title), 100, 0, "SmallText Bold", "AddTo");
</SCRIPT>
      </DIV>
      <TABLE class=RatingBar id=ctl00_RateArticleRow cellSpacing=0 cellPadding=0 
      width="100%" border=0>
        <TBODY>
        <TR>
          <TD><A 
            href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx#_top">Article 
            Top</A></TD>
          <TD align=right>
            <TABLE cellSpacing=0 cellPadding=0 width="100%">
              <TBODY>
              <TR>
                <TD id=ctl00_RateArticle_VoteResultDiv noWrap align=right 
                width="100%"><SPAN id=voteRes></SPAN><IMG id=loaderImg 
                  style="DISPLAY: none" height=16 alt=loading... 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/ajax-loader.gif" 
                  width=16> </TD>
                <TD class=SmallText id=voteTbl style="WHITE-SPACE: nowrap" 
                align=right>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD id=ctl00_RateArticle_RateText 
                      style="PADDING-RIGHT: 5px; WHITE-SPACE: nowrap"><I><B>Rate 
                        this Article for us!</B></I></TD>
                      <TD id=ctl00_RateArticle_StartForm 
                        align=right><I>&nbsp;&nbsp;Poor</I></TD>
                      <TD id=ctl00_RateArticle_VoteFormDiv 
                      style="WHITE-SPACE: nowrap" align=left>
                        <TABLE id=ctl00_RateArticle_VoteRBL border=0>
                          <TBODY>
                          <TR>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_0 
                              type=radio value=1 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_1 
                              type=radio value=2 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_2 
                              type=radio value=3 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_3 
                              type=radio value=4 
                            name=ctl00$RateArticle$VoteRBL></TD>
                            <TD><INPUT id=ctl00_RateArticle_VoteRBL_4 
                              type=radio value=5 
                            name=ctl00$RateArticle$VoteRBL></TD></TR></TBODY></TABLE></TD>
                      <TD id=ctl00_RateArticle_EndForm noWrap 
                        align=left><I>Excellent</I> <INPUT class=FormButton id=ctl00_RateArticle_SubmitRateBtn onclick="return rateItem(19886,2);" type=submit value=Vote name=ctl00$RateArticle$SubmitRateBtn> 
                      </TD>
                      <TD><SPAN 
                    id=ctl00_RateArticle_ErrorMessage></SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <DIV><INPUT id=__EVENTVALIDATION type=hidden 
      value=/wEWCALY2o+PDgLAlMXDBwLBlMXDBwLClMXDBwLDlMXDBwLElMXDBwLP+++tCwK5upDkC6Z3o2QRb1kBp3l+v+Cv7Y+U/8qA 
      name=__EVENTVALIDATION> </DIV></FORM>
      <DIV 
      style="PADDING-RIGHT: 10px; PADDING-LEFT: 10px; PADDING-BOTTOM: 10px; OVERFLOW: hidden; PADDING-TOP: 10px; WHITE-SPACE: nowrap; TEXT-ALIGN: center"><IFRAME 
      src="C:\Documents and Settings\Administrator\Desktop\asqw\CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files\ServeHTML(2).htm" 
      frameBorder=0 width=468 scrolling=no height=58></IFRAME><IFRAME 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/ServeLinks.htm" 
      frameBorder=0 width=300 scrolling=no height=60></IFRAME></DIV><A 
      name=_comments></A><!-- Forum Start -->
      <DIV id=_MessageBoard onclick="return SwitchMessage(event, null)">
      <TABLE class=Frm_MainTable id=ForumTable cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD>
            <FORM 
            style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px" 
            action=/script/Forums/SetOptions.aspx?floc=%2fKB%2fIP%2fHTTPFilter.aspx&amp;fid=445573 
            method=get><INPUT type=hidden value=445573 name=fid><INPUT 
            type=hidden value=?floc=%2fKB%2fIP%2fHTTPFilter.aspx&amp;fid=445573 
            name=currentQS><INPUT type=hidden value=/KB/IP/HTTPFilter.aspx 
            name=floc>
            <TABLE cellSpacing=0 cellPadding=3 width="100%" border=0>
              <TBODY>
              <TR class=Frm_HeaderRow1>
                <TD style="WHITE-SPACE: nowrap"><IMG height=16 alt=FAQ 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/forum_faq.gif" 
                  width=16 align=middle border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/FAQ.aspx"><B>FAQ</B></A>&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Noise 
                  Tolerance<SELECT class=Frm_DropDown size=1 name=noise> 
                    <OPTION value=1>Very High</OPTION><OPTION 
                    value=2>High</OPTION><OPTION value=3 
                    selected>Medium</OPTION><OPTION value=4>Low</OPTION><OPTION 
                    value=5>Very Low</OPTION></SELECT></TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right" 
                  colSpan=2><IMG height=15 alt=Search 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/forum_search.gif" 
                  width=16 align=top border=0>&nbsp;<A 
                  href="http://www.codeproject.com/script/Forums/Search.aspx?fid=445573">Search 
                  Messages</A>&nbsp;</TD>
                <TD style="TEXT-ALIGN: right"><INPUT class=Frm_Button type=submit value="Set Options" name=SetOpt></TD></TR>
              <TR class=Frm_HeaderRow2>
                <TD style="WIDTH: 100%">&nbsp;</TD>
                <TD 
                  style="WHITE-SPACE: nowrap; TEXT-ALIGN: right">Layout<SELECT 
                  class=Frm_DropDown size=1 name=view> <OPTION value=Quick 
                    selected>Normal</OPTION><OPTION value=Topic>Expand Root 
                    Messages</OPTION><OPTION value=Expanded>Expand All 
                    Messages</OPTION><OPTION value=Thread>Thread 
                    View</OPTION><OPTION value=Normal>No Javascript 
                    (slow)</OPTION><OPTION value=Preview>No Javascript 
                    Preview</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD style="WHITE-SPACE: nowrap">Per page<SELECT 
                  class=Frm_DropDown size=1 name=mpp> <OPTION 
                    value=10>10</OPTION><OPTION value=25 
                    selected>25</OPTION><OPTION 
                  value=50>50</OPTION></SELECT>&nbsp;&nbsp;</TD>
                <TD colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></FORM></TD></TR>
        <TR>
          <TD><A name=xx0xx></A>
            <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
              <TBODY>
              <TR class=Frm_NavigationBar>
                <TD><IMG height=16 alt=new 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/forum_newmsg.gif" 
                  width=16 align=top border=0><A class=Frm_HL 
                  title="Create a new message thread" 
                  href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;floc=/KB/IP/HTTPFilter.aspx" 
                  target=_top name=Frm_HoverNL><B>New Message</B></A></TD>
                <TD>Msgs 1 to 25 of 33 (Total in Forum: 33) (<A 
                  href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573">Refresh</A>)</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><SPAN 
                  class=Frm_HL>First</SPAN><SPAN class=Frm_HL>Prev</SPAN><A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next</A></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE class=Frm_MsgTable cellSpacing=0 cellPadding=0 width="100%" 
            border=0><!-- Column Headers -->
              <TBODY>
              <TR class=Frm_ColumnHeaders>
                <TD style="WIDTH: 100%">
                  <TABLE cellSpacing=0 cellPadding=2 width="100%" border=0>
                    <TBODY>
                    <TR>
                      <TD>Subject&nbsp;</TD>
                      <TD class=Frm_MsgAuthor>&nbsp;Author&nbsp;</TD>
                      <TD 
              class=Frm_MsgDate>Date&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2494592_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2494592xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2494592#xx2494592xx" 
                        name=2494592>This cannot be used to bypass proxy 
                        [modified]</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1590948">the 
                        pink jedi</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">1:56 5 
                        Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2494592_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Somehow when using a proxy to 
                                connect to an internet website, this app will 
                                fail even if it tries to detect GET in 
                                HTTP.<BR>Can anyone give me a clue on how to use 
                                ip filter against an internet proxy? <BR><BR>
                                <DIV class=ForumMod>modified on Saturday, April 
                                5, 2008 5:06 AM</DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2494592&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2494592&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2494592">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2494592">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2494592&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2494592 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1590948,2494592,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2494763_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2494763xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2494763#xx2494763xx" 
                        name=2494763>Re: This cannot be used to bypass 
                      proxy</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:45 5 
                        Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2494763_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Definitely you had a true 
                                experience. The fact is that for the first 
                                criteria we check if a desired packet is 
                                destined to port 80 or not. In case of proxies 
                                you always set the fake destination of your 
                                wrapped http requests to port numbers other than 
                                80.<BR>You imagine if a firewall willing to 
                                detect proxied packets it has to inspect 
                                thousands of probable destination ports and this 
                                is deadly impossible. Or if possible it would be 
                                at cost of bandwidth downfall.<BR>You see 
                                nowadays no firewall can inspect tor 
                                proxy.<BR><BR>Anyway if once you wanted to ban 
                                proxied traffic in your local network, you 
                                should define a rule to ban all traffics but 
                                those whom destined to port 80 or 8080 or 443 
                                (https). With my two lines application you 
                                cannot do that since it is a http packet filter 
                                not a firewall.<BR><BR>Sure you can do it using 
                                Linux/ IP filter... <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2494763&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2494763&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2494592">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2494763">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2494763&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2494763 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(47108,2494763,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2495054_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2495054xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2495054#xx2495054xx" 
                        name=2495054>Re: This cannot be used to bypass 
                      proxy</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=1590948">the 
                        pink jedi</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">21:25 5 
                        Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2495054_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>i found the source of the 
                                problem<BR>the proxy i am using provided by my 
                                service provider only has "GET " and not "GET 
                                /"<BR>Changing it solve my problem.<BR>Thanks 
                                for your great code. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2495054&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2495054&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2494592">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2495054">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2495054&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2495054 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(1590948,2495054,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2495303_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx2495303xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2495303#xx2495303xx" 
                        name=2495303>Re: This cannot be used to bypass 
                      proxy</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:16 6 
                        Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2495303_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>you're 
                                welcome<BR><BR><BR>Ruby<BR>www.packetforum.org 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2495303&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2495303&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2494592">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2495303">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2495303&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2495303 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(47108,2495303,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2495305_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx2495305xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2495305#xx2495305xx" 
                        name=2495305>Re: This cannot be used to bypass 
                      proxy</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:20 6 
                        Apr '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2495305_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>You meant you changed it and it 
                                worked or probably I should change the code for 
                                your request? <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2495305&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2495305&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2494592">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2495305">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2495305&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2495305 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(47108,2495305,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2457626_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2457626xx></A><IMG height=16 alt=Question 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2457626#xx2457626xx" 
                        name=2457626>about get http request packet in inside 
                        ethernet card</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4524808">sunliangxu</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:46 8 
                        Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2457626_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hello,i have a problem about this 
                                source code. i run the program at the machine 
                                which has two ethernet card. i bind raw socket 
                                in the inside ethernet card. when other ethernet 
                                machine send a http request packet to the inside 
                                card ,the raw socket can't sniffer the packet 
                                with the above machine's ip. at fact,it 
                                sniffered the packet with the outside ethernet 
                                card or pppoe ip. <BR>please ask the reason for 
                                this . <BR><BR>sunliangxu@sina.com<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2457626&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2457626&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2457626">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2457626">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2457626&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2457626 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4524808,2457626,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2465519_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2465519xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2465519#xx2465519xx" 
                        name=2465519>Re: about get http request packet in inside 
                        ethernet card</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:04 
                        13 Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2465519_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Explain me your exact 
                                topology.<BR>Ingress Network adapter- IP 
                                address<BR>Egress Network adapter- IP 
                                address<BR>HTTP filter listens on which 
                                adapter?<BR><BR>Note that I meant by ingress as 
                                the network adapter which first gets the http 
                                request.<BR>and what is your platform by the 
                                way? (I hope it wouldn't be Windows 
                                XP)<BR><BR>Reza shadmani <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2465519&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2465519&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2457626">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2465519">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2465519&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2465519 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(47108,2465519,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2468477_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2468477xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2468477#xx2468477xx" 
                        name=2468477>Re: about get http request packet in inside 
                        ethernet card</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4524808">sunliangxu</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">6:06 16 
                        Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2468477_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>ingress network 
                                adapter:192.168.1.2<BR>egress network 
                                adaper:pppoe get dynamic ip address<BR>http 
                                filter listen on ingress<BR>but i got the packet 
                                ip address on ingress which is the pppoe's ip 
                                address. i want to get ip address of inside pc 
                                ,not the pppoe's.<BR>i run the program on the 
                                windows 2000. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2468477&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2468477&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2457626">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2468477">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2468477&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2468477 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4524808,2468477,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2472601_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx2472601xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2472601#xx2472601xx" 
                        name=2472601>Re: about get http request packet in inside 
                        ethernet card</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">2:31 19 
                        Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2472601_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Looks strange or I couldn't get 
                                what's the problem.<BR>Start Wireshark on your 
                                ingress adapter and send a get request to 
                                somewhere with your browser.<BR>Send me HTTP Get 
                                captured packet and also a screen shot of 
                                HTTPfilter while working on ingress adapter and 
                                hitting log. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2472601&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2472601&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2457626">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2472601">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2472601&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2472601 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(47108,2472601,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2486396_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=88><A 
                        name=xx2486396xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2486396#xx2486396xx" 
                        name=2486396>Re: about get http request packet in inside 
                        ethernet card</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4524808">sunliangxu</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">17:56 
                        30 Mar '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2486396_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 88px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hello,i have the answer for the 
                                question which is the interenet share 
                                connection(isc) has changed the ip address 
                                before raw socket receives the packets.when i 
                                uses the soft router which windows 2000 server 
                                provides ,i can get the client pc's ip in the 
                                LAN.if you use NAT,the result is the same as 
                                ISC. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2486396&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2486396&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2457626">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2486396">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2486396&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2486396 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4524808,2486396,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2390809_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2390809xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2390809#xx2390809xx" 
                        name=2390809>Windows server 2003 is the only working 
                        environment for this article</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:31 15 
                        Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2390809_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>No comment.<BR>Thanks 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2390809&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2390809&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2390809">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2390809">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2390809&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2390809 
                                style="WHITE-SPACE: nowrap">1.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(47108,2390809,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2379145_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2379145xx></A><IMG height=16 alt=Question 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2379145#xx2379145xx" 
                        name=2379145>Problems on Windows XP SP2</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4713979">mandragorax</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">7:41 5 
                        Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2379145_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi first thanks a lot for the 
                                example it's very useful!<BR>I've a problem 
                                using the code on Windows XP SP2, the error 
                                comes from <BR>the sendto function, do you have 
                                any idea to fix the problem?<BR>Do you know if 
                                the program will work without modification on 
                                windows vista?<BR><BR>Many Many Thanks!!! 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2379145&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2379145&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2379145">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2379145">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2379145&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2379145 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4713979,2379145,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2379189_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2379189xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2379189#xx2379189xx" 
                        name=2379189>Re: Problems on Windows XP SP2</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:06 5 
                        Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2379189_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Dear mandaragorax,<BR>There is a 
                                internall problem with sendto API under XP that 
                                I couldn't figured out. That's why I only 
                                recommended windows 2003.<BR><BR>Cheeers 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2379189&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2379189&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2379145">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2379189">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2379189&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2379189 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(47108,2379189,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2379307_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2379307xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2379307#xx2379307xx" 
                        name=2379307>Re: Problems on Windows XP SP2</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4713979">mandragorax</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:03 5 
                        Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2379307_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Ok!<BR>do you know if is possible 
                                to use the pcap_sendpacket() function of the 
                                winpcal library?<BR>Another question, under 
                                windows vista the problem with the sendto 
                                function still remain?<BR><BR>Many Many thanks 
                                for the help!!! <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2379307&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2379307&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2379145">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2379307">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2379307&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2379307 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4713979,2379307,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2379638_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx2379638xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2379638#xx2379638xx" 
                        name=2379638>Re: Problems on Windows XP SP2</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4713979">mandragorax</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:32 6 
                        Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2379638_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Another question:<BR><BR>is it 
                                possible to use the Socket.SendTo method of the 
                                .NET framework 3.5 instead of the<BR>sendto 
                                method provided by the winsock2 
                                class?<BR><BR>Sorry if i'm disturbing you, but 
                                i've a challenge with a friend of mine, and i'd 
                                like<BR>to solve the problem otherwise i've to 
                                pay a (may be some) beer!!! <IMG title=Smile 
                                src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/smiley_smile.gif" 
                                align=top>))<BR><BR><BR>Many thanks and good 
                                Sunday !!! <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2379638&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2379638&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2379145">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2379638">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2379638&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2379638 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4713979,2379638,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2379640_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=88><A 
                        name=xx2379640xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2379640#xx2379640xx" 
                        name=2379640>Re: Problems on Windows XP SP2</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4713979">mandragorax</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">3:39 6 
                        Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2379640_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 88px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>may be this example could be 
                                useful ...<BR><BR><CODE>public static void 
                                SendTo4()<BR>{<BR>IPHostEntry hostEntry = 
                                Dns.Resolve(Dns.GetHostName());<BR>IPEndPoint 
                                endPoint = new 
                                IPEndPoint(hostEntry.AddressList[0], 
                                11000);<BR><BR>Socket s = new 
                                Socket(endPoint.Address.AddressFamily,<BR>SocketType.Dgram,<BR>ProtocolType.Udp);<BR><BR>byte[] 
                                msg = Encoding.ASCII.GetBytes("This is a 
                                test");<BR>Console.WriteLine("Sending 
                                data.");<BR>// This call blocks. 
                                <BR>s.SendTo(msg, 0, msg.Length, 
                                SocketFlags.None, 
                                endPoint);<BR>s.Close();<BR>}</CODE><BR><BR>i've 
                                found this on the net, is for sending UDP 
                                packet.<BR>Could be adapted to the code of 
                                HTTPFilter?<BR><BR><BR>Thanks a lot again, 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2379640&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2379640&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2379145">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2379640">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2379640&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2379640 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(4713979,2379640,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2390806_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=106><A 
                        name=xx2390806xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2390806#xx2390806xx" 
                        name=2390806>Re: Problems on Windows XP SP2</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">9:29 15 
                        Jan '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2390806_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 106px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Dear mandragorax,<BR><BR>Regarding 
                                pcap, I've to mention yes! before I migrated to 
                                use pure winsock functionalities to send 
                                packets,<BR>I used pcap library but there was an 
                                unbelievable latency while sending immediate 
                                redirect packets. This caused the program to get 
                                out of sync at TCP redirect message. Then I 
                                tried to use libnet's send functionalities but I 
                                <BR>experienced that flaw again also with 
                                libnet.<BR><BR>You said windows vista, emm no 
                                never I tried to test in under 
                                vista...<BR><BR>And about .NET functionality, If 
                                you want to have a little a bit fun regarding 
                                'it just work' and 'dllimport' stuff, You can 
                                write a dll in c# and export the functionality 
                                to c++. but there would be no guarantee that 
                                your redirect packets takes place immediately. 
                                Simply I bet you get out of sync while sending 
                                redirect TCP packets using .NET.<BR><BR>At the 
                                time I wrote this article, My biggest challenge 
                                was the latency of pcap or libnet send packet 
                                and I really wonder why pcap guys left the 
                                library with this flaw.<BR><BR>Just a comment 
                                for you is that I you want to be sure about your 
                                low level library, you have to try a NDIS API. 
                                refer to NTKERNEL.org for more information or 
                                simply google it.<BR><BR>BTW sorry for the late 
                                replay. <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2390806&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2390806&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2379145">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2390806">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2390806&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2390806 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(47108,2390806,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HiVote HdUnSel " id=F2658867_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2658867xx></A><IMG height=16 alt=Answer 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2658867#xx2658867xx" 
                        name=2658867>Re: Problems on Windows XP SP2</A><IMG 
                        height=12 alt=new 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/New.gif" 
                        width=31></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=4845252">densie</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">23:53 
                        30 Jul '08 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2658867_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>This article address this 
                                issue...<BR><BR><A 
                                href="http://msdn.microsoft.com/en-us/library/ms740548.aspx">http://msdn.microsoft.com/en-us/library/ms740548.aspx</A>[<A 
                                title="New Window" 
                                href="http://msdn.microsoft.com/en-us/library/ms740548.aspx" 
                                target=_blank>^</A>]<BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2658867&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2658867&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2379145">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2658867">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2658867&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2658867 
                                style="WHITE-SPACE: nowrap">5.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(4845252,2658867,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd Rt HdUnSel " id=F2326611_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2326611xx></A><IMG height=16 alt=Question 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_question.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2326611#xx2326611xx" 
                        name=2326611>chinese characters</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2295419">hhyjmd</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">23:53 
                        19 Nov '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2326611_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Hi,<BR><IMG title=Smile 
                                src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/smiley_smile.gif" 
                                align=top>Thanks for your article,it works well 
                                on my computer.however, It can't deal with 
                                chinese characters,what should i do then? <IMG 
                                title=Confused 
                                src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/smiley_confused.gif" 
                                align=top> <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2326611&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2326611&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2326611">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2326611">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2326611&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2326611 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(2295419,2326611,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F2331016_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2331016xx></A><IMG height=16 alt=Answer 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_answer.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2331016#xx2331016xx" 
                        name=2331016>Re: chinese characters</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">8:21 22 
                        Nov '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2331016_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Oh yeah, I remember I didn't care 
                                about unicode URLs when I was writing the 
                                application. As soon as possible I'll deal with 
                                that unicode issue.<BR>Thanks for your concern. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2331016&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2331016&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2326611">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2331016">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2331016&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2331016 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(47108,2331016,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2331291_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2331291xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2331291#xx2331291xx" 
                        name=2331291>Re: chinese characters</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=2295419">hhyjmd</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">17:14 
                        22 Nov '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2331291_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Thanks for your reply<IMG 
                                title=Laugh 
                                src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/smiley_laugh.gif" 
                                align=top> <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2331291&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2331291&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2326611">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2331291">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2331291&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2331291 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(2295419,2331291,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgRtDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote Rt HdUnSel " id=F2230221_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=16><A 
                        name=xx2230221xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2230221#xx2230221xx" 
                        name=2230221>winxp</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=3012559">daree</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">2:00 17 
                        Sep '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2230221_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 16px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>hi,<BR><BR>thanks for excellient 
                                piece of article. however, i can't get this to 
                                work with my WinXP. any suggestion? thanks in 
                                advance<BR><BR><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2230221&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2230221&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2230221">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2230221">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2230221&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2230221 
                                style="WHITE-SPACE: nowrap">2.00/5 (1 vote)
                                <SCRIPT type=text/javascript>
												MsgVFrm(3012559,2230221,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2232068_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=34><A 
                        name=xx2232068xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2232068#xx2232068xx" 
                        name=2232068>Re: winxp</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">2:33 18 
                        Sep '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2232068_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 34px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>daree,<BR>It was a long story on 
                                XP. I tested the application on XP with several 
                                components such as pcap, libnet and winsock. But 
                                there's an internal problem in winsock2 on XP 
                                which prevents to send a raw packet over sniffed 
                                connection. Note that the source of problem is 
                                in driver environment and you'll get an 
                                exception reporting that winsock cannot send 
                                asynchronous packet or such.<BR>Similar 
                                condition happened to another reader which 
                                commented out before you. <BR><BR>Meanwhile this 
                                exception occures only in XP platform. In NT, 
                                2000 and 2003 server it works fine. So I 
                                announced that windows 2000 and 2003 are 
                                required platforms to run the 
                                application.<BR><BR>Sorry, I tried but it was a 
                                weird problem.<BR>Don't hesitate to send 
                                comments on this issue if you found out the 
                                source of problem.<BR><BR>From <BR>Reza 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2232068&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2232068&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2230221">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2232068">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2232068&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2232068 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(47108,2232068,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd HdUnSel " id=F2319042_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=52><A 
                        name=xx2319042xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2319042#xx2319042xx" 
                        name=2319042>Re: winxp [modified]</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=475690">Danila 
                        Korablin</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">12:11 
                        14 Nov '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2319042_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 52px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>Is there any way to check outbound 
                                request from WSPSend and block HTTP connection 
                                throught WSPCloseSocket?<BR>I have found a 
                                question at MSDN forum: <A 
                                href="http://forums.microsoft.com/msdn/ShowPost.aspx?postid=2195411&amp;isthread=true&amp;siteid=1&amp;authhash=f677982ada163a2a21f7d19d8e445d9281198f55&amp;ticks=633301590032132816">http://forums.microsoft.com/msdn/ShowPost.aspx?postid=2195411&amp;isthread=true&amp;siteid=1&amp;authhash=f677982ada163a2a21f7d19d8e445d9281198f55&amp;ticks=633301590032132816</A>[<A 
                                title="New Window" 
                                href="http://forums.microsoft.com/msdn/ShowPost.aspx?postid=2195411&amp;isthread=true&amp;siteid=1&amp;authhash=f677982ada163a2a21f7d19d8e445d9281198f55&amp;ticks=633301590032132816" 
                                target=_blank>^</A>]. <BR><BR>
                                <DIV class=ForumSig><I>Wormhole is the God 
                                divided by zero</I></DIV><BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2319042&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2319042&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2230221">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2319042">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2319042&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2319042 
                                style="WHITE-SPACE: nowrap">
                                <SCRIPT type=text/javascript>
												MsgVFrm(475690,2319042,false,"","","");
											</SCRIPT>
                                </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR class=Quick>
                <TD class=Frm_MsgDivide><IMG height=1 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR><!-- Start Message head -->
              <TR class="MsgHd LoVote HdUnSel " id=F2324244_h0>
                <TD width="100%">
                  <TABLE class=QuickHd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent width=70><A 
                        name=xx2324244xx></A><IMG height=16 alt=General 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
                        width=16 align=top></TD>
                      <TD class=Frm_MsgSubject><A id=DynMessLink 
                        href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;select=2324244#xx2324244xx" 
                        name=2324244>Re: winxp</A></TD>
                      <TD style="WIDTH: 20px; WHITE-SPACE: nowrap"><IMG 
                        title=member height=16 alt=member 
                        src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/member_sm.gif" 
                        border=0></TD>
                      <TD class=Frm_MsgAuthor><A 
                        href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=47108">eternalnetworker</A></TD>
                      <TD class=Frm_MsgDate 
                      style="VERTICAL-ALIGN: top; WHITE-SPACE: nowrap">11:12 
                        18 Nov '07 &nbsp;</TD></TR></TBODY></TABLE></TD></TR><!-- End Message head -->
              <TR id=F2324244_h1 style="DISPLAY: none">
                <TD style="WIDTH: 100%">
                  <TABLE class=QuickBd cellSpacing=0 cellPadding=0 width="100%" 
                  border=0>
                    <TBODY>
                    <TR>
                      <TD class=Frm_MsgIndent style="WIDTH: 70px"></TD>
                      <TD class="MsgBd BdSel ">
                        <TABLE cellSpacing=5 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD>
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2>It sounds to me a cool API to do 
                                outbound URL filtering.<BR>BTW personally I 
                                intended to perform these URL filtering things 
                                through deep packet processing and 
                                such...<BR>Thanks Danila informed us of that. 
                                <BR></TD></TR>
                                <TR style="VERTICAL-ALIGN: middle">
                                <TD class=Frm_MsgFt><A class=Frm_MHL title=Reply 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2324244&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=r">Reply</A>·<A 
                                class=Frm_MHL title=Email 
                                href="http://www.codeproject.com/script/Forums/Edit.aspx?fid=445573&amp;select=2324244&amp;floc=/KB/IP/HTTPFilter.aspx&amp;fa=e">Email</A>·<A 
                                class=Frm_MHL title="View Thread" 
                                href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;tid=2230221">View 
                                Thread</A>·<A class=Frm_MHL 
                                title="Get permanent link" 
                                href="http://www.codeproject.com/script/Forums/View.aspx?fid=445573&amp;msg=2324244">PermaLink</A>·<A 
                                class=Frm_MHL title="Bookmark this post" 
                                href="http://www.codeproject.com/script/Bookmarks/Add.aspx?&amp;obid=2324244&amp;obtid=3&amp;bma=AddBookmark">Bookmark</A></TD>
                                <TD class=Frm_MsgFt 
                                style="TEXT-ALIGN: right"><SPAN id=MVF2324244 
                                style="WHITE-SPACE: nowrap">1.50/5 (2 votes)
                                <SCRIPT type=text/javascript>
												MsgVFrm(47108,2324244,false,"","","");
											</SCRIPT>
                                 
                        </SPAN></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
              <TR>
                <TD><IMG height=5 alt="" 
                  src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/t.gif" 
                  width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD>
            <TABLE cellSpacing=0 cellPadding=2 width="100%">
              <TBODY>
              <TR class=Frm_Footer>
                <TD>Last Visit: Tuesday, July 29, 2008 12:24 AM &nbsp; &nbsp; 
                  Last Update:Thursday, August 14, 2008 10:56 AM</TD>
                <TD style="WHITE-SPACE: nowrap; TEXT-ALIGN: right"><B>1</B> <A 
                  class=Frm_HL 
                  href="http://www.codeproject.com/KB/IP/HTTPFilter.aspx?fid=445573&amp;fr=26#xx0xx" 
                  name=Frm_HoverNL>Next 
      »</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
      <P class=SmallText><IMG height=16 alt=General 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_general.gif" 
      width=16 align=top> General &nbsp;&nbsp; <IMG height=16 alt=News 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_news.gif" 
      width=16 align=top> News &nbsp;&nbsp; <IMG height=16 alt=Question 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_question.gif" 
      width=16 align=top> Question &nbsp;&nbsp; <IMG height=16 alt=Answer 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_answer.gif" 
      width=16 align=top> Answer &nbsp;&nbsp; <IMG height=16 alt=Joke 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_joke.gif" 
      width=16 align=top> Joke &nbsp;&nbsp; <IMG height=16 alt=Rant 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_rant.gif" 
      width=16 align=top> Rant &nbsp;&nbsp; <IMG height=16 alt=Admin 
      src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/msg_admin.gif" 
      width=16 align=top> Admin &nbsp;&nbsp; </P><!-- Forum End --></DIV>
      <TABLE width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=TinyText align=left><A id=ctl00_PermaLink 
            href="http://www.codeproject.com/script/Articles/Article.aspx?aid=19886">PermaLink</A> 
            | <A id=ctl00_PrivacyLink 
            href="http://www.codeproject.com/info/privacy.aspx">Privacy </A>| <A 
            id=ctl00_TermsOfUseLink 
            href="http://www.codeproject.com/info/TermsOfUse.aspx">Terms of 
            Use</A> <BR>Last Updated: 26 Aug 2007<BR>Editor: <A 
            id=ctl00_ArticleEditor 
            href="http://www.codeproject.com/script/Membership/Profiles.aspx?mid=28970">Smitha 
            Vijayan</A><BR></TD>
          <TD class=TinyText vAlign=top align=right>Copyright 2007 by 
            eternalnetworker<BR>Everything else Copyright © <A 
            href="mailto:webmaster@codeproject.com">CodeProject</A>, 1999-2008 
            <BR>Web16 | <A id=ctl00_AdvertiseLink 
            href="http://www.codeproject.com/info/MediaKit.aspx">Advertise on 
            the Code Project </A></TD></TR></TBODY></TABLE>
      <CENTER></CENTER></TD></TR>
  <TR>
    <TD align=middle colSpan=2></TD></TR></TBODY></TABLE><BR>
<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
if (document.all) try {window.attachEvent("oncopy",copyCode);}catch(e){};
//]]></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/TogglePre.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/menu132_com.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript 
src="CodeProject Developing a SOHO HTTP filter step by step _ Free source code and programming help_files/TopNavBar.js" 
type=text/javascript></SCRIPT>

<SCRIPT language=Javascript type=text/javascript>//<![CDATA[
new HVMenu(new menu_NavbarConfig());
//]]></SCRIPT>
</BODY></HTML>
