<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0051)http://www.codeproject.com/internet/ctraceroute.asp -->
<HTML><HEAD><TITLE>CTraceRoute v1.0 - The Code Project - Internet & Network</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=ISO-8859-1">
<META content=en-US name=MS.LOCALE>
<META content="A freeware MFC class to implement traceroute functionality." 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="PJ Naughter" name=Author>
<META content="07 Apr 2000 14:00:00 GMT" name=Search.PublishDate>
<META content="07 Apr 2000 14:00:00 GMT" name=Search.RevisedDate>
<META 
content="Free source code, , Visual C++, MFC, Windows, MFC, freeware, traceroute, tracert" 
name=keywords>
<META 
content="Article content copyright PJ Naughter, 2000, everthing else Copyright © CodeProject, 1999-2007, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="The Code Project" 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK href="/favicon.ico" 
type=image/ico rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/oncopy.js"></SCRIPT>

<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
if (typeof(DemoUrl) != "undefined")
	document.write('<me' + 'ta http' + '-equiv="re' + 'fresh" con' + 'tent="1;url=' + DemoUrl + '">');
</SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white>
<SCRIPT 
src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/urchin.js" 
type=text/javascript>
</SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-1735123-1";
urchinTracker();
</SCRIPT>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=3386&cb=6577912\" border=0 frameborder=0 scrolling=no width=728 height=90></IFRAME>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">4,371,493 members and 
            growing! &nbsp; 9,362 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2959938">abdelrady2030 
            </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/internet/ctraceroute.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2959938">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/internet/ctraceroute.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=8">Architect</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=9">SQL</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=1">All Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 300px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=300>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=2">MFC/C++</A> &gt;&gt; <A 
            href="http://www.codeproject.com/internet/">Internet &amp; 
            Network</A> &gt;&gt; <A 
            href="http://www.codeproject.com/internet/#General">General</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">CTraceRoute 
            v1.0</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=184">PJ 
            Naughter</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">A freeware MFC class to implement 
            traceroute functionality.</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C++ (VC6, VC5)<BR>Windows 
            (Win95, NT4, Win98, WinME)<BR>MFC, Win32, VS (VS5)<BR>Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>8 Apr 2000</B><BR><SPAN 
            style="PADDING-RIGHT: 3ex">Views</SPAN>: <B>42,888</B> 
        </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <DIV class=FeatureBlockHeader>Announcements</DIV>
            <DIV class="FeatureBlockContent RHFeatureBar">
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 5px; MARGIN-RIGHT: 10px" 
            height=20 alt=Comp 
            src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/prize_winner_sm.gif" 
            width=10><A 
            href="http://www.codeproject.com/script/competitions/monthly/">Monthly 
            Competition</A></DIV></DIV>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3075&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Faspose%5F160x600%5FAni%5FTotal%5FStr%2Egif&C=False&id=3075&cb=6577919\" alt=\"\" border=0 width=160 height=600></a>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/internet/ctraceroute.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=%2Finternet%2Fctraceroute%2Easp">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Finternet%2Fctraceroute%2Easp&amp;guid=%2Finternet%2Fctraceroute%2Easp">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/internet/ctraceroute.asp#__comments">Discuss</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/mail.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/script/recommend/form.asp?guid=%2Finternet%2Fctraceroute%2Easp">Send 
                        to a friend</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>15 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/red.gif" 
                              width=10 border=0><IMG height=5 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/white.gif" 
                              width=10 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        5.26</A>. Rating: <B>4.48</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <LI class=download><A 
            href="http://www.codeproject.com/internet/CTraceRoute/CTraceRoute_src.zip">Download 
            source files - 13 Kb</A> 
            <P>Welcome to <CODE>CTraceRoute</CODE>, a freeware MFC class to 
            implement trace route functionality. 
            <P><BR>
            <TABLE>
              <TBODY>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/ctraceroute.asp#Features">Features</A></TD></TR>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/ctraceroute.asp#Usage">Usage</A></TD></TR>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/ctraceroute.asp#History">History</A></TD></TR>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/ctraceroute.asp#APIReference">API 
                  Reference</A></TD></TR>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/ctraceroute.asp#Enhancements">Planned 
                  Enhancements</A></TD></TR>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/ctraceroute.asp#Contact">Contacting 
                  the Author</A></TD></TR></TBODY></TABLE>
            <P><BR><A name=Features>
            <H2>Features</H2></A>
            <UL>
              <LI>Simple and clean C++ interface. 
              <LI>The interface provided is synchronous which provides an easier 
              programming model than using asynchronous sockets. 
              <LI>virtual functions are provided to support callback. 
              <LI>A configurable timeout can be set through the class API. 
              <LI>The classes are fully Unicode compliant and include Unicode 
              built options in the workspace file. </LI></UL>
            <P><BR><A name=Usage>
            <H2>Usage</H2></A>
            <UL>
              <LI>To use the class in your code simply include <B>tracer.cpp</B> 
              in your project and <CODE><SPAN class=cpp-preprocessor>#include 
              tracer.h</SPAN></CODE> in which ever of your modules needs to make 
              calls to the class. 
              <LI>Your code will need to include MFC either statically or 
              dynamically. 
              <LI>You will need to have a functioning winsock stack installed as 
              the code links to wsock32.dll. 
              <LI>The code will work just aswell in a GUI or console app. The 
              code should also work in a multithreaded application, although it 
              has not be explicitly tested in this scenario. </LI></UL>
            <P><BR><A name=History>
            <H2>History</H2></A><B>V1.0 (18th November 1998)</B> 
            <UL>
              <LI>Initial public release. </LI></UL>
            <P><BR><A name=APIReference>
            <H2>API Reference</H2></A>The API consists of the the 2 classes: 
            <P><A 
            href="http://www.codeproject.com/internet/ctraceroute.asp#CTraceRouteReply">CTraceRouteReply</A><BR><A 
            href="http://www.codeproject.com/internet/ctraceroute.asp#CTraceRoute">CTraceRoute</A> 

            <P><BR><A name=CTraceRouteReply>
            <H3>CTraceRouteReply</H3></A>This is an encapsulation of all the 
            information as returned from a trace route request. It is a typedef 
            for the following: 
            <P><PRE><SPAN class=cpp-keyword>typedef</SPAN> CArray&lt;CHostTraceMultiReply, CHostTraceMultiReply&amp;&gt; CTraceRouteReply
</PRE>
            <P>The members of CHostTraceMultiReply are as follows: 
            <P>
            <TABLE>
              <TBODY>
              <TR>
                <TD width="16%"><B>DWORD dwError</B></TD>
                <TD width="84%">This is the error if any which occurred when 
                  doing a ping to this host. This corresponds to the values as 
                  returned from GetLastError. 0 represents no error 
              occurred.</TD></TR>
              <TR>
                <TD><B>in_addr Address</B></TD>
                <TD>The IP address of the host for this part of the trace 
                  route.</TD></TR>
              <TR>
                <TD><B>DWORD minRTT</B></TD>
                <TD>Minimum round trip time in milliseconds for this 
              host.</TD></TR>
              <TR>
                <TD><B>DWORD avgRTT</B></TD>
                <TD>Average round trip time in milliseconds for this 
              host.</TD></TR>
              <TR>
                <TD><B>DWORD maxRTT</B></TD>
                <TD>Maximum round trip time in milliseconds for this 
              host.</TD></TR></TBODY></TABLE>
            <P><BR><A name=CTraceRoute>
            <H3>CTraceRoute</H3></A><A 
            href="http://www.codeproject.com/internet/ctraceroute.asp#Trace">Trace</A><BR><A 
            href="http://www.codeproject.com/internet/ctraceroute.asp#OnPingResult">OnPingResult</A><BR><A 
            href="http://www.codeproject.com/internet/ctraceroute.asp#OnSingleHostResult">OnSingleHostResult</A> 

            <P><BR>
            <DL>
              <DT><A name=Trace></A><B><U>CTraceRoute::Trace</U></B>
              <P></P>
              <DD><B><I>BOOL CTraceRoute::Trace(LPCTSTR pszHostName, 
              CTraceRouteReply&amp; trr, UCHAR nHopCount = 30, DWORD dwTimeout = 
              30000, DWORD dwPingsPerHost = 3) const;</I>
              <P>Return Value:</B><BR>If the function succeeds, the return value 
              is TRUE. If the function fails, the return value is FALSE. To get 
              extended error information, call <CODE>::GetLastError()</CODE>.
              <P><B>Parameters:</B> 
              <UL>
                <LI>pszHostName -- The network address of the socket to connect 
                to: a machine name such as "ftp.yourisp.com", or a dotted number 
                such as "128.56.22.8" will both work. 
                <LI>trr -- Upon successful return, this will contain all the 
                information related to the trace route request. See <A 
                href="http://www.codeproject.com/internet/ctraceroute.asp#CTraceRouteReply"><CODE>CTraceRouteReply</CODE></A> 
                for further details. 
                <LI>nHopCount -- This is the maximum TTL to use. This 
                corresponds to the farthest router which the ping request will 
                reach. 
                <LI>dwTimeout -- The timeout for each ping in milliseconds. 
                <LI>dwPingsPerHost -- The number of pings to perform per host. 
                </LI></UL>
              <P><B>Remarks:</B><BR>This function implements the trace route 
              functionality. 
              <P><BR></P>
              <DT><A 
              name=OnPingResult></A><B><U>CTraceRoute::OnPingResult</U></B>
              <P></P>
              <DD><B><I>virtual BOOL CTraceRoute::OnPingResult(int nPingNum, 
              const CHostTraceSingleReply&amp; htsr);</I>
              <P>Return Value:</B><BR>TRUE to continue the trace route. 
              Returning FALSE will cancel the operation.
              <P><B>Parameters:</B> 
              <UL>
                <LI>nPingNum -- The ping reply which this function is being 
                called for. 
                <LI>htsr -- Contains the actual results from the ping for this 
                host. </LI></UL>
              <P><B>Remarks:</B><BR>This function is called just after each ping 
              reply. You can derive your own class from CTraceRoute and override 
              this function so that your version is called at the appropriate 
              times. 
              <P><BR></P>
              <DT><A 
              name=OnSingleHostResult></A><B><U>CTraceRoute::OnSingleHostResult</U></B>
              <P></P>
              <DD><B><I>virtual BOOL CTraceRoute::OnSingleHostResult(int 
              nHostNum, const CHostTraceMultiReply&amp; htmr);</I>
              <P>Return Value:</B><BR>TRUE to continue the trace route. 
              Returning FALSE will cancel the operation.
              <P><B>Parameters:</B> 
              <UL>
                <LI>nHostNum -- The current host which this function is being 
                called for. 
                <LI>htmr -- Contains the collective results from the ping for 
                this host. </LI></UL>
              <P><B>Remarks:</B><BR>This function is called just after all the 
              pings for each host is complete. You can derive your own class 
              from CTraceRoute and override this function so that your version 
              is called at the appropriate times. See the CMyTraceRoute class in 
              main.cpp for a concrete implementation. 
              <P><BR></P></DD></DL>
            <P><BR><A name=Enhancements>
            <H2>Planned Enhancements</H2></A>
            <UL>
              <LI>If you have any other suggested improvements, please let me 
              know so that I can incorporate them into the next release. 
</LI></UL>
            <P><BR><A name=Contact>
            <H2>Contacting the Author</H2></A>PJ Naughter<BR>Email: <A 
            href="mailto:pjn@indigo..ie">mailto:pjn@indigo..ie</A><BR>Web: <A 
            href="http://www.naughter.com/">http://www.naughter.com/</A><BR>18th 
            November 1998 
            <P><BR><!-- Article Ends --></P></LI></DIV></SPAN>
            <SCRIPT 
            src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>PJ Naughter</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><BR></TD>
                <TD class=smallText>
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=184">here</A> 
                  to view PJ Naughter's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular Internet &amp; Network articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/internet/ndk.asp">Network 
                    Development Kit 2.0</A>
                    <DIV class=smallText>Network Development Kit is a set of 
                    simple classes for a client-server architecture.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/internet/drvfltip.asp">Developing 
                    Firewalls for Windows 2000/XP</A>
                    <DIV class=smallText>An article about developing Firewalls 
                    for Windows 2000/XP.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/internet/csmtpconn.asp">CSMTPConnection 
                    v1.36</A>
                    <DIV class=smallText>An MFC class to encapsulate the SMTP 
                    protocol.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/internet/serversocket.asp">Multi-threaded 
                    Client/Server Socket class</A>
                    <DIV class=smallText>A multi-threaded based Client/Server 
                    Socket Communication class.</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2257&cb=6577923\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</SCRIPT>
                </TD></TR></TBODY></TABLE>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden value=/internet/ctraceroute.asp 
            name=vote_name> <INPUT type=hidden value=/internet/ctraceroute.asp 
            name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/internet/ctraceroute.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD 
                style="PADDING-RIGHT: 2px; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; BACKGROUND-COLOR: #eee" 
                width=120 height=60>
                  <DIV align=center>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3919&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Fxoreax%5F808%5Fbutton%5F120x60%2Egif&C=False&id=3919&cb=6577928\" alt=\"Xoreax cuts VS build times by up to 90%\" border=0 width=120 height=60></a>");</SCRIPT>
                  </DIV></TD>
                <TD width=100>&nbsp;</TD>
                <TD width=468 height=60><SPAN id=AdBanner5>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3263&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FCWS%5Fnet%5F468x60%2Egif&C=False&id=3263&cb=6577916\" alt=\"\" border=0 width=468 height=60></a>");</SCRIPT>
                  </SPAN></TD></TR></TBODY></TABLE></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/internet/ctraceroute.asp&amp;df=100&amp;forumid=562 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=562"><IMG 
                              height=15 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION 
                              value=3>Expanded</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/internet/ctraceroute.asp&amp;df=100&amp;forumid=562" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 6 of 6 (Total: 6) 
                              (<A 
                              href="http://www.codeproject.com/internet/ctraceroute.asp?df=100&amp;forumid=562">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=2110453_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx2110453xx></A><IMG 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?df=100&amp;forumid=562&amp;select=2110453#xx2110453xx" 
                                name=2110453><B>erroneous results</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3329771"><IMG 
                                title="Click for User Profile" height=15 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>NicolasCh</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>5:33 3 Jul 
                                '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=2110453_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi. I 
                                have such results:<BR><BR>Tracing route to 
                                codeproject.com<BR>over a maximum of 30 
                                hops:<BR><BR>1 * * * Error:11013<BR>2 * * * 
                                Error:11013<BR>3 * * * Error:11013<BR>4 * * * 
                                Error:11013<BR>5 * * * Error:11013<BR>6 * * * 
                                Error:11013<BR>7 * * * Error:11013<BR>8 * * * 
                                Error:11013<BR>9 * * * Error:11013<BR>10 * * * 
                                Error:11013<BR>11 * * * Error:11013<BR>12 * * * 
                                Error:11013<BR>13 * * * Error:11013<BR>14 * * * 
                                Error:11013<BR>15 * * * Error:11013<BR>16 * * * 
                                Error:11013<BR>17 * * * Error:11013<BR>18 * * * 
                                Error:11013<BR>19 * * * Error:11013<BR>20 * * * 
                                Error:11013<BR>21 * * * Error:11013<BR>22 * * * 
                                Error:11013<BR>23 * * * Error:11013<BR>24 * * * 
                                Error:11013<BR>25 * * * Error:11013<BR>26 1092 
                                ms 1191 ms 1264 ms www.codeproject.com 
                                [69.10.233.10]<BR><BR>Trace 
                                complete.<BR><BR>Why? <BR><BR>
                                <DIV 
                                class=ForumSig>happynomm</DIV><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/internet/ctraceroute.asp&amp;df=100&amp;forumid=562&amp;select=2110453">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/internet/ctraceroute.asp&amp;df=100&amp;forumid=562&amp;select=2110453">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?df=100&amp;tid=2110453&amp;forumid=562&amp;select=2110453#xx2110453xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?msg=2110453#xx2110453xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?msg=2110453#xx2110453xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(3329771,2110453);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1998169_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1998169xx></A><IMG 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?df=100&amp;forumid=562&amp;select=1998169#xx1998169xx" 
                                name=1998169><B>Preventing deadlock</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1431569"><IMG 
                                title="Click for User Profile" height=15 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>sapero_</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>18:25 19 
                                Apr 
                            '07</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1998169_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>inside 
                                CTraceRoute::OnSingleHostResult i would add 
                                <CODE>if (htmr.dwError == WSAHOST_NOT_FOUND) 
                                return false;</CODE> to break the trace in case 
                                a host is blocked in hosts file. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/internet/ctraceroute.asp&amp;df=100&amp;forumid=562&amp;select=1998169">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/internet/ctraceroute.asp&amp;df=100&amp;forumid=562&amp;select=1998169">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?df=100&amp;tid=1998169&amp;forumid=562&amp;select=1998169#xx1998169xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?msg=1998169#xx1998169xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?msg=1998169#xx1998169xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1431569,1998169);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=467256_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx467256xx></A><IMG 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?df=100&amp;forumid=562&amp;select=467256#xx467256xx" 
                                name=467256><B>Great Job..</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=10924"><IMG 
                                title="Click for User Profile" height=15 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>RobJones</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>12:06 7 
                                Apr 
                            '03</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=467256_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Great 
                                Job man.. keep up the good work.<BR><BR>Rob 
                                <BR><BR>Whoever said nothing's impossible never 
                                tried slamming a revolving 
                                door!<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/internet/ctraceroute.asp&amp;df=100&amp;forumid=562&amp;select=467256">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/internet/ctraceroute.asp&amp;df=100&amp;forumid=562&amp;select=467256">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?df=100&amp;tid=467256&amp;forumid=562&amp;select=467256#xx467256xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?msg=467256#xx467256xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?msg=467256#xx467256xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(10924,467256);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=458135_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx458135xx></A><IMG 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?df=100&amp;forumid=562&amp;select=458135#xx458135xx" 
                                name=458135><B>Host's Name</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=14124"><IMG 
                                title="Click for User Profile" height=15 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Eric 
                                Hansen</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>10:58 27 
                                Mar 
                            '03</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=458135_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I'm new 
                                to programming network communications. Most 
                                traceRT utilities (that I've seen) resolve the 
                                hostname when they are invoked. Win2k TraceRT 
                                partial output:<BR><BR>Tracing route to HPR01 
                                [10.0.0.1]<BR>over a maximum of 30 
                                hops:<BR><BR>The "HPR01" portion of this output 
                                is what I'm refering to. I'm trying to figure 
                                out how to do that and thought you may know, and 
                                also that this might be a good addition to your 
                                CTraceRoute class. Thanks in advance for any 
                                help...<BR><BR><BR><BR><B>Eric 
                                Hansen</B><BR><BR><A 
                                href="mailto:ehansen@pmsi.cc">mailto:ehansen@pmsi.cc</A><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/internet/ctraceroute.asp&amp;df=100&amp;forumid=562&amp;select=458135">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/internet/ctraceroute.asp&amp;df=100&amp;forumid=562&amp;select=458135">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?df=100&amp;tid=458135&amp;forumid=562&amp;select=458135#xx458135xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?msg=458135#xx458135xx">PermaLink</A> 
                                | <A title="Go to Thread Start" 
                                href="http://www.codeproject.com/internet/ctraceroute.asp?msg=458135#xx458135xx">Go 
                                to Thread Start</A>]</TD>
                                <TD class=messagetitle align=right>Score: 3.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(14124,458135);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="CTraceRoute v1_0 - The Code Project - Internet &amp; Network_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=458195_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx458195xx></A>&lt;img 
                                height=1 
                    </TR></TBODY></TABLE></TR></TBODY></TABLE></TR></TBODY></TABLE></TR></TBODY></DIV></TR></TBODY></TABLE></TR></TBODY></TABLE></BODY></HTML>
