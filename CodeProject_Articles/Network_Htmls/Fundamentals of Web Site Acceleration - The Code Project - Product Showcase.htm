<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0056)http://www.codeproject.com/showcase/port80software_1.asp -->
<HTML><HEAD><TITLE>Fundamentals of Web Site Acceleration - The Code Project - Product Showcase</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=ISO-8859-1">
<META content=en-US name=MS.LOCALE>
<META 
content="This paper outlines a common sense, cost-effective approach to lowering total cost of ownership and improving Web site and Web application performance." 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="Joe Lima and Port80" name=Author>
<META content="24 Mar 2004 14:00:00 GMT" name=Search.PublishDate>
<META content="24 Mar 2004 14:00:00 GMT" name=Search.RevisedDate>
<META content="Free source code, , Visual C++, MFC, Windows, IIS, compression" 
name=keywords>
<META 
content="Article content copyright Joe Lima and Port80, 2004, everthing else Copyright © CodeProject, 1999-2007, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="The Code Project" 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK href="/favicon.ico" 
type=image/ico rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/oncopy.js"></SCRIPT>

<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
if (typeof(DemoUrl) != "undefined")
	document.write('<me' + 'ta http' + '-equiv="re' + 'fresh" con' + 'tent="1;url=' + DemoUrl + '">');
</SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white>
<SCRIPT 
src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/urchin.js" 
type=text/javascript>
</SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-1735123-1";
urchinTracker();
</SCRIPT>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3011&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FESRI%5Fnet%5F728x90%2Egif&C=False&id=3011&cb=6563761\" alt=\"\" border=0 width=728 height=90></a>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">4,371,492 members and 
            growing! &nbsp; 10,174 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2959938">abdelrady2030 
            </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/showcase/port80software_1.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2959938">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/showcase/port80software_1.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=8">Architect</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=9">SQL</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=1">All Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 300px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=300>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=2">MFC/C++</A>, <A 
            href="http://www.codeproject.com/?cat=3">C#</A>, <A 
            href="http://www.codeproject.com/?cat=4">ASP.NET</A>, <A 
            href="http://www.codeproject.com/?cat=5">.NET</A>, <A 
            href="http://www.codeproject.com/?cat=6">VB.NET</A> &gt;&gt; <A 
            href="http://www.codeproject.com/showcase/">Product Showcase</A> 
            &gt;&gt; <A 
            href="http://www.codeproject.com/showcase/#Components+and+Libraries">Components 
            and Libraries</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">Fundamentals of Web 
            Site Acceleration</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=121605">Joe 
            Lima and Port80</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">This paper outlines a common sense, 
            cost-effective approach to lowering total cost of ownership and 
            improving Web site and Web application performance.</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">Generic<BR>Windows (Win2K, 
            NT4), .NET<BR>ASP.NET, ASP, IIS (IIS 4, IIS 5), Win32, 
            VS<BR>Dev<BR><SPAN style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>25 
            Mar 2004</B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: 
            <B>20,422</B> </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <DIV class=FeatureBlockHeader>Announcements</DIV>
            <DIV class="FeatureBlockContent RHFeatureBar">
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 5px; MARGIN-RIGHT: 10px" 
            height=20 alt=Comp 
            src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/prize_winner_sm.gif" 
            width=10><A 
            href="http://www.codeproject.com/script/competitions/monthly/">Monthly 
            Competition</A></DIV></DIV>
            <CENTER>
            <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2775&cb=6563773\" border=0 frameborder=0 scrolling=no width=160 height=600></IFRAME>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/showcase/port80software_1.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=port80software%5F1%2Fshowcase3%2F25%2F2004">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fshowcase%2Fport80software%5F1%2Easp&amp;guid=port80software%5F1%2Fshowcase3%2F25%2F2004">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/showcase/port80software_1.asp#__comments">Discuss</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/mail.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/script/recommend/form.asp?guid=port80software%5F1%2Fshowcase3%2F25%2F2004">Send 
                        to a friend</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A 
          name=__top></A></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <P><EM>This is a showcase review for our sponsors at CodeProject. 
            These reviews are intended to provide you with information on 
            products and services that we consider useful and of value to 
            developers.</EM> </P>
            <H2>Performance Starts at the Web Server</H2>
            <P><A 
            href="http://www.port80software.com/support/articles/Fundamentals_of_Web_Site_Acceleration_Port80_Software.pdf" 
            target=_blank>[download PDF version]</A></P>
            <H2>Abstract</H2>
            <P>This paper outlines a common sense, cost-effective approach to 
            lowering total cost of ownership and improving Web site and Web 
            application performance according to two simple principles:</P>
            <UL>
              <LI><B>Send as little data as possible</B> 
              <LI><B>Send it as infrequently as possible</B> </LI></UL>We will 
            explore "best practice" strategies that can be systematically 
            employed in Web front-end source code and at the origin server in 
            order to achieve performance improvements. These basic strategies, 
            which all avoid expensive hardware solutions in favor of software 
            and business process enhancements, include: 
            <UL>
              <LI><A 
              href="http://admin.codeproject.com/script/submit/#codeoptimization"><B>Code 
              optimization</B></A> 
              <LI><A 
              href="http://admin.codeproject.com/script/submit/#cachecontrol"><B>Cache 
              control</B></A> 
              <LI><A 
              href="http://admin.codeproject.com/script/submit/#compression"><B>HTTP 
              compression</B></A> </LI></UL>We assume that our typical reader is 
            responsible in some way for development and/or management of a Web 
            site or application running on one or more Windows servers with 
            Internet Information Services (<A 
            href="http://www.microsoft.com/iis" target=_blank>IIS</A>) and that 
            he or she has an interest in improving its performance as much as 
            possible without deploying additional hardware (such as dedicated 
            acceleration appliances) or services (such as Content Distribution 
            Networks). 
            <P>As we examine each strategy, we will explore the potential 
            benefits to a variety of different Web sites and applications in 
            terms of three vital metrics:</P>
            <UL>
              <LI><B>Faster Web page loads and an improved user experience, 
              translating into higher revenue and increased efficiencies</B> 
              <LI><B>Reduction of bandwidth utilization and increased, ongoing 
              savings</B> 
              <LI><B>Consolidation of the number of server resources required to 
              deliver existing sites and applications</B> </LI></UL>We will 
            suggest relatively inexpensive software tools that will leverage 
            common Web standards in order to maximize hardware and network 
            resources, thus improving Web site and application performance while 
            lowering the total cost of ownership of Web infrastructure. 
            <H2>Measuring Web Site Performance</H2>
            <P>The most valuable measurement of Web site performance from an end 
            user's perspective is the amount of time needed to display a 
            requested Web page. The most important metric of page load time is 
            Time to First Byte (<A 
            href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/act/htm/actml_ref_ttfb.asp" 
            target=_blank>TTFB</A>). Defined as the amount of time it takes to 
            deliver the first byte of the requested page to the end user, TTFB 
            represents the visitor's initial confirmation that a Web site or 
            application is responding. Following Time to First Byte is the 
            metric of <A 
            href="http://whatis.techtarget.com/definition/0,,sid9_gci213140,00.html" 
            target=_blank>Throughput</A>, or how many requests can be served by 
            a Web site or application in a given time period. A user expects 
            text, images, and other elements to load swiftly and methodically - 
            failure in any of these metrics results in the perception of poor 
            performance, which can very quickly lead to visitor frustration and 
            abandonment of the site.</P>
            <P>With a large enough budget for heavy infrastructure improvements, 
            any server's connection to the Internet can always be improved. 
            However, we are interested in cases in which these common measures 
            of Web site performance degrade due to uncontrollable network 
            conditions and in which expensive, complex hardware solutions are 
            not feasible or desirable. As Web sites and applications grow 
            increasingly complex with bulky code and third party applications, 
            users - many of whom are still using dial-up connections - must 
            download an increasing amount of data to access a Web site or 
            application. Even when highly efficient applications are made 
            available on fast Wide Area Networks (<A 
            href="http://www.webopedia.com/TERM/w/wide_area_network_WAN.html" 
            target=_blank>WANs</A>) like corporate extranets, segments of the 
            network will always be susceptible to bottlenecks, and the user may 
            experience unacceptably long page load times. If the Web server's 
            source code and management software are not optimized to keep pace 
            with rising site traffic and application complexity, administrators 
            will waste server resources and bandwidth, and users will be 
            presented with slower, easier-to-abandon Web sites.</P>
            <P>Optimizing content and content delivery has been proven to 
            improve Web page delivery speed in case studies conducted by the <A 
            href="http://www.w3.org/" target=_blank>World Wide Web 
            Consortium</A> and has been espoused by Web optimization experts 
            such as <A href="http://www.websiteoptimization.com/" 
            target=_blank>Andy King</A>. Until recently, content optimization 
            required difficult and time-consuming manual coding, but this can 
            now be achieved through the implementation of inexpensive software 
            tools and unobtrusive changes in development and deployment 
            processes. Similarly, while optimizing content delivery once 
            demanded expensive hardware and infrastructure investments, today it 
            can be accomplished with affordable, easy-to-deploy server software 
            tools.</P>
            <P><A 
            href="http://admin.codeproject.com/script/submit/#codeoptimization"><B>Code 
            optimization</B></A>, <A 
            href="http://admin.codeproject.com/script/submit/#cachecontrol"><B>cache 
            control</B></A>, and <A 
            href="http://admin.codeproject.com/script/submit/#compression"><B>HTTP 
            compression</B></A> are strategies that focus on sending as little 
            data as necessary as infrequently as possible to optimize 
            performance in an existing Web application's front-end code and on 
            the origin Web server delivering that content to Web browsers.</P>
            <H2>Code Optimization</H2>
            <P>Source code optimization is an important but often overlooked 
            application of the "send as little data as possible" principle. As a 
            Web site or application acceleration strategy, its chief benefit is 
            that the technique can provide substantial reductions in network 
            payloads without requiring any additional processing on the origin 
            server. Source code optimization should be implemented as a 
            pre-deployment step through which all additions and changes to the 
            front-end source code (including <A href="http://www.w3.org/MarkUp/" 
            target=_blank>markup</A>, <A 
            href="http://www.htmlhelp.com/reference/css/" target=_blank>style 
            sheets</A>, and <A 
            href="http://www.webopedia.com/TERM/c/client_side.html" 
            target=_blank>client-side scripts</A>) normally pass before being 
            uploaded to the "live" production site or application.</P>
            <H3>Beyond White Space Removal</H3>
            <P>While traditional "white space removal" (the elimination of 
            superfluous spaces, tabs, new lines, and comments) can result in 
            modest savings of 10 to 15 percent in typical HTML and CSS files, a 
            code optimizer modeled after a traditional software compiler can 
            achieve a much higher level of optimization on all text-based files. 
            Because it possesses a site-wide contextual awareness, such a tool 
            can employ more aggressive tactics, including condensing function 
            and variable names, re-mapping lengthy identifiers and <A 
            href="http://www.port80software.com/support/articles/nextgenerationurls" 
            target=_blank>URL or URI</A> paths, and through the use of a real 
            JavaScript parser, even streamline lines of code.<BR><BR>Until 
            recently, this approach has been the exclusive domain of JavaScript 
            experts with the time and patience to write very terse code. In 
            addition, hand coding still presented limitations to site expansion 
            and code readability because it maintains a single optimized code 
            base for both development and deployment. It is both safer and more 
            efficient to use next generation development tools like the <A 
            href="http://www.w3compiler.com/" 
            target=_blank><B>w3compiler</B></A> that preserve developer-friendly 
            versions of Web site files as well as the highly optimized versions 
            exclusively for delivery on the Web.<BR><BR>When integrated into the 
            normal developer workflow as a final pre-deployment process, 
            optimizations can be applied to growing Web sites without breaking 
            the external references that abound in modern Web front-ends, 
            including function and variable names defined or initialized in one 
            file and referenced in another. This highly aggressive optimization 
            approach can lead to average savings of 20 to 30 percent in 
            JavaScript files and as high as 70 percent in tested, "real world" 
            cases.<BR><BR>A sensible objection to aggressive source code 
            optimization is that it diminishes the readability of the code when 
            one "views source" in a Web browser. This is a particularly outdated 
            objection as it adds essentially no value for end users and may, in 
            fact, represent a security threat by making it trivially easy for 
            competitors to copy unique client-side features. Even more troubling 
            is the fact that un-optimized source code also clears the way for 
            hackers to conduct reconnaissance on a Web application by "source 
            sifting" for clues to its potential vulnerabilities. Readable and 
            well-commented code is an obvious advantage during initial 
            development, but it is not an appropriate format in which to deliver 
            business-critical Web applications.<BR><BR>Code optimization 
            represents the first step in improving Web site and application 
            performance by reducing the initial network payload that a server 
            must deliver to the end user. Once that content has been optimized 
            on the developer side, attention shifts to how that content can be 
            delivered in its most optimized and efficient form.</P>
            <H2>Cache Control</H2>
            <H3>What Is Caching? How Does It Apply to the Web?</H3>
            <P>Caching is a well-known concept in computer science: when 
            programs continually access the same set of instructions, a massive 
            performance benefit can be realized by storing those instructions in 
            RAM. This prevents the program from having to access the disk 
            thousands or even millions of times during execution by quickly 
            retrieving them from RAM. Caching on the Web is similar in that it 
            avoids a roundtrip to the origin Web server each time a resource is 
            requested and instead retrieves the file from a local computer's 
            browser cache or a proxy cache closer to the user.</P>
            <P>The most commonly encountered caches on the Web are the ones 
            found in a user's Web browser such as Internet Explorer, Mozilla and 
            Netscape. When a Web page, image, or JavaScript file is requested 
            through the browser each one of these resources may be accompanied 
            by HTTP header directives that tell the browser how long the object 
            can be considered "fresh," that is for how long the resource can be 
            retrieved directly from the browser cache as opposed to from the 
            origin or proxy server. Since the browser represents the cache 
            closest to the end user it offers the maximum performance benefit 
            whenever content can be stored there.</P>
            <H3>The Common HTTP Request/Response Cycle</H3>
            <P>When a browser makes an initial <A 
            href="http://www.w3.org/Protocols/HTTP/HTRQ_Headers.html" 
            target=_blank>request</A> to a Web site - for example, a <A 
            href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9.3" 
            target=_blank>GET request</A> for a home page - the server normally 
            returns a 200 OK <A 
            href="http://www.hwg.org/lists/hwg-servers/response_codes.html" 
            target=_blank>response</A> code and the home page. Additionally, the 
            server will return a 200 OK response and the specified object for 
            each of the dependent resources referenced in that page, such as 
            graphics, style sheets, and JavaScript files. Without appropriate 
            freshness headers, a subsequent request for this home page will 
            result in a "conditional" GET request for each resource. This 
            conditional GET validates the freshness of the resource using 
            whatever means it has available for comparison, usually the <A 
            href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.29" 
            target=_blank>Last-Modified</A> timestamp for the resource (if 
            Last-Modified is not available, such as with dynamic files, an 
            unconditional GET will be sent that circumvents caching altogether). 
            Through a roundtrip to the server, it will be determined whether the 
            Last-Modified value of the item on the server matches that of the 
            item cached in the browser, and either a fresh version will be 
            returned from the server with a 200 OK response, or a 304 
            Not-Modified response header will be returned, indicating that the 
            file in the cache is valid and can be used again.</P>
            <P>A major downside to validations such as this is that, for most 
            files on the Web, it can take almost as long to make the roundtrip 
            with the validation request as it does to actually return the 
            resource from the server. When done unnecessarily this wastes 
            bandwidth and slows page load time. With the dominant Internet 
            Explorer browser under its default settings and without sufficient 
            cache control headers, a conditional GET will be sent at the 
            beginning of each new session. This means that most repeat visitors 
            to a Web site or application are needlessly requesting the same 
            resources over and over again.</P>
            <P>Fortunately, there is an easy way to eliminate these unnecessary 
            roundtrips to the server. If a freshness indicator is sent with each 
            of the original responses, the browser can pull the files directly 
            from the browser cache on subsequent requests without any need for 
            server validation until the expires time assigned to the object is 
            reached. When a resource is retrieved directly from the user's 
            browser cache, the responsiveness of the Web site is dramatically 
            improved, giving the perception of a faster site or application. 
            This cache retrieval behavior can be seen clearly when a user 
            revisits a Web page during the same browser session - images render 
            almost instantaneously. When the correct cache control headers are 
            incorporated into a server's responses, this performance improvement 
            and reduction of network traffic will persist for any number of 
            subsequent sessions as long as the object is not expired or until a 
            user manually empties his or her cache.</P>
            <H3>Somewhere Between a Rotting Fish and Burning Currency</H3>
            <P>Web caching via HTTP headers is outlined in <A 
            href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13" 
            target=_blank>HTTP/1.1, section 13 of RFC 2616</A>. The language of 
            the specification itself helps to define the desired effects and 
            tradeoffs of caching on the Web. The specification offers 
            suggestions for explicit warnings given by a user agent (browser) 
            when it is not making optimal use of caching. For cases in which a 
            browser's settings have been configured to prevent the validation of 
            an expired object, the spec suggests that the user agent could 
            display an image of a stale fish. For cases in which an object is 
            unnecessarily validated (or re-sent, despite its being fresh) the 
            suggested image is of burning currency, so that the user "<A 
            href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec13.html#sec13.1.4" 
            target=_blank>does not inadvertently consume excess resources or 
            suffer from excessive latency</A>".</P>
            <P>Cache control headers can be used by a server to provide a 
            browser with the information it needs to accurately handle the 
            resources on a Web site. By setting values to prevent the caching of 
            highly volatile objects, one can help to ensure that files are not 
            given the "rotting fish treatment." In the case of objects that are 
            by design kept consistent for long periods of time, such as a Web 
            site's navigation buttons and logos, setting a lengthy expiration 
            time can avoid the "burning currency treatment." Whatever the 
            desired lifetime of an object is, there is no good reason why each 
            resource should not have cache-related headers sent along with it on 
            every response.</P>
            <P>A variety of cache-related headers are superior to the 
            Last-Modified header because they can do more than merely provide a 
            clue about the version of a resource. They can allow administrators 
            to control how often a conditional GET, or validation trip to the 
            Web server, occurs. Well-written cache control headers help to 
            ensure that a browser always retrieves a fresh resource when 
            necessary or tells the browser how long a validation check can be 
            forestalled. This can dramatically reduce network chatter by 
            eliminating superfluous validations and help keep the pipe clear for 
            essential trips to retrieve dynamic or other files.</P>
            <P>The <A 
            href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.21" 
            target=_blank>Expires header</A> (for HTTP 1.0) and the <A 
            href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9" 
            target=_blank>Cache-control header</A> with its <A 
            href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9.3" 
            target=_blank>max-age</A> directive (for HTTP/1.1) allow a Web 
            developer to define how long each resource is to remain fresh. The 
            value specifies a period of time after which a browser needs to 
            check back with the server to validate whether or not the object has 
            been updated.</P>
            <P>By using a cache control header inspection tool like this <A 
            href="http://www.web-caching.com/cacheability.html" 
            target=_blank>Cacheability Engine</A>, it is easy to see by the 
            Last-Modified header value how long many images, style sheets, and 
            JavaScript files go unchanged. Oftentimes, a year or more has passed 
            since certain images were last modified. This means that all 
            validation trips to the Web server over the past year for these 
            objects were unnecessary, thus incurring higher bandwidth 
            expenditures and slower page loads for users.</P>
            <H3>Cache Control Does the Heavy Lifting in Web Server 
            Performance</H3>
            <P>Formulating a caching policy for a Web site - determining which 
            resources should not get cached, which resources should, and for how 
            long - is a vital step in improving site performance. If the 
            resource is a dynamic page that includes time sensitive database 
            queries on each request, then cache control headers should be used 
            to ensure that the page is never cached. If the data in a page is 
            specific to the user or session, but not highly time sensitive, 
            cache control directives can restrict caching to the user's private 
            browser cache. Any other unchanging resources that are accessed 
            multiple times throughout a Web site, such as logos or navigational 
            graphics, should be retrieved only once during an initial request 
            and after that validated as infrequently as is possible.</P>
            <P>This begs the question: "Who knows best what the caching policies 
            should be?" On Microsoft IIS Web servers, currently the Web site 
            administrator has sole access to cache control-related headers 
            through the MMC control panel, suggesting that the admin is best 
            suited to determine the policies. More often, however, it is the 
            application developer who is most familiar with the resources on the 
            Web site, and is thus best qualified to establish and control the 
            policies. Giving developers the ability to set cache control headers 
            for resources across their site using a rules-based approach is 
            ideal because it allows them to set appropriate policies for single 
            objects, for a directory of objects, or based on MIME types. An 
            added benefit of developer cache management is less work for site 
            administrators. Try out <A href="http://www.cacheright.com/" 
            target=_blank><B>CacheRight</B></A> for Microsoft IIS cache control 
            management and centralized cache rules management.</P>
            <P>No matter what your Web site or application does, or what your 
            network environment includes, performance can be improved by 
            implementing caching policies for the resources on your site. By 
            eliminating unnecessary roundtrips to the server, cache control can 
            go a long way towards achieving the dual objectives of sending as 
            little as possible as infrequently as possible. However, in cases 
            where resources are dynamic or rapidly changing, a roundtrip to the 
            server is unavoidable for each request. In these situations, the 
            payload can still be minimized by using HTTP compression.</P>
            <H2>HTTP Compression</H2>
            <H3>Low Cost, High Impact Performance Tuning Should Not Be 
            Overlooked</H3>
            <P>HTTP compression is a long-established Web standard that is only 
            now receiving the attention it deserves. Its implementation was 
            sketched out in HTTP/1.0 (<A 
            href="http://www.faqs.org/rfcs/rfc1945.html" target=_blank>RFC 
            1945</A>) and completely specified by 1999 in HTTP/1.1 (RFC 2616 
            covers <A 
            href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.3" 
            target=_blank>accept-encoding</A> and <A 
            href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.11" 
            target=_blank>content-encoding</A>). Case studies conducted as early 
            as 1997 by the WC3 proved the ability of compression to 
            significantly reduce bandwidth usage and to improve Web performance 
            (see their <A 
            href="http://www.w3.org/Protocols/HTTP/Performance/Compression/PPP.html" 
            target=_blank>dial-up</A> and <A 
            href="http://www.w3.org/Protocols/HTTP/Performance/Compression/LAN.html" 
            target=_blank>LAN</A> compression studies).</P>
            <P>In the case of HTTP compression, a standard gzip or deflate 
            encoding method is applied to the payload of an HTTP response, 
            significantly compressing the resource before it is transported 
            across the Web. Gzip (RFC 1952) is a lossless compressed data format 
            that has been widely used in computer science for decades. The 
            deflation algorithm used by gzip (RFC 1951) is shared by common 
            libraries like zip and zlib and is an open-source, patent-free 
            variation of the LZ77 (Lempel-Ziv 1977) algorithm. Because of the 
            proven stability of applying compression and decompression, the 
            technology has been supported in all major browser implementations 
            since early in the 4.X generation (for Internet Explorer and 
            Netscape).</P>
            <P>While the application of gzip and deflate is relatively 
            straightforward, two major factors limited the widespread adoption 
            of HTTP compression as a performance enhancement strategy for Web 
            sites and applications. Most notably, isolated bugs in early server 
            implementations and in compression-capable browsers created 
            situations in which servers sent compressed resources to browsers 
            that were not actually able to handle them.</P>
            <P>When data is encoded using a compressed format like gzip or 
            deflate, it introduces complexity into the HTTP request/response 
            interaction by necessitating a type of content negotiation. Whenever 
            compression is applied, it creates two versions of a resource: one 
            compressed (for browsers that can handle compressed data) and one 
            uncompressed (for browsers that cannot). A browser needs only to 
            accurately request which version it would like to receive. However, 
            there are cases in which some browsers express, in their HTTP 
            request headers, the ability to handle a gzip compressed version of 
            a certain MIME type resource when they effectively cannot. These 
            browser bugs have given rise to a number of third-party compression 
            tools for Microsoft IIS Web servers that give administrators the 
            ability to properly configure their servers to handle the exceptions 
            necessary for each problematic browser and MIME type.</P>
            <P>The second factor that has stunted the growth of HTTP compression 
            is something of a historical and economic accident. Giant, pre-2001 
            technology budgets and lofty predictions of widespread 
            high-bandwidth Internet connections led to some much more elaborate 
            and expensive solutions to performance degradation due to high 
            latency network conditions. Despite the elements being in place to 
            safely implement HTTP compression, <A href="http://www.akamai.com/" 
            target=_blank>Akamai</A> and other Content Distribution Networks 
            employing edge caching technology captured the market's attention. 
            While HTTP compression should not be viewed as a direct alternative 
            to these more expensive options, with the help of a reliable 
            configuration and management tool, compression should be employed as 
            a complementary, affordable initial step towards performance 
            enhancement.</P>
            <H3>Compression Will Deliver Smaller Web Transfer Payloads and 
            Improved Performance</H3>
            <P>Most often, HTTP compression is implemented on the server side as 
            a filter or module which applies the gzip algorithm to responses as 
            the server sends them out. Any text-based content can be compressed. 
            In the case of purely static content, such as markup, style sheets, 
            and JavaScript, it is usually possible to cache the compressed 
            representation, sparing the CPU of the burden of repeatedly 
            compressing the same file. When truly dynamic content is compressed, 
            it usually must be recompressed each time it is requested (though 
            there can be exceptions for quasi-dynamic content, given a smart 
            enough compression engine). This means that there is trade-off to be 
            considered between processor utilization and payload reduction. A 
            highly configurable compression tool enables an administrator to 
            adjust the tradeoff point between processor utilization and 
            compressed resource size by setting the compression level for all 
            resources on the Web site, thereby not wasting CPU cycles on 
            "over-compressing" objects which might compress just as tightly with 
            a lower level setting as with a higher one. This also allows for the 
            exclusion of binary image files from HTTP compression, as most 
            images are already optimized when they are created in an editor such 
            as Illustrator. Avoid the needless recompression of images as this 
            may actually increase their file size or introduce distortion.</P>
            <P>Compression results in significant file size savings on text-type 
            files. The exact percentage saved will depend on the degree of 
            redundancy or repetition in the character sequences in the file, but 
            in many cases, individual files may be reduced by 70 or even 80 
            percent. Even relatively lumpy or less uniform text files will often 
            shrink by 60 percent. Keep in mind that when looking at overall 
            savings on the site, these extremely high compression rates will be 
            counterbalanced by the presence of image MIME types that cannot 
            usefully be compressed. Overall savings from compression is likely 
            to be in the range of 30 to 40 percent for the typical Web site or 
            application. This free online tool will help you to <A 
            href="http://www.port80software.com/products/httpzip/compresscheck" 
            target=_blank>see the file size savings and transfer improvement 
            garnered from compressing any Web resource</A>.</P>
            <P>If bandwidth savings is the primary goal, the strategy should be 
            to compress all text-based output. Ideally, this should include not 
            only static text files (such as HTML and CSS), but files that 
            produce output in text media MIME types (such as ASP and ASP.NET 
            files), as well as files that are text-based but of another media 
            type (such as external JavaScript files). This free online tool will 
            help you to <A 
            href="http://www.port80software.com/products/httpzip/bandwidthcalc" 
            target=_blank>gauge the bandwidth cost savings to be realized from 
            compressing any Web resource</A>.</P>
            <P><A 
            href="http://www-106.ibm.com/developerworks/web/library/wa-httpcomp/" 
            target=_blank>Case studies like this one from IBM</A> have proven 
            the performance improvement that can be realized by using 
            compression, especially in WAN environments that include areas of 
            high traffic and high latency. The general principle is clear: the 
            more crowded the pipe and the more hops in the route, the greater 
            the potential benefits of sending the smallest possible payloads. 
            When the size of the resource is drastically reduced, as a text file 
            is when gzip compression is applied, the number of packets sent is 
            also reduced, decreasing the likelihood of lost packets and 
            retransmissions. All of these benefits of HTTP compression lead to 
            much faster and more efficient transfers.</P>
            <P>On Microsoft IIS 4.0 and 5.0 Web servers, <A 
            href="http://www.httpzip.com/" target=_blank><B>httpZip</B></A> is 
            the best solution for compression as it addresses a number of <A 
            href="http://www.port80software.com/products/httpzip/faq#question1" 
            target=_blank>shortcomings in functionality, customization, and 
            reporting on Windows NT/2000</A> that gave rise to a third party 
            tools market. With the launch of Windows Server 2003 and IIS 6.0, 
            Microsoft chose to make compression functionality a priority, and 
            their internal IIS 6.0 compression software works - though you must 
            delve into the IIS metabase to manage it beyond a simple "on/off" 
            decision. You can use a tool like <A 
            href="http://www.zipenable.com/" target=_blank><B>ZipEnable</B></A> 
            to unlock and greatly enhance the configuration and management 
            options for IIS 6.0 built-in compression.</P>
            <H2>Make Your Web Server a Faster, More Efficient Resource</H2>
            <P>Having explored these three techniques for Web server performance 
            optimization, how can you put this learning into practice? We have 
            mentioned a few of our Port80 Software tools above, but the 
            following guidelines will help you find the right solutions for your 
            own Web server performance strategy.</P>
            <H3>Selecting a Code Optimization Tool</H3>
            <P>An effective source code optimizer should combine an awareness of 
            Web standards with the ability to undertake the aggressive 
            optimizations that can only be done if the entire site is treated as 
            a whole. The capability to fully parse the code is the key here. 
            This is particularly true in the case of JavaScript and DHTML 
            optimizations, in which external references can easily be broken if 
            optimization is done file by file.</P>
            <H3>Selecting a Cache Control Tool</H3>
            <P>A cache control tool should provide the ability to implement 
            cache control policies in a rule-based approach so that each 
            resource is cached and validated in the most appropriate and 
            efficient manner. It should also include a mechanism that allows 
            site and application developers to contribute to the generation of 
            those rules without requiring intervention by server administrators. 
            </P>
            <H3>Selecting a HTTP Compression Tool</H3>
            <P>An origin server compression solution should be, above all else, 
            highly configurable. Although compression is widely supported by 
            modern browsers, several known bugs remain. Such potential problems 
            are best addressed on the server side by properly configuring 
            exceptions for the MIME types problematic for each specific browser. 
            Similar exceptions may be made for files that are very small or very 
            large, or which, for other specialized reasons, should not be 
            compressed. It is also helpful to be able to adjust the level of 
            compression for different file types and to be able to monitor and 
            log the results of compression.</P>
            <H2>Strong Performance is the Foundation of Your Web Presence</H2>
            <P>In order to achieve maximum Web site and application performance, 
            it is vital to view the complete chain - from source code 
            development, server-side processes, and the connection between 
            server and end user, all the way to the end user's Web browser - and 
            to examine each link in that chain for both potential pitfalls and 
            opportunities for improvement. Implementing the three-fold strategy 
            of code optimization, cache control, and compression will 
            dramatically reduce the amount of Web site and application data 
            transmitted and ensures that your data is sent in the most efficient 
            manner possible. Leverage the resources of your existing Web 
            infrastructure with the strategies presented here, none of which are 
            particularly expensive. Implementing these unobtrusive changes in 
            development and deployment practices will aid your Web developers, 
            site administrators, and users. The results will speak for 
            themselves: a more efficient Web server, lower bandwidth expenses, 
            and a faster experience for your users, all helping to drive revenue 
            growth, lower costs, and modernize your Web systems. </P><!-- Article Ends --></DIV></SPAN>
            <SCRIPT 
            src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>About Joe Lima and Port80</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><BR></TD>
                <TD class=smallText>Port80 Software, Inc. is an innovative 
                  developer of software products for Microsoft Internet 
                  Information Services (IIS) focused Web site administrators, 
                  developers and owners. Port80 products enhance IIS 
                  functionality, security, performance, and user experience, 
                  augmenting IIS with on-par or better features than those 
                  provided by the Apache server. Port80 also develops the 
                  w3compiler desktop tool for next generation markup and code 
                  optimization. Port80 Software is a Microsoft Certified Partner 
                  located in San Diego, CA. Additional information about the 
                  company is available on the Internet at 
www.port80software.com.
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=121605">here</A> 
                  to view Joe Lima and Port80's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR><BR>
            <CENTER>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD 
                style="PADDING-RIGHT: 2px; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; BACKGROUND-COLOR: #eee" 
                width=120 height=60>
                  <DIV align=center>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3486&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2Fcp%5Fdaily%5F120x60%2Egif&C=False&id=3486&cb=6563780\" alt=\"\" border=0 width=120 height=60></a>");</SCRIPT>
                  </DIV></TD>
                <TD width=100>&nbsp;</TD>
                <TD width=468 height=60><SPAN id=AdBanner5>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3759&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FWholeTomato%5FAutoSuggest%5F468x60%2Egif&C=False&id=3759&cb=6563766\" alt=\"The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you.\" border=0 width=468 height=60></a>");</SCRIPT>
                  </SPAN></TD></TR></TBODY></TABLE></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/showcase/port80software_1.asp&amp;df=100&amp;forumid=36288 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=36288"><IMG 
                              height=15 
                              src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION 
                              value=3>Expanded</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/showcase/port80software_1.asp&amp;df=100&amp;forumid=36288" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Total Messages for this 
                              article: 0 (<A 
                              href="http://www.codeproject.com/showcase/port80software_1.asp?df=100&amp;forumid=36288">Refresh</A>)</TD>
                            <TD noWrap 
                      align=right>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR>
                            <TD class=messagetitle align=middle>-- No entries 
                              --</TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/t.gif" 
                              width=1 
                  border=0></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 25 Mar 2004 </TD>
                <TD class=SmallText align=right>Article content copyright Joe 
                  Lima and Port80, 2004<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2007</A>. <BR>Web09 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="Fundamentals of Web Site Acceleration - The Code Project - Product Showcase_files/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  
            <A href="http://www.aspalliance.com/">ASP Alliance</A>  <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
            href="http://www.developersdex.com/">Developersdex</A>  <A 
            href="http://www.devguru.com/">DevGuru</A>  <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A>  
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
