<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0045)http://www.codeproject.com/internet/cping.asp -->
<HTML><HEAD><TITLE>CPing v1.22 - The Code Project - Internet & Network</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=ISO-8859-1">
<META content=en-US name=MS.LOCALE>
<META content="An MFC class to encapsulate the Ping utility." name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="PJ Naughter" name=Author>
<META content="03 Mar 2000 14:00:00 GMT" name=Search.PublishDate>
<META content="03 Mar 2000 14:00:00 GMT" name=Search.RevisedDate>
<META content="Free source code, , Visual C++, MFC, Windows, ping, network, MFC" 
name=keywords>
<META 
content="Article content copyright PJ Naughter, 2000, everthing else Copyright © CodeProject, 1999-2007, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - VB.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=6" 
type=application/rss+xml rel=alternate><LINK title="The Code Project" 
href="http://www.codeproject.com/info/OpenSearch.xml" 
type=application/opensearchdescription+xml rel=search><LINK href="/favicon.ico" 
type=image/ico rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="CPing v1_22 - The Code Project - Internet &amp; Network_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="CPing v1_22 - The Code Project - Internet &amp; Network_files/oncopy.js"></SCRIPT>

<SCRIPT language=javascript>
if (top != self) top.location.href = location.href;
if (typeof(DemoUrl) != "undefined")
	document.write('<me' + 'ta http' + '-equiv="re' + 'fresh" con' + 'tent="1;url=' + DemoUrl + '">');
</SCRIPT>

<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white>
<SCRIPT 
src="CPing v1_22 - The Code Project - Internet &amp; Network_files/urchin.js" 
type=text/javascript>
</SCRIPT>

<SCRIPT type=text/javascript>
_uacct = "UA-1735123-1";
urchinTracker();
</SCRIPT>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="CPing v1_22 - The Code Project - Internet &amp; Network_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=3133&cb=6473299\" border=0 frameborder=0 scrolling=no width=728 height=90></IFRAME>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">4,371,476 members and 
            growing! &nbsp; 11,769 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2959938">abdelrady2030 
            </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/internet/cping.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2959938">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/internet/cping.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=8">Architect</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=9">SQL</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=1">All Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 300px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=300>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="CPing v1_22 - The Code Project - Internet &amp; Network_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="CPing v1_22 - The Code Project - Internet &amp; Network_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=2">MFC/C++</A> &gt;&gt; <A 
            href="http://www.codeproject.com/internet/">Internet &amp; 
            Network</A> &gt;&gt; <A 
            href="http://www.codeproject.com/internet/#General">General</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">CPing 
            v1.22</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=184">PJ 
            Naughter</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">An MFC class to encapsulate the Ping 
            utility.</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C++ (VC6, VC5)<BR>Windows 
            (Win95, NT4, Win98, WinME)<BR>MFC, Win32, VS (VS5)<BR>Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>4 Mar 2000</B><BR><SPAN 
            style="PADDING-RIGHT: 3ex">Views</SPAN>: <B>118,491</B> 
        </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <DIV class=FeatureBlockHeader>Announcements</DIV>
            <DIV class="FeatureBlockContent RHFeatureBar">
            <DIV style="PADDING-TOP: 5px"><IMG 
            style="PADDING-RIGHT: 10px; FLOAT: left; MARGIN-LEFT: 5px; MARGIN-RIGHT: 10px" 
            height=20 alt=Comp 
            src="CPing v1_22 - The Code Project - Internet &amp; Network_files/prize_winner_sm.gif" 
            width=10><A 
            href="http://www.codeproject.com/script/competitions/monthly/">Monthly 
            Competition</A></DIV></DIV>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3825&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FCraniate%5Ftower%2Danimate2%5F160x600%5F%2Egif&C=False&id=3825&cb=6473307\" alt=\"\" border=0 width=160 height=600></a>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="CPing v1_22 - The Code Project - Internet &amp; Network_files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="CPing v1_22 - The Code Project - Internet &amp; Network_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/internet/cping.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="CPing v1_22 - The Code Project - Internet &amp; Network_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=%2Finternet%2Fcping%2Easp">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="CPing v1_22 - The Code Project - Internet &amp; Network_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Finternet%2Fcping%2Easp&amp;guid=%2Finternet%2Fcping%2Easp">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="CPing v1_22 - The Code Project - Internet &amp; Network_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/internet/cping.asp#__comments">Discuss</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="CPing v1_22 - The Code Project - Internet &amp; Network_files/mail.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/script/recommend/form.asp?guid=%2Finternet%2Fcping%2Easp">Send 
                        to a friend</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>19 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="CPing v1_22 - The Code Project - Internet &amp; Network_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="CPing v1_22 - The Code Project - Internet &amp; Network_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="CPing v1_22 - The Code Project - Internet &amp; Network_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="CPing v1_22 - The Code Project - Internet &amp; Network_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="CPing v1_22 - The Code Project - Internet &amp; Network_files/red.gif" 
                              width=6 border=0><IMG height=5 
                              src="CPing v1_22 - The Code Project - Internet &amp; Network_files/white.gif" 
                              width=14 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        5.5</A>. Rating: <B>4.3</B> out of 
                5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <LI class=download><A 
            href="http://www.codeproject.com/internet/CPing/CPing_src.zip">Download 
            source files - 13 Kb</A> 
            <P>
            <H2>Introduction</H2>Welcome to <CODE>CPing</CODE>, a freeware MFC 
            class to encapsulate the PING protocol. 
            <P><BR>
            <TABLE>
              <TBODY>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/cping.asp#Features">Features</A></TD></TR>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/cping.asp#Usage">Usage</A></TD></TR>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/cping.asp#History">History</A></TD></TR>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/cping.asp#APIReference">API 
                  Reference</A></TD></TR>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/cping.asp#Enhancements">Planned 
                  Enhancements</A></TD></TR>
              <TR>
                <TD><A 
                  href="http://www.codeproject.com/internet/cping.asp#Contact">Contacting 
                  the Author</A></TD></TR></TBODY></TABLE>
            <P><BR><A name=Features>
            <H2>Features</H2></A>
            <UL>
              <LI>Simple and clean C++ interface. 
              <LI>The interface provided is synchronous which provides an easier 
              programming model than using asynchronous sockets. 
              <LI>A configurable timeout for the connection can be set through 
              the class API. 
              <LI>The classes are fully Unicode compliant and include Unicode 
              built options in the workspace file. </LI></UL>
            <P><A name=Usage>
            <H2>Usage</H2></A>
            <UL>
              <LI>To use the class in your code simply include <B>ping.cpp</B> 
              in your project and <CODE><SPAN class=cpp-preprocessor>#include 
              ping.h</SPAN></CODE> in which ever of your modules needs to make 
              calls to the class. 
              <LI>Your code will need to include MFC either statically or 
              dynamically. 
              <LI>You will need to have a functioning winsock stack installed as 
              the code links to <B>winsock.dll</B>. 
              <LI>You will also need to have <B>winsock.h</B> or 
              <B>afxsock.h</B> and <B>afxpriv.h</B> in your precompiled header. 
              The code will work just aswell in a GUI or console app. The code 
              should also work in a multithreaded application, although it has 
              not be explicitly tested in this scenario. </LI></UL>
            <P><BR><A name=History>
            <H2>History</H2></A><B>V1.0 (11th June 1998)</B> 
            <UL>
              <LI>Initial public release. </LI></UL>
            <P><B>V1.1 (23rd June 1998)</B> 
            <UL>
              <LI>The class now supports using Winsock 2 calls instead of using 
              the ICMP dll. To use Winsock 2 calls in <CODE>CPing</CODE> instead 
              of the ICMP dll, just define the preprocessor constant 
              <CODE>CPING_USE_WINSOCK2</CODE> and don't forget to link to 
              <B>ws2_32.lib</B>. </LI></UL>
            <P><B>V1.2 (30th July 1998)</B> 
            <UL>
              <LI>Can now use both Winsock 2 calls and ICMP style calls at the 
              same time with the use of 2 preprocessor directives. 
              <LI>Sample program now use generic entry point 
              <CODE>_tmain</CODE>. 
              <LI>Got rid of a 2 level 4 compiler warnings. 
              <LI>Fixed a problem with the cleanup of ICMP dll usage. 
              <LI>Tidied up and optimized the usage of static variables. 
              <LI>VC++ 6.0 project file is now used for the sample so beware. 
              </LI></UL>
            <P><B>V1.21 (9th November 1998)</B> 
            <UL>
              <LI>Now ships with a VC 5 workspace file instead of VC 6. This is 
              mainly because a lot of people have not migrated to it yet. 
              <LI>Workspace file now includes configurations to allow both the 
              Winsock 2 and ICMP based code to be exercised. 
              <LI>Fixed a level 4 warning which was occurring. 
              <LI>Removed a number of compiler errors which was occurring when 
              code was compiled to use the ICMP or Winsock 2. 
              <LI>Fixed a bug whereby a ping to a non-existent host using the 
              Winsock 2 method blocked indefinitely. 
              <LI>Fixed a socket handle leak which was occurring if the Winsock 
              2 method of pinging was used. 
              <LI>Fixed error in API documentation when compared with the actual 
              header file. 
              <LI>Fixed error in API documentation regarding default timeouts 
              value. </LI></UL>
            <P><B>V1.22 (1st March 2000)</B> 
            <UL>
              <LI>Fixed a problem where I was incorrectly overwritting memory in 
              the function <CODE>FillIcmpData()</CODE>. 
              <LI>Tidied up the console info issued by <CODE>CPing</CODE>. 
              <LI>Minor changes to the way the demo program is initialized 
              (<CODE>main()</CODE> vs. <CODE>tmain()</CODE> etc.). </LI></UL>
            <P><BR><A name=APIReference>
            <H2>API Reference</H2></A>The API consists of the the single public 
            member <CODE>Ping</CODE> of the class <CODE>CPing</CODE>. 
            <P>
            <DL>
              <DT><B><U>CPing::Ping1</U></B>
              <P></P>
              <DD><B><I>BOOL CPing::Ping1(LPCTSTR pszHostName, CPingReply&amp; 
              pr, UCHAR nTTL = 10, DWORD dwTimeout = 5000, UCHAR nPacketSize = 
              32) const;</I>
              <P>Return Value:</B><BR>If the function succeeds, the return value 
              is TRUE. If the function fails, the return value is FALSE. To get 
              extended error information, call <CODE>::GetLastError()</CODE>.
              <P><B>Parameters:</B> 
              <UL>
                <LI>pszHostName -- The network address of the socket to connect 
                to: a machine name such as "ftp.yourisp.com", or a dotted number 
                such as "128.56.22.8" will both work. 
                <LI>pr -- This is a reference to a structure which will be 
                filled in upon successful return of this function. Currently it 
                contains just two members, namely: 
                <UL>
                  <LI><I>Address</I> -- This is the IP address of the replier. 
                  <LI><I>RTT</I> -- This is the round trip time in Milliseconds. 
                  </LI></UL>
                <LI>dwTimeout -- This is the timeout to use for connections in 
                milliseconds. 
                <LI>nTTL -- This is the time to live of the ICMP packet to be 
                sent. For those unfamilar with the low level details of IP, this 
                is the maximum number of routers through which this packet 
                should travel. Each time an IP packet goes through a router, its 
                TTL value is decremented by 1. Eventually when a packet is 
                received with a TTL of 1, it is not forwarded and instead an 
                ICMP reply is generated. This prevents the network from becoming 
                flooded with old IP packets. As an aside this is the basis of 
                how traceroute is implemented. 
                <LI>nPacketSize -- This is the size of the ICMP packet to send. 
                </LI></UL>
              <P><B>Remarks:</B><BR>Internally this function will use the ICMP 
              dll to do a ping. To make this function available you will need to 
              define the <CODE>CPING_USE_ICMP</CODE> preprocessor macro and link 
              to the winsock v1.1dll namely <B>wsock32.dll</B>. 
              <P><BR></P>
              <DT><B><U>CPing::Ping2</U></B>
              <P></P>
              <DD><B><I>BOOL CPing::Ping2(LPCTSTR pszHostName, CPingReply&amp; 
              pr, DWORD dwTimeout = 5000, UCHAR nTTL = 10, UCHAR nPacketSize = 
              32) const;</I>
              <P>Return Value:</B><BR>If the function succeeds, the return value 
              is TRUE. If the function fails, the return value is FALSE. To get 
              extended error information, call <CODE>::GetLastError()</CODE>.
              <P><B>Parameters:</B> 
              <UL>
                <LI>pszHostName -- The network address of the socket to connect 
                to: a machine name such as "ftp.yourisp.com", or a dotted number 
                such as "128.56.22.8" will both work. 
                <LI>pr -- This is a reference to a structure which will be 
                filled in upon successful return of this function. Currently it 
                contains just two members, namely: 
                <UL>
                  <LI><I>Address</I> -- This is the IP address of the replier. 
                  <LI><I>RTT</I> -- This is the round trip time in Milliseconds. 
                  </LI></UL>
                <LI>dwTimeout -- This is the timeout to use for connections in 
                milliseconds. 
                <LI>nTTL -- This is the time to live of the ICMP packet to be 
                sent. For those unfamilar with the low level details of IP, this 
                is the maximum number of routers through which this packet 
                should travel. Each time an IP packet goes through a router, its 
                TTL value is decremented by 1. Eventually when a packet is 
                received with a TTL of 1, it is not forwarded and instead an 
                ICMP reply is generated. This prevents the network from becoming 
                flooded with old IP packets. As an aside this is the basis of 
                how traceroute is implemented. 
                <LI>nPacketSize -- This is the size of the ICMP packet to send. 
                </LI></UL>
              <P><B>Remarks:</B><BR>Internally this function will use the raw 
              winsock 2 calls to do a ping. To make this function available you 
              will need to define the <CODE>CPING_USE_WINSOCK2</CODE> 
              preprocessor macro and link to the winsock v2 dll, namely 
              <B>ws2_32.lib</B>. Please note that this dll is only available on 
              NT or recent service packs of Windows 95 and is not available on 
              the original build of 95, namely build 950. 
              <P><BR></P></DD></DL>
            <P><BR><A name=Enhancements>
            <H2>Planned Enhancements</H2></A>
            <UL>
              <LI>If you have any other suggested improvements, please let me 
              know so that I can incorporate them into the next release. 
</LI></UL>
            <P><BR><A name=Contact>
            <H2>Contacting the Author</H2></A>PJ Naughter<BR>Email: <A 
            href="mailto:pjn@indigo..ie">mailto:pjn@indigo..ie</A><BR>Web: <A 
            href="http://www.naughter.com/">http://www.naughter.com/</A><BR>1 
            March 2000 
            <P><BR><!-- Article Ends --></P></LI></DIV></SPAN>
            <SCRIPT 
            src="CPing v1_22 - The Code Project - Internet &amp; Network_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>PJ Naughter</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><BR></TD>
                <TD class=smallText>
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=184">here</A> 
                  to view PJ Naughter's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular Internet &amp; Network articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/internet/ndk.asp">Network 
                    Development Kit 2.0</A>
                    <DIV class=smallText>Network Development Kit is a set of 
                    simple classes for a client-server architecture.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/internet/drvfltip.asp">Developing 
                    Firewalls for Windows 2000/XP</A>
                    <DIV class=smallText>An article about developing Firewalls 
                    for Windows 2000/XP.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/internet/csmtpconn.asp">CSMTPConnection 
                    v1.36</A>
                    <DIV class=smallText>An MFC class to encapsulate the SMTP 
                    protocol.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/internet/serversocket.asp">Multi-threaded 
                    Client/Server Socket class</A>
                    <DIV class=smallText>A multi-threaded based Client/Server 
                    Socket Communication class.</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=3895&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FInfragistics%5Fdotnet%5Fgeneral%5F300x250a%2Ejpg&C=False&id=3895&cb=6473311\" alt=\"\" border=0 width=300 height=250></a>");</SCRIPT>
                </TD></TR></TBODY></TABLE>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden value=/internet/cping.asp 
            name=vote_name> <INPUT type=hidden value=/internet/cping.asp 
            name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/internet/cping.asp#__top">Top</A>]</TD>&lt;td 
                      align=right 
        vali</TR></TBODY></TABLE></TR></TBODY></TABLE></FORM></TR></TBODY></TABLE></TR></TBODY></TABLE></BODY></HTML>
