<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0047)http://www.codeproject.com/cs/database/dac2.asp -->
<HTML><HEAD><TITLE>Data Access and Transaction Handling Framework - The Code Project - C# Database</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<META content=en-US name=MS.LOCALE>
<META 
content="Generic data access component for different datasources, sprocs/SQL, implicitly propagated transactions, explicitly managed transaction contexts etc." 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="Deyan Petrov" name=Author>
<META content="08 Apr 2003 14:00:00 GMT" name=Search.PublishDate>
<META content="12 Jan 2005 14:00:00 GMT" name=Search.RevisedDate>
<META 
content="Free source code, , Visual C++, MFC, Windows, Data Access Transactions" 
name=keywords>
<META 
content="Article content copyright Deyan Petrov, 2003, everthing else Copyright © CodeProject, 1999-2006, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/oncopy.js"></SCRIPT>

<META content="MSHTML 6.00.2900.2802" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white><!-- COPYRIGHT 2006 I/PRO Corporation ALL RIGHTS RESERVED. - Page view auditing -->
<SCRIPT language=JavaScript type=text/javascript>
var LSPT="";
LSPT += "?durl=" + escape(document.URL);
LSPT += "&hostname=" + location.hostname;
LSPT += "&url=" + location.pathname;
LSPT += "&query=" + escape(location.search) + escape(location.hash);
LSPT += "&referrer=" + escape(document.referrer);
LSPT += "&browser=" + escape(navigator.appName);
LSPT += "&version=" + escape(navigator.appVersion);
LSPT += "&os=" + escape(navigator.platform);
LSPT += "&xdomain=codeproject.com";
LSPT += "&custid=codeproject";
</SCRIPT>

<SCRIPT type=text/javascript>
document.write('<img src=http://'+'content.ipro.com/images/pixel.gif'+LSPT+' height="1" width="1" style="position:absolute; top:0px; left:0px">');
</SCRIPT>
<NOSCRIPT><IMG style="LEFT: 0px; POSITION: absolute; TOP: 0px" height=1 src="" 
width=1> </NOSCRIPT><!-- END I/PRO PAGE TAG -->
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2341&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FScaleout%5FStateServer%5F728x90%2Egif&C=False&id=2341&cb=3456604\" alt=\"\" border=0 width=728 height=90></a>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">3,524,143 members and 
            growing! &nbsp; 6,682 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2959938">abdelrady2030 
            </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/cs/database/dac2.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2959938">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/cs/database/dac2.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=5">.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=1">All Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=380>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/store/">StoreFront</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=4">ASP.NET</A>, <A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=3">C#</A>, <A 
            href="http://www.codeproject.com/?cat=5">.NET</A> &gt;&gt; <A 
            href="http://www.codeproject.com/cs/database/">C# Database</A> 
            &gt;&gt; <A 
            href="http://www.codeproject.com/cs/database/#General">General</A> 
            &nbsp;(<SPAN class=SmallText 
            style="FONT-WEIGHT: bold; COLOR: red">Advanced</SPAN>)<BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">Data Access and 
            Transaction Handling Framework</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=25272">Deyan 
            Petrov</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">Generic data access component for 
            different datasources, sprocs/SQL, implicitly propagated 
            transactions, explicitly managed transaction contexts etc.</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C#<BR>Windows, .NET (.NET 
            1.0, .NET 1.1)<BR>Win32, VS (VS.NET2003)<BR>DB, Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>9 Apr 2003 
            </B><BR><SPAN style="PADDING-RIGHT: 0.3ex">Updated</SPAN>: <B>13 Jan 
            2005</B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: 
            <B>202,562</B> </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <TABLE class=MemberNavBar 
            style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; MARGIN-BOTTOM: 10px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
            cellSpacing=0>
              <TBODY>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/books2_sml.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.amazon.com/gp/redirect.html?link_code=ur2&amp;tag=thecodeprojec-20&amp;camp=1789&amp;creative=9325&amp;location=/gp/browse%3Fnode=5">Programming 
                  books</A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/support_icon.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.codeproject.com/store/"><B>Ultimate 
                  Combo<BR>MFC tools $449</B></A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/mail.gif" 
                  width=16></TD>
                <TD class=SmallText><A 
                  href="http://www.codeproject.com/script/recommend/form.asp?guid=DAC2%2Fcs%2Fdatabase4%2F9%2F2003">Send 
                  to a friend</A></TD></TR></TBODY></TABLE>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2348&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FCWS%5Fnet2%5F160x600%2Egif&C=False&id=2348&cb=3456611\" alt=\"\" border=0 width=160 height=600></a>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/cs/database/dac2.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=DAC2%2Fcs%2Fdatabase4%2F9%2F2003">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fcs%2Fdatabase%2Fdac2%2Easp&amp;guid=DAC2%2Fcs%2Fdatabase4%2F9%2F2003">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/cs/database/dac2.asp#__comments">Discuss</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>102 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/red.gif" 
                              width=10 border=0><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/white.gif" 
                              width=10 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        9.02</A>. Rating: <B>4.49</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <UL class=download>
              <LI><A 
              href="http://www.codeproject.com/cs/database/dac2/DAC2.zip">Download 
              source files and demo project - 134 Kb (VS.NET 2003/.NET 1.1.)</A> 
              </LI></UL>
            <P><IMG height=296 
            src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/Diagram1.jpg" 
            width=600></P>
            <H2>Introduction</H2>
            <P>This is another go at the problem of data access and transaction 
            handling in a multi-tier business application (for example web 
            application). The suggested approach should help in building a 
            database independent data layer. The database can be changed later 
            by simply translating the XML CONFIG files to the required database 
            dialect. Both the SQL and stored procedure commands can be used and 
            easily switched between, without changing the data layer code. The 
            transactions are managed implicitly, but the code explicitly deals 
            with transaction contexts. Several TransactionHandlers are 
            supplied.</P>
            <H2>Background</H2>
            <P>The data layer in a multi-tier application depends on the 
            principal application architecture. The architectural design, on 
            which the rest of the article is based, consists of a Facade layer, 
            Business Logic Layer, Data Layer, and of course additionally a UI in 
            front and a database back behind. The middle tier as a whole is 
            stateless (state kept in the DB) and the data should pass through it 
            in two directions - from UI to the database and from the database to 
            the UI. The architecture is a long story and I will not go into its 
            details. The transactions can be controlled from different layers, 
            usually either from the Facade layer or the Business Logic Layer, 
            while the data access code is usually placed in the data layer.</P>
            <H2>Objectives</H2>
            <OL>
              <LI>Database independent data layer - This means that the database 
              can be changed simply by rewriting the XML files containing the 
              command definitions without rewriting the data layer code (similar 
              to localization). 
              <LI>Support for different data providers and multiple data sources 
              - A certain data source can be retrieved from the factory by 
              specifying its name. 
              <LI>Implicit support for stored procedures as well as SQL 
              statements and SQL batches - In the beginning an SQL batch can be 
              specified and saved in the CONFIG file, later on it can be changed 
              to a stored proc in the data source without affecting the data 
              layer code. 
              <LI>Command parameters are cached and only the values are set in 
              the code (no need for defining the parameters in the code). 
              <LI><CODE>DataSet</CODE>/<CODE>DataAdapter</CODE> support, 
              defining <CODE>DataAdapter</CODE>s in XML or in the code using 
              commands defined in the CONFIG files. 
              <LI>Implicit handling of transactions/connections, the code 
              explicitly enters/commits/rollbacks/exits transaction contexts. A 
              transaction context may span several methods. A method may enter 
              several nested transaction contexts, across several data sources 
              as well. </LI></OL>
            <H2>Design ideas</H2>
            <OL>
              <LI>CONFIG XML file with available data providers and data 
              sources. 
              <LI>CONFIG XML file(s) (one or more in a specified directory with 
              a specified file mask) per data source, containing the definitions 
              of the commands. A command definition consists of 
              <CODE>commandtext</CODE>, <CODE>commandtype</CODE> and parameters. 
              A command's name may/may not coincide with a sproc name. 
              <LI>It is possible to directly derive stored procedures by name 
              from the database, if a corresponding command is not specified in 
              the CONFIG files. 
              <LI>Current transaction/connections are stored in the Thread Local 
              Storage (TLS). Once a transaction (+connection) is opened it is 
              used implicitly by the data layer. </LI></OL>
            <H2>Using the Framework.DataAccess code</H2>
            <P>The <CODE>IDataSource</CODE> is used as a factory for 
            <CODE>IDataCommands</CODE>. It represents a certain database and a 
            .NET data provider, and caches all the commands for this database. 
            Data sources are defined like this:</P><PRE lang=xml>&lt;dataAccessSettings xmlns="Framework.DataAccess"&gt;
    &lt;dataProviders&gt;
        &lt;dataProvider name="SqlClient" 
           connectionType="System.Data.SqlClient.SqlConnection, 
              System.Data, Version=1.0.3300.0, Culture=neutral, 
              PublicKeyToken=b77a5c561934e089"
           commandType="System.Data.SqlClient.SqlCommand, 
              System.Data, Version=1.0.3300.0, Culture=neutral, 
              PublicKeyToken=b77a5c561934e089"
           parameterType="System.Data.SqlClient.SqlParameter, 
              System.Data, Version=1.0.3300.0, Culture=neutral, 
              PublicKeyToken=b77a5c561934e089"
           parameterDbType="System.Data.SqlDbType, System.Data, 
              Version=1.0.3300.0, Culture=neutral, 
              PublicKeyToken=b77a5c561934e089"
           parameterDbTypeProperty="SqlDbType"
           dataAdapterType="System.Data.SqlClient.SqlDataAdapter, 
              System.Data, Version=1.0.3300.0, Culture=neutral, 
              PublicKeyToken=b77a5c561934e089"
           commandBuilderType="System.Data.SqlClient.SqlCommandBuilder, 
              System.Data, Version=1.0.3300.0, Culture=neutral, 
              PublicKeyToken=b77a5c561934e089"
           parameterNamePrefix="@"/&gt;
                   ...
    &lt;/dataProviders&gt;
    &lt;dataSources&gt;
        &lt;dataSource name="DataSource1" isDefault="true"
           provider="SqlClient"
           connectionString="Server=XXXXX;Database=XXXXXXXX;User 
              ID=XXXX;Password=XXXXXXXX"
           dataOperationsPath=
              "..\..\config\SqlClient.DataSource1.Commands*.config"/&gt;
            .....
    &lt;/dataSources&gt;
&lt;/dataAccessSettings&gt;</PRE>
            <P>This is how all the provider-specific stuff is externalized from 
            the code and put in the CONFIG file.</P>
            <P>Instantiation of the default data source would require the 
            following:</P><PRE lang=cs>IDataSource ds = DataSourceFactory.GetDataSource();</PRE>
            <P>for a named data source:</P><PRE lang=cs>IDataSource ds = DataSourceFactory.GetDataSource(<SPAN class=cpp-string>"DataSource1"</SPAN>);</PRE>
            <P><CODE>IDataCommand</CODE> is the object representing a certain 
            database operation resulting in no output, output parameters or 
            output <CODE>IDataReader</CODE>.</P>
            <P>The command definitions are externalized in an XML file like 
            this:</P><PRE lang=xml>&lt;?xml version="1.0" encoding="utf-8" ?&gt; 
&lt;dataOperations dataSource="DataSource1" 
     xmlns="Framework.DataAccess"&gt;
&lt;dataCommands&gt;
    &lt;dataCommand name="Command1" type="Text"&gt;
        &lt;commandText&gt;INSERT INTO Users(Username) 
            VALUES('user')&lt;/commandText&gt;
    &lt;/dataCommand&gt;
&lt;/dataCommands&gt;
....
&lt;/dataOperations&gt;</PRE>
            <P>A command with two parameters returning nothing can be executed 
            this way:</P><PRE lang=cs>IDataSource ds = DataSourceFactory.GetDataSource();
IDataCommand cmd = ds.GetCommand(<SPAN class=cpp-string>"UpdateUserAmount"</SPAN>);
cmd.Parameters[<SPAN class=cpp-string>"UserID"</SPAN>].Value = userID;
cmd.Parameters[<SPAN class=cpp-string>"Amount"</SPAN>].Value = amount;
cmd.ExecuteNonQuery();</PRE>
            <P>The execution of a command returning <CODE>IDataReader</CODE> 
            looks like this:</P><PRE lang=cs>IDataSource ds = DataSourceFactory.GetDataSource();
IDataCommand cmd = ds.GetCommand(<SPAN class=cpp-string>"ListUsers"</SPAN>);
IDataReader dr = cmd.ExecuteReader();
ArrayList userInfos = <SPAN class=cs-keyword>new</SPAN> ArrayList();
<SPAN class=cs-keyword>while</SPAN>(dr.Read())
{
   userInfos.Add(<SPAN class=cs-keyword>new</SPAN> SampleState.UserInfo(dr.GetInt32(<SPAN class=cs-literal>0</SPAN>)));
}
dr.Close();</PRE>
            <P>Output parameters are retrieved using 
            <CODE>IDataCommand.Parameters[...].Value</CODE>:</P><PRE lang=cs>IDataSource ds = DataSourceFactory.GetDataSource();
IDataCommand cmd = ds.GetCommand(<SPAN class=cpp-string>"GetUserDetails"</SPAN>);
cmd.Parameters[<SPAN class=cpp-string>"UserID"</SPAN>].Value = userID;
cmd.ExecuteNonQuery();
<SPAN class=cs-keyword>byte</SPAN> userAge = (<SPAN class=cs-keyword>byte</SPAN>)cmd.Parameters[<SPAN class=cpp-string>"UserAge"</SPAN>].Value);</PRE>
            <P>Apart from the <CODE>IDataSource.GetCommand</CODE> method there 
            is also the possibility to create commands ad hoc, which will not be 
            cached, like this:</P><PRE lang=cs>IDataSource ds = DataSourceFactory.GetDataSource();    

IDataCommand cmd = ds.CreateCommand(<SPAN class=cpp-string>"InsertUser"</SPAN>, 
    <SPAN class=cpp-string>"InsertUser"</SPAN>, CommandType.StoredProcedure);    
cmd.Parameters.Add(<SPAN class=cpp-string>"Username"</SPAN>, <SPAN class=cpp-string>"@Username"</SPAN>, 
    SqlDbType.NVarChar, <SPAN class=cs-literal>50</SPAN>, ParameterDirection.Input, 
    <SPAN class=cpp-string>"user1"</SPAN>);    
cmd.Parameters.Add(<SPAN class=cpp-string>"UserID"</SPAN>, <SPAN class=cpp-string>"@UserID"</SPAN>, DbType.Int32, 
    ParameterDirection.Output);    

<SPAN class=cs-keyword>int</SPAN> recordsAffected = cmd.ExecuteNonQuery();

<SPAN class=cs-keyword>int</SPAN> userID = (<SPAN class=cs-keyword>int</SPAN>)cmd.Parameters[<SPAN class=cpp-string>"UserID"</SPAN>].Value;</PRE>
            <P>This code however introduces dependencies to a certain data 
            provider if the data provider <CODE lang=cs>XXXDbType <SPAN 
            class=cs-keyword>enum</SPAN></CODE> is used (this is supported as 
            well as the generic <CODE>DbType</CODE>) and to a certain command, 
            you cannot change after that the 
            <CODE>CommandType</CODE>/<CODE>CommandText</CODE> for example 
            without modifying the code.</P>
            <P>Additionally commands can be derived directly from the database. 
            In this case the command name is used to find the stored procedure. 
            All parameter names are accessible by skipping the prefix (for 
            example "@") defined in the <I>Framework.DataAccess.dll.config</I> 
            XML file. The search order for getting a command by name is first 
            the CONFIG files (if any), then the database. An exception is thrown 
            if the data command is not found in either of these.</P>
            <P>Another option is to use <CODE>DataSet</CODE>s as DTOs and 
            <CODE>DataAdapters</CODE> for filling and updating the 
            <CODE>DataSet</CODE>s. There are two ways to handle 
            <CODE>DataAdapters</CODE> in DAC2 - either you define them in the 
            XML CONFIG files or you construct them programmatically in the code, 
            both ways being similar to the DataCommands handling. There is a 
            thin wrapper, called <CODE>IDataSetAdapter</CODE>, around the 
            <CODE>IDbDataAdapter</CODE> with <CODE>Fill</CODE> and 
            <CODE>Update</CODE> methods taking into consideration the DAC2 
            framework. The XML definition of the <CODE>IDataSetAdapter</CODE> is 
            the following:</P><PRE lang=xml>&lt;dataOperations dataSource="DataSource1" 
           xmlns="Framework.DataAccess"&gt;
    &lt;dataSetAdapters&gt;    
      &lt;dataSetAdapter name="Adapter1" populateCommands="true"&gt;
        &lt;selectCommand&gt;gt;
          &lt;dataCommand name="Adapter1_SelectCommand" type="Text"&gt;
            &lt;commandText&gt;SELECT * FROM Users WHERE Username 
                         = @Username&lt;/commandText&gt;
              &lt;parameters&gt;
                &lt;param key="Username" name="@Username" 
                    type="NVarChar" size="50" 
                    direction="Input" /&gt;
              &lt;/parameters&gt;
          &lt;/dataCommand&gt;
        &lt;/selectCommand&gt;
        &lt;tableMappings&gt;
          &lt;tableMapping sourceTable="Table" 
                     dataSetTable="Users"/&gt;
        &lt;/tableMappings&gt;
      &lt;/dataSetAdapter&gt;   
    &lt;/dataSetAdapters&gt;    
&lt;/dataOperations&gt;</PRE>
            <P>You can use the above defined <CODE>IDataSetAdapter</CODE> in the 
            following way:</P><PRE lang=cs>IDataSource ds = DataSourceFactory.GetDataSource();
IDataSetAdapter ad = ds.GetDataSetAdapter(<SPAN class=cpp-string>"Adapter1"</SPAN>);

ad.SelectCommand.Parameters[<SPAN class=cpp-string>"Username"</SPAN>].Value = <SPAN class=cpp-string>"user1"</SPAN>;

DataSet dataSet = <SPAN class=cs-keyword>new</SPAN> DataSet();
ad.Fill(dataSet);</PRE>
            <P>Respectively you can update using an 
            <CODE>IDataSetAdapter</CODE>:</P><PRE lang=cs>IDataSource ds = DataSourceFactory.GetDataSource();
IDataSetAdapter ad = ds.GetDataSetAdapter(<SPAN class=cpp-string>"Adapter1"</SPAN>);

ad.SelectCommand.Parameters[<SPAN class=cpp-string>"Username"</SPAN>].Value = <SPAN class=cpp-string>"user1"</SPAN>;

DataSet dataSet = <SPAN class=cs-keyword>new</SPAN> DataSet();
ad.Fill(dataSet);
dataSet.Tables[<SPAN class=cs-literal>0</SPAN>].Rows[<SPAN class=cs-literal>0</SPAN>][<SPAN class=cs-literal>1</SPAN>] = <SPAN class=cpp-string>"user1MODIFIED"</SPAN>;
recordsAffected = ad.Update(dataSet);</PRE>
            <P>The generation of the 
            <CODE>INSERT</CODE>/<CODE>UPDATE</CODE>/<CODE>DELETE</CODE> commands 
            by a <CODE>CommandBuilder</CODE> is invoked by setting the property 
            <CODE lang=cs>populateCommands=<SPAN 
            class=cs-keyword>true</SPAN></CODE> in the XML CONFIG or after 
            manually calling 
<CODE>IDataSetAdapter.PopulateCommands()</CODE>.</P>
            <P>As I already mentioned, <CODE>IDataSetAdapter</CODE> can be 
            programmatically created in the code without using the XML CONFIG 
            files. Only the <CODE>IDataCommands</CODE> can be defined in the 
            "localizable" XML files, while the data provider agnostic 
            <CODE>IDataSetAdapter</CODE> can be instantiated in the code and its 
            <CODE>Select</CODE>/<CODE>Insert</CODE>/<CODE>Update</CODE>/<CODE>DeleteCommand</CODE> 
            properties can be set to the <CODE>IDataCommands</CODE> retrieved 
            from the CONFIGs:</P><PRE lang=cs>IDataSource ds = DataSourceFactory.GetDataSource();
IDataCommand cmd = ds.GetCommand(<SPAN class=cpp-string>"Command5"</SPAN>);
cmd.Parameters[<SPAN class=cpp-string>"Username"</SPAN>].Value = <SPAN class=cpp-string>"user1"</SPAN>;

IDataSetAdapter ad = ds.CreateDataSetAdapter();
ad.SelectCommand = cmd;
ITableMapping dtm = ad.TableMappings.Add(<SPAN class=cpp-string>"st"</SPAN>,<SPAN class=cpp-string>"dt"</SPAN>);

ad.PopulateCommands();

DataSet dataSet = <SPAN class=cs-keyword>new</SPAN> DataSet();
<SPAN class=cs-keyword>int</SPAN> recordsAffected = ad.Fill(dataSet);

dataSet.Tables[<SPAN class=cs-literal>0</SPAN>].Rows[<SPAN class=cs-literal>0</SPAN>][<SPAN class=cs-literal>1</SPAN>] = <SPAN class=cpp-string>"user1MODIFIED"</SPAN>;
recordsAffected = ad.Update(dataSet);</PRE>
            <P>Defining <CODE>IDataSetAdapters</CODE> in the CONFIG files may 
            add flexibility (if needed), although their place may not be there 
            in general, as they are data provider agnostic (this is the 
            difference between them and the <CODE>IDataCommands</CODE>).</P>
            <P>One last point concerning the <CODE>IDataSetAdapters</CODE> is 
            that they fill/update <CODE>DataSet</CODE>s. Other adapters may 
            fill/update <CODE>Hashtables</CODE> or even custom business objects 
            (look at SQLMaps in the <A 
            href="http://www.ibatis.com/common/download.html" 
            target=_blank>IBatis db layer</A>). It is questionable, however, 
            whether the definition of the retrieval/modification of custom 
            business objects in CONFIG files (and the added complexity) really 
            buys something ...</P>
            <P>The <CODE>Framework.DataAccess</CODE> component should be used in 
            the following way. The <CODE>IDataSource</CODE> should be retrieved 
            in the data layer classes (a good place is in the constructor and 
            stored in a private variable) and an <CODE>IDataCommand</CODE> 
            should be retrieved from the <CODE>IDataSource</CODE> using 
            <CODE>IDataSource.GetCommand</CODE> method. This way, all the 
            database/provider/command specific code is external to the app and 
            resides in CONFIG files; hence it can be easily replaced. Upon each 
            modification of the CONFIG files an event is triggered and the 
            internal cache of the <CODE>DataSourceFactory</CODE> is internally 
            used by a certain <CODE>IDataSource</CODE>. 
            <CODE>DataCommandFactory</CODE> is refilled with the fresh info 
            without stopping the application.</P>
            <H2>Using the Framework.Transactions code</H2>
            <P><I>Framework.Transactions.dll</I> is the other component in the 
            package, together with the <I>Framework.DataAccess.dll</I>. All the 
            credits for the idea about transaction contexts goes to David 
            Goldstein, whom I would like to thank personally for sharing it with 
            me!</P>
            <P><CODE>TransactionContextFactory</CODE> is the object servicing 
            the requests for new <CODE>TransactionContexts</CODE>. A parameter 
            of type <CODE>TransactionAffinity</CODE> is passed to it. The values 
            of the <CODE>TransactionAffinity</CODE> <CODE lang=cs><SPAN 
            class=cs-keyword>enum</SPAN></CODE> are the following:</P><PRE lang=cs>    <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>enum</SPAN> TransactionAffinity
    {
        <SPAN class=cs-comment>//creates new transaction</SPAN>
        RequiresNew,
        <SPAN class=cs-comment>//creates new transaction if no current transaction</SPAN>
        Required,
        <SPAN class=cs-comment>//uses current transaction if present</SPAN>
        Supported,
        <SPAN class=cs-comment>//does not use a transaction</SPAN>
        NotSupported
    }</PRE>
            <P><CODE>TransactionAffinity</CODE> values closely match the COM+ 
            Transaction types (also in EnterpriseServices). So a 
            <CODE>TransactionContext</CODE> is requested in the following 
            way:</P><PRE lang=cs>TransactionContext ctx = 
   TransactionContextFactory.GetContext(
          TransactionAffinity.RequiresNew);</PRE>
            <P>The standard structure for using a 
            <CODE>TransactionContext</CODE> is the following:</P><PRE lang=cs>    ctx.Enter();
    <SPAN class=cs-comment>//call bll/dal methods(db operations)</SPAN>
    ctx.VoteCommit() or ctx.VoteRollback()
    ctx.Exit();</PRE>
            <P>If we add exception handling it turns to the following:</P><PRE lang=cs>    TransactionContext ctx = 
        TransactionContextFactory.GetContext(
               TransactionAffinity.RequiresNew);

    <SPAN class=cs-keyword>try</SPAN> 
    {
        ctx.Enter();

        <SPAN class=cs-comment>//call bll/dal methods(db operations)</SPAN>

        ctx.VoteCommit();
    }
    <SPAN class=cs-keyword>catch</SPAN>(Exception e) 
    {
        ctx.VoteRollback();
    }
    <SPAN class=cs-keyword>finally</SPAN> 
    {
        ctx.Exit();
    }</PRE>
            <P>There is also a short way for managing <CODE>Enter</CODE> and 
            <CODE>Exit</CODE>:</P><PRE lang=cs><SPAN class=cs-keyword>using</SPAN>(TransactionContext ctx = 
     TransactionContextFactory.EnterContext(
               TransactionAffinity.Supported)) 
    {
        <SPAN class=cs-comment>//already entered</SPAN>

        ctx.VoteCommit() or exception <SPAN class=cs-keyword>for</SPAN> example
        <SPAN class=cs-comment>//automatic exit upon leaving the scope ...</SPAN>
    }</PRE>
            <P>The nice thing here is that a <CODE>TransactionContext</CODE> can 
            be created and entered in any logical application layer, without any 
            knowledge of the caller. This is an explicit way of declaring the 
            needs of the code at any level. Several contexts may be used in the 
            scope of a method as well as a context may span several methods. 
            There are no limitations as the existing ones in COM+ ;)</P>
            <P>The <CODE>TransactionContext</CODE> has also an 
            <CODE>IsolationLevel</CODE> property of type 
            <CODE>TransactionIsolationLevel</CODE>, which determines the 
            isolation level of the opened transaction. Remember that only 
            contexts which control transactions (i.e. Controlling Contexts - 
            RequiresNew, Required) consider this property, others don't care 
            about its value.</P><PRE lang=cs>    <SPAN class=cs-keyword>public</SPAN> <SPAN class=cs-keyword>enum</SPAN> TransactionIsolationLevel
    {
        ReadUncommitted,
        ReadCommitted,
        RepeatableRead,
        Serializable
    }</PRE>
            <P>The <I>Framework.DataAcccess.dll</I> contains several transaction 
            handling implementations:</P>
            <UL>
              <LI><CODE>HomeGrownTransactionHandler</CODE> (internal handling of 
              connection and transactions), 
              <LI><CODE>SWCTransactionHandler</CODE> (uses services without 
              components in COM+ 1.5) and 
              <LI><CODE>ESTransactionHandler</CODE> (uses 
              <CODE>ServicedComponent</CODE>s without requiring that the 
              business classes inherit from <CODE>ServicedComponent</CODE>!). 
              </LI></UL>
            <P>The following section in <I>Framework.DataAccess.dll</I> 
            determines which one should be used (a switch):</P>
            <P><I>[Editor Note : Line Breaks added to avoid scrolling]</I></P><PRE lang=xml>&lt;transactionHandlingSettings xmlns="Framework.Transactions"&gt;
  &lt;transactionHandler name="HomeGrown" 
    handlerType="Framework.DataAccess.TransactionHandling.
                                HomeGrownTransactionHandler, 
             Framework.DataAccess.TransactionHandling"
            /&gt;

&lt;/transactionHandlingSettings&gt;</PRE>
            <P>The <CODE>Framework.Transactions</CODE> component should be used 
            in the following way. The Facade and BLL layers should reference it 
            and use the <CODE>TransactionContextFactory</CODE> for instantiating 
            <CODE>TransactionContexts</CODE> and should use the above described 
            skeleton code to 
            <CODE>Enter</CODE>/<CODE>VoteCommit</CODE>/<CODE>VoteRollback</CODE>/<CODE>Exit</CODE> 
            the context. <I>Framework.DataAccess.dll</I> internally references 
            <I>Framework.Transactions.dll</I> and subscribes to the events so 
            that it can manage transactions and connections corresponding to the 
            currently available transaction contexts. That's how transactions 
            are controlled from the upper layers and the data layer picks them 
            up and uses them in the data access.</P>
            <H2>CommandText runtime modification</H2>
            <P>You have certainly encountered the following problem - there is a 
            requirement to query data (usually for reporting purposes) with a 
            lot of optional filters. In this case if you use stored procedures, 
            you have to add the filters as optional sproc parameters, which 
            results in a very bad execution plan (at least in SQL Server). Of 
            course the answer to this is dynamic SQL, which omits the optional 
            parameters for which no value has been supplied. But how should this 
            dynamic SQL be built? Inside the code? One possible way of dealing 
            with this is the <CODE>replaceByParamValues</CODE> tag which can be 
            used in the <CODE>dataCommand</CODE> definition. In this way it can 
            be specified which parts of the <CODE>CommandText</CODE> can be 
            omitted in case an input parameter has a certain value, or what 
            additional text should be added (by replacing some placeholder). 
            Here is an example:</P><PRE lang=xml>&lt;dataCommand name="SelectUsersCommand2" type="Text"&gt;
   &lt;commandText&gt;
     &lt;![CDATA[
      SELECT 
      COUNT(*)
      FROM Users AS U1
      WHERE 1=1
      AND U1.UserID &lt; @UserID]]&gt;
   &lt;/commandText&gt;
   &lt;replaceByParamValues&gt;
     &lt;replaceByParamValue paramName="@UserID" 
                      paramValue="DBNull.Value"&gt;
       &lt;oldString&gt;&lt;![CDATA[AND U1.UserID &lt; @UserID]]&gt;
       &lt;/oldString&gt;
       &lt;newString&gt;&lt;/newString&gt;
     &lt;/replaceByParamValue&gt;
   &lt;/replaceByParamValues&gt;
   &lt;parameters&gt;
     &lt;param name="@UserID" type="Int" direction="Input" /&gt;
   &lt;/parameters&gt;   
&lt;/dataCommand&gt;</PRE>
            <H2>History</H2>
            <UL>
              <LI>13.01.2005 
              <UL>
                <LI>Code update. Added command timeout, possibility for creating 
                DB objects instead of cloning them if the provider does not 
                support cloning, as well as the new 
                <CODE>replaceByParamValues</CODE> tags which allow for 
                customizing the <CODE>CommandText</CODE> at runtime. </LI></UL>
              <LI>23.09.2004 
              <UL>
                <LI>Reorganized CONFIG files (moved to <I>App.config</I>). Added 
                <CODE>ESTransactionHandler</CODE> (uses COM+ and 
                <CODE>ServicedComponent</CODE> with no need to inherit the 
                business/service classes from <CODE>ServicedComponent</CODE>). 
                Added <CODE>ColumnMappings</CODE> to <CODE>DataSetAdapter</CODE> 
                definition. </LI></UL>
              <LI>08.07.2004 
              <UL>
                <LI>Added the possibility to derive sprocs directly from the 
                datasource (if there is no cmd found in the CONFIG file (or 
                there is no CONFIG file) then the database will be queried 
                (using <CODE>DeriveCommand</CODE>). </LI></UL>
              <LI>14.04.2004 
              <UL>
                <LI>bugfixes (<CODE>DataSetAdapter</CODE>), no new features. 
                </LI></UL>
              <LI>20.10.2003 
              <UL>
                <LI>download update (HomeGrown Transaction implementation 
                bugfix, added "<CODE>parameterNamePrefix</CODE>" and 
                "<CODE>key</CODE>" CONFIG XML attributes so that the parameter 
                names are also isolated from the concrete DB used, 
                <CODE>Framework.Configuration</CODE> separated etc.). </LI></UL>
              <LI>17.09.2003 
              <UL>
                <LI>download update (SWC bugfix, <I>installinstructions.htm</I> 
                re-included). </LI></UL>
              <LI>11.09.2003 
              <UL>
                <LI>Services Without Components transaction handling 
                implementation (to be tested on Windows Server 2003). XML CONFIG 
                schema changes (have a look at the code download). 
                <CODE>Commit</CODE> and <CODE>Rollback</CODE> changed to 
                <CODE>VoteCommit</CODE> and <CODE>VoteRollback</CODE>, the 
                <CODE>Exit()</CODE> method now completes the transaction. 
                <CODE>ITransactionContext</CODE> interface removed etc. impl. 
                changes and fixes. </LI></UL>
              <LI>16.08.2003 
              <UL>
                <LI>Restructuring in two components 
                (<I>Framework.DataAccess.dll</I> and 
                <I>Framework.Transactions.dll</I>). 
                <CODE>TransactionContexts</CODE> implementation. </LI></UL>
              <LI>27.06.2003 
              <UL>
                <LI>Fixes. </LI></UL>
              <LI>10.06.2003 
              <UL>
                <LI>Added DataSet/Adapter support; changed API for manipulating 
                Parameters( <CODE>cmd.Parameters[...].Value</CODE> instead of 
                <CODE>cmd.Set</CODE>/<CODE>GetParameterValue</CODE>); 
                <CODE>DataCommandFactory</CODE> -&gt; 
                <CODE>DataOperationFactory</CODE>, respectively CONFIG attribute 
                definitions <CODE>commandDir</CODE> -&gt; 
                <CODE>dataOperationsDir</CODE>, <CODE>commandFileMask</CODE> 
                -&gt; <CODE>dataOperationsFileMask</CODE>; added 
                <CODE>SourceColumn</CODE> and <CODE>SourceVersion</CODE> 
                attributes to parameter definition; projects now converted to 
                VS.NET 2003, .NET Framework 1.1. </LI></UL>
              <LI>10.04.2003 
              <UL>
                <LI>Initial functional prototype version without proper 
                exceptions and arguments checking/error handling. 
            </LI></UL></LI></UL>
            <H2>Sample installation instructions</H2>
            <P>Read the <I>InstallInstructions.htm</I> in the root of the demo 
            project.</P>
            <H2>Request</H2>
            <P>I would appreciate your remarks/corrections/suggestions.</P>
            <H2>Questions</H2>
            <UL>
              <LI>Can someone test the <CODE>SWCTransactionHandler</CODE> 
              implementation on Windows Server 2003 and tell me if it works? ;) 
              </LI></UL>
            <H2>Thanks</H2>
            <P>I want to thank Dan Fox for his Data Factory example which gave 
            me some of the ideas as well as David Goldstein who suggested the 
            design of the explicit transaction contexts.</P><!-- Article Ends --></DIV></SPAN>
            <SCRIPT 
            src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>Deyan Petrov</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><BR></TD>
                <TD class=smallText>
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=25272">here</A> 
                  to view Deyan Petrov's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular C# Database articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/sqldodont.asp">SQL 
                    Server DO's and DONT's</A>
                    <DIV class=smallText>SQL Server database best 
practices</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/SqlInjectionAttacks.asp">SQL 
                    Injection Attacks and Some Tips on How to Prevent Them</A>
                    <DIV class=smallText>Discusses various aspects of SQL 
                    Injection attacks, what to look for in your code, and how to 
                    secure it against SQL Injection attacks.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/relationaladonet.asp">Inserting 
                    relational data using DataSet and DataAdapter</A>
                    <DIV class=smallText>This article describes the process of 
                    inserting data in a DataSet and then submitting this changes 
                    to the database. It targets the issue when having 
                    IDENTITY/AutoNumber columns in the database.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/DatabaseAcessWithAdoNet1.asp">Using 
                    ADO.NET for beginners</A>
                    <DIV class=smallText>ADO.NET for beginners.</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2257&cb=3456619\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</SCRIPT>
                </TD></TR></TBODY></TABLE>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden value=DAC2/cs/database4/9/2003 
            name=vote_name> <INPUT type=hidden value=/cs/database/dac2.asp 
            name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/cs/database/dac2.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD 
                style="PADDING-RIGHT: 2px; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; BACKGROUND-COLOR: #eee" 
                width=120 height=60>
                  <DIV align=center>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2225&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FDundas%5F120x60%2Egif&C=False&id=2225&cb=3456622\" alt=\"\" border=0 width=120 height=60></a>");</SCRIPT>
                  </DIV></TD>
                <TD width=100>&nbsp;</TD>
                <TD width=468 height=60><SPAN id=AdBanner5>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2350&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FCWS%5Fcharting%5F468x60%2Ejpg&C=False&id=2350&cb=3456607\" alt=\"\" border=0 width=468 height=60></a>");</SCRIPT>
                  </SPAN></TD></TR></TBODY></TABLE></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	document.write("<br />Report as <a href='#xx" + MsgID.toString() + "xx' title='Mark as Spam' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-1)'>Spam</a> or ");
	document.write("<a href='#xx" + MsgID.toString() + "xx' title='Mark as Abuse' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-2)'>Abuse</a>");
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=15129"><IMG 
                              height=15 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION value=3>Expanded 
                                (Supporters only)</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 25 of 431 (Total: 
                              431) (<A 
                              href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <A class=HoverLink 
                              href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;fr=26" 
                              name=HoverNL>Next</A> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1706459_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1706459xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1706459#xx1706459xx" 
                                name=1706459><B>dbCommand = 
                                (IDbCommand)getCommandMethod.Invoke(_commandBuilder, 
                                null) Problem for Sybase Table.</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2473289"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>zhuomiao.ma@bankofamerica.com</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>16:24 10 
                                Oct 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1706459_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi, 
                                Deyan,<BR><BR>Thanks your nice Transaction 
                                Handling Framework, I am testing this against 
                                our Sybase, I have some problem when I 
                                test:<BR>1) 
                                <DATASETADAPTERS><BR><BR><DATASETADAPTER 
                                populateCommands="true" 
                                name="Adapter1"><BR><BR>&lt;selectCommand 
                                name="Adapter1_SelectCommand" 
                                type="Text"&gt;<BR><BR><COMMANDTEXT>SELECT * 
                                FROM Users </COMMANDTEXT><BR><BR>2) I got base 
                                {"No base table specified"} 
                                System.SystemException 
                                {System.InvalidOperationException} error, the 
                                code line is 
                                PopulateCommands:<BR><BR><BR><BR>if(_insertCommand 
                                == null)<BR><BR>{<BR><BR>getCommandMethod = 
                                _commandBuilder.GetType().GetMethod("GetInsertCommand");<BR><BR>dbCommand 
                                = 
                                (IDbCommand)getCommandMethod.Invoke(_commandBuilder, 
                                null);<BR><BR>_insertCommand = new 
                                DataCommand(dbCommand, 
                                _dataSource);<BR><BR>StackTrace " at 
                                Sybase.Data.AseClient.AseCommandBuilder.CheckBaseTable()\r\n 
                                at 
                                Sybase.Data.AseClient.AseCommandBuilder.GetInsertCommand()" 
                                string<BR><BR>3) The Syabse Configure 
                                is:<BR><BR><BR><BR><DATAPROVIDER 
                                name="AseClient" 
                                <br><BR>connectionType="Sybase.Data.AseClient.AseConnection, 
                                Sybase.Data.AseClient, Version=1.1.376.0, 
                                Culture=neutral, 
                                PublicKeyToken=26e0f1529304f4a7"<BR><BR>commandType="Sybase.Data.AseClient.AseCommand, 
                                Sybase.Data.AseClient, Version=1.1.376.0, 
                                Culture=neutral, 
                                PublicKeyToken=26e0f1529304f4a7"<BR><BR>parameterType="Sybase.Data.AseClient.AseParameter, 
                                Sybase.Data.AseClient, Version=1.1.376.0, 
                                Culture=neutral, 
                                PublicKeyToken=26e0f1529304f4a7"<BR><BR>parameterDbType="Sybase.Data.AseClient.AseDbType, 
                                Sybase.Data.AseClient, Version=1.1.376.0, 
                                Culture=neutral, 
                                PublicKeyToken=26e0f1529304f4a7"<BR><BR>parameterDbTypeProperty="AseDbType"<BR><BR>dataAdapterType="Sybase.Data.AseClient.AseDataAdapter, 
                                Sybase.Data.AseClient, Version=1.1.376.0, 
                                Culture=neutral, 
                                PublicKeyToken=26e0f1529304f4a7"<BR><BR>commandBuilderType="Sybase.Data.AseClient.AseCommandBuilder, 
                                Sybase.Data.AseClient, Version=1.1.376.0, 
                                Culture=neutral, 
                                PublicKeyToken=26e0f1529304f4a7"<BR><BR>parameterNamePrefix="@" 
                                <BR><BR>/&gt;<BR><BR><BR><BR>4) the Users Table 
                                at Sybase is: <BR><BR><BR><BR>CREATE TABLE 
                                dbo.Users<BR>(<BR>UserID int NOT 
                                NULL,<BR>Username nvarchar(50) NULL,<BR>Amount 
                                money NULL,<BR>Age tinyint NULL,<BR>CreatedOn 
                                datetime NULL,<BR>CONSTRAINT 
                                Users_15250461062<BR>UNIQUE NONCLUSTERED 
                                (UserID)<BR>)<BR>LOCK ALLPAGES<BR>go<BR>IF 
                                OBJECT_ID('dbo.Users') IS NOT NULL<BR>PRINT 
                                '&lt;&lt;&lt; CREATED TABLE dbo.Users 
                                &gt;&gt;&gt;'<BR>ELSE<BR>PRINT '&lt;&lt;&lt; 
                                FAILED CREATING TABLE dbo.Users 
                                &gt;&gt;&gt;'<BR>go<BR><BR><BR><BR><BR>Could you 
                                help me something? I spent a couple of days of 
                                this now, no luck at 
                                all.<BR><BR><BR><BR><BR><BR>Zhuomiao (Michael) 
                                Ma <BR>AVP; CNSLT - APPS PROG <BR>WIM BT-ASE 
                                CLIENT REPORTING / APP 
                                DEVELOPMENT<BR><BR><BR><BR>Bank of 
                                America<BR>Mail Code: NY5-513-15-09<BR><BR>26 
                                BROADWAY<BR>NEW YORK NY 10004 <BR><BR>Phone: 
                                212.747.2034<BR>Email: 
                                zhuomiao.ma@bankofamerica.com 
                                <BR><BR><BR><BR>Michael 
                                Ma<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1706459">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1706459">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1706459&amp;forumid=15129&amp;select=1706459#xx1706459xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1706459#xx1706459xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2473289,1706459);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1544807_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1544807xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1544807#xx1544807xx" 
                                name=1544807><B>nunit.framework.dll is 
                                missed</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=3109123"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>kiran.k</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>15:29 22 
                                Jun 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1544807_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I 
                                downloaded the source code. In that 
                                nunit.framework.dll is not found. 
                                <BR><BR>Kiran.K<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1544807">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1544807">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1544807&amp;forumid=15129&amp;select=1544807#xx1544807xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1544807#xx1544807xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(3109123,1544807);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1711350_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1711350xx></A><IMG 
                                height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1711350#xx1711350xx" 
                                name=1711350>Re: nunit.framework.dll is 
                                missed</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2473289"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>zhuomiao.ma@bankofamerica.com&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>10:51 13 Oct 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1711350_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Download 
                                NUnit-2.2.8-net-2.0.msi this file and install 
                                it. <BR><BR>Regards,<BR><BR>Michael 
                                Ma<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1711350">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1711350">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1544807&amp;forumid=15129&amp;select=1711350#xx1711350xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1711350#xx1711350xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(2473289,1711350);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1536828_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1536828xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1536828#xx1536828xx" 
                                name=1536828><B>can't find the refrence of 
                                nunit</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2715500"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>KENTDEAN</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>6:05 17 
                                Jun 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1536828_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>open 
                                the src file by VS.Net,but can't find the 
                                refrence of nunit.framework,where is the nunit? 
                                <BR><BR>Kent<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1536828">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1536828">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1536828&amp;forumid=15129&amp;select=1536828#xx1536828xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1536828#xx1536828xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2715500,1536828);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1484327_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1484327xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1484327#xx1484327xx" 
                                name=1484327><B>Precision and Scale</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=582068"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Juan Manuel Bastidas 
                                Bonilla</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>15:35 11 
                                May 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1484327_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hello<BR><BR>I'm working 
                                with DAC2 and its an amazing framework, I like 
                                ir very much.<BR>In this moment i have a 
                                problem, beacuse of precision and scale 
                                attributes from the parameters. Why cant I 
                                specify this 2 attributes for a parameter of 
                                DECIMAL type in the commnads configuration 
                                file?? And if I'm using numeric type, what 
                                SqlDbType I have to use??<BR><BR>What is the 
                                last version of DAC2? Maybe I dont have the last 
                                version!! <BR><BR>Juan Manuel Bastidas 
                                Bonilla<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1484327">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1484327">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1484327&amp;forumid=15129&amp;select=1484327#xx1484327xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1484327#xx1484327xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 4.4 (2 
                                votes).
                                <SCRIPT language=Javascript>MsgVoteForm(582068,1484327);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1481222_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1481222xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1481222#xx1481222xx" 
                                name=1481222><B>is it work fine on .net 2.0 with 
                                sqlserver 2000</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2990165"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>narendra 
                                bhabha</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>3:34 10 
                                May 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1481222_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>hi 
                                ...<BR>this is narendra bhabha ...<BR>i am using 
                                Data Access and Transaction Handling Framework 
                                since one year.....on .net 1.1 with 
                                oracle..<BR>it is working fine with out any 
                                problemm.. <BR><BR>i want to know ,is Data 
                                Access and Transaction Handling 
                                Framework<BR>works fine on .net 2.0 with 
                                sqlserver 2000 for asp.net 2.0 using 
                                Estranscation handler...<BR><BR>pls help me .... 
                                by giving proper info....... for this 
                                requirement... <BR><BR>narendra bhabha 
                                sm<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1481222">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1481222">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1481222&amp;forumid=15129&amp;select=1481222#xx1481222xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1481222#xx1481222xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(2990165,1481222);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1462628_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1462628xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1462628#xx1462628xx" 
                                name=1462628><B>Deadlock problems</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=867658"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Thiago 
                                Rafael</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>16:52 25 
                                Apr 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1462628_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Deyan,<BR><BR>I have an aspx page that does a 
                                lot database selects for some report. Sometimes 
                                under certain circumstances it ends in this 
                                error:<BR><BR><CODE><BR>System.Data.SqlClient.SqlException: 
                                Transaction (Process ID ###) was deadlocked on 
                                lock resources with another process and has been 
                                chosen as the deadlock victim. Rerun the 
                                transaction.<BR></CODE><BR><BR>I'm trying to 
                                figure out what transaction might cause this 
                                error, but as I said I use only selects (no 
                                updates/inserts/deletes) on the page, so there 
                                is no transaction here.<BR>Do you know if 
                                there's some internal transaction in DAC2 that 
                                could be locking some resource?<BR><BR>Do you 
                                think it could be caused by another process of 
                                another ASP.NET application?<BR><BR>I'm really 
                                confused, if someone could help me I'll be very 
                                thankful.<BR><BR>Thank you, and sorry by my bad 
                                english. <BR><BR>--<BR>Thiago Rafael<BR><BR>-- 
                                modified at 16:55 Tuesday 25th April, 
                                2006<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1462628">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1462628">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1462628&amp;forumid=15129&amp;select=1462628#xx1462628xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1462628#xx1462628xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(867658,1462628);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1463058_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1463058xx></A><IMG 
                                height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1463058#xx1463058xx" 
                                name=1463058>Re: Deadlock problems</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=25272"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Deyan 
Petrov&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>3:13 26 Apr 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1463058_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Rafael,<BR><BR>Depending on the database, there 
                                is a default Transaction Isolation level set, 
                                even if you select records only. This means, 
                                that also Select statements create Locks, and 
                                can potentially collide with other statements 
                                running at the same time against the same db 
                                objects. I would recommend that you reduce the 
                                transaction isolation level, so that no locks 
                                are created. In MS Sql server you can do that by 
                                including the SET TRANSACTION ISOLATION LEVEL 
                                READ UNCOMMITTED at the beginning of your db 
                                script, or by adding the WITH (NOLOCK) 
                                statements besides every table name in your 
                                select statement.<BR><BR>The above is under the 
                                assumption that your db script ***really*** does 
                                only selects. If it creates temp tables, or does 
                                updates etc the reason for the deadlocsk would 
                                be another one.<BR><BR>Br,<BR>Deyan 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1463058">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1463058">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1462628&amp;forumid=15129&amp;select=1463058#xx1463058xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1463058#xx1463058xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(25272,1463058);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1415059_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1415059xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1415059#xx1415059xx" 
                                name=1415059><B>Timeout</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=867658"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Thiago 
                                Rafael</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>13:13 20 
                                Mar 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1415059_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Deyan,<BR><BR>How do I configure the command 
                                timeout?<BR><BR>I have a heavy query and it 
                                always ends in "Timeout expired. The timeout 
                                period elapsed prior to completion of the 
                                operation or the server is not 
                                responding."<BR><BR>I just updated to the last 
                                version but I don't know how to set the 
                                timeout.<BR><BR>Thank you. <BR><BR>--<BR>Thiago 
                                Rafael<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1415059">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1415059">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1415059&amp;forumid=15129&amp;select=1415059#xx1415059xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1415059#xx1415059xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(867658,1415059);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1421133_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1421133xx></A><IMG 
                                height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1421133#xx1421133xx" 
                                name=1421133>Re: Timeout</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=25272"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Deyan 
Petrov&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>11:52 24 Mar 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1421133_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Thiago,<BR><BR>You have to create a dataCommand 
                                in a config file. <BR><BR>The dataCommand can 
                                either contain the name of a sproc, with type = 
                                StoredProcedure, or directly the sql, with type 
                                = Text. Another attribute of the dataCommand is 
                                the timeout (in seconds). So you can write 
                                something like 
                                this:<BR><BR><CODE><BR>&lt;dataCommand 
                                name="SelectUsersCommand2" type="Text" 
                                timeout="600"&gt;<BR>...<BR>&lt;/dataCommand&gt;<BR></CODE><BR><BR>Br,<BR>Deyan 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1421133">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1421133">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1415059&amp;forumid=15129&amp;select=1421133#xx1421133xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1421133#xx1421133xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(25272,1421133);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1407274_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1407274xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1407274#xx1407274xx" 
                                name=1407274><B>SQL Batches</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=952441"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>rhaps0dy_</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>10:36 14 
                                Mar 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1407274_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Deyan<BR><BR>Firstly a great tool, thank you, i 
                                have used it for about 12 months but so far only 
                                used it to access SQL Server.<BR><BR>I have a 
                                question about sql batches, how/if are these 
                                implemented. I am attempting to write an 
                                application that will run on both sql server and 
                                microsoft access. <BR><BR>Obviously mimicing 
                                stored procedures in Microsoft Access is a 
                                challenge, and was hoping "SQL Batches" 
                                mentioned in the objectives may be what I am 
                                after. I can't see any info on how to implement 
                                them or what the syntax would be in the commands 
                                configuration file.<BR><BR>for example how would 
                                I create a command that inserted a record and 
                                returned in someway the newly created id using 
                                an "sql batch".<BR><BR>thanks for your time 
                                <BR><BR>Shane <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1407274">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1407274">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1407274&amp;forumid=15129&amp;select=1407274#xx1407274xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1407274#xx1407274xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(952441,1407274);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1421127_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1421127xx></A><IMG 
                                height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1421127#xx1421127xx" 
                                name=1421127>Re: SQL Batches</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=25272"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Deyan 
Petrov&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>11:48 24 Mar 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1421127_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Well, 
                                there is at least one example in the article 
                                which shows a dataCommand definition in a config 
                                file. You can also take a look at the example 
                                code.<BR><BR>I have already forgotten how MS 
                                Access worked, but I am sure you can get the id 
                                after an insert and set an output parameter to 
                                its value.<BR><BR>Br,<BR>Deyan 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1421127">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1421127">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1407274&amp;forumid=15129&amp;select=1421127#xx1421127xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1421127#xx1421127xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(25272,1421127);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1480042_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1480042xx></A><IMG 
                                height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1480042#xx1480042xx" 
                                name=1480042>Re: SQL Batches</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=369362"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>versteijn&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>9:31 9 May 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1480042_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>If you 
                                are in a transaction you can do something 
                                like<BR><BR>select @@identity from 
                                mytable<BR><BR>after each insert to mytable. 
                                This will return the latest inserted ID value 
                                for that table in the current 
                                transaction/context. Batches like they are known 
                                in SQL Server do not exist in MS Access though. 
                                You should send commands one by one.<BR><BR>Hope 
                                this helps<BR>Good luck<BR><BR>Freek Versteijn 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1480042">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1480042">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1407274&amp;forumid=15129&amp;select=1480042#xx1480042xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1480042#xx1480042xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(369362,1480042);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1386353_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1386353xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1386353#xx1386353xx" 
                                name=1386353><B>Excellent works on ASP.NET 2.0 
                                &amp; Oracle</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=714158"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>crabo</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>5:06 27 
                                Feb 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1386353_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Excellent works on ASP.NET 
                                2.0 &amp; Oracle!<BR><BR>Thanks to your great 
                                job! 
                                <BR><BR>http://blog.csdn.net/crabo<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1386353">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1386353">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1386353&amp;forumid=15129&amp;select=1386353#xx1386353xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1386353#xx1386353xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(714158,1386353);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1334762_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1334762xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1334762#xx1334762xx" 
                                name=1334762><B>Problem with Clone and DB2 
                                Provider</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=238386"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>pefr</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>11:23 13 
                                Jan 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1334762_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Deyan,<BR><BR>We're using your Framework with 
                                IBM DB2 ISeries Provider for .Net which do not 
                                implement the "Cloneable" interface.<BR><BR>So 
                                even if your last Framework upgrade can bypass 
                                this problem, we got an error when executing a 
                                command with some parameters.<BR><BR>The 
                                behavior is the same when we're using SQLServer 
                                Provider and force the Framework to ignore the 
                                ICloneable interface.<BR><BR>Finally we found 
                                and resolved the problem by adding the copy of 
                                parameters collection in your DataCommand.Clone 
                                method (see the bold section below) 
                                :<BR><BR>.........<BR>else<BR>{<BR>dbCommand = 
                                (IDbCommand)Activator.CreateInstance(<BR>_dataSource.Provider.CommandObjectType); 
                                <BR>dbCommand.CommandType = 
                                _dbCommand.CommandType;<BR>dbCommand.CommandText 
                                = 
                                _dbCommand.CommandText;<BR>dbCommand.CommandTimeout 
                                = _dbCommand.CommandTimeout;<BR><BR><B>for (int 
                                i = 0; i &lt;= _dbCommand.Parameters.Count-1; 
                                i++) <BR>{<BR>IDbDataParameter 
                                param=_dbCommand.CreateParameter();<BR>param = 
                                (IDbDataParameter)_dbCommand.Parameters[i];<BR>dbCommand.Parameters.Add(param);<BR>}</B> 
                                <BR>}<BR>.........<BR><BR>This correction works 
                                fine and now we can use your Framework with our 
                                DB2/400 database <IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/smiley_wink.gif" 
                                align=absMiddle><BR><BR>Is this solution the 
                                good way according to the whole design of your 
                                framework ?<BR><BR>Thanks again for your great 
                                job.<BR>Regards.<BR><BR>Philippe.<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1334762">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1334762">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1334762&amp;forumid=15129&amp;select=1334762#xx1334762xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1334762#xx1334762xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(238386,1334762);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1337277_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1337277xx></A><IMG 
                                height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1337277#xx1337277xx" 
                                name=1337277>Re: Problem with Clone and DB2 
                                Provider</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=25272"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Deyan 
Petrov&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>18:33 16 Jan 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1337277_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hmm, at 
                                first glance the code in bold doesn't look good. 
                                <BR><BR>The line <BR><BR><CODE>IDbDataParameter 
                                param=_dbCommand.CreateParameter();</CODE><BR><BR>creates 
                                a new object of type IDbDataParameter. On the 
                                next line you effectively drop this object and 
                                point the reference to the template 
                                _dbcommand.Parameters[i]:<BR><BR><CODE>param = 
                                (IDbDataParameter)_dbCommand.Parameters[i];</CODE><BR><BR>Correct 
                                me if I am wrong, but after these 2 lines you 
                                get simply another reference to the 
                                _dbCommand.Parameters[i], what you do is that 
                                you don't really copy the IDbDataParameter, you 
                                just get another reference to it. That's why you 
                                can simply skip the first line and write 
                                directly:<BR><BR><CODE>IDbDataParameter 
                                param=(IDbDataParameter)_dbCommand.Parameters[i];</CODE><BR><BR>Of 
                                course, in both cases I would expect problems, 
                                especially if there are multiple thread running, 
                                as every thread will use in fact the same 
                                IDbDataParameter and changing it's value will 
                                lead to some strange effects on other 
                                threads...<BR><BR>A correct way would be to 
                                assign all properties of the newly created param 
                                (first line) one by one, to the values of the 
                                properties of the 
                                (IDbDataParameter)_dbCommand.Parameters[i].<BR><BR>Br,<BR>Deyan 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1337277">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1337277">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1334762&amp;forumid=15129&amp;select=1337277#xx1337277xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1337277#xx1337277xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(25272,1337277);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1347411_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1347411xx></A><IMG 
                                height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=36><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1347411#xx1347411xx" 
                                name=1347411>Re: Problem with Clone and DB2 
                                Provider</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=238386"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>pefr&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>11:22 25 Jan 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1347411_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=36><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Deyan,<BR><BR>Thanks to reply.<BR><BR>After 
                                debug, we modified our "parameter's cloning" 
                                code as ...<BR><BR>for (int i = 0; i &lt;= 
                                _dbCommand.Parameters.Count-1; i++) 
                                <BR>{<BR>IDbDataParameter 
                                paramNew=dbCommand.CreateParameter();<BR><BR>IDbDataParameter 
                                paramOld=(IDbDataParameter)_dbCommand.Parameters[i];<BR><BR>paramNew.ParameterName=paramOld.ParameterName;<BR>paramNew.DbType=paramOld.DbType;<BR>if(paramOld.Size 
                                &gt; 0) 
                                paramNew.Size=paramOld.Size;<BR>if(paramOld.Scale 
                                &gt; 0) 
                                paramNew.Scale=paramOld.Scale;<BR>paramNew.Direction=paramOld.Direction;<BR>paramNew.Value=paramOld.Value;<BR>if(paramOld.SourceColumn 
                                != null &amp;&amp; paramOld.SourceColumn != 
                                string.Empty)<BR>paramNew.SourceColumn=paramOld.SourceColumn;<BR>paramNew.SourceVersion=paramOld.SourceVersion;<BR><BR>dbCommand.Parameters.Add(paramNew);<BR>}<BR><BR>Without 
                                all these stuff, DB2 provider raise some errors 
                                or request is not execute or return 
                                nothing.<BR><BR>I think it's the good way, and 
                                it will be helpfull.<BR><BR><BR><BR><BR>Thanks 
                                again.<BR>Philippe<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1347411">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1347411">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1334762&amp;forumid=15129&amp;select=1347411#xx1347411xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1347411#xx1347411xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(238386,1347411);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1327209_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1327209xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1327209#xx1327209xx" 
                                name=1327209><B>.Net2.0 Error</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2576898"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Xp4ever</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>10:29 6 
                                Jan 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1327209_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>The 
                                following error raised even the version of 
                                'System.Date' Changed to 2.0.0.0<BR>Any advice 
                                is much 
                                appreciated.<BR><BR>Framework.UnitTests.CommandTests.CreateCommandSP 
                                : System.TypeInitializationException : The type 
                                initializer for 
                                'Framework.DataAccess.DataSourceFactory' threw 
                                an exception.<BR>----&gt; 
                                Framework.DataAccess.DataAccessException : Error 
                                loading cache from config.<BR>----&gt; 
                                Framework.DataAccess.DataAccessException : Error 
                                loading cache from config.<BR>----&gt; 
                                System.Data.SqlClient.SqlException : An error 
                                has occurred while establishing a connection to 
                                the server. When connecting to SQL Server 2005, 
                                this failure may be caused by the fact that 
                                under the default settings SQL Server does not 
                                allow remote connections. (provider: Named Pipes 
                                Provider, error: 40 - Could not open a 
                                connection to SQL Server) 
                                <BR><BR>Forest<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1327209">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1327209">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1327209&amp;forumid=15129&amp;select=1327209#xx1327209xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1327209#xx1327209xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2576898,1327209);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1327211_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1327211xx></A><IMG 
                                height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1327211#xx1327211xx" 
                                name=1327211>Re: .Net2.0 Error</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2576898"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Xp4ever&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>10:30 6 Jan 
                                '06&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1327211_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>pls 
                                kindly note that Database is sql server 2000 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1327211">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1327211">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1327209&amp;forumid=15129&amp;select=1327211#xx1327211xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1327211#xx1327211xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2576898,1327211);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1260517_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1260517xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1260517#xx1260517xx" 
                                name=1260517><B>Transaction behavior with 
                                multiple Win32 Threads</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=238386"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>pefr</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>17:07 21 
                                Oct 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1260517_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi 
                                Deyan,<BR><BR>I'm using your very usefull 
                                framework in a Web/Win32 mixed .Net solution 
                                .<BR>With ASP.Net, a page is always running in a 
                                single execution unit, so transaction handling 
                                is clear and comprehensive.<BR>But in a Win32 
                                application, i wonder if i should get trouble 
                                with transaction when using multiple 
                                threads.<BR>I think good questions are : <BR>1) 
                                What is the scope of a DAC2 implicit transaction 
                                ? current thread, current process or else 
                                ?<BR>2) Are different DAC2 transactions - 
                                running each in different threads - isolated or 
                                not ? (with the same datasource or not)<BR><BR>I 
                                hope my questions are as much comprehensive as 
                                in my mind <IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/smiley_smile.gif" 
                                align=absMiddle><BR><BR><BR><BR><BR>Best 
                                regards,<BR>Phil<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1260517">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1260517">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1260517&amp;forumid=15129&amp;select=1260517#xx1260517xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1260517#xx1260517xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(238386,1260517);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1261018_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1261018xx></A><IMG 
                                height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1261018#xx1261018xx" 
                                name=1261018>Re: Transaction behavior with 
                                multiple Win32 Threads</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=25272"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Deyan 
Petrov&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>9:49 22 Oct 
                                '05&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1261018_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>The transaction 
                                handling implementation in the DAC2 is not 
                                thread-safe. This means that it is designed to 
                                run on a thread basis (one transaction context 
                                per thread), and multiple threads in general 
                                don't share the same transaction. In other words 
                                transaciton running on different threads are 
                                ignorant of each other. <BR>Transaction context 
                                in the DAC2 is thread-scoped. This is so, 
                                because the transaction information is 
                                maintained in the thread local storage 
                                (CallContext.SetData &amp; CallContext.GetData 
                                methods are used). <BR>If a thread spawns a new 
                                thread, the new thread does not participate in 
                                the parent's thread transaction. <BR>A simple 
                                test with 2 threads can answer your questions 
                                best.<BR><BR>Br,<BR>Deyan 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1261018">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1261018">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1260517&amp;forumid=15129&amp;select=1261018#xx1261018xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1261018#xx1261018xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(25272,1261018);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1251310_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1251310xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_question.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1251310#xx1251310xx" 
                                name=1251310><B>WebApplication</B></A></TD>
                                <TD vAlign=bottom noWrap><IMG height=13 
                                alt="Unconfirmed/Anonymous posting" 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/usersuss.gif" 
                                width=15></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Joey 
                                Chömpff</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>9:06 12 
                                Oct 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1251310_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Is this 
                                framework usable in an 
                                webapplication?<BR><BR>Thanx in 
                                advance.<BR><BR>Sincerly, <BR><BR>Joey 
                                Chömpff<BR>.NET 
                                Developer<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1251310">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1251310">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1251310&amp;forumid=15129&amp;select=1251310#xx1251310xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1251310#xx1251310xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1251310">Modify</A> 
                                | <A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1251310">Delete</A>]<BR>
                                <SCRIPT language=Javascript>MsgVoteForm(0,1251310);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1251532_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1251532xx></A><IMG 
                                height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_answer.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1251532#xx1251532xx" 
                                name=1251532>Re: WebApplication</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=25272"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Deyan 
Petrov&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>12:12 12 Oct 
                                '05&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1251532_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Definitely! <IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/smiley_wink.gif" 
                                align=absMiddle><BR><BR>br,<BR>deyan 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1251532">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1251532">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1251310&amp;forumid=15129&amp;select=1251532#xx1251532xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1251532#xx1251532xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(25272,1251532);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1238683_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1238683xx></A><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1238683#xx1238683xx" 
                                name=1238683><B>Connection pool</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=867658"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Thiago 
                                Rafael</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>20:52 27 
                                Sep 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1238683_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Hi, 
                                very good work. I'm using this for about a year 
                                and now I upgraded to the newer 
                                version.<BR><BR>How do it handle the SQL-Server 
                                connection pool? I saw you always use 
                                conn.close(), do it leave the connection opened 
                                in the pool or really close it?<BR><BR>About the 
                                transaction modes, which one should I use? 
                                HomeGrown or SWC? I'm not using COM+ by now. Can 
                                I do distributed transactions with 
                                HomeGrown?<BR><BR>Thanks, and sorry by my bad, 
                                bad english <IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/smiley_smile.gif" 
                                align=absMiddle> <BR><BR>--<BR>Thiago 
                                Rafael<BR><A 
                                href="http://www.curricular.com.br/Help/Servicos.aspx"><B>Modelo 
                                de curriculum</B></A><BR><A 
                                href="http://www.curricular.com.br/"><B>Como 
                                fazer um 
                                curriculum</B></A><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1238683">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1238683">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1238683&amp;forumid=15129&amp;select=1238683#xx1238683xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1238683#xx1238683xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(867658,1238683);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1238865_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1238865xx></A><IMG 
                                height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;select=1238865#xx1238865xx" 
                                name=1238865>Re: Connection pool</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=25272"><IMG 
                                title="Click for User Profile" height=15 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Deyan 
Petrov&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>3:11 28 Sep 
                                '05&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1238865_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Hi,<BR><BR>Connection 
                                pooling is handled by ADO.NET. All connections 
                                are closed immediately after use, which returns 
                                them to the pool. The only exception is in case 
                                of HomeGrown transaction handling, when the 
                                connection is managed internally by the 
                                framework and closed only at the end of the 
                                transaction. <BR><BR>Use HomeGrown transaction 
                                handling if you need speed - lightweight ADO.NET 
                                transactions are used. It is the fastest option. 
                                Supports also transactions spanning multiple 
                                database - keeps pairs of ADO.NET connection and 
                                transaction objects for each database and at 
                                commit/rollback iterates over them (pseudo 
                                2-phase commit).<BR><BR>Use SWC or ES 
                                transaction handlers if you need distributed 
                                transactions. If you have COM+ 1.5 use 
                                SWC.<BR><BR>Br,<BR>Deyan<BR><BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1238865">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dac2.asp&amp;df=100&amp;forumid=15129&amp;select=1238865">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;tid=1238683&amp;forumid=15129&amp;select=1238865#xx1238865xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dac2.asp?msg=1238865#xx1238865xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(25272,1238865);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=#fbedbb>
                      <TD>
                        <TABLE cellPadding=2 width="100%">
                          <TBODY>
                          <TR>
                            <TD class=messagetitle>Last Visit: 9:30 Saturday 
                              11th November, 2006</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <A class=HoverLink 
                              href="http://www.codeproject.com/cs/database/dac2.asp?df=100&amp;forumid=15129&amp;fr=26" 
                              name=HoverNL>Next</A> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 13 Jan 2005 </TD>
                <TD class=SmallText align=right>Article content copyright 
                  Deyan Petrov, 2003<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2006</A>. <BR>Web08 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <SCRIPT 
      src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/front.asp" 
      type=text/javascript></SCRIPT>
      <BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="Data Access and Transaction Handling Framework - The Code Project - C# Database_files/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  
            <A href="http://www.aspalliance.com/">ASP Alliance</A>  <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
            href="http://www.developersdex.com/">Developersdex</A>  <A 
            href="http://www.devguru.com/">DevGuru</A>  <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A>  
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
