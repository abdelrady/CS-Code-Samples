<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0055)http://www.codeproject.com/cs/database/RandomSelect.asp -->
<HTML><HEAD><TITLE>How to make a random selection from an SQL table - The Code Project - C# Database</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<META content=en-US name=MS.LOCALE>
<META content="A simple technique for selecting random records from a table." 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content=Ach1lles name=Author>
<META content="01 Mar 2005 14:00:00 GMT" name=Search.PublishDate>
<META content="01 Mar 2005 14:00:00 GMT" name=Search.RevisedDate>
<META 
content="Free source code, , Visual C++, MFC, Windows, SQL, Random, C#, SELECT" 
name=keywords>
<META 
content="Article content copyright Ach1lles, 2005, everthing else Copyright © CodeProject, 1999-2006, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="How to make a random selection from an SQL table - The Code Project - C# Database_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="How to make a random selection from an SQL table - The Code Project - C# Database_files/oncopy.js"></SCRIPT>

<META content="MSHTML 6.00.2900.2802" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white><!-- COPYRIGHT 2006 I/PRO Corporation ALL RIGHTS RESERVED. - Page view auditing -->
<SCRIPT language=JavaScript type=text/javascript>
var LSPT="";
LSPT += "?durl=" + escape(document.URL);
LSPT += "&hostname=" + location.hostname;
LSPT += "&url=" + location.pathname;
LSPT += "&query=" + escape(location.search) + escape(location.hash);
LSPT += "&referrer=" + escape(document.referrer);
LSPT += "&browser=" + escape(navigator.appName);
LSPT += "&version=" + escape(navigator.appVersion);
LSPT += "&os=" + escape(navigator.platform);
LSPT += "&xdomain=codeproject.com";
LSPT += "&custid=codeproject";
</SCRIPT>

<SCRIPT type=text/javascript>
document.write('<img src=http://'+'content.ipro.com/images/pixel.gif'+LSPT+' height="1" width="1" style="position:absolute; top:0px; left:0px">');
</SCRIPT>
<NOSCRIPT><IMG style="LEFT: 0px; POSITION: absolute; TOP: 0px" height=1 src="" 
width=1> </NOSCRIPT><!-- END I/PRO PAGE TAG -->
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="How to make a random selection from an SQL table - The Code Project - C# Database_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2371&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FGraphicsServer%5F728x90%2Egif&C=False&id=2371&cb=3451227\" alt=\"\" border=0 width=728 height=90></a>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">3,524,141 members and 
            growing! &nbsp; 6,618 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2959938">abdelrady2030 
            </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/cs/database/RandomSelect.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2959938">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/cs/database/RandomSelect.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=5">.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=1">All Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=380>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/store/">StoreFront</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="How to make a random selection from an SQL table - The Code Project - C# Database_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="How to make a random selection from an SQL table - The Code Project - C# Database_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=4">ASP.NET</A>, <A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=3">C#</A>, <A 
            href="http://www.codeproject.com/?cat=5">.NET</A> &gt;&gt; <A 
            href="http://www.codeproject.com/cs/database/">C# Database</A> 
            &gt;&gt; <A 
            href="http://www.codeproject.com/cs/database/#General">General</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">How to make a random 
            selection from an SQL table</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=103912">Ach1lles</A></B>. 
            <BR><BR>
            <DIV style="FONT-SIZE: 12px">A simple technique for selecting random 
            records from a table.</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C#, SQL<BR>Windows, .NET, 
            .NET CF<BR>ASP, ASP.NET, Win32, VS, PDA, ADO, ADO.NET<BR>DB, 
            Dev<BR><SPAN style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>2 Mar 2005 
            </B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: <B>24,823</B> 
          </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <TABLE class=MemberNavBar 
            style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; MARGIN-BOTTOM: 10px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
            cellSpacing=0>
              <TBODY>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="How to make a random selection from an SQL table - The Code Project - C# Database_files/books2_sml.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.amazon.com/gp/redirect.html?link_code=ur2&amp;tag=thecodeprojec-20&amp;camp=1789&amp;creative=9325&amp;location=/gp/browse%3Fnode=5">Programming 
                  books</A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="How to make a random selection from an SQL table - The Code Project - C# Database_files/support_icon.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.codeproject.com/store/"><B>Ultimate 
                  Combo<BR>MFC tools $449</B></A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="How to make a random selection from an SQL table - The Code Project - C# Database_files/mail.gif" 
                  width=16></TD>
                <TD class=SmallText><A 
                  href="http://www.codeproject.com/script/recommend/form.asp?guid=RandomSelect%2Fcs%2Fdatabase3%2F2%2F2005">Send 
                  to a friend</A></TD></TR></TBODY></TABLE>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2259&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FWholeTomato%5FChangeSigExt%5F160x600%2Egif&C=False&id=2259&cb=3451238\" alt=\"The intellisense upgrade for Visual Studio .NET - make your IDE as smart as you.\" border=0 width=160 height=600></a>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="How to make a random selection from an SQL table - The Code Project - C# Database_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/cs/database/RandomSelect.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="How to make a random selection from an SQL table - The Code Project - C# Database_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=RandomSelect%2Fcs%2Fdatabase3%2F2%2F2005">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="How to make a random selection from an SQL table - The Code Project - C# Database_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fcs%2Fdatabase%2FRandomSelect%2Easp&amp;guid=RandomSelect%2Fcs%2Fdatabase3%2F2%2F2005">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="How to make a random selection from an SQL table - The Code Project - C# Database_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/cs/database/RandomSelect.asp#__comments">Discuss</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>18 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/red.gif" 
                              width=4 border=0><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/white.gif" 
                              width=16 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        5.26</A>. Rating: <B>4.19</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <H2>Introduction</H2>
            <P>This is one of the simplest solutions to a difficult problem I 
            have ever come across. If like me, you have ever had the need to 
            randomly select a number of database records from an SQL server 
            (e.g. for banner ads or special offer selections) then this is an 
            easy solution.</P>
            <H2>Solution</H2>
            <P>OK. So you have a table of records in an SQL database. Let's call 
            the table "<CODE>tbl_offers</CODE>" for this example. In SQL you can 
            assign a new ID value to any record which you select using the 
            function "<CODE>NewID()</CODE>". This means if you order your 
            records by this randomly generated ID field and select the top five 
            or ten say, then every time you will get a different set of 
            results.</P>
            <H2>Code</H2>
            <P>Please note I have written the following code only to demonstrate 
            the use of the SQL and so have made it as simple as possible.</P><PRE lang=cs><SPAN class=cs-comment>//This table can subsequently be used as a datasource</SPAN>
DataTable tbl_offers = <SPAN class=cs-keyword>new</SPAN> DataTable();

SqlConnection conn_offers = <SPAN class=cs-keyword>new</SPAN> SqlConnection(
    <SPAN class=cpp-string>"Insert your DB Connection string here"</SPAN>
    );
SqlDataAdapter da_offers = <SPAN class=cs-keyword>new</SPAN> SqlDataAdapter(
     <SPAN class=cpp-string>"SELECT Top 5 * FROM tbl_offers ORDER BY NewID()"</SPAN>, 
      conn
    );
da_offers.Fill(tbl_offers);</PRE>
            <P>And that's it. Very simple, very effective.</P><!-- Article Ends --></DIV></SPAN>
            <SCRIPT 
            src="How to make a random selection from an SQL table - The Code Project - C# Database_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>About Ach1lles</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><IMG 
                  src="How to make a random selection from an SQL table - The Code Project - C# Database_files/{761B3CBC-B28D-48AE-8E6D-00C0B44F91C4}.jpg"><BR></TD>
                <TD class=smallText>My Evolution: <BR>TRS-80 Basic, Clipper, 
                  C, Better Basic, FORTRAN, C++, Visual Basic, Delphi, C#<BR>
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=103912">here</A> 
                  to view Ach1lles's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular C# Database articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/sqldodont.asp">SQL 
                    Server DO's and DONT's</A>
                    <DIV class=smallText>SQL Server database best 
practices</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/SqlInjectionAttacks.asp">SQL 
                    Injection Attacks and Some Tips on How to Prevent Them</A>
                    <DIV class=smallText>Discusses various aspects of SQL 
                    Injection attacks, what to look for in your code, and how to 
                    secure it against SQL Injection attacks.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/relationaladonet.asp">Inserting 
                    relational data using DataSet and DataAdapter</A>
                    <DIV class=smallText>This article describes the process of 
                    inserting data in a DataSet and then submitting this changes 
                    to the database. It targets the issue when having 
                    IDENTITY/AutoNumber columns in the database.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/dac2.asp">Data 
                    Access and Transaction Handling Framework</A>
                    <DIV class=smallText>Generic data access component for 
                    different datasources, sprocs/SQL, implicitly propagated 
                    transactions, explicitly managed transaction contexts 
                    etc.</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2257&cb=3451255\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</SCRIPT>
                </TD></TR></TBODY></TABLE>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden 
            value=RandomSelect/cs/database3/2/2005 name=vote_name> <INPUT 
            type=hidden value=/cs/database/RandomSelect.asp name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/cs/database/RandomSelect.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD 
                style="PADDING-RIGHT: 2px; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; BACKGROUND-COLOR: #eee" 
                width=120 height=60>
                  <DIV align=center>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2343&cb=3451258\" border=0 frameborder=0 scrolling=no width=120 height=60></IFRAME>");</SCRIPT>
                  </DIV></TD>
                <TD width=100>&nbsp;</TD>
                <TD width=468 height=60><SPAN id=AdBanner5>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2223&cb=3451232\" border=0 frameborder=0 scrolling=no width=468 height=60></IFRAME>");</SCRIPT>
                  </SPAN></TD></TR></TBODY></TABLE></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	document.write("<br />Report as <a href='#xx" + MsgID.toString() + "xx' title='Mark as Spam' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-1)'>Spam</a> or ");
	document.write("<a href='#xx" + MsgID.toString() + "xx' title='Mark as Abuse' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-2)'>Abuse</a>");
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=158619"><IMG 
                              height=15 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION value=3>Expanded 
                                (Supporters only)</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 11 of 11 (Total: 
                              11) (<A 
                              href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1527040_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1527040xx></A><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619&amp;select=1527040#xx1527040xx" 
                                name=1527040><B>You can do the same using Rand 
                                function right !!</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2376575"><IMG 
                                title="Click for User Profile" height=15 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Himanshu Kumar 
                                Sinha</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>5:07 12 
                                Jun 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1527040_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent><BR>I 
                                think the Rand(0 function can also help <IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/smiley_smile.gif" 
                                align=absMiddle><BR><BR>if exists ( select 1 
                                from sysobjects where name ='TestRan')<BR>drop 
                                table TestRand<BR>go <BR>Create table 
                                TestRand<BR>(<BR>ADID int identity (0,1) 
                                <BR>,ADlocation varchar(20) <BR>)<BR>go 
                                <BR><BR>INSERT INTO TestRand(ADlocation) VALUES 
                                ('WWW.LOCATION1')<BR>INSERT INTO 
                                TestRand(ADlocation) VALUES 
                                ('WWW.LOCATION2')<BR>INSERT INTO 
                                TestRand(ADlocation) VALUES 
                                ('WWW.LOCATION3')<BR>INSERT INTO 
                                TestRand(ADlocation) VALUES 
                                ('WWW.LOCATION4')<BR>INSERT INTO 
                                TestRand(ADlocation) VALUES 
                                ('WWW.LOCATION5')<BR><BR>GO <BR><BR>DECLARE 
                                @TOTALRECORDS int<BR>DECLARE @AdidToBePicked int 
                                <BR>select @TOTALRECORDS = count(*) from 
                                TestRand<BR>select @AdidToBePicked = rand() * 
                                @TOTALRECORDS<BR>select ADlocation from TestRand 
                                where ADID = @AdidToBePicked <BR><BR>regds 
                                <BR>Himanshu<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1527040">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1527040">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;tid=1527040&amp;forumid=158619&amp;select=1527040#xx1527040xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?msg=1527040#xx1527040xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2376575,1527040);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1501213_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1501213xx></A><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619&amp;select=1501213#xx1501213xx" 
                                name=1501213><B>Fantastic 
                                But............</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1836675"><IMG 
                                title="Click for User Profile" height=15 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>yasir1024</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>2:58 24 
                                May 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1501213_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Infact 
                                when I first look at the SQL statement It does 
                                not make sense to me....I was taking NewID() as 
                                some other function...<BR>Yet It is builtin SQL 
                                Server Method and you just have to copy and 
                                paste the Query in your Query 
                                Analyzer..<BR>Great any way.........<IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/smiley_redface.gif" 
                                align=absMiddle> <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1501213">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1501213">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;tid=1501213&amp;forumid=158619&amp;select=1501213#xx1501213xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?msg=1501213#xx1501213xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1836675,1501213);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1463477_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1463477xx></A><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619&amp;select=1463477#xx1463477xx" 
                                name=1463477><B>Great!</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=2427820"><IMG 
                                title="Click for User Profile" height=15 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>takcrazy</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>8:31 26 
                                Apr 
                            '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1463477_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thanks 
                                your tip! <BR><BR>Make a brighter 
                                day...<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1463477">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1463477">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;tid=1463477&amp;forumid=158619&amp;select=1463477#xx1463477xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?msg=1463477#xx1463477xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(2427820,1463477);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1404549_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1404549xx></A><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aa0000" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aa0000" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619&amp;select=1404549#xx1404549xx" 
                                name=1404549><B>Brilliant</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=32918"><IMG 
                                title="Click for User Profile" height=15 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>furioso</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>17:18 12 Mar 
                                '06</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1404549_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Excellent piece of code! 
                                <BR>I've been working as a SQL man for some 
                                years now and I've never realized this was 
                                possible. Always thought NewId's were assigned 
                                on insertions, not on "ORDER BY"<BR><BR>You 
                                deserve a beer or 
                                two!<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1404549">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1404549">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;tid=1404549&amp;forumid=158619&amp;select=1404549#xx1404549xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?msg=1404549#xx1404549xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(32918,1404549);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1069403_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1069403xx></A><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619&amp;select=1069403#xx1069403xx" 
                                name=1069403><B>Fascinating -- where 
                                documented?</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=263577"><IMG 
                                title="Click for User Profile" height=15 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>davidw88011</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>14:00 28 
                                Mar 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1069403_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>This is 
                                amazing. Nowhere in reading BOL would you guess 
                                that you can do this. <BR><BR>The doc for Order 
                                By says that Order "Specifies a column on which 
                                to sort. A sort column can be specified as a 
                                name or column alias (which can be qualified by 
                                the table or view name), an expression, 
                                ..."<BR><BR>So you can sort by an expression. It 
                                seems that, magically, a newid() is appended to 
                                each record, even though there is not a newid() 
                                field in the original table, and the table is 
                                sorted by that, then of course the top 5 of 
                                those sorted records are selected. <BR><BR>You 
                                can also do " Select top 5 * from [whatever] 
                                Order By 'a' " although it's not very useful. 
                                I'm just surprised that you can do this. 
                                <BR><BR>Where is it documented (and explained) 
                                that you can sort by fields that don't even 
                                exist in the table? BOL might mention that you 
                                can sort by an "expression" although it sure 
                                doesn't explain what that really means or give 
                                ANY examples. <BR><BR>David 
                                Walker<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1069403">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1069403">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;tid=1069403&amp;forumid=158619&amp;select=1069403#xx1069403xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?msg=1069403#xx1069403xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(263577,1069403);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1069405_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1069405xx></A><IMG 
                                height=1 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619&amp;select=1069405#xx1069405xx" 
                                name=1069405>Re: Fascinating -- where 
                                documented?</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=263577"><IMG 
                                title="Click for User Profile" height=15 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>davidw88011&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>14:02 28 Mar 
                                '05&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1069405_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT 
                                class=messagecontent>Actually, BOL does say "The 
                                ORDER BY clause can include items not appearing 
                                in the select list." But it sure doesn't explain 
                                how this works or what really happens if you 
                                sort by items not in the select list. 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1069405">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1069405">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;tid=1069403&amp;forumid=158619&amp;select=1069405#xx1069405xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?msg=1069405#xx1069405xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 2.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(263577,1069405);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1053125_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1053125xx></A><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619&amp;select=1053125#xx1053125xx" 
                                name=1053125><B>performance hit?</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=52576"><IMG 
                                title="Click for User Profile" height=15 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Ashley van 
                                Gerven</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>18:55 4 
                                Mar 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1053125_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I 
                                imagine every single row in the table gets 
                                assigned this NEWID()... on large tables do you 
                                know if there would be performance issues? (e.g. 
                                on a high traffic website). 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1053125">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1053125">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;tid=1053125&amp;forumid=158619&amp;select=1053125#xx1053125xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?msg=1053125#xx1053125xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(52576,1053125);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1053401_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1053401xx></A><IMG 
                                height=1 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619&amp;select=1053401#xx1053401xx" 
                                name=1053401>Re: performance hit?</A></TD>
                                <TD vAlign=bottom noWrap><IMG height=13 
                                alt="Unconfirmed/Anonymous posting" 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/usersuss.gif" 
                                width=15></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Stephen R&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>11:04 5 Mar 
                                '05&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1053401_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Yes, 
                                there will be issues on large tables. See <A 
                                href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnsqlpro04/html/sp04c1.asp">msdn.microsoft.com/library/default.asp?url=/library/en-us/dnsqlpro04/html/sp04c1.asp</A> 
                                for other solutions. <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1053401">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1053401">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;tid=1053125&amp;forumid=158619&amp;select=1053401#xx1053401xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?msg=1053401#xx1053401xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>[<A 
                                href="http://www.codeproject.com/script/comments/owner_modify_pw.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1053401">Modify</A> 
                                | <A 
                                href="http://www.codeproject.com/script/comments/owner_delete_pw.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1053401">Delete</A>]<BR>
                                <SCRIPT language=Javascript>MsgVoteForm(0,1053401);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1066558_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1066558xx></A><IMG 
                                height=1 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619&amp;select=1066558#xx1066558xx" 
                                name=1066558>Re: performance hit?</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=121580"><IMG 
                                title="Click for User Profile" height=15 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Rafael 
                                Araújo&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>19:06 23 Mar 
                                '05&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1066558_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I wrote 
                                this solution that is considerable faster then 
                                the NewID() solution but has no flexibility and 
                                is based on tables with int primary keys (the 
                                ideal is an identity primary key).<BR>If you 
                                dont need to make joins with other tables or 
                                other kinds of filters and, like me, always have 
                                identity primary keys, it will fit in most 
                                cases<BR><BR>Usage Examples (not good examples 
                                since 'Northwind..Products' only has 77 rows): 
                                <IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/smiley_shucks.gif" 
                                align=absMiddle><BR>--return 100 random rows in 
                                a random order with all Products columns 
                                <BR>exec spGetRandomRows 
                                'Northwind..Products','ProductID'<BR><BR>--return 
                                1000 random rows in a random order with columns 
                                ProductID,ProductName<BR>exec spGetRandom 
                                'Northwind..Products', 'ProductID', 1000, 
                                'ProductID,ProductName'<BR><BR>--return 1000 
                                random rows with columns ProductID, SupplierID, 
                                ProductName ordered by SupplierID and 
                                ProductName<BR>exec spGetRandomRows 
                                'Northwind..Products', 'ProductID', 1000, 
                                'ProductID,SupplierID,ProductName', 
                                'SupplierID,ProductName'<BR><BR><BR>create proc 
                                spGetRandomRows<BR>@source_table 
                                sysname,<BR>@source_key 
                                sysname,<BR>@return_count bigint = 
                                100,<BR>@return_columns varchar(200) = 
                                '',<BR>@return_order varchar(200) = 
                                ''<BR>as<BR><BR>set nocount on<BR><BR>select 
                                <BR>@return_columns = case when 
                                len(@return_columns) &gt; 0 then @return_columns 
                                else @source_table+'.*' end,<BR>@return_order = 
                                case when len(@return_order) &gt; 0 then ' order 
                                by '+@return_order else ' order by 
                                f.the_random_order' end<BR><BR>declare @sql 
                                varchar(8000)<BR><BR>if @return_count &gt; 0 
                                <BR>begin<BR>set @sql = '<BR>declare @i bigint, 
                                @count bigint, @return_count bigint<BR>select @i 
                                = 0, @return_count = 
                                '+convert(varchar(20),@return_count)+'<BR><BR>declare 
                                @the_random_keys table(the_random_key bigint, 
                                the_random_order bigint identity(1,1) primary 
                                key)<BR><BR>declare @the_max_key 
                                table(the_max_key float, the_row_count 
                                bigint)<BR><BR>insert into 
                                @the_max_key(the_max_key,the_row_count) select 
                                max('+@source_key+'), count(*) from 
                                '+@source_table+'<BR><BR>select @return_count = 
                                case when @return_count &lt; the_row_count then 
                                @return_count else the_row_count end from 
                                @the_max_key<BR><BR>while @i &lt; 
                                @return_count<BR>begin<BR>declare 
                                @the_random_key bigint<BR>while @the_random_key 
                                is null<BR>select top 1 @the_random_key = 
                                o1.'+@source_key+' from '+@source_table+' o1 
                                with(nolock)<BR>where '+@source_key+' &gt; 
                                <BR>(select rand() * the_max_key from 
                                @the_max_key)<BR>and o1.'+@source_key+' not in 
                                (select the_random_key from 
                                @the_random_keys)<BR><BR><BR>insert into 
                                @the_random_keys(the_random_key)values(@the_random_key)<BR>set 
                                @the_random_key = null<BR><BR>set @i = @i + 
                                1<BR>end<BR><BR>select '+@return_columns+' from 
                                '+@source_table+' with(nolock)<BR>inner join 
                                @the_random_keys f on f.the_random_key = 
                                '+@source_table+'.'+@source_key<BR>+@return_order<BR>exec(@sql)<BR>end<BR>else<BR>select 
                                null<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1066558">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1066558">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;tid=1053125&amp;forumid=158619&amp;select=1066558#xx1066558xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?msg=1066558#xx1066558xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(121580,1066558);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1051611_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1051611xx></A><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619&amp;select=1051611#xx1051611xx" 
                                name=1051611><B>gr8!</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=701747"><IMG 
                                title="Click for User Profile" height=15 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Assaad 
                                Codoholic</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>2:17 3 Mar 
                                '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1051611_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>easy 
                                ,simple,gr8 and does the necessary! this is what 
                                i love!<BR>Thanks!is the most useful line of 
                                code i have seen in weeks <BR><BR>Kill The 
                                Tester<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1051611">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1051611">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;tid=1051611&amp;forumid=158619&amp;select=1051611#xx1051611xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?msg=1051611#xx1051611xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(701747,1051611);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1051085_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1051085xx></A><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;forumid=158619&amp;select=1051085#xx1051085xx" 
                                name=1051085><B>Nice tip! - more info 
                                here...</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=156647"><IMG 
                                title="Click for User Profile" height=15 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>RayD</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>11:59 2 
                                Mar 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1051085_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>This is 
                                a great tip! For more info, check out these 
                                links:<BR><A 
                                href="http://www.sqlteam.com/item.asp?ItemID=8747" 
                                rel=nofollow>http://www.sqlteam.com/item.asp?ItemID=8747</A>[<A 
                                title="New Window" 
                                href="http://www.sqlteam.com/item.asp?ItemID=8747" 
                                target=_blank rel=nofollow>^</A>]<BR><A 
                                href="http://www.microsoft.com/sql/techinfo/tips/development/queryresults.asp" 
                                rel=nofollow>http://www.microsoft.com/sql/techinfo/tips/development/queryresults.asp</A>[<A 
                                title="New Window" 
                                href="http://www.microsoft.com/sql/techinfo/tips/development/queryresults.asp" 
                                target=_blank rel=nofollow>^</A>]<BR><BR>My 
                                $.02. <IMG 
                                src="How to make a random selection from an SQL table - The Code Project - C# Database_files/smiley_smile.gif" 
                                align=absMiddle> <BR><BR>Ray Dixon<BR><A 
                                href="http://raysblog.com/" 
                                rel=nofollow>http://raysblog.com/</A>[<A 
                                title="New Window" href="http://raysblog.com/" 
                                target=_blank 
                                rel=nofollow>^</A>]<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1051085">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/RandomSelect.asp&amp;df=100&amp;forumid=158619&amp;select=1051085">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?df=100&amp;tid=1051085&amp;forumid=158619&amp;select=1051085#xx1051085xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/RandomSelect.asp?msg=1051085#xx1051085xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(156647,1051085);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="How to make a random selection from an SQL table - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=#fbedbb>
                      <TD>
                        <TABLE cellPadding=2 width="100%">
                          <TBODY>
                          <TR>
                            <TD class=messagetitle>Last Visit: 9:30 Saturday 
                              11th November, 2006</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="How to make a random selection from an SQL table - The Code Project - C# Database_files/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 2 Mar 2005 </TD>
                <TD class=SmallText align=right>Article content copyright 
                  Ach1lles, 2005<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2006</A>. <BR>Web12 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <SCRIPT 
      src="How to make a random selection from an SQL table - The Code Project - C# Database_files/front.asp" 
      type=text/javascript></SCRIPT>
      <BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="How to make a random selection from an SQL table - The Code Project - C# Database_files/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  
            <A href="http://www.aspalliance.com/">ASP Alliance</A>  <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
            href="http://www.developersdex.com/">Developersdex</A>  <A 
            href="http://www.devguru.com/">DevGuru</A>  <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A>  
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
