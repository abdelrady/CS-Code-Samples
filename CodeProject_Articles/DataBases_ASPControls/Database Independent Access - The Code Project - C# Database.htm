<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0055)http://www.codeproject.com/cs/database/dataprovider.asp -->
<HTML><HEAD><TITLE>Database Independent Access - The Code Project - C# Database</TITLE>
<META http-equiv=Reply-to content=mailto:webmaster@codeproject.com>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<META content=en-US name=MS.LOCALE>
<META 
content="Use different database providers without tying implementation to one." 
name=Description>
<META content=kbArticle name=Search.TopicType>
<META content="Jaryl Sim" name=Author>
<META content="04 Jan 2005 14:00:00 GMT" name=Search.PublishDate>
<META content="04 Jan 2005 14:00:00 GMT" name=Search.RevisedDate>
<META 
content="Free source code, , Visual C++, MFC, Windows, Database, OleDb, SQLServer, Independent" 
name=keywords>
<META 
content="Article content copyright Jaryl Sim, 2005, everthing else Copyright © CodeProject, 1999-2006, All Rights Reserved." 
name=Copyright><LINK title="CodeProject Lounge Postings" 
href="http://www.codeproject.com/webservices/LoungeRSS.aspx" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - All topics" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=1" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - MFC / C++" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=2" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - C#" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=3" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - ASP.NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=4" 
type=application/rss+xml rel=alternate><LINK 
title="CodeProject Latest articles - .NET" 
href="http://www.codeproject.com/webservices/articlerss.aspx?cat=5" 
type=application/rss+xml rel=alternate><LINK href="/favicon.ico" type=image/ico 
rel=icon><LINK href="/favicon.ico" rel="SHORTCUT ICON"><LINK 
href="Database Independent Access - The Code Project - C# Database_files/global.css" 
type=text/css rel=stylesheet>
<SCRIPT language=javascript 
src="Database Independent Access - The Code Project - C# Database_files/oncopy.js"></SCRIPT>

<META content="MSHTML 6.00.2900.2802" name=GENERATOR></HEAD>
<BODY style="MARGIN: 0px" oncopy="return copyCode();" text=black vLink=navy 
aLink=red link=blue bgColor=white><!-- COPYRIGHT 2006 I/PRO Corporation ALL RIGHTS RESERVED. - Page view auditing -->
<SCRIPT language=JavaScript type=text/javascript>
var LSPT="";
LSPT += "?durl=" + escape(document.URL);
LSPT += "&hostname=" + location.hostname;
LSPT += "&url=" + location.pathname;
LSPT += "&query=" + escape(location.search) + escape(location.hash);
LSPT += "&referrer=" + escape(document.referrer);
LSPT += "&browser=" + escape(navigator.appName);
LSPT += "&version=" + escape(navigator.appVersion);
LSPT += "&os=" + escape(navigator.platform);
LSPT += "&xdomain=codeproject.com";
LSPT += "&custid=codeproject";
</SCRIPT>

<SCRIPT type=text/javascript>
document.write('<img src=http://'+'content.ipro.com/images/pixel.gif'+LSPT+' height="1" width="1" style="position:absolute; top:0px; left:0px">');
</SCRIPT>
<NOSCRIPT><IMG style="LEFT: 0px; POSITION: absolute; TOP: 0px" height=1 src="" 
width=1> </NOSCRIPT><!-- END I/PRO PAGE TAG -->
<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD class=HeaderLogo><A href="http://www.codeproject.com/"><IMG height=90 
      alt=Home 
      src="Database Independent Access - The Code Project - C# Database_files/codeproject225x90.gif" 
      border=0></A></TD>
    <TD class=HeaderBanner><SPAN id=AdBanner4>
      <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2320&cb=3454718\" border=0 frameborder=0 scrolling=no width=728 height=90></IFRAME>");</SCRIPT>
      </SPAN></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=MemberNavBar cellSpacing=0 cellPadding=5 width="100%" 
      border=0>
        <TBODY>
        <TR vAlign=center>
          <TD class=smallText style="FONT-WEIGHT: bold">3,524,152 members and 
            growing! &nbsp; 6,682 now online. </TD>
          <TD class=userNavText align=right><A 
            href="http://www.codeproject.com/script/profile/whos_who.asp?id=2959938">abdelrady2030 
            </A>| <A 
            href="http://www.codeproject.com/script/profile/modify.asp?ct=/cs/database/dataprovider.asp"><B>My 
            Settings</B></A> | <A 
            href="http://www.codeproject.com/script/profile/bookmark_list.asp">My 
            Bookmarks</A> | <A 
            href="http://www.codeproject.com/script/articles/list_articles.asp?userid=2959938">My 
            Articles</A> | <A 
            href="http://www.codeproject.com/script/profile/logoff.asp?ct=/cs/database/dataprovider.asp">Sign 
            out</A> </TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=SiteNavBar id=tblSiteToolbar cellSpacing=0 cellPadding=0>
        <TBODY>
        <TR>
          <TD><A href="http://www.codeproject.com/">Home</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=2">MFC/C++</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=3">C#</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=4">ASP.NET</A></TD>
          <TD><A href="http://www.codeproject.com/index.asp?cat=5">.NET</A></TD>
          <TD noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=6">VB.NET</A></TD>
          <TD class=SelCat noWrap><A 
            href="http://www.codeproject.com/index.asp?cat=1">All Topics</A></TD>
          <TD width="100%">&nbsp;</TD>
          <TD>
            <DIV id=MenuPos 
            style="WIDTH: 380px; POSITION: relative; TOP: 1px; HEIGHT: 22px">
            <TABLE id=MPH 
            style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; HEIGHT: 20px; BORDER-RIGHT-WIDTH: 0px" 
            cellSpacing=0 cellPadding=0 width=380>
              <TBODY>
              <TR vAlign=center>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/faq.asp">Help!</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/info/latest.asp">Articles</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/script/comments/forums.asp">Message 
                  Boards</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/store/">StoreFront</A></TD>
                <TD 
                style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" 
                noWrap><A 
                  href="http://www.codeproject.com/lounge.asp">Lounge</A></TD></TR></TBODY></TABLE></DIV></TD></TR></TBODY></TABLE>
      <SCRIPT type=text/javascript>function Go(){return}</SCRIPT>

      <SCRIPT 
      src="Database Independent Access - The Code Project - C# Database_files/cpmenu_var.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT 
      src="Database Independent Access - The Code Project - C# Database_files/menu10_com.js" 
      type=text/javascript></SCRIPT>

      <SCRIPT type=text/javascript>
var MPH = document.getElementById("MPH");
if (MPH) MPH.style.display='none';
</SCRIPT>
    </TD></TR>
  <TR>
    <TD colSpan=2>
      <TABLE class=ArticleHeader cellSpacing=0 cellPadding=3 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD class=smallText style="PADDING-RIGHT: 10px"><A 
            href="http://www.codeproject.com/?cat=4">ASP.NET</A>, <A 
            href="http://www.codeproject.com/?cat=1">All Topics</A>, <A 
            href="http://www.codeproject.com/?cat=3">C#</A>, <A 
            href="http://www.codeproject.com/?cat=5">.NET</A> &gt;&gt; <A 
            href="http://www.codeproject.com/cs/database/">C# Database</A> 
            &gt;&gt; <A 
            href="http://www.codeproject.com/cs/database/#General">General</A><BR><BR>
            <DIV style="FONT-WEIGHT: bold; FONT-SIZE: 16pt">Database Independent 
            Access</DIV><B>By <A 
            href="http://www.codeproject.com/script/Articles/list_articles.asp?userid=1621814">Jaryl 
            Sim</A></B>. <BR><BR>
            <DIV style="FONT-SIZE: 12px">Use different database providers 
            without tying implementation to one.</DIV></TD>
          <TD class=smallText style="WIDTH: 200px">C#, SQL<BR>Windows, .NET 
            (.NET 1.1, .NET 1.0)<BR>ASP.NET, Win32, VS (VS.NET2003), 
            ADO.NET<BR>DB, Arch, Dev<BR><SPAN 
            style="PADDING-RIGHT: 2ex">Posted</SPAN>: <B>5 Jan 2005 
            </B><BR><SPAN style="PADDING-RIGHT: 3ex">Views</SPAN>: <B>24,561</B> 
          </TD></TR></TD></TR></TD></TR></TBODY></TABLE>
      <TABLE cellSpacing=0 cellPadding=0 border=0>
        <TBODY>
        <TR vAlign=top>
          <TD class=LHNavBar rowSpan=2><!-- Yes, there are IE hacks that will allow us to create a min-width DIV 
	     (eg http://www.webreference.com/programming/min-width/) but I couldn't
	     be arsed. Wait for it in v2.0 -->
            <TABLE class=MemberNavBar 
            style="BORDER-RIGHT: 0px; BORDER-TOP: 0px; MARGIN-BOTTOM: 10px; BORDER-LEFT: 0px; BORDER-BOTTOM: 0px" 
            cellSpacing=0>
              <TBODY>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Database Independent Access - The Code Project - C# Database_files/books2_sml.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.amazon.com/gp/redirect.html?link_code=ur2&amp;tag=thecodeprojec-20&amp;camp=1789&amp;creative=9325&amp;location=/gp/browse%3Fnode=5">Programming 
                  books</A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Database Independent Access - The Code Project - C# Database_files/support_icon.gif" 
                  width=16></TD>
                <TD class=smallText><A 
                  href="http://www.codeproject.com/store/"><B>Ultimate 
                  Combo<BR>MFC tools $449</B></A></TD></TR>
              <TR vAlign=top>
                <TD></TD>
                <TD></TD></TR></TR>
              <TR vAlign=top>
                <TD><IMG height=16 
                  src="Database Independent Access - The Code Project - C# Database_files/mail.gif" 
                  width=16></TD>
                <TD class=SmallText><A 
                  href="http://www.codeproject.com/script/recommend/form.asp?guid=dataprovider%2Fcs%2Fdatabase1%2F5%2F2005">Send 
                  to a friend</A></TD></TR></TBODY></TABLE>
            <CENTER>
            <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2348&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FCWS%5Fnet2%5F160x600%2Egif&C=False&id=2348&cb=3454728\" alt=\"\" border=0 width=160 height=600></a>");</SCRIPT>
            </CENTER><BR><BR><IMG height=1 
            src="Database Independent Access - The Code Project - C# Database_files/t.gif" 
            width=160> </TD>
          <TD width="100%">
            <TABLE class=SearchHeaderBar cellSpacing=0 width="100%">
              <TBODY>
              <TR>
                <TD vAlign=center noWrap align=right width="60%">
                  <FORM style="MARGIN: 0px" name=Search action=/info/search.asp 
                  method=post><B>Search &nbsp;</B><INPUT class=smallText 
                  style="WIDTH: 200px" name=target> <SELECT 
                  style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" name=st> <OPTION 
                    value=kw selected>Articles</OPTION> <OPTION 
                    value=au>Authors</OPTION></SELECT> <INPUT style="FONT-WEIGHT: bold; FONT-SIZE: 8pt" type=submit value=" Go! "> 
                  &nbsp; </FORM></TD>
                <TD class=tinyText noWrap><A 
                  href="http://www.codeproject.com/info/search.asp">Advanced 
                  Search</A><BR><A 
                  href="http://www.codeproject.com/script/articles/sections.asp">Sitemap</A> 
                </TD></TR></TBODY></TABLE>
            <TABLE width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=SmallText noWrap>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText noWrap><IMG 
                        src="Database Independent Access - The Code Project - C# Database_files/print.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/cs/database/dataprovider.asp?print=true" 
                        target=_print>Print</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Database Independent Access - The Code Project - C# Database_files/sitebuild_icon.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/submit/ReportProblem.asp?GUID=dataprovider%2Fcs%2Fdatabase1%2F5%2F2005">Broken 
                        Article?</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Database Independent Access - The Code Project - C# Database_files/link.gif" 
                        align=absMiddle><A 
                        href="http://www.codeproject.com/script/profile/add_bookmark.asp?t=0&amp;ct=%2Fcs%2Fdatabase%2Fdataprovider%2Easp&amp;guid=dataprovider%2Fcs%2Fdatabase1%2F5%2F2005">Bookmark</A></TD>
                      <TD class=smallText noWrap><IMG 
                        src="Database Independent Access - The Code Project - C# Database_files/mail_small.gif" 
                        align=absMiddle> <A 
                        href="http://www.codeproject.com/cs/database/dataprovider.asp#__comments">Discuss</A></TD></TR></TBODY></TABLE></TD>
                <TD noWrap align=right><A name=__top></A>
                  <TABLE>
                    <TBODY>
                    <TR>
                      <TD class=smallText align=right>12 votes for this 
                        article.</TD>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 border=2>
                          <TBODY>
                          <TR>
                            <TD><IMG height=5 
                              src="Database Independent Access - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Database Independent Access - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Database Independent Access - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Database Independent Access - The Code Project - C# Database_files/red.gif" 
                              width=20 border=0></TD>
                            <TD><IMG height=5 
                              src="Database Independent Access - The Code Project - C# Database_files/red.gif" 
                              width=5 border=0><IMG height=5 
                              src="Database Independent Access - The Code Project - C# Database_files/white.gif" 
                              width=15 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR>
                      <TD class=smallText align=right colSpan=2><A 
                        title="Calculated as rating x Log10(# votes)" 
                        href="http://www.codeproject.com/script/articles/top_articles.asp?st=2">Popularity: 
                        4.57</A>. Rating: <B>4.24</B> out of 
                  5.</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
        <TR>
          <TD class=ArticlePane><SPAN id=intelliTXT>
            <DIV id=contentdiv><!-- Article Starts -->
            <UL class=download>
              <LI><A 
              href="http://www.codeproject.com/cs/database/dataprovider/dataprovider_src.zip">Download 
              source files - 2.41 Kb</A> </LI></UL>
            <H2>Introduction</H2>
            <P>If you ever needed to port over a project using one database to 
            another, you'd know what a pain that could be. By hiding all the 
            implementation details inside the <CODE>DataProvider</CODE>, we are 
            able to achieve implementation independence by specifying what type 
            of database to be used.</P>
            <H2>Features</H2>
            <P><CODE>DataProvider</CODE> currently supports Ole DB and SQL 
            Server providers, but you can easily customise it to support your 
            provider if you wish. You can execute SQL statements against the 
            database with SQL parameters to guard against SQL injection. 
            <CODE>DataProvider</CODE> is designed with connection pooling 
            considerations in mind although I have yet to test it in a 
            production environment. Using Reflection, there's no more need to 
            write tedious code to populate a class object. Lastly, 
            <CODE>DataProvider</CODE> supports database transactions for 
            non-query SQL.</P>
            <H2>Getting Started</H2>
            <P>Copy over <I>DataProvider.cs</I> into your project, renaming the 
            namespace if necessary for your project purposes. Using 
            <CODE>DataProvider</CODE> is simple, declare it like this:</P><PRE lang=cs>DataProvider dp = 
    <SPAN class=cs-keyword>new</SPAN> DataProvider(<I>ConnectionString</I>, DataProvider.DBType.OleDb);</PRE>
            <P>If you want to use the SQL provider, change <CODE>OleDb</CODE> to 
            <CODE>SqlServer</CODE>. Change <CODE>ConnectionString</CODE> to the 
            database you are using. Now let's say we want to return the number 
            of rows in the entire Test table:</P><PRE lang=cs>DataProvider dp = 
    <SPAN class=cs-keyword>new</SPAN> DataProvider(<I>ConnectionString</I>, DataProvider.DBType.OleDb);
DataSet = dp.ExecuteScalar(<SPAN class=cpp-string>"SELECT COUNT(*) FROM Test;"</SPAN>);</PRE>
            <P>Pretty simple huh? It gets better. Using parameterised SQL is 
            important in guarding against SQL injection. Furthermore, building 
            strings makes for unsightly code. Here's another snippet that 
            updates the database:</P><PRE lang=cs>DataProvider dp = 
    <SPAN class=cs-keyword>new</SPAN> DataProvider(<I>ConnectionString</I>, DataProvider.DBType.OleDb);

DataProvider.Command cmd = 
    dp.CreateCommand(<SPAN class=cpp-string>"UPDATE Test SET TestString=@TestString;"</SPAN>);
cmd.AddParameter(<SPAN class=cpp-string>"@TestString"</SPAN>, <SPAN class=cpp-string>"Test123"</SPAN>);

dp.ExecuteNonQuery(cmd);</PRE>
            <P>I've avoided allowing <CODE>AddParameter()</CODE> to specify the 
            data type. While this may be useful, it made it exponentially harder 
            to cater to the different data types supported by different 
            providers. All parameters are added to the command as objects.</P>
            <H2>Retrieving DataReaders and DataSets</H2>
            <P>So what if you require the power offered by 
            <CODE>DataReader</CODE>s and <CODE>DataSet</CODE>s? 
            <CODE>DataProvider</CODE> provides such support as easily as the 
            codes above.</P><PRE lang=cs>DataProvider dp = 
    <SPAN class=cs-keyword>new</SPAN> DataProvider(<I>ConnectionString</I>, DataProvider.DBType.OleDb);
<SPAN class=cs-keyword>try</SPAN>
{
  <SPAN class=cs-keyword>using</SPAN> (IDataReader reader = dp.ExecuteReader(<SPAN class=cpp-string>"SELECT * FROM Test;"</SPAN>))
  {
        <SPAN class=cs-keyword>while</SPAN> (reader.Read())
        {
          <SPAN class=cs-keyword>for</SPAN> (<SPAN class=cs-keyword>int</SPAN> i=<SPAN class=cs-literal>0</SPAN>; i&lt;reader.FieldCount; i++)
          {
            Response.Write(reader.GetName(i) + <SPAN class=cpp-string>": "</SPAN> + reader.GetValue(i));
          }
        }
        reader.Close();
  }
} 
<SPAN class=cs-keyword>catch</SPAN> (Exception exception)
{
          System.Diagnostics.Debug.WriteLine(exception.Message);
}</PRE>
            <P>I've used the <CODE lang=cs><SPAN 
            class=cs-keyword>using</SPAN></CODE> keyword here to ensure the 
            destruction of the <CODE>IDataReader</CODE> object, which in turn 
            ensures the closing of the database connection, freeing up the 
            server's resources. <CODE>IDataReader</CODE> objects can be used 
            just like you've always used them so you should already be familiar 
            with that. Getting and using <CODE>DataGrid</CODE>s are even 
            easier:</P><PRE lang=cs>DataProvider dp = 
    <SPAN class=cs-keyword>new</SPAN> DataProvider(<I>ConnectionString</I>, DataProvider.DBType.OleDb);
DataSet = dp.FillDataSet(<SPAN class=cpp-string>"SELECT * FROM Test;"</SPAN>);</PRE>
            <P>Do note that all the functions we've used so far are overloaded 
            to take strings and Command objects so you can easily switch between 
            plain SQL strings or paramterised SQL.</P>
            <H2>Using Transactions</H2>
            <P>Using transactions have never been easier without the use of 
            <CODE>DataProvider</CODE>. Simply create an array of command objects 
            and pass it into <CODE>ExecuteTransaction()</CODE>. Again, you have 
            a choice to use plain SQL or parameterised SQL.</P><PRE lang=cs>DataProvider dp = 
    <SPAN class=cs-keyword>new</SPAN> DataProvider(<I>ConnectionString</I>, DataProvider.DBType.OleDb);
DataProvider.Command [] commands = <SPAN class=cs-keyword>new</SPAN> DataProvider.Command[<SPAN class=cs-literal>2</SPAN>];

commands[<SPAN class=cs-literal>0</SPAN>] = 
    dp.CreateCommand(<SPAN class=cpp-string>"INSERT INTO Test (TestNumber, TestString, TestDate) 
            VALUES (73, @TestString, @TestDate);"</SPAN>);
commands[<SPAN class=cs-literal>0</SPAN>].AddParameter(<SPAN class=cpp-string>"@TestString"</SPAN>, <SPAN class=cpp-string>"Testing"</SPAN>);
commands[<SPAN class=cs-literal>0</SPAN>].AddParameter(<SPAN class=cpp-string>"@TestDate"</SPAN>, DateTime.Now);

commands[<SPAN class=cs-literal>1</SPAN>] = dp.CreateCommand(<SPAN class=cpp-string>"UPDATE Test SET TestNumber=44 WHERE ID=2;"</SPAN>);
dp.ExecuteTransaction(commands);</PRE>
            <H2>Using Reflection</H2>
            <P>If you don't already know, Reflection allows us to access and 
            modify an object's class information programmatically. Hence, we can 
            use it to populate an object from a database table.</P><PRE lang=cs>DataProvider dp = 
    <SPAN class=cs-keyword>new</SPAN> DataProvider(<I>ConnectionString</I>, DataProvider.DBType.OleDb);

TestObject obj = <SPAN class=cs-keyword>new</SPAN> TestObject();
obj = (TestObjec) dp.ReflectObject(<SPAN class=cpp-string>"SELECT * FROM Test WHERE TestID=37;"</SPAN>, 
                                                          obj.GetType());</PRE>
            <P>Here, <CODE>TestObject</CODE> is a user-defined class. Make sure 
            that the class member variable names match the field names in the 
            database. Fields that do not match are ignored. I instantiate a new 
            <CODE>TestObject</CODE> here because I require it to get its Type. 
            However, this is unnecessary because <CODE>ReflectObject()</CODE> 
            will return a new instance anyway.</P>
            <P>I've yet to find out a way to determine a Type without going 
            through the trouble of instantiating it (I assume that this is 
            required for runtime identification purposes) or specifying assembly 
            names.</P>
            <P>You can also use <CODE>DataProvider</CODE> to reflect multiple 
            instances of an object and return it as an 
            <CODE>ICollection</CODE>.</P><PRE lang=cs>DataProvider dp = 
    <SPAN class=cs-keyword>new</SPAN> DataProvider(<I>ConnectionString</I>, DataProvider.DBType.OleDb);
TestObject obj = <SPAN class=cs-keyword>new</SPAN> TestObject();
List = (ArrayList) dp.ReflectCollection(<SPAN class=cpp-string>"SELECT * FROM Test;"</SPAN>, 
                                                obj.GetType());</PRE>
            <H2>Final Notes</H2>
            <P>Even if you do not require database independent access, 
            <CODE>DataProvider</CODE> is easy to use. If you have any queries or 
            suggestions, please email <A 
            href="mailto:jaryl.sim@gmail.com">me</A>.</P><!-- Article Ends --></DIV></SPAN>
            <SCRIPT 
            src="Database Independent Access - The Code Project - C# Database_files/togglePre.js" 
            type=text/javascript></SCRIPT>

            <H2>About Jaryl Sim</H2>
            <DIV style="OVERFLOW: hidden">
            <TABLE border=0>
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText noWrap><BR></TD>
                <TD class=smallText>Jaryl Sim is a polytechnic student with a 
                  knack for programming.
                  <P class=smallText>Click <A 
                  href="http://www.codeproject.com/script/profile/whos_who.asp?vt=arts&amp;id=1621814">here</A> 
                  to view Jaryl Sim's online 
            profile.</P></TD></TR></TBODY></TABLE></DIV><BR>
            <TABLE cellPadding=4 width="100%" border=0>
              <TBODY>
              <TR vAlign=top>
                <TD width="100%">
                  <H2>Other popular C# Database articles:</H2>
                  <UL>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/sqldodont.asp">SQL 
                    Server DO's and DONT's</A>
                    <DIV class=smallText>SQL Server database best 
practices</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/SqlInjectionAttacks.asp">SQL 
                    Injection Attacks and Some Tips on How to Prevent Them</A>
                    <DIV class=smallText>Discusses various aspects of SQL 
                    Injection attacks, what to look for in your code, and how to 
                    secure it against SQL Injection attacks.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/relationaladonet.asp">Inserting 
                    relational data using DataSet and DataAdapter</A>
                    <DIV class=smallText>This article describes the process of 
                    inserting data in a DataSet and then submitting this changes 
                    to the database. It targets the issue when having 
                    IDENTITY/AutoNumber columns in the database.</DIV>
                    <LI><A 
                    href="http://www.codeproject.com/cs/database/dac2.asp">Data 
                    Access and Transaction Handling Framework</A>
                    <DIV class=smallText>Generic data access component for 
                    different datasources, sprocs/SQL, implicitly propagated 
                    transactions, explicitly managed transaction contexts 
                    etc.</DIV></LI></UL></TD>
                <TD width=360>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2390&cb=3454750\" border=0 frameborder=0 scrolling=no width=300 height=250></IFRAME>");</SCRIPT>
                </TD></TR></TBODY></TABLE>
            <FORM action=/script/rating/code/app/insert_vote.asp 
            method=post><INPUT type=hidden 
            value=dataprovider/cs/database1/5/2005 name=vote_name> <INPUT 
            type=hidden value=/cs/database/dataprovider.asp name=goal> 
            <TABLE cellSpacing=0 cellPadding=1 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE cellSpacing=0 cellPadding=4 width="100%" 
                  bgColor=#fbedbb border=0>
                    <TBODY>
                    <TR>
                      <TD class=smalltext vAlign=center>[<A 
                        href="http://www.codeproject.com/cs/database/dataprovider.asp#__top">Top</A>]</TD>
                      <TD vAlign=center noWrap align=right><I><B>Rate this 
                        Article for us!</B></I>&nbsp;&nbsp;&nbsp;&nbsp; 
                        <I>Poor</I><INPUT type=radio value=1 name=rate><INPUT 
                        type=radio value=2 name=rate><INPUT type=radio value=3 
                        name=rate><INPUT type=radio value=4 name=rate><INPUT 
                        type=radio value=5 
name=rate><I>Excellent</I>&nbsp;&nbsp;<INPUT class=FormButton type=submit value=Vote> 
                      </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></FORM>
            <CENTER>
            <TABLE cellSpacing=0 cellPadding=0 border=0>
              <TBODY>
              <TR>
                <TD 
                style="PADDING-RIGHT: 2px; PADDING-LEFT: 2px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px; BACKGROUND-COLOR: #eee" 
                width=120 height=60>
                  <DIV align=center>
                  <SCRIPT language=javascript>document.write("<IFRAME src=\"/script/ann/ServeHTML.aspx?C=False&id=2319&cb=3454753\" border=0 frameborder=0 scrolling=no width=120 height=60></IFRAME>");</SCRIPT>
                  </DIV></TD>
                <TD width=100>&nbsp;</TD>
                <TD width=468 height=60><SPAN id=AdBanner5>
                  <SCRIPT language=javascript>document.write("<a href=\"/script/admentor/admentorredir.asp?id=2350&way=ban\" target=_blank><img src=\"/script/ann/ServeImg.aspx?File=%2Fscript%2Fadmentor%2Fimages%2FCWS%5Fcharting%5F468x60%2Ejpg&C=False&id=2350&cb=3454723\" alt=\"\" border=0 width=468 height=60></a>");</SCRIPT>
                  </SPAN></TD></TR></TBODY></TABLE></CENTER><A name=__comments></A>
            <SCRIPT language=JavaScript>

function MsgVoteForm(MemberID, MsgID)
{
	document.write("<span id=\"MVF" + MsgID + "\">");
	document.write("Rate this message: ");
	for (var i=1; i<=5;i++)
	{
		document.write("<a href='#xx" + MsgID.toString() + "xx' title='give this message a vote of " + i.toString());
		document.write("' onclick='return RateMsg(" + MemberID.toString() + ", " + MsgID.toString() + ", ");
		document.write(i.toString() + ")'><b>" + i.toString() + "</b></a> ");
	}
	document.write(" (out of 5)");
	document.writeln("</span>");
	
	document.write("<br />Report as <a href='#xx" + MsgID.toString() + "xx' title='Mark as Spam' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-1)'>Spam</a> or ");
	document.write("<a href='#xx" + MsgID.toString() + "xx' title='Mark as Abuse' onclick='return ReportMsg(" + MemberID.toString());
	document.writeln(", " + MsgID.toString() + ",-2)'>Abuse</a>");
}

function RetypeForm(MemberID, MsgID)
{
	var types = [
				 {pic:'news_general.gif',  id: 1},
	             {pic:'news_info.gif',     id: 2},
	             {pic:'news_question.gif', id: 4},
	             {pic:'news_answer.gif',   id: 8},
	             {pic:'news_game.gif',     id: 16},
	             {pic:'news_spam.gif',     id: 32}
	            ];
	
	document.write("<span id=\"RTF" + MsgID + "\">");
	for (var i=0;i<types.length;i++)
	{
		document.write("<a href='/script/comments/retype?msg=" + MsgID.toString());
		document.write("&mid=" + MemberID.toString() + "&type=" + types[i].id + "'>");
		document.write("<img border=0 src='/script/images/" + types[i].pic + "'></a><br />");
	}
	document.writeln("</span>");
}

function ReportMsg(userid, msgid, score)
{
	if (confirm("Are you sure you want to report this message?") == true)
		return RateMsg(userid, msgid, score);
	else return false;
}


function RateMsg(userid, msgid, score)
{

   var req = new ActiveXObject("Msxml2.XMLHTTP"); 

   req.onreadystatechange = function()
   {
      if ( req.readyState == 4 )
      {
         if ( req.status == 200 )
         {
         	var respText = req.responseText;
         	var re = new RegExp("\<div\>([^\<]*)\</div\>", "g");
         	var match = re.exec(respText);
         	status.innerHTML = "<b>" + (match)?match[1]:"An error occured" + "</b>";
         }
         else
         {
            status.innerHTML = "<b style='color:red'>Failed!" + req.statusText + "</b>";
         }
      }
   }
   
   var status = document.getElementById("MVF" + msgid);
   if (!status) return;  // should never happen...   
   status.innerHTML = "<b style='color:green'>Voting...</b>";
   
   var strAction = "/script/comments/vote.asp?js=1&user="+userid+"&msg="+msgid+"&score="+score;
   req.open("GET", strAction, true);
   req.send(null);
   return false;
}

</SCRIPT>

            <SCRIPT language=JavaScript>
var Selected = "";

var AdTime = new Date();


// Ensures the expanded message appears reasonably close to where 
// it should appear: on screen, and if possible, under the mouse cursor.
function SwitchMessage(e)
{
   if ( !e ) e = window.event;
   var target = e.target ? e.target : e.srcElement;

   // is it a post?
   while ( target && target.id != 'DynMessLink' )
      target = target.parentNode;
   if ( !target || target.id != 'DynMessLink' )
      return;

   if (Selected)
   {
      var body = document.getElementById(Selected + "_h1");
      if (body)
         body.style.display = 'none';
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#FEF9E7';
   }

   if (Selected == target.name) // just collapse
      Selected="";
   else
   {
      Selected = target.name;
      var body = document.getElementById(Selected + "_h1");
      if (body)
      {
         if (body.style.display=='none')
            body.style.display='';
         else
            body.style.display = 'none';
      }
      var head = document.getElementById(Selected + "_h0");
      if (head)
         head.bgColor = '#99CCFF';

      if ( body && head && body.style.display != 'none' )
      {
         // the bit that keeps the post on-screen and under the cursor
         //var dif = (getRealPos(head, "Top") + head.offsetHeight/2) - (document.body.scrollTop+e.clientY);
         //document.body.scrollTop += dif;
         document.body.scrollTop = getRealPos(head, "Top") - document.body.clientHeight/10;
         EnsureMessageVisible(target.name, true);
      }
   }

   if ( e.preventDefault )
      e.preventDefault();
   else
      e.returnValue = false;
   return false;
}

// does its best to make a message visible on-screen (vs. scrolled off somewhere).
function EnsureMessageVisible(msgID, bShowTop) {
   var msgHeader = document.getElementById(msgID + "_h0");
   var msgBody = document.getElementById(msgID + "_h1");

   // determine scroll position of top and bottom
   var scrollContainer = document.body;
   var top = getRealPos(msgHeader, 'Top');
   var bottom = getRealPos(msgBody, 'Top') + msgBody.offsetHeight;

   // if not already visible, scroll to make it so
   if ( scrollContainer.scrollTop > top && !bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
   if ( scrollContainer.scrollTop+scrollContainer.clientHeight < bottom )
      scrollContainer.scrollTop = bottom-scrollContainer.clientHeight;
   if ( scrollContainer.scrollTop > top && bShowTop)
      scrollContainer.scrollTop = top - document.body.clientHeight/10;
}

// utility
function getRealPos(i,which)
{
   iPos = 0
   while (i!=null)
   {
      iPos += i["offset" + which];
      i = i.offsetParent;
   }
   return iPos
}


</SCRIPT>

            <DIV id=_MessageBoard onclick=SwitchMessage(event)>
            <TABLE cellSpacing=0 cellPadding=0 width="100%" bgColor=#ff9900 
            border=0>
              <TBODY>
              <TR>
                <TD width="100%">
                  <TABLE id=ForumTable cellSpacing=1 cellPadding=0 width="100%" 
                  bgColor=#ff9900 border=0>
                    <FORM 
                    action=/script/comments/app/do_filtermessages.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724 
                    method=post>
                    <TBODY>
                    <TR>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=3 width="100%" 
                        bgColor=white border=0>
                          <TBODY>
                          <TR bgColor=#fbedbb>
                            <TD class=smalltext noWrap><A 
                              href="http://www.codeproject.com/script/comments/faq.asp"><IMG 
                              height=16 
                              src="Database Independent Access - The Code Project - C# Database_files/forum_faq.gif" 
                              width=16 align=absMiddle border=0> 
                            <B>FAQ</B></A>&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>Message score threshold <SELECT 
                              class=smalltext size=1 name=noise><OPTION 
                                value=1>1.0</OPTION> <OPTION 
                                value=2>2.0</OPTION> <OPTION value=3 
                                selected>3.0</OPTION> <OPTION 
                                value=4>4.0</OPTION> <OPTION 
                              value=5>5.0</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=center noWrap align=right 
                            colSpan=2><A 
                              href="http://www.codeproject.com/script/comments/search_comments.asp?forumid=141724"><IMG 
                              height=15 
                              src="Database Independent Access - The Code Project - C# Database_files/forum_search.gif" 
                              width=16 border=0> Search comments</A> &nbsp;</TD>
                            <TD vAlign=top align=right><INPUT class=FormButton type=submit value="Set Options" name=submit></TD></TR>
                          <TR bgColor=#ff9900>
                            <TD width="100%">&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap 
                              align=right>View <SELECT class=smalltext size=1 
                              name=expand><OPTION value=0>Normal 
                                (slow)</OPTION> <OPTION value=2>Preview 
                                (slow)</OPTION> <OPTION value=5 selected>Message 
                                View</OPTION> <OPTION value=6>Topic 
                                View</OPTION> <OPTION value=1>Thread 
                                View</OPTION> <OPTION value=3>Expanded 
                                (Supporters only)</OPTION></SELECT>&nbsp;&nbsp;</TD>
                            <TD class=smalltext vAlign=top noWrap>Per page 
                              <SELECT class=smalltext size=1 
                                name=perpage><OPTION value=10>10</OPTION> 
                                <OPTION value=25 selected>25</OPTION> <OPTION 
                                value=50>50</OPTION></SELECT></TD>
                            <TD 
                    colSpan=2>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></FORM>
                    <TR bgColor=#fbedbb>
                      <TD><A name=xx0xx></A>
                        <TABLE cellPadding=2 width="100%" bgColor=#fbedbb 
                        border=0>
                          <TBODY>
                          <TR>
                            <TD class=messagetitle><IMG height=16 
                              src="Database Independent Access - The Code Project - C# Database_files/forum_newmsg.gif" 
                              width=16 align=top border=0><A class=HoverLink 
                              title="Add a new message to the discussions" 
                              href="http://www.codeproject.com/script/comments/user_new.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724" 
                              target=_top name=HoverNL><B>New Message</B></A></TD>
                            <TD class=messagetitle>Msgs 1 to 6 of 6 (Total: 6) 
                              (<A 
                              href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;forumid=141724">Refresh</A>)</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=white>
                      <TD>
                        <TABLE cellSpacing=0 cellPadding=0 width="100%" 
border=0>
                          <TBODY>
                          <TR>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=2 bgColor=#fbedbb 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD class=messagetitle 
                                width="100%">Subject&nbsp;</TD>
                                <TD class=messagetitle noWrap 
                                width=140>Author&nbsp;</TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT 
                                class=messagetitle>Date&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Database Independent Access - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1096389_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1096389xx></A><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;forumid=141724&amp;select=1096389#xx1096389xx" 
                                name=1096389><B>I'll take Simplicity Versus 
                                Complex</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=624004"><IMG 
                                title="Click for User Profile" height=15 
                                src="Database Independent Access - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>vextant</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>12:58 1 
                                May 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1096389_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Just my 
                                2 cents, his DataProvider class is very simple 
                                and easy to use, and I noticed the ADP project, 
                                while a good idea, is a bit large for a simple 
                                Access solution. Being American, the comments in 
                                French (or is that Italian), doesn't help me. I 
                                try to stay away from Access, but alas not 
                                everyone feels the same so I am stuck looking 
                                for a nice class library to make it more 
                                manageable.<BR><BR>I'm going to use this 
                                DataProvider in a project, we'll see how it 
                                goes. Good job! <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1096389">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1096389">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;tid=1096389&amp;forumid=141724&amp;select=1096389#xx1096389xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?msg=1096389#xx1096389xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(624004,1096389);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Database Independent Access - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1096671_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1096671xx></A><IMG 
                                height=1 
                                src="Database Independent Access - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;forumid=141724&amp;select=1096671#xx1096671xx" 
                                name=1096671>Re: I'll take Simplicity Versus 
                                Complex</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1621814"><IMG 
                                title="Click for User Profile" height=15 
                                src="Database Independent Access - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Jaryl Sim&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>2:52 2 May 
                                '05&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1096671_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Database Independent Access - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Thanks 
                                vextant, I've been meaning to update this 
                                article for a long time but haven't found the 
                                time. Also, if you've made any improvements to 
                                the code, please send me a copy if you could 
                                because I'd like to know what could be done to 
                                improve it. There must be something I haven't 
                                forseen and I'm always interested in improving 
                                the code.<BR><BR>The DataProvider here is indeed 
                                supposed to be simple to use and that's why it's 
                                all packaged in a single file. I've been using 
                                it for a long time and it hasn't given me any 
                                problems so far. <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1096671">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1096671">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;tid=1096389&amp;forumid=141724&amp;select=1096671#xx1096671xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?msg=1096671#xx1096671xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1621814,1096671);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Database Independent Access - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Database Independent Access - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1016869_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1016869xx></A><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;forumid=141724&amp;select=1016869#xx1016869xx" 
                                name=1016869><B>ADP</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1440661"><IMG 
                                title="Click for User Profile" height=15 
                                src="Database Independent Access - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Fábio 
                                Batista</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>19:27 15 
                                Jan 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1016869_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Check 
                                this out:<BR><A 
                                href="http://advanced-ado.sourceforge.net/">http://advanced-ado.sourceforge.net/</A><BR><BR>I'm 
                                using this provider in my projects. I think 
                                their idea is better than yours because they 
                                reimplemented the ADO.NET objects (Command, 
                                DataReder, etc) to include extended funcionality 
                                not found in the ADO.NET interfaces (ICommand, 
                                IDataReader, etc). <BR><BR>Fábio David 
                                Batista<BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1016869">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1016869">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;tid=1016869&amp;forumid=141724&amp;select=1016869#xx1016869xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?msg=1016869#xx1016869xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1440661,1016869);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Database Independent Access - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Database Independent Access - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1010112_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1010112xx></A><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle style="COLOR: #aa0000" 
                                width="100%"><A class=messagetitle 
                                id=DynMessLink style="COLOR: #aa0000" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;forumid=141724&amp;select=1010112#xx1010112xx" 
                                name=1010112><B>Determining type...</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=270800"><IMG 
                                title="Click for User Profile" height=15 
                                src="Database Independent Access - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>Arjan 
                                Einbu</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle 
                                style="COLOR: #aa0000"><B>17:19 6 Jan 
                                '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1010112_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Jaryl 
                                Sim wrote: "<I>I've yet to find out a way to 
                                determine a Type without going through the 
                                trouble of instantiating it.</I>"<BR><PRE>TestObject obj = new TestObject();<BR>obj = (TestObjec) dp.ReflectObject("SELECT * FROM Test WHERE TestID=37;", obj.GetType());</PRE>could 
                                be rewritten to:<BR><PRE>TestObject obj = (TestObjec) dp.ReflectObject("SELECT * FROM Test WHERE TestID=37;", typeof(TestObject));</PRE>Saving 
                                you from instantiating an object you're just 
                                going to throw away.<BR>(You won't be able to 
                                determine its type from just a null variable, 
                                due to the possibilities of inheritance 
                                etc.)<BR><BR>Alternatly you could populate the 
                                object thats passed in as a parameter instead of 
                                creating and returning a new one, though that 
                                would perhaps make the code less intuitive... 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1010112">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1010112">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;tid=1010112&amp;forumid=141724&amp;select=1010112#xx1010112xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?msg=1010112#xx1010112xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>Score: 5.0 (1 
                                vote).
                                <SCRIPT language=Javascript>MsgVoteForm(270800,1010112);</SCRIPT>
                                 
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Database Independent Access - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR height=1>
                            <TD bgColor=#ff9900><IMG height=1 
                              src="Database Independent Access - The Code Project - C# Database_files/t.gif" 
                              width=1></TD></TR>
                          <TR id=1009816_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1009816xx></A><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;forumid=141724&amp;select=1009816#xx1009816xx" 
                                name=1009816><B>DAAB 3 (Data Access Application 
                                Block )</B></A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=892140"><IMG 
                                title="Click for User Profile" height=15 
                                src="Database Independent Access - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle><B>Yitzhak 
                                Gootvilig</B>&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle><B>10:16 6 
                                Jan 
                            '05</B>&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1009816_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>Very 
                                good idea!<BR>But.. there is a generic project 
                                called Data Access Application Block version 
                                3.<BR>They implemented already ODBC,OleDB,ORACLE 
                                and SqlServer<BR>See at <A 
                                href="http://www.gotdotnet.com/workspaces/workspace.aspx?id=c20d12b0-af52-402b-9b7c-aaeb21d1f431">http://www.gotdotnet.com/workspaces/workspace.aspx?id=c20d12b0-af52-402b-9b7c-aaeb21d1f431</A>[<A 
                                title="New Window" 
                                href="http://www.gotdotnet.com/workspaces/workspace.aspx?id=c20d12b0-af52-402b-9b7c-aaeb21d1f431" 
                                target=_blank>^</A>]<BR><BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1009816">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1009816">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;tid=1009816&amp;forumid=141724&amp;select=1009816#xx1009816xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?msg=1009816#xx1009816xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(892140,1009816);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=6 
                              src="Database Independent Access - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR>
                          <TR id=1009833_h0 bgColor=#fef9e7>
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD bgColor=white><A name=xx1009833xx></A><IMG 
                                height=1 
                                src="Database Independent Access - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_general.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD class=messagetitle width="100%"><A 
                                class=messagetitle id=DynMessLink 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;forumid=141724&amp;select=1009833#xx1009833xx" 
                                name=1009833>Re: DAAB 3 (Data Access Application 
                                Block )</A></TD>
                                <TD vAlign=bottom noWrap><A 
                                href="http://www.codeproject.com/script/profile/whos_who.asp?id=1621814"><IMG 
                                title="Click for User Profile" height=15 
                                src="Database Independent Access - The Code Project - C# Database_files/userinfo.gif" 
                                width=14 border=0></A>&nbsp;</TD>
                                <TD noWrap width=140><FONT 
                                class=messagetitle>Jaryl Sim&nbsp;</FONT></TD>
                                <TD style="WIDTH: 9em" noWrap align=right 
                                width=120><FONT class=messagetitle>10:42 6 Jan 
                                '05&nbsp;</FONT></TD></TR></TBODY></TABLE></TD></TR>
                          <TR id=1009833_h1 style="DISPLAY: none">
                            <TD width="100%">
                              <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                              border=0>
                                <TBODY>
                                <TR>
                                <TD><IMG height=1 
                                src="Database Independent Access - The Code Project - C# Database_files/ind.gif" 
                                width=18><IMG 
                                src="Database Independent Access - The Code Project - C# Database_files/news_blank.gif" 
                                align=absMiddle>&nbsp;</TD>
                                <TD width="100%" bgColor=#d5eaff>
                                <TABLE cellSpacing=5 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD>
                                <TABLE cellSpacing=0 cellPadding=0 width="100%" 
                                border=0>
                                <TBODY>
                                <TR>
                                <TD colSpan=2><FONT class=messagecontent>I've 
                                been meaning to check out application blocks. I 
                                did this article after creating the DataProvider 
                                from another article and building upon it 
                                further.<BR><BR>Check it out <A 
                                href="http://www.developer.com/db/article.php/1452401">here</A><BR><BR>It 
                                seemed the right thing to share the code. 
                                Perhaps I should also show how it is done? 
                                <BR>&nbsp;</FONT></TD></TR>
                                <TR vAlign=top>
                                <TD class=messagetitle>[<A 
                                title="Reply to this current thread" 
                                href="http://www.codeproject.com/script/comments/user_reply.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1009833">Reply</A> 
                                | <A 
                                title="Email a reply to the author of this message" 
                                href="http://www.codeproject.com/script/comments/user_mail.asp?main=/cs/database/dataprovider.asp&amp;df=100&amp;forumid=141724&amp;select=1009833">Email</A> 
                                | <A 
                                title="View only messages within this thread" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?df=100&amp;tid=1009816&amp;forumid=141724&amp;select=1009833#xx1009833xx">View 
                                Thread</A> | <A 
                                title="Get the URL for this message" 
                                href="http://www.codeproject.com/cs/database/dataprovider.asp?msg=1009833#xx1009833xx">Get 
                                Link</A>]</TD>
                                <TD class=messagetitle align=right>
                                <SCRIPT language=Javascript>MsgVoteForm(1621814,1009833);</SCRIPT>
                                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
                          <TR>
                            <TD><IMG height=5 
                              src="Database Independent Access - The Code Project - C# Database_files/t.gif" 
                              width=1 border=0></TD></TR></TBODY></TABLE></TD></TR>
                    <TR bgColor=#fbedbb>
                      <TD>
                        <TABLE cellPadding=2 width="100%">
                          <TBODY>
                          <TR>
                            <TD class=messagetitle>Last Visit: 9:30 Saturday 
                              11th November, 2006</TD>
                            <TD noWrap align=right><FONT 
                              class=messagetitle><SPAN 
                              class=HoverLink>First</SPAN> <SPAN 
                              class=HoverLink>Prev</SPAN> <SPAN 
                              class=HoverLink>Next</SPAN> <SPAN 
                              class=HoverLink>&nbsp;&nbsp;&nbsp;&nbsp;</SPAN> 
                              </FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></DIV>
            <P class=smallText><IMG 
            src="Database Independent Access - The Code Project - C# Database_files/news_general.gif" 
            align=absMiddle> General comment &nbsp;&nbsp; <IMG 
            src="Database Independent Access - The Code Project - C# Database_files/news_info.gif" 
            align=absMiddle> News / Info &nbsp;&nbsp; <IMG 
            src="Database Independent Access - The Code Project - C# Database_files/news_question.gif" 
            align=absMiddle> Question &nbsp;&nbsp; <IMG 
            src="Database Independent Access - The Code Project - C# Database_files/news_answer.gif" 
            align=absMiddle> Answer &nbsp;&nbsp; <IMG 
            src="Database Independent Access - The Code Project - C# Database_files/news_game.gif" 
            align=absMiddle> Joke / Game &nbsp;&nbsp; <IMG 
            src="Database Independent Access - The Code Project - C# Database_files/news_sticky.gif" 
            align=absMiddle> Admin message</P><BR>
            <TABLE cellSpacing=5 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD class=smallText>Updated: 5 Jan 2005 </TD>
                <TD class=SmallText align=right>Article content copyright 
                  Jaryl Sim, 2005<BR>everything else Copyright © <A 
                  href="mailto:webmaster@codeproject.com">CodeProject</A>, 
                  1999-2006</A>. <BR>Web10 | <A 
                  href="http://www.codeproject.com/info/MediaKit">Advertise on 
                  The Code Project</A> | <A 
                  href="http://www.codeproject.com/info/privacy.asp">Privacy</A> 
                </TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
      <SCRIPT 
      src="Database Independent Access - The Code Project - C# Database_files/front.asp" 
      type=text/javascript></SCRIPT>
      <BR>
      <CENTER>
      <TABLE cellSpacing=0 cellPadding=0 width="95%" border=0>
        <TBODY>
        <TR>
          <TD bgColor=#ff9900 height=1><IMG height=1 
            src="Database Independent Access - The Code Project - C# Database_files/space.gif"></TD></TR>
        <TR>
          <TD align=middle><FONT size=1><A 
            href="http://www.theultimatetoolbox.com/">The Ultimate Toolbox</A>  
            <A href="http://www.aspalliance.com/">ASP Alliance</A>  <A 
            href="http://www.developerfusion.co.uk/">Developer Fusion</A>  <A 
            href="http://www.developersdex.com/">Developersdex</A>  <A 
            href="http://www.devguru.com/">DevGuru</A>  <A 
            href="http://www.programmersheaven.com/">Programmers Heaven</A>  <A 
            href="http://www.planet-source-code.com/">Planet Source Code</A>  
            <A href="http://www.tek-tips.com/">Tek-Tips Forums</A>  
        </FONT></TD></TR></TBODY></TABLE></CENTER></TR></TBODY></TABLE></BODY></HTML>
