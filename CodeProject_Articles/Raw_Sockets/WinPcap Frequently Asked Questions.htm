<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0035)http://www.winpcap.org/misc/faq.htm -->
<!-- saved from url=(0024)http://netgroup/winpcap/ --><HTML><HEAD><TITLE>WinPcap Frequently Asked Questions</TITLE>
<META http-equiv=Content-Type content="text/html; charset=windows-1252">
<META http-equiv=Content-Language content=en-us>
<META 
content="packet capture, packet filtering, packet injection, network monitoring, network driver, packet driver, network traffic generation, Windows Drivers, network monitoring, network analysis, network traffic analysis, packet analyzers, protocol analyzers, network troubleshooting, network analysis, network tools, TCP/IP, Ethernet, Ethernet analysis, network traffic injection, traffic generation" 
name=keywords>
<META 
content="Packet library for Windows. WinPcap is the standard tool for link-layer network access in the Windows environments: it can be used to capture and transmit raw network packets and has many useful advanced features, including kernel-level filtering, a network statistics engine and support for remote capture. WinPcap consists of a driver, that extends the operating system to provide low-level network access and a library that developer's can use to easily access the low-level network layers." 
name=description><LINK 
href="WinPcap Frequently Asked Questions_files/winpcap.css" type=text/css 
rel=stylesheet>
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY vLink=#b7a787 aLink=#b7a787 link=#776747 bgColor=#dfd7c7>
<H1>WinPcap: The Windows Packet Capture Library</H1>
<TABLE id=table2 cellSpacing=0 cellPadding=0 width="100%" border=0>
  <TBODY>
  <TR>
    <TD vAlign=top align=left rowSpan=4><!--webbot bot="Include" U-Include="../buttons.htm" TAG="BODY" startspan -->
      <TABLE style="MARGIN-RIGHT: 10px" borderColor=#666666 cellSpacing=0 
      cellPadding=2 bgColor=#000000 border=1>
        <TBODY>
        <TR>
          <TD class=menu onmouseover="style.background='#ffffcc'" 
          onmouseout="style.background='#77bbee'" borderColor=black><A 
            class=anchmenu 
            href="http://www.winpcap.org/default.htm">Home&nbsp;&nbsp;&nbsp;&nbsp;</A></TD></TR>
        <TR>
          <TD class=menu onmouseover="style.background='#ffffcc'" 
          onmouseout="style.background='#77bbee'" borderColor=black><A 
            class=anchmenu 
            href="http://www.winpcap.org/news.htm">News&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A></TD></TR>
        <TR>
          <TD class=menu onmouseover="style.background='#ffffcc'" 
          onmouseout="style.background='#77bbee'" borderColor=black><A 
            class=anchmenu href="http://www.winpcap.org/install/default.htm">Get 
            WinPcap&nbsp;&nbsp;</A></TD></TR>
        <TR>
          <TD class=menu onmouseover="style.background='#ffffcc'" 
          onmouseout="style.background='#77bbee'" borderColor=black><A 
            class=anchmenu 
            href="http://www.winpcap.org/windump/install/default.htm">Get 
            WinDump&nbsp;</A></TD></TR>
        <TR>
          <TD class=menu onmouseover="style.background='#ffffcc'" 
          onmouseout="style.background='#77bbee'" borderColor=black><A 
            class=anchmenu 
            href="http://www.winpcap.org/devel.htm">Development&nbsp;&nbsp;</A></TD></TR>
        <TR>
          <TD class=menu onmouseover="style.background='#ffffcc'" 
          onmouseout="style.background='#77bbee'" borderColor=black><A 
            class=anchmenu 
            href="http://www.winpcap.org/contact.htm">Support&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A></TD></TR>
        <TR>
          <TD class=menu onmouseover="style.background='#ffffcc'" 
          onmouseout="style.background='#77bbee'" borderColor=black><A 
            class=anchmenu 
            href="http://www.cacetech.com/products/index.htm?utm_source=Winpcap&amp;utm_medium=cpc&amp;utm_term=products&amp;utm_content=products&amp;utm_campaign=Winpcap_Product">Products&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A></TD></TR>
        <TR>
          <TD class=menu onmouseover="style.background='#ffffcc'" 
          onmouseout="style.background='#77bbee'" borderColor=black><A 
            class=anchmenu 
            href="http://www.winpcap.org/misc/links.htm">Links&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A></TD></TR>
        <TR>
          <TD class=menu onmouseover="style.background='#ffffcc'" 
          onmouseout="style.background='#77bbee'" borderColor=black><A 
            class=anchmenu 
            href="http://www.winpcap.org/misc/faq.htm">FAQ&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A></TD></TR>
        <TR>
          <TD class=menu onmouseover="style.background='#ffffcc'" 
          onmouseout="style.background='#77bbee'" borderColor=black><NOBR><A 
            class=anchmenu href="http://www.winpcap.org/misc/credits.htm">The 
            Team&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A></NOBR></TD></TR>
        <TR>
          <TD class=menu onmouseover="style.background='#ffffcc'" 
          onmouseout="style.background='#77bbee'" borderColor=black><A 
            class=anchmenu 
            href="http://www.winpcap.org/misc/copyright.htm">License&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</A></TD></TR></TBODY></TABLE><!--webbot bot="Include" endspan i-checksum="815" --></TD>
    <TD vAlign=top bgColor=#ffffff><IMG height=28 
      src="WinPcap Frequently Asked Questions_files/curve.gif" width=31 
border=0>
      <TABLE id=table119 cellSpacing=0 cellPadding=9 width="100%" border=0>
        <TBODY>
        <TR>
          <TD vAlign=top>
            <TABLE id=table120 cellSpacing=0 cellPadding=0 width="100%" 
border=0>
              <TBODY>
              <TR>
                <TD vAlign=top>
                  <H2>Frequently Asked Questions</H2>
                  <OL>
                    <LI><I><A href="http://www.winpcap.org/misc/faq.htm#Q-1">How 
                    can I see if WinPcap is installed on my system? How can I 
                    remove it?</A></I> 
                    <LI><I><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-2">After the 
                    installation, I cannot see WinPcap under the properties of 
                    my network adapter in control panel. Did anything go 
                    wrong?</A></I> 
                    <LI><I><A href="http://www.winpcap.org/misc/faq.htm#Q-3">How 
                    can I see if WinPcap is currently running on my Win2K/XP 
                    machine?</A></I> 
                    <LI><I><A href="http://www.winpcap.org/misc/faq.htm#Q-4">The 
                    XXX WinPcap-based application doesn't run properly on my 
                    system. Is it a WinPcap problem?</A></I> 
                    <LI><I><A href="http://www.winpcap.org/misc/faq.htm#Q-6">Can 
                    I use WinPcap on a PPP connection?</A></I> 
                    <LI><I><A href="http://www.winpcap.org/misc/faq.htm#Q-6">Can 
                    I use WinPcap on a VPN connection?</A></I> 
                    <LI><I><A href="http://www.winpcap.org/misc/faq.htm#Q-7">Do 
                    I need to be Administrator in order to execute programs 
                    based on WinPcap on Windows NT/2000/XP?</A></I> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-8">Can I use 
                    WinPcap with Borland development tools?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-9">Can I use 
                    WinPcap with Visual Basic?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-10">Does WinPcap 
                    work in connection with personal firewalls?</A></EM> 
                    <LI><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-11"><I>When I 
                    capture on Windows in promiscuous mode, I can see packets 
                    other than those sent to or from my machine; however, those 
                    packets show up with a "Short Frame" indication, unlike 
                    packets to or from my machine.&nbsp; What should I do to 
                    arrange that I see those packets in their entirety?</I></A> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-12">Does WinPcap 
                    work with Java?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-13">Does WinPcap 
                    support the loopback device?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-14">On which OS 
                    can I run WinPcap?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-15">Does WinPcap 
                    work on my multiprocessor (SMP) machine?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-16">Which 
                    network adapters are supported by WinPcap?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-17">Can I use 
                    WinPcap to drop the incoming packets? Is it possible to use 
                    WinPcap to build a firewall?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-18">Is it 
                    possible to start WinPcap automatically when the system 
                    boots?</A></EM> 
                    <LI><EM><A href="http://www.winpcap.org/misc/faq.htm#Q-19">I 
                    recompiled the sources of WinPcap and the result doesn't 
                    seem to work as expected.</A></EM> 
                    <LI><EM><A href="http://www.winpcap.org/misc/faq.htm#Q-20">I 
                    installed Zx Sniffer on my PC, and after that, WinPcap based 
                    applications fail to work. What's wrong?</A></EM> 
                    <LI><I><A href="http://www.winpcap.org/misc/faq.htm#Q-21">My 
                    application doesn't see any traffic being sent by the 
                    machine running WinPcap.</A></I> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-22">When I use 
                    one of the WinPcap-based applications, why do I see only 
                    packets to or from my machine, or why do I not see all the 
                    traffic I'm expecting to see from or to the machine I'm 
                    trying to monitor? </A></EM>
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-23">If I try to 
                    compile my application using the new pcap APIs provided in 
                    WinPcap 3.1beta, the compiler fails with <CODE>"warning 
                    C4013: 'pcap_???' undefined"</CODE> or <CODE>"error C2065: 
                    'PCAP_OPENFLAG_????' : undeclared identifier"</CODE>. What's 
                    the problem?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-24">If I try 
                    compile wpcap.dll with the project configuration "wpcap - 
                    Win32 Debug" or "wpcap - Win32 Release" some pcap APIs (like 
                    <CODE>pcap_open()</CODE>) are not exported. Is it 
                    normal?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-25">I'm trying 
                    to capture from my dialup(PPP) connection with WinPcap 
                    3.1beta, but I cannot see any PPP adapter. What's the 
                    problem (this information applies to 2000/XP/2003 
                    only)?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-26">How does 
                    WinPcap interfaces with Windows Networking? Does it slow 
                    down the TCP/IP stack and applications?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-27">My antivirus 
                    / antispyware detector program reports WinPcap as a virus / 
                    trojan/ spyware! Are you hackers trying to infect my 
                    computer?</A></EM> 
                    <LI><EM><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-28">Does WinPcap 
                    work on Windows Vista?</A></EM> 
                    <LI><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-29"><EM>Whenever 
                    I try to create a WinPcap-based application with Visual 
                    Studio.NET 2002 or later, I get the error 
                    "</EM><I><CODE>TypeLoadException, Could not load type 
                    pcap"</CODE>.</I></A> 
                    <LI><I><A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-30">The WinPcap 
                    installation fails with the error message "An error occurred 
                    while installing the NPF driver ( -1 ). Please contact the 
                    WinPcap team"</A></I> </LI></OL>
                  <P>&nbsp;</P>
                  <P>&nbsp;</P>
                  <HR>

                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-1>Q-1</A></B></FONT>: <I><A 
                  name=remove>How can I see if</A> WinPcap is installed on my 
                  system? How can I remove it?</I></P>
                  <P><FONT size=4><B>A</B></FONT>: <B>WinPcap 2.1 or newer</B>: 
                  go to the control-panel, then open the "Add or Remove 
                  Programs" applet.&nbsp; If WinPcap is present in your system, 
                  an entry called "WinPcap" will be present.&nbsp; Double-click 
                  on it to uninstall WinPcap.<BR><B>WinPcap 2.02 or older</B>: 
                  go to the control-panel, then open the "Network" applet. If 
                  WinPcap is present in your system, an entry called "Packet 
                  Capture Driver" will be listed (in Windows NT you have to 
                  choose the "Services" tab). Select it and press "Remove" to 
                  uninstall WinPcap.</P>
                  <P>To be absolutely sure that WinPcap has been installed, 
                  please look at your system folder: you should find files 
                  called packet.* and wpcap.dll. Please check the file dates: 
                  these should be compatible with the WinPcap release dates. 
                  We've had reports of trojans or other malware that silently 
                  install the WinPcap driver, NPF.sys. If you've been infected 
                  by them, you'll probably see the driver file in 
                  Windows\System32\Drivers, but no entries in the "Add or Remove 
                  Programs" applet and no dlls.</P>
                  <P><B>IMPORTANT NOTE</B>: sometimes, when uninstalling WinPcap 
                  version 2.02 or older from the control panel's network applet 
                  in Windows 9x, the file Windows\Packet.dll is not deleted. You 
                  must delete this file manually, otherwise version 2.1 will not 
                  work properly and could cause system crashes.&nbsp;</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-2>Q-2</A></B></FONT>:<I> After 
                  the installation, I cannot see WinPcap under the properties of 
                  my network adapter in control panel. Did anything go 
                  wrong?</I></P>
                  <P><FONT size=4><B>A</B></FONT>: No, if you have a recent 
                  version of WinPcap. As <A 
                  href="http://www.winpcap.org/misc/faq.htm#Q-1">Q-1</A> says, 
                  recent versions appear under "add/remove programs" and not 
                  under network properties.</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-3>Q-3</A></B></FONT>: <I>How can 
                  I see if WinPcap is currently running on my Win2K/XP/2k3 
                  machine?</I></P>
                  <P><FONT size=4><B>A</B></FONT>: Click on the Start button and 
                  then on <I>run</I>. Type <CODE>msinfo32</CODE>. The System 
                  Information panel will show up. Choose Software Environment, 
                  then System Drivers. The entry <I>NPF</I> should appear there. 
                  If you launched a WinPcap application previously, the state 
                  should be <I>running</I>. Remember that WinPcap should have 
                  been run at least one time in order to appear in this 
list.</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-4>Q-4</A></B></FONT>: <I>The XXX 
                  WinPcap-based application doesn't run properly on my system. 
                  Is it a WinPcap problem?</I></P>
                  <P><FONT size=4><B>A</B></FONT>: Try <A 
                  href="http://www.winpcap.org/windump">Windump</A>. In 
                  particular, "windump -D" reports the list of valid adapters 
                  and shows if WinPcap is able to detect correctly your 
                  hardware. If WinDump works, the problem is in the <I>XXX</I> 
                  program and not in WinPcap, so contact the authors of XXX for 
                  help.</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-5>Q-5</A></B></FONT>: <I>Can I 
                  use WinPcap on a PPP connection?</I></P>
                  <P><FONT size=4><B>A</B></FONT>: <B>Windows 9x</B>: We have 
                  tested WinPcap on PPP connections under Windows 95, Windows 98 
                  and Windows ME. In Windows 95, due to a bug in NDIS, WinPcap 
                  sometimes resets the PPP connection. In Windows 98/ME this bug 
                  seems to be fixed, and WinPcap seems to receive packets 
                  correctly, however it's <B>not</B> able to transmit packets. 
                  </P>
                  <P><B>Windows NT4/Longhorn/Vista/64 bit:</B> these systems 
                  have limitations in the NDIS binding process that prevent a 
                  protocol driver from working properly on WAN adapters. It's 
                  <B><I>not</I></B> possible to capture on PPP/VPN connections 
                  on these operating systems.</P>
                  <P><B>Windows 2000/XP/2003:</B> these systems have limitations 
                  in the NDIS binding process that prevent a protocol driver 
                  from working properly on WAN adapters. WinPcap 3.1 and newer 
                  offer limited support for capturing on dial-up adapters using 
                  a wrapper over the Microsoft NetMon driver. <BR>NOTES:</P>
                  <UL>
                    <LI>it is possible to capture control packets (LCP and NCP) 
                    using the "Generic Dialup" or "Generic NdisWan" adapter 
                    (which is always listed even if no dialup connections are 
                    available). Control frames are captured as Ethernet 
                    encapsulated PPP frames. 
                    <LI>the PPP protocol is translated by the OS into a fake 
                    Ethernet. You'll see Ethernet frames and not PPP frames. 
                    <LI>transmission is not supported. 
                    <LI>filtering and statistics gathering is done at user 
                    level. </LI></UL>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-6>Q-6</A></B></FONT>: <I>Can I 
                  use WinPcap on a VPN connection?</I></P>
                  <P><FONT size=4><B>A</B></FONT>: If you use standard Windows 
                  VPNs, yes, with the restrictions explained in <A 
                  href="http://www.winpcap.org/misc/faq.htm#Q-5">Q5</A>. A 
                  Windows VPN is treated by the OS as a dial-up connection, so 
                  everything explained in <A 
                  href="http://www.winpcap.org/misc/faq.htm#Q-5">Q5</A> applied 
                  here too. Third party VPN implementation: some of them are not 
                  detected because of their unclean NDIS intermediate driver 
                  structure.</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-7>Q-7</A></B></FONT>: <I>Do I 
                  need to be Administrator in order to execute programs based on 
                  WinPcap on Windows NT/2000/XP?</I></P>
                  <P><FONT size=4><B>A</B></FONT>: Yes/no. The security model of 
                  WinPcap is quite poor, and we plan to work on it in the 
                  future. At the moment, if you execute a WinPcap-based 
                  application for the first time since the last reboot, you must 
                  be administrator. At the first execution, the driver will be 
                  dynamically installed in the system, and from that moment 
                  every user will be able to use WinPcap to sniff the 
                  packets.</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-8>Q-8</A></B></FONT>:<EM> Can I 
                  use WinPcap with Borland development tools?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: Note first of all that we 
                  support <B>only</B> Microsoft Visual C++, so we are not able 
                  to provide help about other compilers.</P>
                  <P>If you want to use to Use WinPcap under C++ Builder 
                  (version 5.0), you have to use the program COFF2OMF.EXE which 
                  can be find&nbsp; in the directory of BORLAND. This program 
                  gives the possibility to convert Packet.lib and wpcap.lib 
                  (which are in the Visual C++ standart, COFF) to the OMF 
                  standart, the one of C++ Builder. For more information type 
                  COFF2OMF in the Help of C++ Builder.<BR>Syntax (in a DOS 
                  console) :&nbsp;</P>
                  <BLOCKQUOTE><PRE>COFF2OMF input.lib output.lib
</PRE></BLOCKQUOTE>
                  <P>In this case case Input.lib = wpcap.lib or 
                  packet.lib<BR>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-9>Q-9</A></B></FONT>:<EM> Can I 
                  use WinPcap with Visual Basic?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: We don't support Visual Basic 
                  and we are not able to provide help on this subject because we 
                  don't know enough about it. BeeSync has developed an ActiveX 
                  control that integrates the WinPcap packet capture 
                  functionality with Visual Basic or any other programming 
                  environment supporting Microsoft ActiveX technology. You can 
                  find it at <A 
                  href="http://www.beesync.com/products.html">http://www.beesync.com/products.html</A>.</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-10>Q-10</A></B></FONT>:<EM> Does 
                  WinPcap work in connection with personal firewalls?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: We got several reports saying 
                  that WinPcap does not work well if a personal firewall is 
                  installed on the same machine as WinPcap. The typical problem 
                  is the impossibility to capture all or part of the traffic 
                  from an adapter, but some users reported strange behaviors 
                  (like some packets disappearing) on the transmit side 
                  too.<BR>Most of the times, the problem is caused by 
                  non-standard interactions between the firewall and the network 
                  stack of the OS, so there not a lot to do on our side; the 
                  suggested remedy consists in uninstalling the firewall. 
                  <BR>Note: <B>uninstalling</B>, and not <B>disabling</B>, 
                  because some firewalls (like <I>ZoneAlarm</I>) keep having 
                  strange behaviors even when they are disabled.</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-11>Q-11</A></B></FONT>:<EM> 
                  </EM><I>When I capture on Windows in promiscuous mode, I can 
                  see packets other than those sent to or from my machine; 
                  however, those packets show up with a "Short Frame" 
                  indication, unlike packets to or from my machine.&nbsp; What 
                  should I do to arrange that I see those packets in their 
                  entirety?</I></P>
                  <P><FONT size=4><B>A</B></FONT>: In at least some cases, this 
                  appears to be the result of PGPnet running on the network 
                  interface on which you're capturing; turn it off on that 
                  interface.</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-12>Q-12</A></B></FONT>:<EM> Does 
                  WinPcap work with Java?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: We do not directly support 
                  Java. However you can find a Java wrapper at <A 
                  href="http://netresearch.ics.uci.edu/kfujii/jpcap/doc/index.html">http://netresearch.ics.uci.edu/kfujii/jpcap/doc/index.html</A> 
                  and <A 
                  href="http://jnetpcap.sourceforge.net/">http://jnetpcap.sourceforge.net/</A>.</P>
                  <P> 
                  <P><FONT size=4><B><A name=Q-13>Q-13</A></B></FONT>:<EM> Does 
                  WinPcap support the loopback device?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: No. Only physical interfaces 
                  are supported. This is a limitation of Windows and not of 
                  WinPcap.</P>
                  <P> 
                  <P><FONT size=4><B><A name=Q-14>Q-14</A></B></FONT>:<EM> On 
                  which OS can I run WinPcap?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: WinPcap can run on all the 
                  main Win32 operating systems:Windows 95, 98, ME, NT4, 2000, 
                  XP, 2003, Vista (formerly known as "Longhorn"). 
                  <P>The overall situation is the following one:
                  <UL>
                    <LI><B>Windows 95,98, ME</B>: Support for Windows 95/98/ME 
                    has been dropped starting from WinPcap 4.0 beta3. The source 
                    packages still include the code base for those operating 
                    systems, but the setup executable will refuse to install. 
                    The last versions supporting such operating systems are 
                    WinPcap 3.1 (stable) and WinPcap 4.0 beta2 (unstable), 
                    <I>however </I>they are no longer supported by the WinPcap 
                    team, so if you encounter any problem you are on your own. 
                    <LI><B>Windows XP/2003</B>: WinPcap 2.3 or newer is 
                    required. 
                    <LI><B>Windows XP/2003 (x64)</B>: WinPcap 3.2 alpha1 or 
                    newer is required. Capture from dialup/VPN adapters is not 
                    supported on 64 bit platforms. 
                    <LI><B>Vista/Longhorn (x86)</B>: WinPcap 3.1 should work, 
                    but with limited functionality. PPP is not supported, and 
                    IPv6 addresses are not listed. We strongly suggest upgrading 
                    to WinPcap 4.0 or newer for better support on Windows Vista. 
                    Please refer to <A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-28">FAQ Q-28</A> 
                    for more details on Vista support. 
                    <LI><B>Vista/Longhorn (x64)</B>: WinPcap 4.0 or newer is 
                    required. </LI></UL>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-15>Q-15</A></B></FONT>:<EM> Why 
                  doesn't WinPcap work on my multiprocessor (SMP) 
                  machine?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: Support for SMP machines has 
                  been included starting from version 3.0. Please update your 
                  installation of WinPcap.
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-16>Q-16</A></B></FONT>:<EM> Which 
                  network adapters are supported by WinPcap?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: The WinPcap device driver was 
                  developed to work primarily with Ethernet (10/100/1000) 
                  adapters. Support for other MACs was added during the 
                  development, but Ethernet remains the most tested one. A 
                  pretty complete list of supported adapters is maintained by 
                  the AirSnare team at <A 
                  href="http://www.micro-logix.com/WinPcap/Supported.asp">http://www.micro-logix.com/WinPcap/Supported.asp</A>, 
                  you are encouraged to use that page to report the results of 
                  your experiences with WinPcap. REMEMBER that this list is 
                  created by WinPcap Users, so it cannot be considered official 
                  or 100% reliable. <BR>The overall situation is: 
                  <UL>
                    <LI><B>Windows 95/98/ME</B>: the packet driver works ok on 
                    Ethernet networks. It works also on PPP WAN links, but with 
                    some limitations (for example it is not able to capture the 
                    LCP and NCP packets). FDDI, ARCNET, ATM and Token Ring 
                    should be supported, however we did not test them because we 
                    do not have the hardware.<BR>&nbsp; 
                    <LI><B>Windows NT4/2000/XP/2003/Vista</B>: the packet driver 
                    works ok on Ethernet networks. As for dial-up adapters and 
                    VPN connections, read <A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-5">Q5</A> and <A 
                    href="http://www.winpcap.org/misc/faq.htm#Q-6">Q6</A>.&nbsp; 
                    As in Win9x,&nbsp; FDDI, ARCNET, ATM and Token Ring are 
                    supported, but not tested by us.<BR>&nbsp; 
                    <LI><B>Wireless adapters</B>: these adapters may present 
                    problems, because they are not properly supported by the 
                    Windows Kernel. Some of them are not detected, other don't 
                    support promiscuous mode. In the best case, WinPcap is able 
                    to see an Ethernet emulation and not the real transiting 
                    packets: this means that the 802.11 frames are transformed 
                    into fake Ethernet frames before being captured, and that 
                    control frames are not received. Again, refer to the <A 
                    href="http://www.micro-logix.com/WinPcap/Supported.asp">http://www.micro-logix.com/WinPcap/Supported.asp</A> 
                    to discover if your adapter works. If it doesn't, you can 
                    use <A 
                    href="http://www.micro-logix.com/WinPcap/howtonetworkbridge.avi">the 
                    trick explained in this video</A> to capture its 
                    traffic.<BR><BR>For real wireless capture, CACE Technologies 
                    offers the <A 
                    href="http://www.cacetech.com/products/airpcap.htm">AirPcap 
                    adapter</A>, specifically designed to sniff 802.11 traffic, 
                    including control frames, management frames and power 
                    information. AirPcap at this time is the only solution for 
                    capturing raw 802.11 traffic with WinPcap. More details can 
                    be found on the <A 
                    href="http://www.cacetech.com/products/airpcap.htm">AirPcap 
                    product page</A>. </LI></UL>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-17>Q-17</A></B></FONT>:<EM> Can I 
                  use WinPcap to drop the incoming packets? Is it possible to 
                  use WinPcap to build a firewall?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: No. WinPcap is implemented as 
                  a protocol, therefore it is able to capture the packets, but 
                  it can't be used to drop them before they reach the 
                  applications. The filtering capabilities of WinPcap work only 
                  on the sniffed packets. In order to intercept the packets 
                  before the TCP/IP stack, you must create an intermediate 
                  driver.&nbsp; 
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-18>Q-18</A></B></FONT>:<EM> Is it 
                  possible to start WinPcap automatically when the system 
                  boots?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: You can change the start 
                  settings of the NPF service to "automatic" or "system". A way 
                  to do this is changing the registry key 
                  HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\NPF\Start 
                  from 0x3 (SERVICE_DEMAND_START) to 0x2 (SERVICE_AUTO_START) or 
                  0x1 (SERVICE_SYSTEM_START). This works only in Windows NTx.
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-19>Q-19</A></B></FONT>:<EM> I 
                  recompiled the sources of WinPcap and the result doesn't seem 
                  to work as expected.</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: If you used Microsoft Visual 
                  Studio 6, try to install the service pack 5 and compile again. 

                  <P>&nbsp;
                  <P><FONT size=4><B><A name=Q-20>Q-20</A></B></FONT>:<EM> I 
                  installed Zx Sniffer on my PC, and after that, WinPcap based 
                  applications fail to work. What's wrong?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: Zx Sniffer uses a custom 
                  packet capture driver that is <B>very</B> similar to WinPcap, 
                  which conflicts with WinPcap. You have to uninstall ZxSniffer 
                  to make WinPcap working.
                  <P>&nbsp;
                  <P><FONT size=4><B><A name=Q-21>Q-21</A></B></FONT>:<EM> 
                  </EM><I>My application doesn't see any traffic being sent by 
                  the machine running WinPcap.</I></P>
                  <P><FONT size=4><B>A</B></FONT>: If you are running some form 
                  of VPN client software, it might be causing this problem; 
                  people have seen this problem when they have Check Point's VPN 
                  software installed on their machine. If that's the cause of 
                  the problem, you will have to remove the VPN software in order 
                  to make the application see outgoing packets.
                  <P>&nbsp;
                  <P><FONT size=4><B><A name=Q-22>Q-2<SPAN 
                  lang=en-nz>2</SPAN></A></B></FONT>:<EM> </EM><I>When I use 
                  <SPAN lang=en-nz>one of the WinPcap-based applications</SPAN>, 
                  why do I see only packets to or from my machine, or why do I 
                  not see all the traffic I'm expecting to see from or to the 
                  machine I'm trying to monitor?</I></P>
                  <P><FONT size=4><B>A</B></FONT>: This might be because the 
                  interface on which you're capturing is plugged into a switch; 
                  on a switched network, unicast traffic between two ports will 
                  not necessarily appear on other ports - only broadcast and 
                  multicast traffic will be sent to all ports. 
                  <P>Note that even if your machine is plugged into a hub, the 
                  "hub" may be a switched hub, in which case you're still on a 
                  switched network. </P>
                  <P>Note also that on the Linksys Web site, they say that their 
                  auto-sensing hubs "broadcast the 10Mb packets to the port that 
                  operate at 10Mb only and broadcast the 100Mb packets to the 
                  ports that operate at 100Mb only", which would indicate that 
                  if you sniff on a 10Mb port, you will not see traffic coming 
                  sent to a 100Mb port, and <I>vice versa</I>. This problem has 
                  also been reported for Netgear dual-speed hubs, and may exist 
                  for other "auto-sensing" or "dual-speed" hubs. </P>
                  <P>Some switches have the ability to replicate all traffic on 
                  all ports to a single port so that you can plug your analyzer 
                  into that single port to sniff all traffic. You would have to 
                  check the documentation for the switch to see if this is 
                  possible and, if so, to see how to do this. See, for example: 
                  </P>
                  <UL>
                    <LI><A 
                    href="http://www.cisco.com/warp/public/473/41.html">this 
                    documentation from Cisco on the Switched Port Analyzer 
                    (SPAN) feature on Catalyst switches</A>; 
                    <LI><A 
                    href="http://www.hp.com/rnd/support/faqs/sw_208_224.htm#question25">documentation 
                    from HP on how to set `monitoring'/`mirroring' on ports on 
                    the console for HP Advancestack Switch 208 and 224</A>; 
                    <LI>the `Network Monitoring Port Features' section of 
                    chapter 6 of <A 
                    href="ftp://ftp.hp.com/pub/networking/software/59692320.pdf">documentation 
                    from HP for HP ProCurve Switches 1600M, 2424M, 4000M, and 
                    8000M</A>; 
                    <LI>the `Switch Port-Mirroring' section of chapter 6 of <A 
                    href="http://www.extremenetworks.com/common/asp/frameHandler.asp?go=/services/documentation/Summit200User.pdf">documentation 
                    from Extreme Networks for their Summit 200 switches</A>; 
                    <LI><A 
                    href="http://www.foundrynet.com/services/documentation/FES/FES_Global_Features.html#59101">the 
                    documentation on `Configuring Port Mirroring and 
                    Monitoring'</A> in Foundry Networks' documentation for their 
                    FastIron Edge Switches; 
                    <LI><A 
                    href="http://www.foundrynet.com/services/documentation/mg8/BIMG8_Config_Basic%20Features.html#47463">the 
                    documentation on `Configuring Port Mirroring and 
                    Monitoring'</A> in Foundry Networks' documentation for their 
                    BigIron MG8 Layer 3 Switches; 
                    <LI>the `Port Monitor' subsection of the `Status Monitor and 
                    Statistics' section of <A 
                    href="http://www.foundrynet.com/services/documentation/edgeIron/EdgeIron-Guide-v148a.pdf">the 
                    documentation from Foundry Networks for their EdgeIron 4802F 
                    and 10GC2F switches</A>; 
                    <LI>the `Configuring Port Mirroring' section of chapter 3 of 
                    <A 
                    href="http://www.foundrynet.com/services/documentation/edgeIron/24G_2402CF_4802CF_User.pdf">the 
                    documentation from Foundry Networks for their EdgeIron 24G, 
                    2402CF, and 4802CF switches</A>; 
                    <LI>the documentation on <A 
                    href="http://www.foundrynet.com/services/documentation/sribcg/Global_Features.html#59101">`Configuring 
                    Port Mirroring and Monitoring'</A> in Foundry Networks' 
                    documentation for their other switches and metro routers. 
                    </LI></UL>
                  <P>Note also that many firewall/NAT boxes have a switch built 
                  into them; this includes many of the "cable/DSL router" boxes. 
                  If you have a box of that sort, that has a switch with some 
                  number of Ethernet ports into which you plug machines on your 
                  network, and another Ethernet port used to connect to a cable 
                  or DSL modem, you can, at least, sniff traffic between the 
                  machines on your network and the Internet by plugging the 
                  Ethernet port on the router going to the modem, the Ethernet 
                  port on the modem, and the machine on which you're running 
                  tcpdump into a hub (make sure it's not a switching hub, and 
                  that, if it's a dual-speed hub, all three of those ports are 
                  running at the same speed. </P>
                  <P>If your machine is <EM>not</EM> plugged into a switched 
                  network or a dual-speed hub, or it is plugged into a switched 
                  network but the port is set up to have all traffic replicated 
                  to it, the problem might be that the network interface on 
                  which you're capturing doesn't support "promiscuous" mode, or 
                  because your OS can't put the interface into promiscuous mode. 
                  Normally, network interfaces supply to the host only: </P>
                  <UL>
                    <LI>packets sent to one of that host's link-layer addresses; 

                    <LI>broadcast packets; 
                    <LI>multicast packets sent to a multicast address that the 
                    host has configured the interface to accept. </LI></UL>
                  <P>Most network interfaces can also be put in "promiscuous" 
                  mode, in which they supply to the host all network packets 
                  they see. Tcpdump will try to put the interface on which it's 
                  capturing into promiscuous mode unless the <TT>-p</TT> option 
                  was specified. However, some network interfaces don't support 
                  promiscuous mode, and some OSes might not allow interfaces to 
                  be put into promiscuous mode. </P>
                  <P>If the interface is not running in promiscuous mode, it 
                  won't see any traffic that isn't intended to be seen by your 
                  machine. It <STRONG>will</STRONG> see broadcast packets, and 
                  multicast packets sent to a multicast MAC address the 
                  interface is set up to receive. </P>
                  <P>You should ask the vendor of your network interface whether 
                  it supports promiscuous mode. If it does, you should ask 
                  whoever supplied the driver for the interface (the vendor, or 
                  the supplier of the OS you're running on your machine) whether 
                  it supports promiscuous mode with that network interface. </P>
                  <P>In the case of token ring interfaces, the drivers for some 
                  of them, on Windows, may require you to enable promiscuous 
                  mode in order to capture in promiscuous mode. Ask the vendor 
                  of the card how to do this, or see, for example, <A 
                  href="http://www.madge.com/_assets/downloads/lsshelp8.0/LSSHelp/AdvFeat/Promisc/Promisc2.htm">this 
                  information on promiscuous mode on some Madge token ring 
                  adapters</A> (note that those cards can have promiscuous mode 
                  disabled permanently, in which case you <EM>can't</EM> enable 
                  it). </P>
                  <P>In the case of wireless LAN interfaces, it appears that, 
                  when those interfaces are promiscuously sniffing, they're 
                  running in a significantly different mode from the mode that 
                  they run in when they're just acting as network interfaces (to 
                  the extent that it would be a significant effor for those 
                  drivers to support for promiscuously sniffing <EM>and</EM> 
                  acting as regular network interfaces at the same time), so it 
                  may be that Windows drivers for those interfaces don't support 
                  promiscuous mode.<BR>For real wireless capture, CACE 
                  Technologies offers the <A 
                  href="http://www.cacetech.com/products/airpcap.htm">AirPcap 
                  adapter</A>, specifically designed to sniff 802.11 traffic, 
                  including control frames, management frames and power 
                  information. AirPcap at this time is the only solution for 
                  capturing raw 802.11 traffic with WinPcap. More details can be 
                  found on the <A 
                  href="http://www.cacetech.com/products/airpcap.htm">AirPcap 
                  product page</A>. </P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-23>Q-23</A></B></FONT>:<EM> 
                  </EM><I>If I try to compile my application using the new pcap 
                  APIs provided in WinPcap 3.1beta, the compiler fails with 
                  <CODE>"warning C4013: 'pcap_???' undefined"</CODE> or 
                  <CODE>"error C2065: 'PCAP_OPENFLAG_????' : undeclared 
                  identifier"</CODE>. What's the problem?</I></P>
                  <P><FONT size=4><B>A</B></FONT>: The following new pcap APIs 
                  provided in WinPcap 3.1beta work only if "HAVE_REMOTE" is 
                  defined:
                  <UL>
                    <LI>pcap_open() 
                    <LI>pcap_findalldevs_ex() 
                    <LI>pcap_createsrcstr() 
                    <LI>pcap_parsesrcstr() 
                    <LI>pcap_setsampling() 
                    <LI>pcap_remoteact_accept() 
                    <LI>pcap_remoteact_list() 
                    <LI>pcap_remoteact_close() 
                    <LI>pcap_remoteact_cleanup() </LI></UL>
                  <P>You can define HAVE_REMOTE
                  <UL>
                    <LI>in your source/header files, with <CODE>#define 
                    HAVE_REMOTE</CODE>, <I>before including pcap.h</I> 
                    <LI>through a compiler/project option </LI></UL>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-24>Q-24</A></B></FONT>:<EM> 
                  </EM><I>If I try compile wpcap.dll with the project 
                  configuration "wpcap - Win32 Debug" or "wpcap - Win32 Release" 
                  some pcap APIs (like <CODE>pcap_open()</CODE>) are not 
                  exported. Is it normal?</I></P>
                  <P><FONT size=4><B>A</B></FONT>: Yes, this is normal. Some 
                  pcap APIs (the ones listed in FAQ <A 
                  href="http://www.winpcap.org/misc/faq.htm#Q-23">Q-23</A>) are 
                  compiled and exported only in the "wpcap - Win32 ??? REMOTE 
                  ???" configurations, because they depend on the remote capture 
                  stuff. 
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-25>Q-25</A></B></FONT>:<EM> I'm 
                  trying to capture from my dialup(PPP) connection with WinPcap 
                  3.1beta, but I cannot (capture from)/see any PPP adapter. 
                  What's the problem (this information applies to 2000/XP/2003 
                  only)?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: First of all, WinPcap 3.1 
                  uses the Microsoft NetMon driver to capture from dialup and 
                  VPN connection. This driver is installed automatically with 
                  the WinPcap setup. You can see this driver by looking at the 
                  properties of each network card or dialup connection (tab 
                  "General" or "Networking", depending on the adapter, it's 
                  listed as "Network Monitor Driver"). If you have accidentally 
                  removed this driver from your machine, you can reinstall it by 
                  issuing the following command (with administrator privileges) 
                  from the WinPcap installation folder, which is <CODE>\Program 
                  Files\WinPcap</CODE>:</P>
                  <BLOCKQUOTE>
                    <P><CODE>NetMonInstaller.exe i</CODE></P></BLOCKQUOTE>
                  <P>Secondly, in order to capture, you must have "Power Users" 
                  or "Administrators" privileges on Windows 2000 and XP, and 
                  "Power Users + Network Configuration Operations" or 
                  "Administrators" privileges on Windows Server 2003. If you do 
                  not have such privileges, WinPcap 3.1beta will list such 
                  adapters, but you won't be able to open them (with 
                  pcap_openXXX or PacketOpenAdapter).</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-26>Q-26</A></B></FONT>:<EM> How 
                  does WinPcap interfaces with Windows Networking? Does it slow 
                  down the TCP/IP stack and applications?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: Inside the Windows kernel, 
                  WinPcap runs as a protocol driver. It's at the same level of 
                  tcpip.sys, and like the TCP/IP stack it receives the packets 
                  from the underlying NIC driver, but only <I>when at least one 
                  WinPcap-based tool is capturing</I>. This means that when 
                  WinPcap is installed but not capturing, the impact on the 
                  system is nonexistent. <BR>Note in particular that the WinPcap 
                  driver is loaded inside the kernel only when the first capture 
                  application opens an adapter after a machine boot.</P>
                  <P>When WinPcap runs, it doesn't directly interact with 
                  TCP/IP. However especially under high network loads, the 
                  WinPcap activity (in particular the one at software interrupt 
                  level) will impact on TCP/IP responsiveness.</P>
                  <P>Note: To unload the WinPcap driver (under Windows NT4, 
                  2000, XP and 2003), the following command can be used:</P>
                  <BLOCKQUOTE>
                    <P><FONT face="Courier New" size=3>net stop npf</FONT></P>
                    <P>&nbsp;</P></BLOCKQUOTE>
                  <P><A name=Q-27><FONT size=4><B>Q-27</B></FONT></A>:<EM> My 
                  antivirus / antispyware program reports WinPcap as a virus / 
                  trojan/ spyware! Are you hackers trying to infect my 
                  computer?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: WinPcap is not a virus. 
                  WinPcap is an industry standard library used by <A 
                  href="http://www.winpcap.org/misc/links.htm">many tools</A>, 
                  several of which commercial, and developed by a respected team 
                  of people. However, since it's free and since it's an easy and 
                  powerful way to receive and transmit low-level network 
                  traffic, it seems that some virus writers used it too. As a 
                  result, at least once a month we have somebody complaining its 
                  antivirus program tells him that WinPcap <B>is</B> a virus. 
                  Your antivirus program should detect the virus itself, 
                  <B>not</B> the libraries used by it. It's like saying the MS 
                  Winsock is a virus because some trojans use sockets to send or 
                  receive data on the network.<BR>So, please contact your 
                  antivirus company and tell them to fix the problem.</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-28>Q-28</A></B></FONT>:<EM> Does 
                  WinPcap work on Windows Vista?</EM></P>
                  <P><FONT size=4><B>A</B></FONT>: </P>
                  <P><B>WinPcap 3.1</B>: The installer is able to correctly 
                  detect and install the product on Microsoft Windows Vista 
                  Beta1 (x86). <I>However</I> WinPcap has not been fully tested 
                  on this newly released operating system, since Windows Vista 
                  Beta1 was released less than two weeks before WinPcap 3.1. No 
                  other builds of Vista have been tested.<BR>Additionally, the 
                  support for this operating system is limited. In particular, 
                  these are the known limitations:</P>
                  <UL>
                    <LI>Capturing from dialup/VPN adapters is disabled. 
                    <LI>No support for IPv6 (<I>update: </I>WinPcap 4.0 beta3). 
                    <LI>WinPcap can fail listing the adapters if the TCP/IP 
                    protocol stack is not enabled. </LI></UL>
                  <P><B>WinPcap 4.0 beta2: </B>The installer is able to 
                  correctly detect and install the product on Microsoft Windows 
                  Vista Beta2 (x86). No other builds of Vista (RC1, RC2) have 
                  been tested.<BR>Additionally, the support for this operating 
                  system is limited. In particular, these are the known 
                  limitations:</P>
                  <UL>
                    <LI>Capturing from dialup/VPN adapters is disabled. 
                    <LI>No support for IPv6 (<I>update: </I>WinPcap 4.0 beta3). 
                    <LI>WinPcap can fail listing the adapters if the TCP/IP 
                    protocol stack is not enabled. </LI></UL>
                  <P><B>WinPcap 4.0 beta3: </B>The installer is able to 
                  correctly detect and install the product on Microsoft Windows 
                  Vista RTM (x86). No other builds of Vista (BETA1, BETA2, RC1, 
                  RC2) have been tested. Moreover, capturing from dialup/VPN 
                  adapters is not supported.</P>
                  <P><B>WinPcap 4.0 or newer: </B>The installer is able to 
                  correctly detect and install the product on Microsoft Windows 
                  Vista RTM (x86 and x64). No other builds of Vista (BETA1, 
                  BETA2, RC1, RC2) have been tested. Moreover, capturing from 
                  dialup/VPN adapters is not supported.</P>
                  <P><B>Previous WinPcap versions: </B>No support for Vista.</P>
                  <P><B>Windows Vista (x64)</B>: WinPcap 4.0 or newer is 
                  required.</P>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-29>Q-29</A></B></FONT>:<EM> 
                  Whenever I try to create a WinPcap-based application with 
                  Visual Studio.NET 2002 or later, I get the error 
                  "</EM><I><CODE>TypeLoadException, Could not load type 
                  pcap"</CODE>.</I></P>
                  <P><FONT size=4><B>A</B></FONT>: You are using Managed C++ 
                  (i.e. you executable is targeted to the .NET CLR, Common 
                  Language Runtime).</P>
                  <P>The problem is due to the fact that the standard WinPcap 
                  include file "pcap.h" contains only a forward declaration of 
                  "struct pcap", but not the actual definition of it. As a 
                  consequence, the Managed C++ compiler does not emit any 
                  metadata for that type, since there's no definition for 
it.</P>
                  <P>There are two solutions to the problem:</P>
                  <OL>
                    <LI>Include "<CODE>pcap-int.h</CODE>" instead of 
                    "<CODE>pcap.h</CODE>". This includes the actual definition 
                    for the type "<CODE>struct pcap</CODE>" 
                    <LI>Add a fake definition of "<CODE>struct pcap</CODE>". The 
                    simplest one is "<CODE>struct pcap{};</CODE>". </LI></OL>
                  <P>&nbsp;</P>
                  <P><FONT size=4><B><A name=Q-30>Q-30</A></B></FONT>:<EM> 
                  </EM><I>The WinPcap installation fails with the error message 
                  "An error occurred while installing the NPF driver ( -1 ). 
                  Please contact the WinPcap team".</I></P>
                  <P><FONT size=4><B>A</B></FONT>: This error is usually caused 
                  by an antivirus or antimalware software that incorrectly 
                  detects the WinPcap kernel driver (NPF) as malware. This is 
                  because in the past some malware tools have been developed 
                  over the WinPcap library.</P>
                  <P>The workaround is to disable such antivirus/antimalware 
                  programs while installing WinPcap.</P>
                  <P>&nbsp;</P></TD>
                <TD width=20>&nbsp;</TD>
                <TD vAlign=top><I><!--webbot bot="Include" U-Include="../banner.htm" TAG="BODY" startspan -->
                  <DIV id=ad160x600>
                  <SCRIPT type=text/javascript>
  function link(){
    window.location.href="http://www.cacetech.com/products/turbocap.htm?utm_source=Winpcap&amp;utm_medium=banner&amp;utm_term=vertical&amp;utm_campaign=TurboCap"; 
  } 
</SCRIPT>

                  <TABLE onmouseover="this.style.cursor='pointer'" 
                  onclick=link() borderColor=#ffffff height=600 cellSpacing=1 
                  width=160 bgColor=#eeeeee border=0>
                    <TBODY>
                    <TR>
                      <TD><IMG height=600 
                        src="WinPcap Frequently Asked Questions_files/turbocap_banner.png" 
                        width=160 border=0></TD></TR></TBODY></TABLE></DIV><!--webbot bot="Include" endspan i-checksum="6429" --></I>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD vAlign=top bgColor=#ffffff>&nbsp;</TD></TR>
  <TR>
    <TD vAlign=bottom bgColor=#ffffff><IMG height=28 
      src="WinPcap Frequently Asked Questions_files/curvedown.gif" width=31 
      border=0></TD></TR>
  <TR>
    <TD vAlign=bottom>
      <P align=right><I><BR>Last modified: <!--webbot bot="Timestamp"
            S-Type="EDITED" S-Format="%A, %B %d, %Y %H.%M" startspan -->Monday, 
      November 12, 2007 18.58<!--webbot bot="Timestamp" endspan i-checksum="60180" --> 
  </I></P></TD></TR></TBODY></TABLE></BODY></HTML>
